(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84438,       2474]
NotebookOptionsPosition[     80435,       2333]
NotebookOutlinePosition[     80792,       2349]
CellTagsIndexPosition[     80749,       2346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6682273356962023`*^9, 3.668227348117989*^9}, {
   3.66823504347218*^9, 3.668235051088855*^9}, {3.66878897064669*^9, 
   3.668788976459469*^9}, 3.669464023036398*^9}],

Cell[BoxData["\<\"/Users/neerajsarna/sciebo/DG_moments_deal/Mathematica_files\
\"\>"], "Output",
 CellChangeTimes->{3.6694640236948442`*^9, 3.669544373074829*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["develop sparsity and write matrix", "Section",
 CellChangeTimes->{{3.6681731720116997`*^9, 3.66817319332295*^9}, {
   3.668228151665504*^9, 3.668228156542235*^9}, 3.668228799380147*^9, {
   3.668228831468952*^9, 3.66822883407552*^9}}],

Cell["\<\
Use this function to create the entries of the sparse matrix. The first value \
written to the file is the number of non zeros. Incase of symbolic matrices, \
the entries are considered to be zero. flag = 0 for symbolic, flag = 1 for \
constant matrices.

Caution: always send N[a].\
\>", "Text",
 CellChangeTimes->{{3.66822884187737*^9, 3.668228941383243*^9}, {
  3.668229646182706*^9, 3.668229661478045*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"developsparsity", "[", 
   RowBox[{"a_", ",", "filename_", ",", "flag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nnz", ",", "indicies", ",", "rowindicies", ",", "colindicies", ",", 
      "entries", ",", "str"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nnz", " ", "=", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", "a", "]"}], "]"}], "-", 
       RowBox[{"Count", "[", 
        RowBox[{"a", ",", "0.", ",", "Infinity"}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"total", " ", "number", " ", "of", " ", "non"}], "-", 
       RowBox[{"zeros", " ", "in", " ", "the", " ", "matrix"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"indicies", " ", "=", " ", 
      RowBox[{
       RowBox[{"ArrayRules", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "nnz"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rowindicies", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "nnz"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colindicies", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "nnz"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"entries", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "nnz"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rowindicies", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"indicies", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "indicies", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"colindicies", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"indicies", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "indicies", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"entries", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"indicies", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "indicies", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"OpenWrite", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<../system_matrices/\>\"", ",", "filename"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", 
       RowBox[{"ToString", "[", "nnz", "]"}], ",", "\"\<\\n\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"flag", " ", "\[Equal]", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"WriteString", "[", 
            RowBox[{"str", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"rowindicies", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\< \>\"", " ", 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"colindicies", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\< \>\"", " ", 
             ",", 
             RowBox[{"ToString", "[", "0", "]"}], ",", "\"\<\\n\>\""}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{"Length", "[", "rowindicies", "]"}]}], "}"}]}], "]"}], 
         ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"flag", " ", "\[Equal]", " ", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"WriteString", "[", 
            RowBox[{"str", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"rowindicies", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\< \>\"", " ", 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"colindicies", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\< \>\"", " ", 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"entries", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{"Length", "[", "rowindicies", "]"}]}], "}"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "str", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.668173195704064*^9, 3.668173232725699*^9}, {
  3.668226970770607*^9, 3.6682270927202587`*^9}, {3.6682271428666363`*^9, 
  3.668227155768401*^9}, {3.668227193724353*^9, 3.668227323574191*^9}, {
  3.668227415971815*^9, 3.668227421857192*^9}, {3.668227680651102*^9, 
  3.668227718490542*^9}, {3.6682279731791277`*^9, 3.668228105520145*^9}, {
  3.6682289471772957`*^9, 3.668229088847966*^9}, {3.6682292584757767`*^9, 
  3.668229263653676*^9}, {3.6682295296762543`*^9, 3.66822953308567*^9}, {
  3.668229643177256*^9, 3.6682296763141413`*^9}, {3.6687889038876867`*^9, 
  3.668788918608638*^9}, {3.668788982206395*^9, 3.668788982557585*^9}, {
  3.669542397774646*^9, 3.6695424007824087`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["System A", "Title",
 CellChangeTimes->{{3.669461769616527*^9, 3.669461771405653*^9}}],

Cell[CellGroupData[{

Cell["entropy", "Section",
 CellChangeTimes->{{3.670671885850288*^9, 3.670671886816636*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"entropyA", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     SuperscriptBox["\[Theta]", "2"], "+", 
     SuperscriptBox["qx", "2"], "+", 
     SuperscriptBox["qy", "2"], "+", 
     SuperscriptBox["Rxx", "2"], "+", 
     SuperscriptBox["Ryy", "2"], "+", 
     RowBox[{"2", 
      SuperscriptBox["Rxy", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Rxx", "+", "Ryy"}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UA", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\[Theta]", ",", "qx", ",", "qy", ",", "Rxx", ",", "Rxy", ",", "Ryy"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetrizerA", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"entropyA", ",", 
       RowBox[{"{", "UA", "}"}]}], "]"}], ",", 
     RowBox[{"{", "UA", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", "symmetrizerA", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetrizerA", ".", "Ax"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"developsparsity", "[", 
  RowBox[{
   RowBox[{"N", "[", "symmetrizerA", "]"}], ",", "\"\<6S.txt\>\"", ",", "1"}],
   "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.670671933982193*^9, 3.670672019177978*^9}, {
  3.670672667350333*^9, 3.670672679766087*^9}, {3.670672746386731*^9, 
  3.670672770556343*^9}, {3.670672934532301*^9, 3.6706729517026663`*^9}, {
  3.670673006350505*^9, 3.670673021646216*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "4", ",", "2", ",", "2", ",", "2", ",", "2"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.670671989540197*^9, 3.6706720259380627`*^9}, {
   3.6706727600450773`*^9, 3.670672770984294*^9}, {3.670672935781314*^9, 
   3.670672947846903*^9}, 3.67067302209481*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "2.`", "0.`", "0.`", "0.`", "0.`"},
     {"2.`", "0.`", "0.`", "2.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "2.`", "0.`"},
     {"0.`", "2.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "2.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.670671989540197*^9, 3.6706720259380627`*^9}, {
   3.6706727600450773`*^9, 3.670672770984294*^9}, {3.670672935781314*^9, 
   3.670672947846903*^9}, 3.670673022104196*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projector Matrix", "Section",
 CellChangeTimes->{{3.66816612877555*^9, 3.668166131598057*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"nx_", ",", "ny_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1.0"}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", "nx"}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", "ny"}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", "nx"}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", 
       RowBox[{"nx", "*", "nx"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "5"}], "]"}], "]"}], "=", 
       RowBox[{"2", "*", "nx", "*", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "6"}], "]"}], "]"}], "=", 
       RowBox[{"ny", "*", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "4"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "nx"}], "*", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "5"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"nx", "*", "nx"}], "-", 
        RowBox[{"ny", "*", "ny"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "6"}], "]"}], "]"}], "=", 
       RowBox[{"nx", "*", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"6", ",", "4"}], "]"}], "]"}], "=", 
       RowBox[{"ny", "*", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"6", ",", "5"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "2"}], "*", "nx", "*", "ny"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", 
       RowBox[{"nx", "*", "nx"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6681661349926653`*^9, 3.668166141886918*^9}, {
  3.66816619437088*^9, 3.668166286485059*^9}, {3.668234932366765*^9, 
  3.668235037095531*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["BC matrix", "Section",
 CellChangeTimes->{{3.668167107632235*^9, 3.668167109102911*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BC", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCrhs", " ", "=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", "chi"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"1.0", "*", "chi"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "3"}], "]"}], "]"}], "=", "chi"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BC", "[", 
     RowBox[{"[", 
      RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", "1.0"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCrhs", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"chi", "*", "theta0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BCrhs", "[", 
    RowBox[{"[", "5", "]"}], "]"}], "=", 
   RowBox[{"uW", "*", 
    RowBox[{"p", "[", "1", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.668167136835634*^9, 3.6681672383079157`*^9}, {
   3.668167274782091*^9, 3.668167294223648*^9}, {3.668167346685598*^9, 
   3.668167399185473*^9}, {3.668229170280418*^9, 3.6682291863435297`*^9}, {
   3.668229723418779*^9, 3.668229725785616*^9}, 3.6682350654654837`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BCrhs", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"BC", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6681672431937637`*^9, 3.668167246522026*^9}, {
  3.668167384321085*^9, 3.66816738449725*^9}, {3.668229188679359*^9, 
  3.668229191396183*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{"chi", " ", "theta0"}]},
      {"0"},
      {"0"},
      {
       RowBox[{"uW", " ", 
        RowBox[{"p", "[", "1", "]"}]}]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.668167246858397*^9, {3.6681673852962303`*^9, 3.668167401706259*^9}, 
   3.668229191831009*^9, 3.6682292845257597`*^9, 3.669637501683858*^9, 
   3.6701618817985153`*^9, 3.6706713245322227`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0", "0", "0", "0", "0"},
     {"chi", "0", "0", 
      RowBox[{"1.`", " ", "chi"}], "0", "0"},
     {"0", "0", "1.`", "0", "0", "0"},
     {"0", "0", "0", "1.`", "0", "0"},
     {"0", "0", "chi", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.668167246858397*^9, {3.6681673852962303`*^9, 3.668167401706259*^9}, 
   3.668229191831009*^9, 3.6682292845257597`*^9, 3.669637501683858*^9, 
   3.6701618817985153`*^9, 3.670671324543955*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Ax and Ay", "Section",
 CellChangeTimes->{{3.668167542126465*^9, 3.668167542605095*^9}, {
  3.668235070958353*^9, 3.668235072302519*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ax", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ay", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.668167545031974*^9, 3.6681675711603317`*^9}, {
  3.668228410999034*^9, 3.6682284568501177`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "5"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"2", "/", "3"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "1"}], "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ay", " ", "=", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"Projector", "[", 
       RowBox[{"0", ",", "1"}], "]"}], "]"}], ".", "Ax", ".", 
     RowBox[{"Projector", "[", 
      RowBox[{"0", ",", "1"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"developsparsity", "[", 
  RowBox[{
   RowBox[{"N", "[", "Ax", "]"}], ",", "\"\<6A1.txt\>\"", ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"developsparsity", "[", 
   RowBox[{
    RowBox[{"N", "[", "Ay", "]"}], ",", "\"\<6A2.txt\>\"", ",", "1"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.668228538024083*^9, 3.668228717984861*^9}, 
   3.6682287928852654`*^9, {3.668229318261447*^9, 3.668229374621969*^9}, {
   3.668229538804018*^9, 3.668229567259851*^9}, {3.668239971119564*^9, 
   3.668239980094585*^9}, {3.670672100348789*^9, 3.670672102147484*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Ax", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Ay", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6682287217735653`*^9, 3.6682287231780157`*^9}, {
  3.668228760715251*^9, 3.668228769511263*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1.`", "0", "0", "0", "0"},
     {"1.`", "0", "0", "1.`", "0", "0"},
     {"0", "0", "0", "0", "1.`", "0"},
     {"0", 
      FractionBox["2", "3"], "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", "3"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6682287699028873`*^9, 3.669637501793293*^9, 
  3.670161881917243*^9, 3.670671324656356*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
     {"1.`", "0.`", "0.`", "0.`", "0.`", "1.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "0.3333333333333333`"}], "0.`", "0.`", "0.`"},
     {"0.`", "0.5`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.6666666666666666`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6682287699028873`*^9, 3.669637501793293*^9, 
  3.670161881917243*^9, 3.670671324669242*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{"BC", ",", "0", ",", "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.6682292241499653`*^9, 3.6682292298181057`*^9}}],

Cell[BoxData["29"], "Output",
 CellChangeTimes->{3.6682292301832457`*^9, 3.6696375018423977`*^9, 
  3.6701618819688597`*^9, 3.6706713247064447`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{"Ax", ",", "0.", ",", "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.668229399291717*^9, 3.668229405492681*^9}, {
  3.668229603654406*^9, 3.668229621176084*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.668229405894606*^9, {3.668229605980451*^9, 3.668229621740861*^9}, 
   3.669637501892982*^9, 3.670161882002668*^9, 3.6706713247387657`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Production term", "Section",
 CellChangeTimes->{{3.6682297706826887`*^9, 3.668229773785501*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"valuesdiagonal", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", " ", "=", 
    RowBox[{"DiagonalMatrix", "[", "valuesdiagonal", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"developsparsity", "[", 
   RowBox[{
    RowBox[{"N", "[", "P", "]"}], ",", "\"\<6P.txt\>\"", ",", "1"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6682297766927423`*^9, 3.668229786490243*^9}, {
   3.668229891450204*^9, 3.668230040674677*^9}, {3.6687889322178926`*^9, 
   3.668788947068466*^9}, 3.670672113763754*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6682300138065443`*^9, 3.6682300412785397`*^9}, 
   3.668788947794016*^9, 3.668788988867683*^9, 3.669637501927466*^9, 
   3.670161882035015*^9, 3.670671324773243*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["An", "Section",
 CellChangeTimes->{{3.668233981028426*^9, 3.668233981339031*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"An", " ", "=", " ", 
   RowBox[{
    RowBox[{"Ax", " ", "nx"}], " ", "+", " ", 
    RowBox[{"Ay", " ", "ny"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"developsparsity", "[", 
   RowBox[{"An", ",", "\"\<6An.txt\>\"", ",", "0"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"An", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.668233983873081*^9, 3.668234014406711*^9}, {
   3.6682382265403833`*^9, 3.668238230105122*^9}, 3.6706724335714684`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "nx"}]}], 
      RowBox[{"1.`", " ", "ny"}], "0.`", "0.`", "0.`"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "nx"}]}], "0.`", "0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "nx"}]}], 
      RowBox[{"1.`", " ", "ny"}], "0.`"},
     {
      RowBox[{"1.`", " ", "ny"}], "0.`", "0.`", "0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "nx"}]}], 
      RowBox[{"1.`", " ", "ny"}]},
     {"0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       FractionBox[
        RowBox[{"2", " ", "nx"}], "3"]}], 
      RowBox[{
       RowBox[{"-", "0.3333333333333333`"}], " ", "ny"}], "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"0.5`", " ", "ny"}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       FractionBox["nx", "2"]}], "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       FractionBox["nx", "3"]}], 
      RowBox[{"0.6666666666666666`", " ", "ny"}], "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.668238230500681*^9, 3.669637501957094*^9, 
  3.670161882068824*^9, 3.670671324824155*^9, 3.6706724342252502`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["|S.An|", "Section",
 CellChangeTimes->{{3.670694038103603*^9, 3.670694043712446*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SAn", " ", "=", 
   RowBox[{"TrigReduce", "[", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"symmetrizerA", ".", 
       RowBox[{"Projector", "[", 
        RowBox[{"nx", ",", 
         RowBox[{"-", "ny"}]}], "]"}], ".", "Ax", ".", 
       RowBox[{"Projector", "[", 
        RowBox[{"nx", ",", "ny"}], "]"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nx", "\[Rule]", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"ny", "\[Rule]", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"Eigenvalues", "[", "SAn", "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.670694047313587*^9, 3.670694177737584*^9}, 
   3.670694216415811*^9, {3.670697386803678*^9, 3.670697394068843*^9}, {
   3.670697557618453*^9, 3.6706976045376177`*^9}, {3.6706976458113823`*^9, 
   3.670697686413377*^9}, {3.6706977212685537`*^9, 3.670697723854785*^9}, {
   3.670699964466599*^9, 3.670699982188972*^9}, {3.6707000526309137`*^9, 
   3.670700054117174*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", 
   RowBox[{"Root", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"8.666666666666666`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "\[Theta]"}], "]"}]}], "-", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["#1", "2"]}], "+", 
       RowBox[{"0.3333333333333333`", " ", 
        SuperscriptBox["#1", "4"]}]}], "&"}], ",", "1"}], "]"}], ",", 
   RowBox[{"Root", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"8.666666666666666`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "\[Theta]"}], "]"}]}], "-", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["#1", "2"]}], "+", 
       RowBox[{"0.3333333333333333`", " ", 
        SuperscriptBox["#1", "4"]}]}], "&"}], ",", "2"}], "]"}], ",", 
   RowBox[{"Root", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"8.666666666666666`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "\[Theta]"}], "]"}]}], "-", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["#1", "2"]}], "+", 
       RowBox[{"0.3333333333333333`", " ", 
        SuperscriptBox["#1", "4"]}]}], "&"}], ",", "3"}], "]"}], ",", 
   RowBox[{"Root", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"8.666666666666666`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.`", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "\[Theta]"}], "]"}]}], "-", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["#1", "2"]}], "+", 
       RowBox[{"0.3333333333333333`", " ", 
        SuperscriptBox["#1", "4"]}]}], "&"}], ",", "4"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.670697604830748*^9, 3.670697651425655*^9, 3.670697686874312*^9, {
   3.6706999672127657`*^9, 3.670699982512197*^9}, 3.670700054573329*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["System B", "Title",
 CellChangeTimes->{{3.669461778659162*^9, 3.6694617801576242`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nEqnB", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nBC", " ", "=", " ", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.669462017105925*^9, 3.669462024433653*^9}, {
  3.66946590973746*^9, 3.6694659136522627`*^9}, {3.669466719889617*^9, 
  3.669466721177087*^9}}],

Cell[CellGroupData[{

Cell["Projector Matrix", "Section",
 CellChangeTimes->{{3.668167107632235*^9, 3.668167109102911*^9}, {
  3.669461872903412*^9, 3.6694618851939373`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Projector", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"nEqnB", ",", "nEqnB"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", "nx"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", "ny"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"-", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", "nx"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "5"}], "]"}], "]"}], "=", 
   RowBox[{"2", "*", "nx", "*", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "6"}], "]"}], "]"}], "=", 
   RowBox[{"ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "nx"}], "*", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "5"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"nx", " ", "nx"}], "-", 
    RowBox[{"ny", " ", "ny"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "6"}], "]"}], "]"}], "=", 
   RowBox[{"nx", "*", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "5"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "nx", "*", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", 
   RowBox[{"nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "7"}], "]"}], "]"}], "=", 
   RowBox[{"nx", "*", "nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "8"}], "]"}], "]"}], "=", 
   RowBox[{"3", "*", "ny", "*", "nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "9"}], "]"}], "]"}], "=", 
   RowBox[{"3", "*", "nx", "*", "ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "10"}], "]"}], "]"}], "=", 
   RowBox[{"ny", "*", "ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"8", ",", "7"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "ny"}], "*", "nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"8", ",", "8"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"nx", "*", "nx", " ", "nx"}], "-", 
    RowBox[{"2", "*", "nx", "*", "ny", " ", "ny"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"8", ",", "9"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", "*", "ny", "*", "nx", " ", "nx"}], "-", 
    RowBox[{"ny", "*", "ny", " ", "ny"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"8", ",", "10"}], "]"}], "]"}], "=", 
   RowBox[{"nx", "*", "ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "7"}], "]"}], "]"}], "=", 
   RowBox[{"nx", "*", "ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "8"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], "*", "ny", "*", "nx", " ", "nx"}], "+", 
    RowBox[{"ny", "*", "ny", " ", "ny"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "9"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"nx", "*", "nx", " ", "nx"}], "-", 
    RowBox[{"2", "*", "nx", "*", "ny", " ", "ny"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "10"}], "]"}], "]"}], "=", 
   RowBox[{"ny", "*", "nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"10", ",", "7"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "ny"}], "*", "ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"10", ",", "8"}], "]"}], "]"}], "=", 
   RowBox[{"3", "*", "nx", "*", "ny", " ", "ny"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"10", ",", "9"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "3"}], "*", "ny", "*", "nx", " ", "nx"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"[", 
     RowBox[{"10", ",", "10"}], "]"}], "]"}], "=", 
   RowBox[{"nx", "*", "nx", " ", "nx"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.668167136835634*^9, 3.6681672383079157`*^9}, {
   3.668167274782091*^9, 3.668167294223648*^9}, {3.668167346685598*^9, 
   3.668167399185473*^9}, {3.668229170280418*^9, 3.6682291863435297`*^9}, {
   3.668229723418779*^9, 3.668229725785616*^9}, 3.6682350654654837`*^9, {
   3.6694620365111923`*^9, 3.669462072643057*^9}, {3.669462148232964*^9, 
   3.669462201856625*^9}, {3.6694622353770533`*^9, 3.6694623149639*^9}, {
   3.6694623597497473`*^9, 3.669462710612587*^9}, {3.669463397114246*^9, 
   3.669463429376215*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["System Matrix", "Section",
 CellChangeTimes->{{3.669462749298864*^9, 3.6694627517620687`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ax", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"nEqnB", ",", "nEqnB"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "5"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"4.0", "/", "3"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "7"}], "]"}], "]"}], "=", "2.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "8"}], "]"}], "]"}], "=", "2.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "3"}], "]"}], "]"}], "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2.0"}], "/", "3"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "9"}], "]"}], "]"}], "=", "2.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"3.0", "/", "5"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"8", ",", "5"}], "]"}], "]"}], "=", 
   RowBox[{"8.0", "/", "15"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "6"}], "]"}], "]"}], "=", 
   RowBox[{"1.0", "/", "3"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ax", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2.0"}], "/", "15"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ax", "[", 
     RowBox[{"[", 
      RowBox[{"10", ",", "5"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", "2.0"}], "/", "5"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ay", " ", "=", " ", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"(", 
      RowBox[{"Projector", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nx", "\[Rule]", "0"}], ",", 
         RowBox[{"ny", "\[Rule]", "1"}]}], "}"}]}], ")"}], "]"}], ".", "Ax", 
    ".", 
    RowBox[{"(", 
     RowBox[{"Projector", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nx", "\[Rule]", "0"}], ",", 
        RowBox[{"ny", "\[Rule]", "1"}]}], "}"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ax", "//", "MatrixForm"}], "//", "TraditionalForm"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ay", "//", "MatrixForm"}], "//", "TraditionalForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrayRules", "[", "Ax", "]"}], "//", "MatrixForm"}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrayRules", "[", "Ay", "]"}], "//", "MatrixForm"}], "//", 
   "TraditionalForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"developsparsity", "[", 
  RowBox[{
   RowBox[{"N", "[", "Ax", "]"}], ",", "\"\<10A1.txt\>\"", ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"developsparsity", "[", 
   RowBox[{
    RowBox[{"N", "[", "Ay", "]"}], ",", "\"\<10A2.txt\>\"", ",", "1"}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6694627537444487`*^9, 3.6694628106059113`*^9}, {
  3.669462854707877*^9, 3.6694629601865997`*^9}, {3.669463054575781*^9, 
  3.669463067411045*^9}, {3.669463266309106*^9, 3.669463381735436*^9}, {
  3.6694634372705517`*^9, 3.669463455994079*^9}, {3.669463685961817*^9, 
  3.669463769094901*^9}, {3.66946382342915*^9, 3.6694638964273367`*^9}, {
  3.669463986119438*^9, 3.669463995348338*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0"},
      {"1.`", "0", "0", "1.`", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "1.`", "0", "0", "0", "0", "0"},
      {"0", "1.3333333333333333`", "0", "0", "0", "0", "2.`", "0", "0", "0"},
      {"0", "0", "1.`", "0", "0", "0", "0", "2.`", "0", "0"},
      {"0", 
       RowBox[{"-", "0.6666666666666666`"}], "0", "0", "0", "0", "0", "0", 
       "2.`", "0"},
      {"0", "0", "0", "0.6000000000000001`", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0.5333333333333333`", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       RowBox[{"-", "0.13333333333333333`"}], "0", "0.3333333333333333`", "0",
        "0", "0", "0"},
      {"0", "0", "0", "0", 
       RowBox[{"-", "0.4`"}], "0", "0", "0", "0", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6694629487862062`*^9, 3.669462960544304*^9}, {
   3.66946305978557*^9, 3.669463067768262*^9}, {3.669463312417933*^9, 
   3.669463382864255*^9}, {3.669463456482998*^9, 3.669463477396164*^9}, 
   3.669463695809162*^9, {3.669463735003063*^9, 3.6694637696459837`*^9}, {
   3.669463852482915*^9, 3.6694638971349497`*^9}, {3.669463984146413*^9, 
   3.6694639960360537`*^9}, 3.669464092364044*^9}],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
      {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
      {"1.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`"},
      {"0.`", "0.`", 
       RowBox[{"-", "0.6666666666666666`"}], "0.`", "0.`", "0.`", "0.`", 
       "2.`", "0.`", "0.`"},
      {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "2.`", "0.`"},
      {"0.`", "0.`", "1.3333333333333333`", "0.`", "0.`", "0.`", "0.`", "0.`",
        "0.`", "2.`"},
      {"0.`", "0.`", "0.`", "0.`", 
       RowBox[{"-", "0.4`"}], "0.`", "0.`", "0.`", "0.`", "0.`"},
      {"0.`", "0.`", "0.`", "0.3333333333333333`", "0.`", 
       RowBox[{"-", "0.13333333333333333`"}], "0.`", "0.`", "0.`", "0.`"},
      {"0.`", "0.`", "0.`", "0.`", "0.5333333333333333`", "0.`", "0.`", "0.`",
        "0.`", "0.`"},
      {"0.`", "0.`", "0.`", "0.`", "0.`", "0.6000000000000001`", "0.`", "0.`",
        "0.`", "0.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6694629487862062`*^9, 3.669462960544304*^9}, {
   3.66946305978557*^9, 3.669463067768262*^9}, {3.669463312417933*^9, 
   3.669463382864255*^9}, {3.669463456482998*^9, 3.669463477396164*^9}, 
   3.669463695809162*^9, {3.669463735003063*^9, 3.6694637696459837`*^9}, {
   3.669463852482915*^9, 3.6694638971349497`*^9}, {3.669463984146413*^9, 
   3.6694639960360537`*^9}, 3.669464092373478*^9}],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", 
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "5"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "2"}], "}"}], "\[Rule]", 
         "1.3333333333333333`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "7"}], "}"}], "\[Rule]", "2.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "3"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "8"}], "}"}], "\[Rule]", "2.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "2"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.6666666666666666`"}]}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "9"}], "}"}], "\[Rule]", "2.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "4"}], "}"}], "\[Rule]", 
         "0.6000000000000001`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"8", ",", "5"}], "}"}], "\[Rule]", 
         "0.5333333333333333`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.13333333333333333`"}]}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"9", ",", "6"}], "}"}], "\[Rule]", 
         "0.3333333333333333`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"10", ",", "5"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.4`"}]}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], "\[Rule]", "0"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.5599999999999999]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     Column], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6694629487862062`*^9, 3.669462960544304*^9}, {
   3.66946305978557*^9, 3.669463067768262*^9}, {3.669463312417933*^9, 
   3.669463382864255*^9}, {3.669463456482998*^9, 3.669463477396164*^9}, 
   3.669463695809162*^9, {3.669463735003063*^9, 3.6694637696459837`*^9}, {
   3.669463852482915*^9, 3.6694638971349497`*^9}, {3.669463984146413*^9, 
   3.6694639960360537`*^9}, 3.669464092381403*^9}],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", 
    TagBox[GridBox[{
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "5"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "6"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "3"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.6666666666666666`"}]}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "8"}], "}"}], "\[Rule]", "2.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "2"}], "}"}], "\[Rule]", "1.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "9"}], "}"}], "\[Rule]", "2.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "3"}], "}"}], "\[Rule]", 
         "1.3333333333333333`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "10"}], "}"}], "\[Rule]", "2.`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "5"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.4`"}]}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"8", ",", "4"}], "}"}], "\[Rule]", 
         "0.3333333333333333`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"8", ",", "6"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.13333333333333333`"}]}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"9", ",", "5"}], "}"}], "\[Rule]", 
         "0.5333333333333333`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"10", ",", "6"}], "}"}], "\[Rule]", "0.6000000000000001`"}]},
       {
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], "\[Rule]", "0"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.5599999999999999]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     Column], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6694629487862062`*^9, 3.669462960544304*^9}, {
   3.66946305978557*^9, 3.669463067768262*^9}, {3.669463312417933*^9, 
   3.669463382864255*^9}, {3.669463456482998*^9, 3.669463477396164*^9}, 
   3.669463695809162*^9, {3.669463735003063*^9, 3.6694637696459837`*^9}, {
   3.669463852482915*^9, 3.6694638971349497`*^9}, {3.669463984146413*^9, 
   3.6694639960360537`*^9}, 3.6694640923871326`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.669464144498992*^9, 3.6694641459332542`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Production term", "Section",
 CellChangeTimes->{{3.6694641834749603`*^9, 3.6694641857704973`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"valuesdiagonal", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", "valuesdiagonal", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"developsparsity", "[", 
    RowBox[{
     RowBox[{"N", "[", "P", "]"}], ",", "\"\<10P.txt\>\"", ",", "1"}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6694641941888866`*^9, 3.6694642050892973`*^9}, {
  3.669464292299955*^9, 3.6694643414363728`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary condition matrix", "Section",
 CellChangeTimes->{{3.6694657339651003`*^9, 3.669465739244362*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X0", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"nEqnB", ",", "nBC"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X0", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X0", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X0", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "3"}], "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"X0", "[", 
     RowBox[{"[", 
      RowBox[{"9", ",", "4"}], "]"}], "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BC", " ", "is", " ", 
     RowBox[{"BC", ".", "U"}]}], " ", "=", " ", "g"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"nBC", ",", "nEqnB"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "chi"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"-", "1.0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", "chi"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "5"}], "]"}], "]"}], "=", 
   RowBox[{"-", "1.0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "8"}], "]"}], "]"}], "=", 
   RowBox[{"kappa", "*", "chiW"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "4"}], "]"}], "]"}], "=", "chi"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "7"}], "]"}], "]"}], "=", 
   RowBox[{"-", "1.0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "6"}], "]"}], "]"}], "=", "chi"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BC", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "9"}], "]"}], "]"}], "=", 
    RowBox[{"-", "1.0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "\[Theta]", ",", "qn", ",", "qt", ",", "Rnn", ",", "Rnt", ",", "Rtt", 
      ",", "\[Psi]nnn", ",", "\[Psi]nnt", ",", "\[Psi]ntt", ",", 
      "\[Psi]ttt"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Developing", " ", "BC", " ", "to", " ", "the", " ", "BC", " ", "in", " ",
      "u"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"BC", ".", "u"}], " ", "-", " ", "g"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCnew", " ", "=", " ", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Chi]", " ", "\[Theta]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"qt", "\[Equal]", "0"}], ",", 
         RowBox[{"Rnn", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Chi]", " ", "qt"}], "+", 
           RowBox[{
           "2", " ", "*", " ", "\[Chi]", " ", "*", " ", "\[Psi]nnt"}]}], 
          "\[Equal]", " ", "0"}], ",", 
         RowBox[{"Rtt", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Chi]", " ", "Rnn"}], "\[Equal]", "0"}], ",", 
         RowBox[{"\[Psi]nnt", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Chi]", " ", "Rtt"}], " ", "\[Equal]", " ", "0"}], ",", 
         RowBox[{"\[Psi]ttt", "\[Equal]", "0"}]}], "}"}], ",", "U"}], "]"}], 
     "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Converting", " ", "BCnew", " ", "to", " ", "a", " ", "full", " ", 
    "matrix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCnew2", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "10"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"BCnew", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "/.", 
            RowBox[{"\[Chi]", "\[Rule]", "1"}]}], ")"}], "\[NotEqual]", "0"}],
          ",", 
         RowBox[{
          RowBox[{"BCnew2", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "=", 
          RowBox[{"BCnew", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj"}], "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", "1", ",", "nEqnB"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "nEqnB"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC", ".", "U"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"BCnew", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"U", "-", 
    RowBox[{"BCnew", ".", "U"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayRules", "[", "BCnew", "]"}], "\[IndentingNewLine]", 
 RowBox[{"developsparsity", "[", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"BCnew2", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Chi]", "\[Rule]", "1"}], "}"}]}], "]"}], ",", 
   "\"\<10BC.txt\>\"", ",", "1"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.669465741157029*^9, 3.6694659949241753`*^9}, {
   3.669466028518326*^9, 3.669466059087019*^9}, {3.669466604571867*^9, 
   3.669466699986724*^9}, {3.66946673308873*^9, 3.66946677492064*^9}, {
   3.6695386103638573`*^9, 3.66953861223459*^9}, {3.669540114069283*^9, 
   3.6695401840216217`*^9}, {3.669541404220098*^9, 3.669541458362795*^9}, {
   3.669541509743507*^9, 3.669541629649158*^9}, {3.669541664354578*^9, 
   3.669541771190962*^9}, {3.669541805723054*^9, 3.669541867809637*^9}, {
   3.669541906037899*^9, 3.669541920329953*^9}, {3.669542036801756*^9, 
   3.669542051144247*^9}, {3.6695422558814983`*^9, 3.66954234398691*^9}, {
   3.669543949723399*^9, 3.669544018965741*^9}, 3.669544101975421*^9, {
   3.669544143592725*^9, 3.669544155992837*^9}, {3.669544225500751*^9, 
   3.669544323389647*^9}, {3.669544357576277*^9, 3.669544363429809*^9}, {
   3.670996886203312*^9, 3.6709969064881973`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.`"}], " ", "qn"}], "+", 
        RowBox[{"chi", " ", "\[Theta]"}]}]},
      {
       RowBox[{
        RowBox[{"chi", " ", "qt"}], "-", 
        RowBox[{"1.`", " ", "Rnt"}], "+", 
        RowBox[{"chiW", " ", "kappa", " ", "\[Psi]nnt"}]}]},
      {
       RowBox[{
        RowBox[{"chi", " ", "Rnn"}], "-", 
        RowBox[{"1.`", " ", "\[Psi]nnn"}]}]},
      {
       RowBox[{
        RowBox[{"chi", " ", "Rtt"}], "-", 
        RowBox[{"1.`", " ", "\[Psi]ntt"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669540179933435*^9, 3.669540184367526*^9}, {
   3.669541701200108*^9, 3.669541740209993*^9}, {3.669541855547288*^9, 
   3.6695418686413307`*^9}, {3.6695419091371593`*^9, 
   3.6695419207026463`*^9}, {3.669542046544066*^9, 3.669542051555575*^9}, 
   3.669542274143705*^9, {3.6695423279764347`*^9, 3.6695423449902077`*^9}, {
   3.669543992524206*^9, 3.669544019708315*^9}, {3.669544102566052*^9, 
   3.669544110974855*^9}, 3.669544156458805*^9, 3.669544283121976*^9, 
   3.669544332635459*^9, {3.669544364631585*^9, 3.669544376907649*^9}, 
   3.6709968666024637`*^9, 3.6709969069271717`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"\[Chi]", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "\[Chi]", "0", "0", "0", "0", 
      RowBox[{"2", " ", "\[Chi]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "\[Chi]", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "\[Chi]", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {10, 10}, 0, {
     1, {{0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11}, {{1}, {1}, {3}, {4}, {3}, {8}, {
       6}, {4}, {8}, {6}, {10}}}, {
      1, $CellContext`\[Chi], 1, 1, $CellContext`\[Chi], 
       2 $CellContext`\[Chi], 1, $CellContext`\[Chi], 1, $CellContext`\[Chi], 
       1}}]]]]], "Output",
 CellChangeTimes->{{3.669540179933435*^9, 3.669540184367526*^9}, {
   3.669541701200108*^9, 3.669541740209993*^9}, {3.669541855547288*^9, 
   3.6695418686413307`*^9}, {3.6695419091371593`*^9, 
   3.6695419207026463`*^9}, {3.669542046544066*^9, 3.669542051555575*^9}, 
   3.669542274143705*^9, {3.6695423279764347`*^9, 3.6695423449902077`*^9}, {
   3.669543992524206*^9, 3.669544019708315*^9}, {3.669544102566052*^9, 
   3.669544110974855*^9}, 3.669544156458805*^9, 3.669544283121976*^9, 
   3.669544332635459*^9, {3.669544364631585*^9, 3.669544376907649*^9}, 
   3.6709968666024637`*^9, 3.670996906938898*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{"qn", "-", 
        RowBox[{"\[Theta]", " ", "\[Chi]"}]}]},
      {"0"},
      {"0"},
      {
       RowBox[{"Rnt", "-", 
        RowBox[{"qt", " ", "\[Chi]"}], "-", 
        RowBox[{"2", " ", "\[Chi]", " ", "\[Psi]nnt"}]}]},
      {"0"},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "Rnn"}], " ", "\[Chi]"}], "+", "\[Psi]nnn"}]},
      {"0"},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "Rtt"}], " ", "\[Chi]"}], "+", "\[Psi]ntt"}]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669540179933435*^9, 3.669540184367526*^9}, {
   3.669541701200108*^9, 3.669541740209993*^9}, {3.669541855547288*^9, 
   3.6695418686413307`*^9}, {3.6695419091371593`*^9, 
   3.6695419207026463`*^9}, {3.669542046544066*^9, 3.669542051555575*^9}, 
   3.669542274143705*^9, {3.6695423279764347`*^9, 3.6695423449902077`*^9}, {
   3.669543992524206*^9, 3.669544019708315*^9}, {3.669544102566052*^9, 
   3.669544110974855*^9}, 3.669544156458805*^9, 3.669544283121976*^9, 
   3.669544332635459*^9, {3.669544364631585*^9, 3.669544376907649*^9}, 
   3.6709968666024637`*^9, 3.670996906945907*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", "\[Chi]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"5", ",", "3"}], "}"}], "\[Rule]", "\[Chi]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"5", ",", "8"}], "}"}], "\[Rule]", 
    RowBox[{"2", " ", "\[Chi]"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"6", ",", "6"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"7", ",", "4"}], "}"}], "\[Rule]", "\[Chi]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"8", ",", "8"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"9", ",", "6"}], "}"}], "\[Rule]", "\[Chi]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", "10"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"_", ",", "_"}], "}"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.669540179933435*^9, 3.669540184367526*^9}, {
   3.669541701200108*^9, 3.669541740209993*^9}, {3.669541855547288*^9, 
   3.6695418686413307`*^9}, {3.6695419091371593`*^9, 
   3.6695419207026463`*^9}, {3.669542046544066*^9, 3.669542051555575*^9}, 
   3.669542274143705*^9, {3.6695423279764347`*^9, 3.6695423449902077`*^9}, {
   3.669543992524206*^9, 3.669544019708315*^9}, {3.669544102566052*^9, 
   3.669544110974855*^9}, 3.669544156458805*^9, 3.669544283121976*^9, 
   3.669544332635459*^9, {3.669544364631585*^9, 3.669544376907649*^9}, 
   3.6709968666024637`*^9, 3.670996906954348*^9}],

Cell[BoxData[
 RowBox[{"developsparsity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "2.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
       "0.`", ",", "0.`", ",", "0.`", ",", "1.`"}], "}"}]}], "}"}], 
   ",", "\<\"10BC.txt\"\>", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{{3.669540179933435*^9, 3.669540184367526*^9}, {
   3.669541701200108*^9, 3.669541740209993*^9}, {3.669541855547288*^9, 
   3.6695418686413307`*^9}, {3.6695419091371593`*^9, 
   3.6695419207026463`*^9}, {3.669542046544066*^9, 3.669542051555575*^9}, 
   3.669542274143705*^9, {3.6695423279764347`*^9, 3.6695423449902077`*^9}, {
   3.669543992524206*^9, 3.669544019708315*^9}, {3.669544102566052*^9, 
   3.669544110974855*^9}, 3.669544156458805*^9, 3.669544283121976*^9, 
   3.669544332635459*^9, {3.669544364631585*^9, 3.669544376907649*^9}, 
   3.6709968666024637`*^9, 3.670996906959332*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.669637664356062*^9, 3.6696376656641073`*^9}}]
}, Open  ]],

Cell["", "Section",
 CellChangeTimes->{{3.669637675809004*^9, 3.669637677816489*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["rough work", "Title",
 CellChangeTimes->{{3.6696376843258047`*^9, 3.669637685834502*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trialAn", " ", "=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Projector", "[", 
       RowBox[{"nx", ",", 
        RowBox[{"-", "ny"}]}], "]"}], ".", "Ax", ".", 
      RowBox[{"Projector", "[", 
       RowBox[{"nx", ",", "ny"}], "]"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nx", "\[Rule]", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{"ny", "\[Rule]", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trial\[Lambda]", " ", "=", " ", 
   RowBox[{"Chop", "[", 
    RowBox[{"Eigenvalues", "[", "trialAn", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trialnullspace", "=", 
   RowBox[{"TrigReduce", "[", 
    RowBox[{"NullSpace", "[", "trialAn", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.669637693631024*^9, 3.669637716718173*^9}, {
   3.669637748839427*^9, 3.669637876383808*^9}, {3.669637925402279*^9, 
   3.6696379977461042`*^9}, {3.669638035789756*^9, 3.6696380427608013`*^9}, {
   3.669638093462358*^9, 3.669638143496087*^9}, {3.669638194923623*^9, 
   3.669638205691493*^9}, 3.669638247039381*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TrigReduce", "[", 
   RowBox[{"trialAn", ".", 
    RowBox[{
     RowBox[{"Transpose", "[", "trialnullspace", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6696381209336433`*^9, 3.669638125508058*^9}, {
  3.669638208207522*^9, 3.669638214777503*^9}, {3.669638262386148*^9, 
  3.669638303492735*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.`"},
      {"0"},
      {"0"},
      {"0.`"},
      {"0.`"},
      {"0.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669638268132888*^9, 3.669638303837656*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "trialnullspace", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.669638248862899*^9, 3.66963825780797*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.`"}], 
      RowBox[{
       RowBox[{"-", "1.`"}], " ", 
       RowBox[{"Cot", "[", "\[Theta]", "]"}]}]},
     {"0.`", "0.`"},
     {"0.`", "0.`"},
     {"1.`", 
      RowBox[{"2.`", " ", 
       RowBox[{"Cot", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}]},
     {"0.`", "1.`"},
     {"1.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669638253483192*^9, 3.669638258093545*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TrigReduce", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"symmetrizerA", ".", 
      RowBox[{"Projector", "[", 
       RowBox[{"nx", ",", 
        RowBox[{"-", "ny"}]}], "]"}], ".", "Ax", ".", 
      RowBox[{"Projector", "[", 
       RowBox[{"nx", ",", "ny"}], "]"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nx", "\[Rule]", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{"ny", "\[Rule]", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6706956467511*^9, 3.670695658339362*^9}, {
  3.6706997950559053`*^9, 3.670699805546062*^9}, {3.6706998399393263`*^9, 
  3.670699918596775*^9}, {3.6707000352103167`*^9, 3.670700036467512*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", 
      RowBox[{"2.`", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{"2.`", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0.`", "0.`", "0.`"},
     {
      RowBox[{"2.`", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "0.`", "0.`", 
      RowBox[{"2.`", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{"2.`", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0.`"},
     {
      RowBox[{"2.`", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0.`", "0.`", "0.`", 
      RowBox[{"2.`", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{"2.`", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {"0.`", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "0.`", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "0.`", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6706956549209127`*^9, 3.670695658718473*^9}, {
   3.670699855184404*^9, 3.67069991903135*^9}, 3.6707000368145447`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"symmetrizerA", ".", "Ax"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.670699925998831*^9, 3.670699933116548*^9}, {
  3.670699988493011*^9, 3.670699989658866*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "2.`", "0.`", "0.`", "0.`", "0.`"},
     {"2.`", "0.`", "0.`", "2.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "2.`", "0.`"},
     {"0.`", "2.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "2.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.670699928335279*^9, 3.670699933441*^9}, 
   3.670699989989539*^9}]
}, Open  ]]
}, Closed]]
},
WindowSize->{1011, 735},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 332, 7, 46, "Input"],
Cell[915, 31, 162, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1114, 38, 240, 3, 64, "Section"],
Cell[1357, 43, 420, 9, 87, "Text"],
Cell[1780, 54, 6398, 152, 522, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8215, 211, 91, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[8331, 216, 92, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[8448, 221, 1558, 41, 138, "Input"],
Cell[10009, 264, 307, 6, 28, "Output"],
Cell[10319, 272, 1037, 24, 115, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11405, 302, 100, 1, 64, "Section"],
Cell[11508, 305, 3205, 90, 403, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[14750, 400, 94, 1, 50, "Section"],
Cell[14847, 403, 2151, 69, 267, "Input"],
Cell[CellGroupData[{
Cell[17023, 476, 291, 5, 46, "Input"],
Cell[17317, 483, 994, 30, 126, "Output"],
Cell[18314, 515, 1031, 26, 126, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[19394, 547, 143, 2, 50, "Section"],
Cell[19540, 551, 516, 14, 46, "Input"],
Cell[20059, 567, 1995, 62, 216, "Input"],
Cell[CellGroupData[{
Cell[22079, 633, 242, 4, 46, "Input"],
Cell[22324, 639, 992, 27, 150, "Output"],
Cell[23319, 668, 1013, 24, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24369, 697, 169, 3, 28, "Input"],
Cell[24541, 702, 148, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24726, 709, 215, 4, 28, "Input"],
Cell[24944, 715, 191, 3, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[25184, 724, 102, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[25311, 729, 812, 20, 114, "Input"],
Cell[26126, 751, 961, 24, 126, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[27136, 781, 87, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[27248, 786, 510, 12, 63, "Input"],
Cell[27761, 800, 1795, 46, 148, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[29605, 852, 91, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[29721, 857, 1136, 27, 63, "Input"],
Cell[30860, 886, 1895, 50, 91, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[32816, 943, 93, 1, 66, "Title"],
Cell[32912, 946, 329, 7, 46, "Input"],
Cell[CellGroupData[{
Cell[33266, 957, 152, 2, 64, "Section"],
Cell[33421, 961, 6418, 209, 590, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[39876, 1175, 100, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[40001, 1180, 4428, 143, 522, "Input"],
Cell[44432, 1325, 1800, 37, 193, "Output"],
Cell[46235, 1364, 1986, 39, 193, "Output"],
Cell[48224, 1405, 3063, 95, 295, "Output"],
Cell[51290, 1502, 3056, 94, 295, "Output"]
}, Open  ]],
Cell[54361, 1599, 94, 1, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[54492, 1605, 104, 1, 50, "Section"],
Cell[54599, 1608, 730, 18, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[55366, 1631, 112, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[55503, 1636, 7198, 212, 658, "Input"],
Cell[62704, 1850, 1745, 44, 92, "Output"],
Cell[64452, 1896, 2083, 42, 194, "Output"],
Cell[66538, 1940, 1732, 47, 194, "Output"],
Cell[68273, 1989, 1807, 48, 46, "Output"],
Cell[70083, 2039, 2540, 54, 97, "Output"]
}, Open  ]],
Cell[72638, 2096, 94, 1, 28, "Input"]
}, Open  ]],
Cell[72747, 2100, 85, 1, 64, "Section"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72869, 2106, 95, 1, 92, "Title"],
Cell[72967, 2109, 1227, 31, 63, "Input"],
Cell[CellGroupData[{
Cell[74219, 2144, 432, 11, 28, "Input"],
Cell[74654, 2157, 753, 24, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75444, 2186, 176, 4, 28, "Input"],
Cell[75623, 2192, 955, 29, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76615, 2226, 800, 20, 46, "Input"],
Cell[77418, 2248, 1806, 47, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79261, 2300, 209, 4, 28, "Input"],
Cell[79473, 2306, 934, 23, 115, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
