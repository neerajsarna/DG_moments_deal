(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12268,        398]
NotebookOptionsPosition[     10884,        344]
NotebookOutlinePosition[     11244,        360]
CellTagsIndexPosition[     11201,        357]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
To Run this file, first run CompleteGenericMatrix_Diff_Basis.nb\
\>", "Text",
 CellChangeTimes->{{3.696227720773604*^9, 3.69622773635017*^9}},
 Background->RGBColor[0.9, 1, 1]],

Cell[CellGroupData[{

Cell["Penalty Matrix", "Section",
 CellChangeTimes->{{3.696227761589219*^9, 3.696227764429803*^9}}],

Cell[CellGroupData[{

Cell["G20", "Subsection",
 CellChangeTimes->{{3.696227771174666*^9, 3.696227782847147*^9}}],

Cell[CellGroupData[{

Cell["System Matrices", "Subsubsection",
 CellChangeTimes->{{3.69622804479382*^9, 3.696228047346311*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "Ax20New", ",", "Ay20New", ",", "B20New", ",", "var20", ",", "varOdd20", 
     ",", "varEven20", ",", "varRearranged20", ",", "PermuteMatrix20", ",", 
     "PermuteMatInv20"}], "}"}], "=", 
   RowBox[{"FinalMatrices", "[", "6", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Symmetrizer20", " ", "=", " ", 
   RowBox[{"GenerateSymmetrizer2D", "[", "6", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6962279403394423`*^9, 3.696227944694131*^9}, 
   3.696228034990724*^9, {3.696228066146994*^9, 3.696228075728263*^9}, {
   3.696228420748418*^9, 3.696228440458877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Onsager Mat\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.696228441021338*^9}],

Cell[BoxData[
 StyleBox["\<\"Symmetric\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.696228441031279*^9}],

Cell[BoxData[
 StyleBox["\<\"Positive Definite\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.696228441042686*^9}],

Cell[BoxData[
 StyleBox["\<\"Null Space Included\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.696228441050426*^9}],

Cell[BoxData[
 StyleBox["\<\"Norsdtom Condition\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.6962284410583878`*^9}],

Cell[BoxData[
 StyleBox["\<\"Symmetric\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.696228441066326*^9}],

Cell[BoxData[
 StyleBox["\<\"Positive Definite\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.696227883904346*^9, 3.6962279452112226`*^9, 
  3.696228035528439*^9, 3.696228076211774*^9, 3.696228441074217*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Permutation Matrices", "Subsubsection",
 CellChangeTimes->{{3.6962281415767307`*^9, 3.696228146601063*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u1", " ", "=", " ", "var20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u2", " ", "=", " ", "varRearranged20"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q12", " ", "=", " ", "PermuteMatrix20"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q21", " ", "=", " ", "PermuteMatInv20"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Q12", " ", "and", " ", "Q21", " ", "are", " ", "norm", " ", "preserving", 
    " ", "matrices", " ", "and", " ", "therefore", " ", "should", " ", "be", 
    " ", "orthogonal"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Similarly", " ", "Q12", " ", "and", " ", "Q21", " ", "should", " ", "be", 
    " ", "orthogonal", " ", "to", " ", "each", " ", "other"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6962281520637817`*^9, 3.69622817487197*^9}, {
  3.696228443853733*^9, 3.696228469700244*^9}, {3.6962289590499983`*^9, 
  3.6962289749858007`*^9}, {3.696229063225647*^9, 3.696229086569186*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projector Matrices", "Subsubsection",
 CellChangeTimes->{{3.696228598415359*^9, 3.696228603520422*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1", " ", "=", " ", 
   RowBox[{"GenerateProjector2D", "[", "6", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P2", " ", "=", " ", 
   RowBox[{"Q21", ".", "P1", ".", "Q12"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6962286062199783`*^9, 3.696228653824236*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symmetrizer and SAoe", "Subsubsection",
 CellChangeTimes->{{3.696229092277492*^9, 3.696229099060339*^9}, {
  3.696229197923172*^9, 3.6962292010619707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"symm20", " ", "=", " ", 
    RowBox[{"GenerateSymmetrizer2D", "[", "6", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "compute", " ", "the", " ", "entropy", " ", "flux", " ", "corresponding", 
    " ", "to", " ", "the", " ", "un", " ", "permuted", " ", "system"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SA", " ", "=", " ", 
    RowBox[{"symm20", ".", "Ax20New"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "we", " ", "permute", " ", "the", " ", "matrix", " ", "SA"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SAperm", " ", "=", " ", 
    RowBox[{
     RowBox[{"Transpose", "[", "Q12", "]"}], ".", "SA", ".", "Q12"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SAeo", " ", "=", " ", 
   RowBox[{"SAperm", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{"1", ";;", 
      RowBox[{"Length", "[", "varOdd20", "]"}]}]}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "Q21", "]"}], ".", "SAeo"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.696229101208928*^9, 3.6962291129187117`*^9}, {
  3.6962292029265947`*^9, 3.696229399411133*^9}, {3.69622943383375*^9, 
  3.696229436274076*^9}, {3.6962420048377438`*^9, 3.6962420092075577`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", 
      SqrtBox["2"], "0", "0", "0"},
     {
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], "0", 
      SqrtBox[
       FractionBox["5", "3"]], "0", "0"},
     {
      SqrtBox["2"], "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["5"]]}], 
      RowBox[{"2", " ", 
       SqrtBox["3"]}], 
      SqrtBox["3"]},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SqrtBox["3"], 
      RowBox[{"2", " ", 
       SqrtBox["3"]}]},
     {"0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["5"]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"2", " ", 
       SqrtBox["3"]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6962292412363443`*^9, 3.696229244343028*^9}, {
   3.69622935445343*^9, 3.696229385783518*^9}, 3.696229436606142*^9, {
   3.696242009649219*^9, 3.696242014263773*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B20New", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.696243297093004*^9, 3.696243300334223*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "1", "0", 
      SqrtBox[
       FractionBox["2", "3"]], 
      RowBox[{"-", 
       SqrtBox["2"]}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["\[Pi]"]]}], "0", "0", "1", "0", "0", 
      SqrtBox[
       FractionBox["2", 
        RowBox[{"5", " ", "\[Pi]"}]]], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "\[Pi]"]]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       SqrtBox[
        FractionBox["2", 
         RowBox[{"15", " ", "\[Pi]"}]]]}], 
      SqrtBox[
       FractionBox["2", 
        RowBox[{"5", " ", "\[Pi]"}]]], "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SqrtBox[
          FractionBox["2", "\[Pi]"]]}], "15"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["7", "5"]}], " ", 
       SqrtBox[
        FractionBox["2", 
         RowBox[{"3", " ", "\[Pi]"}]]]}], "0", "0", "0", "0", "1", "0", "0", 
      "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox[
        FractionBox["2", "\[Pi]"]], "15"], 
      RowBox[{
       FractionBox["1", "5"], " ", 
       SqrtBox[
        FractionBox["2", 
         RowBox[{"3", " ", "\[Pi]"}]]]}], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", 
         RowBox[{"3", " ", "\[Pi]"}]]]}], "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.696243300647876*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{13, Automatic}, {-46, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 186, 4, 46, "Text"],
Cell[CellGroupData[{
Cell[769, 28, 99, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[893, 33, 91, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1009, 38, 105, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1139, 43, 653, 14, 75, "Input"],
Cell[CellGroupData[{
Cell[1817, 61, 247, 5, 24, "Print"],
Cell[2067, 68, 245, 5, 24, "Print"],
Cell[2315, 75, 253, 5, 24, "Print"],
Cell[2571, 82, 255, 5, 24, "Print"],
Cell[2829, 89, 256, 5, 24, "Print"],
Cell[3088, 96, 245, 5, 24, "Print"],
Cell[3336, 103, 253, 5, 24, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3650, 115, 113, 1, 35, "Subsubsection"],
Cell[3766, 118, 1099, 25, 180, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4902, 148, 109, 1, 35, "Subsubsection"],
Cell[5014, 151, 316, 8, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5367, 164, 162, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[5554, 170, 1441, 38, 180, "Input"],
Cell[6998, 210, 1592, 52, 291, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8627, 267, 130, 2, 32, "Input"],
Cell[8760, 271, 2072, 67, 307, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

