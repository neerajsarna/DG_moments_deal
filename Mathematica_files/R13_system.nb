(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    166065,       4422]
NotebookOptionsPosition[    162244,       4288]
NotebookOutlinePosition[    162603,       4304]
CellTagsIndexPosition[    162560,       4301]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tensor Definitions", "Section",
 CellChangeTimes->{{3.569139429210832*^9, 3.569139448895958*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.679824085289926*^9}],

Cell["\<\
Mathematica build-in function like \[OpenCurlyQuote]Symmetrize[]\
\[CloseCurlyQuote] and \[OpenCurlyQuote]TensorContract[]\[CloseCurlyQuote] \
seem 
to work really slow or fail due to memory requirements on fully symmetric \
tensors 
with degree >10.
We define our own functions below based on a simply array data structure for \
fully symmetric tensors.\
\>", "Text",
 CellChangeTimes->{{3.5691393015045276`*^9, 3.5691394253246098`*^9}, {
  3.569230437595318*^9, 3.569230461117482*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "n", ",", "degree", ",", "idx", ",", "idx1", ",", "A", ",", "b", ",", "id3",
    ",", "IDX"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "TensorDegree", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Every", " ", "symmetric", " ", "tensor", " ", "can", " ", "be", " ", 
     "identified", " ", "with", " ", "the", " ", "help", " ", "of", " ", "a", 
     " ", "2", "D", " ", "array", " ", "say", " ", 
     RowBox[{
      RowBox[{"a", "[", "N", "]"}], "[", "3", "]"}], " ", "where", " ", "N", 
     " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "indepedent", " ", "variables", " ", "it", " ", 
     RowBox[{"has", ".", " ", "So"}], " ", "every", " ", "row", " ", "ie", 
     " ", 
     RowBox[{"a", "[", "i", "]"}], " ", "store", " ", "the", " ", "number", 
     " ", "of", " ", "entries", " ", "for", " ", "x", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}]}], ",", 
    RowBox[{"for", " ", "y", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}], " ", "and", " ", "for", 
     " ", "z", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "3", "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", "ii"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "the", " ", "same", " ", "thing", " ", "as", " ", "IDXFull", 
    " ", "but", " ", "for", " ", "trace", " ", "free", " ", "tensors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXtrfFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"ii", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IDX", "[", "degree", "]"}], "=", 
      RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDXtrf", "[", "degree", "]"}], "=", 
      RowBox[{"IDXtrfFull", "[", "degree", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "0", ",", "40"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"given", " ", "an", " ", "array", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "counts", " ", "the", " ", 
     "number", " ", "of", " ", "1", "s"}], ",", " ", 
    RowBox[{"2", "s", " ", "and", " ", "3", "s"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX1", "[", "list_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Input", " ", "cartesean", " ", "indices"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "3"}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "Total", " ", "of", " ", "the", " ", "list", " ", "is", " ", 
     "the", " ", "tensorial", " ", "degree", " ", "we", " ", "are", " ", 
     "interested", " ", 
     RowBox[{"in", ".", " ", "So"}], " ", "list", " ", "should", " ", "be", 
     " ", "a", " ", "3", "X1", " ", "array", " ", "and", " ", "the", " ", 
     "following", " ", "function", " ", "will", " ", "give", " ", "us", " ", 
     "the", " ", "n", " ", "corresponding", " ", "to", " ", "which", " ", 
     RowBox[{"a", "[", "n", "]"}]}], " ", "=", " ", 
    RowBox[{"list", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX2", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDX", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX3", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDXtrfFull", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "tensor", " ", "degree", " ", "of", " ", "a", 
    " ", "symmetric", " ", 
    RowBox[{"tensor", ".", "\[IndentingNewLine]", 
     RowBox[{"CAUTION", ":", " ", 
      RowBox[{
      "the", " ", "formulae", " ", "is", " ", "not", " ", "valid", " ", "for",
        " ", "trace", " ", "free", " ", 
       RowBox[{"tensors", "."}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorDegree", "[", "A_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         RowBox[{"Length", "[", "A", "]"}]}]}]]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"id3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaValues", "[", "list_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"b", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"c", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OddQ", "[", "a", "]"}], "||", 
         RowBox[{"OddQ", "[", "b", "]"}], "||", 
         RowBox[{"OddQ", "[", "c", "]"}]}], ",", "0", ",", 
        FractionBox[
         RowBox[{"Multinomial", "[", 
          RowBox[{
           FractionBox["a", "2"], ",", 
           FractionBox["b", "2"], ",", 
           FractionBox["c", "2"]}], "]"}], 
         RowBox[{"Multinomial", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "applied", " ", "deltavalues", " ", "to", " ", "all", " ", "the", " ", 
    "components", " ", "of", " ", "an", " ", "even", " ", "degree", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor2", "[", 
     RowBox[{"degree_", "?", "EvenQ"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"DeltaValues", ",", 
      RowBox[{"IDX", "[", "degree", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"What", " ", "does", " ", "this", " ", 
    RowBox[{"do", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTrace2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX2", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IDX", "[", 
                   RowBox[{"degree", "-", "2"}], "]"}], 
                  "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTraces", "[", 
     RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", "=", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"SymTrace2", "[", "res", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Assumes", " ", "3", " ", 
     RowBox[{"dimensions", ".", " ", "And"}], " ", "so"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contraction", " ", "of", " ", "a", " ", "symmetric", " ", "tensor", " ", 
    "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymDot2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Lets", " ", "take", " ", "a", " ", "particular", " ", "term", " ",
             "say", " ", "Ai1i2"}], ".."}], 
          RowBox[{"xbx", ".", " ", "In"}], " ", "the", " ", "result", " ", 
          "only", " ", "those", " ", "components", " ", "will", " ", "appear",
           " ", "in", " ", "which", " ", "x", " ", "atleast", " ", "appears", 
          " ", "once", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "why", " ", "the", " ", "addition",
           " ", "of", " ", 
          RowBox[{"id3", "[", 
           RowBox[{"[", "iis", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"toIDX2", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IDX", "[", 
                    RowBox[{"degree", "-", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                  "+", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "]"}], 
                "\[RightDoubleBracket]"}], 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "full", " ", "contraction", " ", "of", " ", "two", " ", "symmetric", " ", 
     "tensors", " ", "A"}], ",", " ", 
    RowBox[{"B", " ", "with", " ", "same", " ", "degree"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymFullDot", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TensorDegree", "[", "B", "]"}], "\[NotEqual]", "degree"}], 
         ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"idx", "=", 
           RowBox[{
            RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", "jj",
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "+=", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
              "]"}], 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{
            "B", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProduct2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"degree", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"degree", "+", "1"}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "1"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "b", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProductDelta2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"degree", "+", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"degree", "+", "1"}], ")"}]}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "2"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[GreaterEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}], 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "converts", " ", "a", " ", "symmetric", " ", "tensor", " ", "into", " ", 
    "a", " ", "trace", " ", "free", " ", "tensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "returns", " ", "the", " ", "tracefree", " ", "part", " ", "of", " ", "a",
      " ", "symmetric", " ", "tensor"}], ",", " ", 
    RowBox[{"but", " ", "with", " ", "all", " ", "components"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymTracefree", "[", "A_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
       RowBox[{"degree", "=", 
        RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", "res", 
       ",", "trace", ",", "res1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"trace", "=", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"trace", "=", 
           RowBox[{"SymTrace2", "[", "trace", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"res1", "=", 
            RowBox[{"SymProductDelta2", "[", "res1", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ll", ",", "1", ",", "kk"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "kk"], 
               RowBox[{"degree", "!"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"degree", "-", 
                  RowBox[{"2", "kk"}]}], ")"}], "!"}], 
               SuperscriptBox["2", "kk"], 
               RowBox[{"kk", "!"}]}]], 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"jj", "=", 
                RowBox[{"degree", "-", "kk"}]}], 
               RowBox[{"degree", "-", "1"}]], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", "jj"}], "+", "1"}]]}]}], ")"}], "res1"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"degree", "/", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5977647060562134`*^9, 3.5977647268750763`*^9}, {
   3.597764982828605*^9, 3.5977649884363317`*^9}, {3.676179501293851*^9, 
   3.6761796856337767`*^9}, {3.676179724780055*^9, 3.6761797401819553`*^9}, {
   3.6761800693011913`*^9, 3.67618009071702*^9}, {3.67618055987227*^9, 
   3.676180688136693*^9}, {3.676180727497422*^9, 3.676180773976479*^9}, {
   3.676181010436315*^9, 3.676181034457363*^9}, {3.676182895833144*^9, 
   3.676182910871441*^9}, {3.676183029280117*^9, 3.676183040299528*^9}, {
   3.676183109751354*^9, 3.676183133647092*^9}, {3.676184105172339*^9, 
   3.676184107563058*^9}, {3.676184447780569*^9, 3.676184559506366*^9}, 
   3.676184625341688*^9, {3.6761850010521708`*^9, 3.676185035780895*^9}, {
   3.6763163148181763`*^9, 3.676316347073567*^9}, {3.676316864163743*^9, 
   3.676316876694518*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trfEvaluate", "[", 
     RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "m", ",", 
        RowBox[{"dim", "=", "3"}], ",", 
        RowBox[{"degree", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", 
          "2"}]}], ",", "length", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "list"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"c", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"toIDX3", "[", "list", "]"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Binomial", "[", 
               RowBox[{"m", ",", "i"}], "]"}], 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX3", "[", 
                RowBox[{"list", "+", 
                 RowBox[{"2", "i", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "i"}], ")"}], " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"2", "m", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "say", " ", "we", " ", "have", " ", "a", " ", "trace", " ", "free", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "whose", " ", "independent", " ", "components", " ", "are", " ", "given",
       " ", "then", " ", "the", " ", "following", " ", "function", " ", 
      "will", " ", "introduce", " ", "those", " ", "components", " ", "in", 
      " ", "the", " ", "list", " ", "which", " ", "have", " ", "been", " ", 
      "negelected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
      "free", " ", "nature", " ", "of", " ", "the", " ", 
      RowBox[{"tensor", ".", " ", "For"}], " ", 
      RowBox[{"eg", ".", " ", "it"}], " ", "will", " ", "introduce"}], " ", 
     "-", "Rxx", "-", 
     RowBox[{
     "Ryy", " ", "for", " ", "a", " ", "second", " ", "order", " ", 
      "tensor"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trf2sym", "[", "A_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"trfEvaluate", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
       "#"}], "]"}], "&"}], ",", 
    RowBox[{"IDX", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", "2"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.592214156581615*^9, 3.5922142269069633`*^9}, {
  3.592214273648*^9, 3.592214321643592*^9}, {3.592214562691799*^9, 
  3.5922146307578783`*^9}, {3.5922150087114487`*^9, 3.5922151927530117`*^9}, {
  3.592215226866392*^9, 3.592215227208199*^9}, {3.5922152622517147`*^9, 
  3.592215315308941*^9}, {3.592215349687686*^9, 3.592215358801886*^9}, {
  3.59221558179191*^9, 3.592215608488448*^9}, {3.592215669267857*^9, 
  3.592215699095985*^9}, {3.676315905534268*^9, 3.676315915972599*^9}, {
  3.6763161617740183`*^9, 3.676316190517806*^9}, {3.67631623272976*^9, 
  3.676316302687489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTensorForm", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
               RowBox[{
               "A", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               "}"}], "&"}], ",", 
            RowBox[{
             RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", 
             "ii", "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "length"}], "}"}]}], "]"}], "//", 
        "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.59211253078022*^9, 3.592112545437512*^9}, {
   3.5921125805422792`*^9, 3.5921127616337748`*^9}, {3.592112796427103*^9, 
   3.5921128146670732`*^9}, 3.597764731152925*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymProductDelta2", "[", 
  RowBox[{"SymProductDelta2", "[", 
   RowBox[{"SymProductDelta2", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
        "]"}], "&"}], ",", 
      RowBox[{"IDX", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516209179254*^9, 3.591516237845764*^9}, {
  3.591516279723213*^9, 3.591516319002157*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675954441912649*^9, 3.676179291151037*^9, 
  3.6762888609657383`*^9, 3.6763161356528177`*^9, 3.6779058949079237`*^9, 
  3.678529868398068*^9, 3.6789569966828136`*^9, 3.679817284096423*^9, 
  3.679824018877027*^9, 3.6798241121962147`*^9, 3.679913339333569*^9, 
  3.679915660129981*^9, 3.679922840093841*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "2", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591517786313066*^9, 3.5915178359472446`*^9}, {
  3.591517885949567*^9, 3.591517930610208*^9}, {3.5977650183992825`*^9, 
  3.597765018845586*^9}, {3.676316092317675*^9, 3.6763161065616913`*^9}, {
  3.676316140175808*^9, 3.676316140772443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441957636*^9, 3.6761792911794147`*^9, 3.676288861012822*^9, {
   3.676316093569808*^9, 3.676316107287977*^9}, {3.676316137581958*^9, 
   3.6763161413544827`*^9}, 3.677905894933*^9, 3.678529868437419*^9, 
   3.67895699670127*^9, 3.679817284141407*^9, 3.679824018900482*^9, 
   3.679824112240232*^9, 3.679913339381771*^9, 3.679915660173421*^9, 
   3.679922840141613*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", 
          RowBox[{"2.", "#2"}], "-", 
          RowBox[{"3", "#3"}]}], "&"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "4", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516796847253*^9, 3.591516813094841*^9}, {
   3.5915174393368073`*^9, 3.5915174614075623`*^9}, {3.59151750012652*^9, 
   3.59151776014233*^9}, {3.591517814794807*^9, 3.5915178185262527`*^9}, {
   3.591517860691409*^9, 3.5915178802347727`*^9}, 3.591518123963479*^9, {
   3.5915182744621964`*^9, 3.591518302569395*^9}, {3.591526482595047*^9, 
   3.5915265043240232`*^9}, {3.591611217481101*^9, 3.591611231450076*^9}, {
   3.597765011088415*^9, 3.5977650116257725`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1428571428571423`"}], ",", "1.1428571428571432`", ",", 
   "2.571428571428571`", ",", "3.428571428571429`", ",", 
   "1.4285714285714286`", ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", "3.1428571428571432`", ",", 
   "2.857142857142857`", ",", 
   RowBox[{"-", "4.285714285714286`"}], ",", 
   RowBox[{"-", "5.428571428571429`"}], ",", 
   RowBox[{"-", "2.2857142857142847`"}], ",", "4.285714285714286`", ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "5.714285714285714`"}], ",", "3.428571428571427`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675954442007567*^9, 3.67617929122402*^9, 
  3.676288861058632*^9, 3.677905894982387*^9, 3.678529868487091*^9, 
  3.6789569967340937`*^9, 3.679817284174168*^9, 3.679824018948873*^9, 
  3.679824112272427*^9, 3.679913339431921*^9, 3.679915660205641*^9, 
  3.6799228401900883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymFullDot", "[", 
   RowBox[{
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], "}"}], 
      "]"}], "]"}], ",", 
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], "}"}], 
      "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Rxx", " ", "Sxx"}], "+", 
  RowBox[{"Ryy", " ", "Sxx"}], "+", 
  RowBox[{"2", " ", "Rxy", " ", "Sxy"}], "+", 
  RowBox[{"Rxx", " ", "Syy"}], "+", 
  RowBox[{"2", " ", "Ryy", " ", "Syy"}]}]], "Output",
 CellChangeTimes->{3.675954442064178*^9, 3.676179291269311*^9, 
  3.676288861096998*^9, 3.6779058950315104`*^9, 3.6785298685371113`*^9, 
  3.678956996767218*^9, 3.679817284207345*^9, 3.679824018993655*^9, 
  3.679824112315743*^9, 3.679913339464592*^9, 3.679915660227969*^9, 
  3.679922840234264*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], 
               "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], 
               "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sxx", ",", "Sxy", ",", "Syy"}], "}"}]}], "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759544421144657`*^9, 3.676179291324445*^9, 
  3.676288861145307*^9, 3.6779058950810213`*^9, 3.678529868586431*^9, 
  3.6789569967998867`*^9, 3.679817284241613*^9, 3.6798240190319567`*^9, 
  3.679824112356357*^9, 3.67991333949728*^9, 3.679915660267836*^9, 
  3.679922840273624*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "mxxx", ",", "mxxy", ",", "0", ",", "mxyy", ",", "0", ",", 
                "myyy", ",", "0"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "nxxx", ",", "nxxy", ",", "0", ",", "nxyy", ",", "0", ",", 
                "nyyy", ",", "0"}], "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy"}], "}"}]}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"nxxx", ",", "nxxy", ",", "nxyy", ",", "nyyy"}], "}"}]}], "]"}],
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}, {3.656607710425463*^9, 
  3.656607745128602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759544421633577`*^9, 3.676179291374331*^9, 
  3.6762888611958103`*^9, 3.6779058951312113`*^9, 3.6785298686374598`*^9, 
  3.678956996833495*^9, 3.679817284276608*^9, 3.679824019081929*^9, 
  3.6798241123905783`*^9, 3.6799133395317783`*^9, 3.6799156603051643`*^9, 
  3.679922840321316*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equations Definitions", "Section"],

Cell[CellGroupData[{

Cell["Basic Definitions", "Subsection",
 CellChangeTimes->{{3.679224206952962*^9, 3.67922420968581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ref", " ", "to", " ", "manuels", " ", "paper", " ", "on", " ", "fluxes", 
    " ", "for", " ", "large", " ", "moment", " ", "system", " ", "for", " ", 
    "a", " ", "detailed", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "tensorial", " ", "degree", " ", "including", " ", 
    "traces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"iFullDegree", "[", "i_", "]"}], "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"4", "i"}], "-", "3"}]], "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "traces", " ", 
     RowBox[{"C", "^", "2"}], " ", "has", " ", "one", " ", "trace"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTraces", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"iFullDegree", "[", "i", "]"}]}]}], ")"}], "2"], "]"}], 
      "-", "i"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "tensorial", " ", "degree"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTensorDegree", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"iFullDegree", "[", "i", "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"iTraces", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ii", "[", 
      RowBox[{"s_", ",", "A_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"A", "+", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{"A", "+", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"s", "+", "1"}], ")"}]}], "-", 
         RowBox[{"Floor", "[", 
          FractionBox[
           RowBox[{"A", "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}]}], ")"}]}], "-",
       "s"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "i", " ", "is", " ", "as", " ", "defined", " ", "in", " ", "the", " ", 
     "reference"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables2D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iTensorDegree", "[", "i", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfFullTensors3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"iFullDegree", "[", "ntensors", "]"}]}], ",", "frac"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"m", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "3"}], ")"}]}], "6."], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", 
               RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}], "2"], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varName", "[", 
     RowBox[{"s_", ",", "ix_", ",", "iy_", ",", "iz_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\[Rho]\>\"", ",", 
      RowBox[{"ToString", "[", "s", "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<x\>\"", ",", "ix"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<y\>\"", ",", "iy"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<z\>\"", ",", "iz"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "not", " ", "the", " ", "norm", " ", "of", " ", 
      "\[Psi]"}], ",", " ", 
     RowBox[{"rather", " ", 
      RowBox[{"it", "'"}], "s", " ", "the", " ", "norm", " ", "of", " ", 
      "the", " ", "laguerre", " ", "polynomials"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm\[Psi]", "[", 
      RowBox[{"a_", ",", "deg_"}], "]"}], "=", 
     FractionBox[
      RowBox[{
       RowBox[{"deg", "!"}], 
       RowBox[{"a", "!"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"deg", "+", "a", "+", 
         RowBox[{"3", "/", "2"}]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"deg", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "given", " ", "a", " ", "tensor", " ", "W", " ", "extract", " ", "all", 
     " ", "the", " ", "independed", " ", "components", " ", "in", " ", "2", 
     "D", " ", "in", " ", "case", " ", "of", " ", "trace", " ", "free", " ", 
     "situation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfComponents2D", "[", "W_", "]"}], ":=", 
    RowBox[{"Extract", "[", 
     RowBox[{"W", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"IDX", "[", 
             RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}], ",", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"IDXtrf", "[", 
           RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"TensorDegree", "[", "W", "]"}]}], "}"}]}], "]"}]}], 
            "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfVar2D", "[", 
     RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"name", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"deg", "+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"From2Dto3D", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "list", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Given", " ", "the", " ", "components", " ", "of", " ", "a", " ", 
        "tensor", " ", "represented", " ", "by", " ", "B"}], ",", " ", 
       RowBox[{
        RowBox[{
        "then", " ", "tmp", " ", "collects", " ", "the", " ", "terms", " ", 
         "corresponding", " ", 
         RowBox[{"to", " ", "\\", "partial_x"}], " ", 
         RowBox[{"in", " ", "\\", "partial_"}]}], "<", 
        RowBox[{"x_", 
         RowBox[{"{", "in", "}"}], " ", "w_", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i1", ".."}], "in"}], ">"}], "}"}], "\[IndentingNewLine]",
          "the", " ", "second", " ", "one", " ", "does", " ", "the", " ", 
         "same", " ", "job", " ", "but", " ", "for", " ", "a", " ", "tensor", 
         " ", 
         RowBox[{"product", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymDot2", "[", 
              RowBox[{
               RowBox[{"trf2sym", "[", 
                RowBox[{"From2Dto3D", "[", 
                 RowBox[{"trfVar2D", "[", 
                  RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficient", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", 
         "tensor", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymTracefree", "[", 
              RowBox[{"SymProduct2", "[", 
               RowBox[{
                RowBox[{"trf2sym", "[", 
                 RowBox[{"From2Dto3D", "[", 
                  RowBox[{"trfVar2D", "[", 
                   RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficients", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "15"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "moment", " ", "equation", " ", "as", " ", "given", " ", "in", " ", "the",
      " ", "boundary", " ", "value", " ", "problem", " ", "paper", " ", 
     "from", " ", 
     RowBox[{"Manuel", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"recursion1", "[", 
     RowBox[{"a_", ",", "deg_", ",", "flag_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "deg"}], "+", "2"}], 
         RowBox[{
          RowBox[{"2", "deg"}], "+", "3"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"deg", "+", "a", "+", 
            FractionBox["3", "2"]}]], 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar2D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", "a", ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
         RowBox[{
          SqrtBox["a"], " ", 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar2D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", 
                RowBox[{"a", "-", "1"}], ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
        ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"deg", ">", "0"}], ",", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", "deg"}], 
           RowBox[{
            RowBox[{"2", "deg"}], "+", "1"}]]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SqrtBox[
             RowBox[{"(", 
              RowBox[{"deg", "+", "a", "+", 
               FractionBox["1", "2"]}], ")"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
           RowBox[{
            SqrtBox[
             RowBox[{"a", "+", "1"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"a", "+", "1"}], ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
          ")"}]}], ",", "0"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetMatrices1D", "[", "Ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "varIdx", ",", "varIdxComplete", ",", "theory", ",", "normMatrix", 
         ",", "varNames", ",", "var", ",", "Ax", ",", "Ay", ",", 
         "\[IndentingNewLine]", "var1D", ",", "BCvar", ",", "varOdd", ",", 
         "varIdxCompleteEven", ",", "varEven", ",", "BCraw", ",", 
         RowBox[{"\[Rho]index", "=", "1"}], ",", 
         RowBox[{"vindex", "=", "2"}], ",", "\[Rho]Weqn", ",", "BCnum", ",", 
         "BCrhs", ",", "P", ",", "NumVar"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "compute", " ", "the", " ", "tensor", " ", "degree", " ", "and", " ",
           "the", " ", "number", " ", "of", " ", "traces", " ", "for", " ", 
          "every", " ", "tensor", " ", "in", " ", "the", " ", 
          RowBox[{"system", ".", "\[IndentingNewLine]", "In"}], " ", "all", 
          " ", "the", " ", "coming", " ", "computations"}], ",", " ", 
         RowBox[{
         "iTraces", " ", "will", " ", "be", " ", "represented", " ", "by", 
          " ", 
          RowBox[{"a", ".", "sa"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"varIdx", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"iTraces", "[", "i", "]"}], ",", 
             RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "same", " ", "as", " ", "IDXtrf", " ", "but", " ", "instead", " ", 
          "stores", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
          "number", " ", "of", " ", "traces", " ", "in", " ", "the", " ", 
          "first", " ", "argument", " ", "of", " ", "every", " ", "list"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"varIdxComplete", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}],
                   ",", "#"}], "]"}], "&"}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"IDXtrf", "[", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
                 ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
         "computes", " ", "the", " ", "number", " ", "of", " ", "traces", " ",
           "for", " ", "a", " ", "given", " ", 
          RowBox[{"iTensorDegree", ".", " ", "The"}], " ", "final", " ", 
          "result", " ", "gives", " ", "us", " ", "the", " ", "tuple", " ", 
          "discussed", " ", "in", " ", "the", " ", "paper", " ", "on", " ", 
          "the", " ", "convergence", " ", "of", " ", "the", " ", "boundary", 
          " ", "value", " ", 
          RowBox[{"problem", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"theory", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"varIdx", ",", 
             RowBox[{"{", 
              RowBox[{"_", ",", "k"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"iFullDegree", "[", "Ntensors", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<number of different tensor degrees: \>\"", ",", "theory"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<corresponding variables (traces,indices): \>\"", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", 
                  RowBox[{
                   RowBox[{
                   "theory", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "theory", "]"}]}], "}"}]}], "]"}], ",",
             "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 1D: \>\"", ",", "Ntensors"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 2D: \>\"", ",", 
          RowBox[{"NumberOfVariables2D", "[", "Ntensors", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 3D: \>\"", ",", 
          RowBox[{"NumberOfVariables3D", "[", "Ntensors", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of full Tensors 3D: \>\"", ",", 
          RowBox[{"NumberOfFullTensors3D", "[", "Ntensors", "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"normMatrix", "=", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "deg"}], "}"}], ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"Norm\[Psi]", "[", 
                    RowBox[{"a", ",", "deg"}], "]"}], ",", 
                    RowBox[{"deg", "+", "1"}]}], "]"}]}], "]"}], "@@", "#"}], 
               "&"}], ",", "varIdx"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "the", " ", "result", " ", "from", " ", "var", " ", "consists", " ",
            "of", " ", "the", " ", "form", " ", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"n", ",", "a", ",", "deg"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"where", " ", "a"}], " ", "=", " ", "#traces"}], ",", " ", 
          
          RowBox[{"deg", " ", "=", " ", 
           RowBox[{
            RowBox[{
            "#free", " ", "indices", " ", "and", " ", "n", " ", "is", " ", 
             "the", " ", "name", " ", "for", " ", "eg", " ", "vx"}], " ", "=",
             " ", 
            RowBox[{
             RowBox[{"1", " ", "and", " ", "vy"}], " ", "=", " ", 
             RowBox[{
             "2", " ", "or", " ", "\[Theta]", " ", "is", " ", "simply", " ", 
              "1"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"var", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "deg"}], "}"}], ",", 
               RowBox[{"trfVar2D", "[", 
                RowBox[{"deg", ",", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", 
                   RowBox[{"#", ",", "a", ",", "deg"}], "]"}], "&"}]}], 
                "]"}]}], "]"}], ",", "item"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NumVar", " ", "=", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"Flatten", "[", "var", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Ax", "=", 
         RowBox[{
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", ",", "deg"}], "}"}], ",", 
                   RowBox[{"recursion1", "[", 
                    RowBox[{"a", ",", "deg", ",", "1"}], "]"}]}], "]"}], ",", 
                 "item"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ay", "=", 
         RowBox[{
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", ",", "deg"}], "}"}], ",", 
                   RowBox[{"recursion1", "[", 
                    RowBox[{"a", ",", "deg", ",", "2"}], "]"}]}], "]"}], ",", 
                 "item"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "production", " ", "term"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"P", " ", "=", " ", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "NumVar"}], "}"}]}], "]"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", "0"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Ax", ",", "Ay", ",", "var", ",", "P"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.6789571122427063`*^9, 
   3.678957168470767*^9}, {3.678957258151763*^9, 3.67895728691035*^9}, {
   3.6789574805203876`*^9, 3.6789574813607388`*^9}, 3.678957647285915*^9, {
   3.678957709797439*^9, 3.678957720845735*^9}, {3.678957938446752*^9, 
   3.678958016986763*^9}, {3.678958060884356*^9, 3.67895808288346*^9}, {
   3.678958258367999*^9, 3.6789582586646748`*^9}, {3.678959201968364*^9, 
   3.678959203973609*^9}, {3.678959253091893*^9, 3.6789593377942467`*^9}, {
   3.678959710864044*^9, 3.678959744805642*^9}, {3.6789597880911617`*^9, 
   3.678959848591672*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Ax", ",", "Ay", ",", "var", ",", "P"}], "}"}], "=", 
   RowBox[{"GetMatrices1D", "[", "8", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", " ", "=", " ", 
    RowBox[{"Flatten", "[", "var", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "Ax", ")"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "need", " ", "to", " ", "remove", " ", "the", " ", "rows", " ", "in", " ", 
    "the", " ", "end", " ", "so", " ", "that", " ", "we", " ", "can", " ", 
    "insert", " ", "the", " ", "R13", " ", "closure"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ax", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"Ax", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "ii", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "10", ",", "17"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ay", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"Ay", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "ii", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "10", ",", "17"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678957291033966*^9, 3.678957293271102*^9}, 
   3.678957575551816*^9, {3.67895811955786*^9, 3.678958129772015*^9}, {
   3.678958269413616*^9, 3.678958269707749*^9}, {3.678958434459474*^9, 
   3.6789584388254128`*^9}, {3.678959378689608*^9, 3.6789593790635233`*^9}, {
   3.678995419567569*^9, 3.678995438316271*^9}, {3.678995469976138*^9, 
   3.678995473523082*^9}, {3.678995524314109*^9, 3.678995547466898*^9}, {
   3.678995588371447*^9, 3.678995592190835*^9}, {3.679032723408598*^9, 
   3.679032759232046*^9}, {3.679032934009947*^9, 3.679032935856627*^9}, {
   3.679136594348855*^9, 3.679136614005979*^9}, {3.6792236644541388`*^9, 
   3.6792236678183813`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of different tensor degrees: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2", ",", "1", ",", "0"}], "}"}]}],
  SequenceForm["number of different tensor degrees: ", {3, 2, 2, 1, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9, 
   3.679913344495296*^9, 3.679914269846286*^9, {3.679915663503821*^9, 
   3.67991566918887*^9}, 3.679922843393436*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"corresponding variables (traces,indices): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}],
  SequenceForm[
  "corresponding variables (traces,indices): ", {{0, 0}, {1, 0}, {2, 0}, {0, 
   1}, {1, 1}, {0, 2}, {1, 2}, {0, 3}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9, 
   3.679913344495296*^9, 3.679914269846286*^9, {3.679915663503821*^9, 
   3.67991566918887*^9}, 3.679922843402459*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 1D: \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Number of Variables 1D: ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9, 
   3.679913344495296*^9, 3.679914269846286*^9, {3.679915663503821*^9, 
   3.67991566918887*^9}, 3.679922843415017*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 2D: \"\>", "\[InvisibleSpace]", "17"}],
  SequenceForm["Number of Variables 2D: ", 17],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9, 
   3.679913344495296*^9, 3.679914269846286*^9, {3.679915663503821*^9, 
   3.67991566918887*^9}, 3.679922843422468*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 3D: \"\>", "\[InvisibleSpace]", "26"}],
  SequenceForm["Number of Variables 3D: ", 26],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9, 
   3.679913344495296*^9, 3.679914269846286*^9, {3.679915663503821*^9, 
   3.67991566918887*^9}, 3.679922843429723*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of full Tensors 3D: \"\>", "\[InvisibleSpace]", 
   "3.4000000000000004`"}],
  SequenceForm["Number of full Tensors 3D: ", 3.4000000000000004`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9, 
   3.679913344495296*^9, 3.679914269846286*^9, {3.679915663503821*^9, 
   3.67991566918887*^9}, 3.6799228434375*^9}]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"1", "0", "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], 
      SqrtBox["2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], "0", "0", "0", "0", "0", 
      SqrtBox[
       FractionBox["5", "3"]], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox["2"]}], "3"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["4", 
        RowBox[{"3", " ", 
         SqrtBox["5"]}]]}], "0", 
      SqrtBox["3"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["5"]]}], "0", 
      SqrtBox["3"], "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox["2"], "3"]}], "0", "0", "0", "0", "0", 
      FractionBox["2", 
       RowBox[{"3", " ", 
        SqrtBox["5"]}]], "0", "0", "0", 
      SqrtBox["3"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SqrtBox[
       FractionBox["5", "3"]], 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["5"]]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["3"]]}], 
      SqrtBox[
       FractionBox["14", "5"]], "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["5"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SqrtBox[
       FractionBox["14", "5"]], "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", 
        SqrtBox["3"]}], "5"], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", 
         SqrtBox[
          FractionBox["6", "7"]]}], "5"]}], "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["8", 
       RowBox[{"5", " ", 
        SqrtBox["3"]}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"8", " ", 
         SqrtBox[
          FractionBox["2", "21"]]}], "5"]}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]]}], "0", 
      FractionBox["1", 
       SqrtBox["3"]], "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         FractionBox["2", "21"]]}], "5"], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "21"]]}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SqrtBox["3"]}], "5"]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         FractionBox["6", "7"]]}], "5"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["3"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         FractionBox["14", "5"]]}], "3"], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "7"]]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      SqrtBox[
       FractionBox["7", "10"]], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "7"]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         FractionBox["14", "5"]], "3"]}], "0", "0", "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "7"]]}], "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {17, 17}, 0, {
     1, {{0, 1, 4, 5, 7, 10, 13, 16, 20, 22, 24, 26, 30, 32, 33, 35, 37, 
       39}, {{2}, {5}, {1}, {4}, {6}, {2}, {8}, {10}, {2}, {8}, {11}, {3}, {
       9}, {2}, {8}, {12}, {5}, {15}, {4}, {14}, {6}, {16}, {5}, {15}, {6}, {
       16}, {15}, {5}, {7}, {17}, {6}, {16}, {8}, {10}, {8}, {11}, {9}, {8}, {
       12}}}, {1, 2^Rational[1, 2], 1, -Rational[2, 3]^Rational[1, 2], 2^
       Rational[1, 2], -Rational[2, 3]^Rational[1, 2], Rational[5, 3]^
       Rational[1, 2], 3^Rational[1, 2], Rational[2, 3] 2^Rational[1, 2], 
       Rational[-4, 3] 5^Rational[-1, 2], 3^Rational[1, 2], 2^
       Rational[-1, 2], -5^Rational[-1, 2], Rational[-1, 3] 2^Rational[1, 2], 
       Rational[2, 3] 5^Rational[-1, 2], 3^Rational[1, 2], (-2) 
       5^Rational[-1, 2], Rational[14, 5]^Rational[1, 2], Rational[5, 3]^
       Rational[1, 2], (-2) 3^Rational[-1, 2], (-2) 5^Rational[-1, 2], 
       Rational[14, 5]^Rational[1, 2], Rational[3, 5] 3^Rational[1, 2], 
       Rational[-3, 5] Rational[6, 7]^Rational[1, 2], Rational[8, 5] 
       3^Rational[-1, 2], Rational[-8, 5] Rational[2, 21]^Rational[1, 2], 
       Rational[2, 5] Rational[2, 21]^Rational[1, 2], Rational[-2, 5] 
       3^Rational[-1, 2], 3^Rational[-1, 2], -Rational[2, 21]^Rational[1, 2], 
       Rational[-2, 5] 3^Rational[1, 2], Rational[2, 5] 
       Rational[6, 7]^Rational[1, 2], (-2) 3^Rational[-1, 2], -
       Rational[6, 7]^Rational[1, 2], Rational[2, 3] 
       Rational[14, 5]^Rational[1, 2], -Rational[6, 7]^Rational[1, 2], 
       Rational[7, 10]^Rational[1, 2], Rational[-1, 3] 
       Rational[14, 5]^Rational[1, 2], -
       Rational[6, 7]^Rational[1, 2]}}]]]]], "Output",
 CellChangeTimes->{
  3.6792236683737383`*^9, {3.6798172899109583`*^9, 3.6798172990727243`*^9}, 
   3.679819032531104*^9, 3.679824021597459*^9, 3.679824122584605*^9, 
   3.679913344540002*^9, 3.679914269900814*^9, {3.67991566355788*^9, 
   3.6799156692460213`*^9}, 3.679922843447669*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["var"], "Input",
 CellChangeTimes->{{3.678958272038644*^9, 3.6789582789665537`*^9}, 
   3.678958352695456*^9, {3.678958393239523*^9, 3.678958395646706*^9}, {
   3.678958442740348*^9, 3.678958442933165*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"3", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"3", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"4", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "1", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.678958279380022*^9, 3.678958396082905*^9, {3.678958443369494*^9, 
   3.6789584472826433`*^9}, 3.6792234683764277`*^9, {3.679817289957815*^9, 
   3.679817299106327*^9}, 3.6798190325719233`*^9, 3.67982402164268*^9, 
   3.679824122620924*^9, 3.679913344589188*^9, 3.679914269950979*^9, {
   3.679915663596456*^9, 3.679915669287416*^9}, 3.679922843496037*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["variable transformation", "Subsection",
 CellChangeTimes->{{3.6789581840153227`*^9, 3.678958187756557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "map", " ", "from", " ", "\[Psi]", " ", "to", " ", "conventional", " ", 
    "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"transfMoments", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "\[Rho]"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", "vx"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", "vy"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["3", "2"]]}], " ", "\[Theta]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "2"}], "]"}], "->", 
        FractionBox["\[Sigma]xx", 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "2"}], "]"}], "->", 
        FractionBox["\[Sigma]xy", 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "0", ",", "2"}], "]"}], "->", 
        FractionBox["\[Sigma]yy", 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["2", "5"]]}], "qx"}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["2", "5"]]}], "qy"}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["mxxx", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["mxxy", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["mxyy", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"4", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["myyy", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "2", ",", "0"}], "]"}], "->", 
        FractionBox["\[CapitalDelta]", 
         RowBox[{"2", " ", 
          SqrtBox["30"]}]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "->", 
        FractionBox[
         RowBox[{"-", "Rxx"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}], "->", 
        FractionBox[
         RowBox[{"-", "Rxy"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "1", ",", "2"}], "]"}], "->", 
        FractionBox[
         RowBox[{"-", "Ryy"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConversionMatrix", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "2"]]}], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", "1", ",", "1", ",", "1", ",", "1", 
        ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConversionMatrix2", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "2"]]}], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["30"]}]], ",", 
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]], ",", 
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]], ",", 
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"map", " ", "from", " ", "w", " ", "to", " ", "\[Psi]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"transfMoments2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "2", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "0", ",", "2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "3"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"4", ",", "0", ",", "3"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "1", ",", "2"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varConventional", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\[Rho]", ",", "vx", ",", "vy", ",", " ", "\[Theta]", ",", "\[Sigma]xx",
        ",", "\[Sigma]xy", ",", "\[Sigma]yy", ",", "qx", ",", "qy", ",", 
       "mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy", ",", "\[CapitalDelta]", 
       ",", "Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varLocal", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\[Rho]", ",", "vn", ",", "vt", ",", " ", "\[Theta]", ",", "\[Sigma]nn",
        ",", "\[Sigma]nt", ",", "\[Sigma]tt", ",", "qn", ",", "qt", ",", 
       "mnnn", ",", "mnnt", ",", "mntt", ",", "mttt", ",", "\[CapitalDelta]", 
       ",", "Rnn", ",", "Rnt", ",", "Rtt"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Conversion", " ", "from", " ", "Global", " ", "to", " ", "local", " ", 
     "variables"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varGlobalLocal", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vx", "\[Rule]", "vt"}], ",", 
       RowBox[{"vy", "\[Rule]", "vn"}], ",", " ", 
       RowBox[{"\[Sigma]xx", "\[Rule]", "\[Sigma]tt"}], ",", 
       RowBox[{"\[Sigma]xy", "\[Rule]", "\[Sigma]nt"}], ",", 
       RowBox[{"\[Sigma]yy", "\[Rule]", "\[Sigma]nn"}], ",", 
       RowBox[{"qx", "\[Rule]", "qt"}], ",", 
       RowBox[{"qy", "\[Rule]", "qn"}], ",", 
       RowBox[{"mxxx", "\[Rule]", "mttt"}], ",", 
       RowBox[{"mxxy", "\[Rule]", "mttn"}], ",", 
       RowBox[{"mxyy", "\[Rule]", "mtnn"}], ",", 
       RowBox[{"myyy", "\[Rule]", "mnnn"}], ",", 
       RowBox[{"Rxx", "\[Rule]", "Rtt"}], ",", 
       RowBox[{"Rxy", "\[Rule]", "Rtn"}], ",", 
       RowBox[{"Ryy", "\[Rule]", "Rnn"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678958354291965*^9, 3.6789585180047913`*^9}, {
  3.6789585788239517`*^9, 3.67895863147085*^9}, {3.67895868219844*^9, 
  3.6789587407131033`*^9}, {3.678958821637702*^9, 3.678958834413289*^9}, {
  3.678958867759439*^9, 3.678958900712845*^9}, {3.678958949516328*^9, 
  3.678958950284752*^9}, {3.678958996761046*^9, 3.678959134643436*^9}, {
  3.678961242948419*^9, 3.6789612446999207`*^9}, {3.678963444023161*^9, 
  3.6789635343713512`*^9}, {3.6789635876002283`*^9, 3.678963710689351*^9}, {
  3.678967624607039*^9, 3.678967700603652*^9}, {3.678967779211268*^9, 
  3.6789678801914883`*^9}, {3.679817793309338*^9, 3.679817862622698*^9}, {
  3.679817979299653*^9, 3.679818050828229*^9}, {3.6798187643327312`*^9, 
  3.679818791640038*^9}, {3.679829074506608*^9, 3.679829079849581*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["conversion to conventional variables", "Subsection",
 CellChangeTimes->{{3.6789586432158422`*^9, 3.678958647389152*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AxConventional", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ax", ".", "var"}], ")"}], "/.", "transfMoments"}], ",", 
      "varConventional"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AyConventional", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ay", ".", "var"}], ")"}], "/.", "transfMoments"}], ",", 
      "varConventional"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PConventional", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"P", ".", "var"}], ")"}], "/.", "transfMoments"}], ",", 
      "varConventional"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PConventional", " ", "=", " ", 
    RowBox[{"PConventional", "/", "Kn"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "AyConventional", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.678958656662806*^9, 3.67895867103199*^9}, {
  3.678959161877551*^9, 3.678959171789771*^9}, {3.678959386210034*^9, 
  3.678959444509392*^9}, {3.678959481399109*^9, 3.67895960305048*^9}, {
  3.678959641877749*^9, 3.678959678552741*^9}, {3.67895975505232*^9, 
  3.678959756399041*^9}, {3.678959906052855*^9, 3.678959967763588*^9}, {
  3.6789615600694923`*^9, 3.678961608975268*^9}, {3.678961734511387*^9, 
  3.678961749412485*^9}, {3.678961831583569*^9, 3.678961831935166*^9}, {
  3.678962147704145*^9, 3.678962218397575*^9}, {3.678962265414879*^9, 
  3.678962267721305*^9}, {3.679817530484885*^9, 3.6798175306165323`*^9}, {
  3.6798175611562033`*^9, 3.679817561924119*^9}, {3.679818059685359*^9, 
  3.679818078393009*^9}, {3.6798190663827887`*^9, 3.679819077010035*^9}}],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{{3.679819066834867*^9, 3.679819077331353*^9}, 
   3.679819136305929*^9, 3.679819190132214*^9, 3.679824021693763*^9, 
   3.67982412268178*^9, 3.679913437958385*^9, 3.679914270029652*^9, 
   3.679915681771141*^9, 3.679922843579108*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["regularized closure", "Subsection",
 CellChangeTimes->{{3.6789928993043003`*^9, 3.678992903090581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Contribution", " ", "from", " ", "mijk", " ", "into", " ", "the", " ", 
    "Ax"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EqnmijkX", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"2", ",", "1"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"2", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "\[Sigma]xx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "\[Sigma]xy"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "3", "]"}], "\[Rule]", "\[Sigma]yy"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "mijk", " ", "into", " ", "the", " ", "Ay", 
     " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqnmijkY", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"2", ",", "2"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"2", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "\[Sigma]xx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "\[Sigma]xy"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "3", "]"}], "\[Rule]", "\[Sigma]yy"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"insert", " ", "new", " ", "rows"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AxConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AxConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnmijkX", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AyConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AyConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnmijkY", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "EqnmijkX", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "\[CapitalDelta]", " ", "into", " ", "the", 
     " ", "Ax"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqn\[CapitalDelta]X", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"8", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "\[CapitalDelta]", " ", "into", " ", "the", 
     " ", "Ay", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqn\[CapitalDelta]Y", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"8", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"insert", " ", "new", " ", "rows"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AxConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AxConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"Eqn\[CapitalDelta]X", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AyConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AyConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"Eqn\[CapitalDelta]Y", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "Eqn\[CapitalDelta]X", "]"}]}], "}"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "Rij", " ", "into", " ", "the", " ", "Ax"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqnRijX", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox["28", "5"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "\[CapitalDelta]", " ", "into", " ", "the", 
     " ", "Ay", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqnRijY", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox["28", "5"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"insert", " ", "new", " ", "rows"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AxConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AxConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnRijX", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AyConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AyConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnRijY", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "EqnRijX", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.678992938968079*^9, 3.678993025406086*^9}, {
  3.6789930601406937`*^9, 3.678993119752409*^9}, {3.678993586817073*^9, 
  3.678993719832505*^9}, {3.678993783230296*^9, 3.67899378932616*^9}, {
  3.6789939129243526`*^9, 3.678993929361561*^9}, {3.678993961982028*^9, 
  3.678994137522501*^9}, {3.678994168158155*^9, 3.6789941854626427`*^9}, {
  3.6798184026908627`*^9, 3.679818426703833*^9}, {3.67981847523556*^9, 
  3.679818477930049*^9}, {3.679818580599434*^9, 3.679818632567211*^9}, {
  3.679818684763143*^9, 3.67981869241901*^9}, {3.679819084561821*^9, 
  3.6798191128879213`*^9}, {3.679828580897443*^9, 3.679828581374837*^9}, {
  3.679915617391424*^9, 3.679915629687915*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AxR13", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "ConversionMatrix", "]"}], ".", 
    "AxConventional"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AyR13", "=", 
    RowBox[{
     RowBox[{"Inverse", "[", "ConversionMatrix", "]"}], ".", 
     "AyConventional"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dx", " ", 
    RowBox[{"AxR13", ".", "varConventional"}]}], "+", 
   RowBox[{"dy", " ", 
    RowBox[{"AyR13", ".", "varConventional"}]}], "+", 
   FractionBox[
    RowBox[{"P", ".", "varConventional"}], "Kn"]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6789937390505533`*^9, 3.67899374216776*^9}, {
   3.679223496965559*^9, 3.679223514305544*^9}, 3.679223689731427*^9, {
   3.6798176532872953`*^9, 3.679817672695807*^9}, {3.6798182479622517`*^9, 
   3.67981826917864*^9}, {3.679818975717106*^9, 3.6798189990019073`*^9}, 
   3.679819055822591*^9, {3.679819119950396*^9, 3.6798192324133577`*^9}, {
   3.6798192659276333`*^9, 3.679819327757249*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"dx", " ", "vx"}], "+", 
        RowBox[{"dy", " ", "vy"}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]xx"}], ")"}]}], 
        "+", 
        RowBox[{"dy", " ", "\[Sigma]xy"}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", "\[Sigma]xy"}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]yy"}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "qx"}], "3"], "+", 
           FractionBox[
            RowBox[{"2", " ", "vx"}], "3"]}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "qy"}], "3"], "+", 
           FractionBox[
            RowBox[{"2", " ", "vy"}], "3"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"mxxx", "+", 
           FractionBox[
            RowBox[{"8", " ", "qx"}], "15"], "+", 
           FractionBox[
            RowBox[{"4", " ", "vx"}], "3"]}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"mxxy", "-", 
           FractionBox[
            RowBox[{"4", " ", "qy"}], "15"], "-", 
           FractionBox[
            RowBox[{"2", " ", "vy"}], "3"]}], ")"}]}], "+", 
        FractionBox["\[Sigma]xx", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"mxyy", "+", 
           FractionBox[
            RowBox[{"2", " ", "qx"}], "5"], "+", "vx"}], ")"}]}], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"mxxy", "+", 
           FractionBox[
            RowBox[{"2", " ", "qy"}], "5"], "+", "vy"}], ")"}]}], "+", 
        FractionBox["\[Sigma]xy", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"mxyy", "-", 
           FractionBox[
            RowBox[{"4", " ", "qx"}], "15"], "-", 
           FractionBox[
            RowBox[{"2", " ", "vx"}], "3"]}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"myyy", "+", 
           FractionBox[
            RowBox[{"8", " ", "qy"}], "15"], "+", 
           FractionBox[
            RowBox[{"4", " ", "vy"}], "3"]}], ")"}]}], "+", 
        FractionBox["\[Sigma]yy", "Kn"]}]},
      {
       RowBox[{
        FractionBox["qx", "Kn"], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Rxx", "2"], "+", 
           FractionBox["\[CapitalDelta]", "6"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]xx"}], 
          ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}], ")"}]}]}]},
      {
       RowBox[{
        FractionBox["qy", "Kn"], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Ryy", "2"], "+", 
           FractionBox["\[CapitalDelta]", "6"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]yy"}], 
          ")"}]}]}]},
      {
       RowBox[{
        FractionBox["mxxx", "Kn"], "+", 
        FractionBox[
         RowBox[{"9", " ", "dx", " ", "\[Sigma]xx"}], "5"], "-", 
        FractionBox[
         RowBox[{"6", " ", "dy", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{
        FractionBox["mxxy", "Kn"], "+", 
        FractionBox[
         RowBox[{"8", " ", "dx", " ", "\[Sigma]xy"}], "5"], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Sigma]xx", "-", 
           FractionBox[
            RowBox[{"2", " ", "\[Sigma]yy"}], "5"]}], ")"}]}]}]},
      {
       RowBox[{
        FractionBox["mxyy", "Kn"], "+", 
        FractionBox[
         RowBox[{"8", " ", "dy", " ", "\[Sigma]xy"}], "5"], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", "\[Sigma]xx"}], "5"]}], "+", "\[Sigma]yy"}], 
          ")"}]}]}]},
      {
       RowBox[{
        FractionBox["myyy", "Kn"], "-", 
        FractionBox[
         RowBox[{"6", " ", "dx", " ", "\[Sigma]xy"}], "5"], "+", 
        FractionBox[
         RowBox[{"9", " ", "dy", " ", "\[Sigma]yy"}], "5"]}]},
      {
       RowBox[{
        RowBox[{"8", " ", "dx", " ", "qx"}], "+", 
        RowBox[{"8", " ", "dy", " ", "qy"}], "+", 
        FractionBox["\[CapitalDelta]", "Kn"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"56", " ", "dx", " ", "qx"}], "15"], "-", 
        FractionBox[
         RowBox[{"28", " ", "dy", " ", "qy"}], "15"], "+", 
        FractionBox["Rxx", "Kn"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"14", " ", "dy", " ", "qx"}], "5"], "+", 
        FractionBox[
         RowBox[{"14", " ", "dx", " ", "qy"}], "5"], "+", 
        FractionBox["Rxy", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"28", " ", "dx", " ", "qx"}], "15"]}], "+", 
        FractionBox[
         RowBox[{"56", " ", "dy", " ", "qy"}], "15"], "+", 
        FractionBox["Ryy", "Kn"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.679819215407778*^9, {3.6798192775166073`*^9, 3.6798193284727*^9}, 
   3.679824021760694*^9, 3.679824122777813*^9, 3.6799134430855*^9, 
   3.6799142700959787`*^9, 3.679915652211622*^9, 3.679915684032857*^9, 
   3.67992284366866*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "AyConventional", "]"}]], "Input",
 CellChangeTimes->{{3.67981901766683*^9, 3.679819022781282*^9}}],

Cell[BoxData["17"], "Output",
 CellChangeTimes->{3.679819023167349*^9, 3.679819059309663*^9, 
  3.679824021781609*^9, 3.6798241228157578`*^9, 3.679913443117028*^9, 
  3.679914270115789*^9, 3.6799156840538187`*^9, 3.67992284370227*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrices to check Boundary stability", "Subsection",
 CellChangeTimes->{{3.679742700232418*^9, 3.679742705723098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoundaryMatrices", "[", 
   RowBox[{"Ax_", ",", "B_", ",", "nEqn_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "X", ",", "\[Lambda]Ax", ",", "Position\[Lambda]neg", ",", 
      "num\[Lambda]neg", ",", "Position\[Lambda]pos", ",", "num\[Lambda]pos", 
      ",", "Position\[Lambda]zero", ",", "num\[Lambda]zero", ",", "Xsorted", 
      ",", "Xplus", ",", "Xminus", ",", "Bminus", ",", "Bplus", ",", 
      "Bhatplus", ",", "Btemp", ",", "\[Lambda]plus", ",", "\[Lambda]minus"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "nomenclature", " ", "matches", " ", "with", " ", "the", " ",
       "DG", " ", 
      RowBox[{"paper", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]Ax", ",", "X"}], "}"}], " ", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"Eigensystem", "[", "Ax", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", 
      RowBox[{"Transpose", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Position\[Lambda]neg", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"\[Lambda]Ax", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "<", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num\[Lambda]neg", " ", "=", " ", 
      RowBox[{"Length", "[", "Position\[Lambda]neg", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Position\[Lambda]pos", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"\[Lambda]Ax", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num\[Lambda]pos", " ", "=", " ", 
      RowBox[{"Length", "[", "Position\[Lambda]pos", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Position\[Lambda]zero", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"\[Lambda]Ax", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "==", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num\[Lambda]zero", " ", "=", " ", 
      RowBox[{"Length", "[", "Position\[Lambda]zero", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"sorting", " ", "the", " ", "eigen", " ", "vectors"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Xsorted", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"nEqn", ",", "nEqn"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xsorted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", "num\[Lambda]neg"}]}], "]"}], "]"}], "=", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "Position\[Lambda]neg"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xsorted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "1"}], ";;", 
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero"}]}]}], "]"}], 
       "]"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"NullSpace", "[", "Ax", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xsorted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero", "+", "1"}], ";;",
           "nEqn"}]}], "]"}], "]"}], "=", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "Position\[Lambda]pos"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", "Xsorted"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]plus", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"\[Lambda]Ax", "[", 
        RowBox[{"[", "Position\[Lambda]pos", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]minus", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"\[Lambda]Ax", "[", 
        RowBox[{"[", "Position\[Lambda]neg", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Xplus", " ", "=", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero", "+", "1"}], ";;",
           "nEqn"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Xminus", " ", "=", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", "num\[Lambda]neg"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Bminus", " ", "=", " ", 
      RowBox[{"B", ".", "Xminus"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bplus", " ", "=", " ", 
      RowBox[{"B", ".", "Xplus"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Bhatplus", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", "Bminus", "]"}], ".", "Bplus"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{
        RowBox[{"Bhatplus", ".", "\[Lambda]minus", ".", 
         RowBox[{"Transpose", "[", "Bhatplus", "]"}]}], "+", 
        "\[Lambda]plus"}], "]"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Chop", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Ax", ".", "Xplus"}], "-", 
        RowBox[{"Xplus", ".", "\[Lambda]plus"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.679742724254963*^9, 3.679742982479104*^9}, {
   3.679743034130999*^9, 3.679743038305441*^9}, {3.679746427634984*^9, 
   3.679746486133237*^9}, {3.679746717663476*^9, 3.679746791661701*^9}, {
   3.679746887851783*^9, 3.679746897906802*^9}, {3.679747079267716*^9, 
   3.679747081368713*^9}, {3.6797471180927067`*^9, 3.6797472939285183`*^9}, {
   3.679747395750904*^9, 3.6797474865110283`*^9}, {3.679747804259759*^9, 
   3.6797478196951323`*^9}, {3.679747959032469*^9, 3.6797480109595757`*^9}, {
   3.679748491903791*^9, 3.6797485329048758`*^9}, {3.679748586027457*^9, 
   3.679748600194077*^9}, {3.6797504373314543`*^9, 3.6797504517929287`*^9}, {
   3.679750486418377*^9, 3.679750487017827*^9}, {3.679750517587657*^9, 
   3.679750581949787*^9}, {3.67975063285717*^9, 3.679750637687499*^9}, 
   3.679751110863654*^9, {3.679751151465179*^9, 3.679751224449839*^9}, {
   3.679752325463382*^9, 3.679752383543941*^9}, {3.679752419545927*^9, 
   3.6797524211614428`*^9}, {3.679752758222352*^9, 3.6797527730125303`*^9}, {
   3.679752862672418*^9, 3.679752898594411*^9}, {3.679752981820176*^9, 
   3.6797530073981647`*^9}, {3.67975305432629*^9, 3.679753055239648*^9}, {
   3.679825084672862*^9, 3.679825085303248*^9}, {3.6798251202338667`*^9, 
   3.679825194076666*^9}, {3.679827238061002*^9, 3.6798272597719917`*^9}, {
   3.679922881478836*^9, 3.6799229160337677`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stabilizing the boundary conditions", "Subsection",
 CellChangeTimes->{{3.679741348312159*^9, 3.679741355527245*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "The", " ", "following", " ", "routine", " ", "fixes", " ", "the", " ", 
      "null", " ", 
      RowBox[{"space", ".", " ", "A0"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Ax", " ", "and", " ", "B", " ", "is", " ", "the", " ", "matrix", " ", 
        "in", " ", "BU"}], "+", "g"}], " ", "=", " ", "0"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FixNullSpace", "[", 
     RowBox[{"B_", ",", "A0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kerA0", ",", "BDotkerA0", ",", "coeffs", ",", "MaxIndex", ",", 
        "coeffValues", ",", "coeffMax", ",", "coeffMaxValue", ",", "Btemp", 
        ",", "presentCoeffs", ",", "ValuepresentCoeffs", ",", "ValueMaxCoeff",
         ",", "coeffsFound", ",", "numpresentCoeffs", ",", "presentterm"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coeffs", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"B", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"B", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coeffs", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "=", 
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"ii", ",", "jj"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"B", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"B", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "introduce", " ", "coefficients", " ", "in", " ", "the", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Btemp", " ", "=", 
        RowBox[{"B", "*", "coeffs"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kerA0", " ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"NullSpace", "[", "A0", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BDotkerA0", " ", "=", " ", 
        RowBox[{"Btemp", ".", "kerA0"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"coeffsFound", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "solve", " ", "for", " ", "every", " ", 
         "equation", " ", "corresponding", " ", "to", " ", "BDotkerA0", " ", 
         RowBox[{"separately", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "substitute", " ", "the", " ", "previous", " ", "solution"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"presentterm", "=", 
             RowBox[{
              RowBox[{"BDotkerA0", "[", 
               RowBox[{"[", 
                RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "/.", 
              "coeffsFound"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"presentCoeffs", " ", "=", " ", 
             RowBox[{"Extract", "[", 
              RowBox[{"presentterm", ",", 
               RowBox[{"Position", "[", 
                RowBox[{"presentterm", ",", 
                 RowBox[{"\[Alpha]", "[", 
                  RowBox[{"_", ",", "_"}], "]"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"numpresentCoeffs", " ", "=", " ", 
             RowBox[{"Length", "[", "presentCoeffs", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"MaxIndex", " ", "=", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"numpresentCoeffs", " ", ">", "0"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"presentCoeffs", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", "0"}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"presentCoeffs", " ", "=", " ", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"presentCoeffs", ",", 
               RowBox[{"\[Alpha]", "[", 
                RowBox[{"ii", ",", "MaxIndex"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ValuepresentCoeffs", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"presentCoeffs", "[", 
                 RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", "1", ",", 
                 RowBox[{"Length", "[", "presentCoeffs", "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ValueMaxCoeff", " ", "=", " ", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"presentterm", "/.", "ValuepresentCoeffs"}], ")"}], 
                "\[Equal]", "0"}], ",", 
               RowBox[{"\[Alpha]", "[", 
                RowBox[{"ii", ",", "MaxIndex"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"coeffsFound", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Insert", "[", 
               RowBox[{"coeffsFound", ",", 
                RowBox[{"{", 
                 RowBox[{"ValuepresentCoeffs", ",", "ValueMaxCoeff"}], "}"}], 
                ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"BDotkerA0", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}]}], "}"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"BDotkerA0", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "replace", " ", "all", " ", "the", " ", "remaining", " ", "alphas", 
         " ", "by", " ", "1", " ", "since", " ", "they", " ", "do", " ", 
         "not", " ", "play", " ", "a", " ", "role", " ", "in", " ", "the", 
         " ", "nullspace", " ", 
         RowBox[{"mainpulation", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Btemp", "/.", "coeffsFound"}], "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "[", 
                RowBox[{"ii", ",", "jj"}], "]"}], "\[Rule]", "1"}], ",", 
              RowBox[{"{", 
               RowBox[{"jj", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"B", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"B", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.679734508235077*^9, {3.6797412453982687`*^9, 3.6797412458160887`*^9}, 
   3.679741342228931*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary Condition evaluation", "Section",
 CellChangeTimes->{{3.678962278116391*^9, 3.678962286119834*^9}}],

Cell[CellGroupData[{

Cell["R13 Boundary Conditions", "Subsection",
 CellChangeTimes->{{3.678963733758984*^9, 3.678963738325531*^9}, {
  3.678966730504191*^9, 3.678966734257338*^9}, {3.678994352432108*^9, 
  3.67899435695588*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BCR13", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"vx", ",", 
      RowBox[{
       FractionBox["mxxy", "4"], "+", 
       FractionBox["qy", "10"], "+", 
       FractionBox["vy", "2"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         FractionBox["\[Pi]", "2"]], " ", "\[Sigma]xy"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox[
          FractionBox["\[Pi]", "10"]]}], " ", "qx"}], "-", 
       FractionBox[
        RowBox[{
         SqrtBox["5"], " ", "Rxx"}], "28"], "-", 
       FractionBox["\[CapitalDelta]", 
        RowBox[{"15", " ", 
         SqrtBox["5"]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "\[Theta]"}], 
        SqrtBox["5"]], "+", 
       FractionBox[
        RowBox[{"2", " ", "\[Theta]W"}], 
        SqrtBox["5"]], "-", 
       FractionBox["\[Sigma]xx", 
        RowBox[{"2", " ", 
         SqrtBox["5"]}]]}], ",", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", "mxxx", " ", 
        SqrtBox[
         FractionBox["\[Pi]", "6"]]}], "-", 
       FractionBox["Rxx", 
        RowBox[{"140", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "Rxx"}], "70"], "-", 
       FractionBox["\[CapitalDelta]", 
        RowBox[{"150", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox["\[Theta]", 
        RowBox[{"10", " ", 
         SqrtBox["3"]}]], "-", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "\[Theta]"}], "10"], "-", 
       FractionBox["\[Theta]W", 
        RowBox[{"10", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "\[Theta]W"}], "10"], "+", 
       FractionBox["\[Sigma]xx", 
        RowBox[{"10", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "\[Sigma]xx"}], "5"]}], ",", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", "mxyy", " ", 
        SqrtBox[
         FractionBox["\[Pi]", "6"]]}], "+", 
       FractionBox["Ryy", 
        RowBox[{"28", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox["\[CapitalDelta]", 
        RowBox[{"300", " ", 
         SqrtBox["3"]}]], "-", 
       FractionBox["\[Theta]", 
        RowBox[{"20", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "\[Theta]"}], "20"], "+", 
       FractionBox["\[Theta]W", 
        RowBox[{"20", " ", 
         SqrtBox["3"]}]], "-", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "\[Theta]W"}], "20"], "-", 
       FractionBox["\[Sigma]xx", 
        RowBox[{"10", " ", 
         SqrtBox["3"]}]], "+", 
       FractionBox["\[Sigma]yy", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}]]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["mxxy", 
         RowBox[{"4", " ", 
          SqrtBox["14"]}]]}], "-", 
       FractionBox[
        RowBox[{"11", " ", "qy"}], 
        RowBox[{"10", " ", 
         SqrtBox["14"]}]], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SqrtBox[
         FractionBox["\[Pi]", "7"]], " ", "Rxy"}], "+", 
       FractionBox["vy", 
        RowBox[{"2", " ", 
         SqrtBox["14"]}]]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BR13", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"BCR13", "*", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", 
         SqrtBox["5"], ",", 
         RowBox[{"2", 
          SqrtBox["3"]}], ",", 
         RowBox[{"2", 
          SqrtBox["3"]}], ",", 
         RowBox[{"4", 
          SqrtBox[
           FractionBox["7", "2"]]}]}], "}"}]}], ",", "varConventional"}], 
     "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.678963760240951*^9, 3.678963806036078*^9}, {
  3.6789667768634043`*^9, 3.6789667837819767`*^9}, {3.678966832378827*^9, 
  3.678966833177177*^9}, {3.678967727189939*^9, 3.6789677684009333`*^9}, {
  3.678967891165854*^9, 3.67896789165585*^9}, {3.6789679358493958`*^9, 
  3.6789679480363817`*^9}, {3.67896800651656*^9, 3.6789680127226267`*^9}, {
  3.678968134710946*^9, 3.678968136434082*^9}, {3.67897023542036*^9, 
  3.678970236631343*^9}, {3.679916359355739*^9, 3.679916376336895*^9}, {
  3.679916418654149*^9, 3.679916577045532*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stable bc", "Subsection",
 CellChangeTimes->{{3.679916593839644*^9, 3.679916595386127*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BR13Stable", " ", "=", " ", 
   RowBox[{"FixNullSpace", "[", 
    RowBox[{"BR13", ",", "AxR13"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BR13Stable", ".", "varConventional"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.679916597009883*^9, 3.6799166652959967`*^9}, {
  3.6799170698087673`*^9, 3.6799170790618067`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"vx"},
      {
       RowBox[{"mxxy", "+", 
        FractionBox["qy", "5"], "+", "vy", "+", 
        RowBox[{
         SqrtBox[
          FractionBox["\[Pi]", "2"]], " ", "\[Sigma]xy"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["\[Pi]", "2"]]}], " ", "qx"}], "-", 
        FractionBox[
         RowBox[{"2", " ", "Rxx"}], "5"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[CapitalDelta]"}], "15"], "-", 
        RowBox[{"2", " ", "\[Theta]"}], "-", 
        FractionBox["\[Sigma]xx", "2"]}]},
      {
       RowBox[{
        RowBox[{"mxxx", " ", 
         SqrtBox[
          FractionBox["\[Pi]", "2"]]}], "-", 
        FractionBox[
         RowBox[{"2", " ", "Rxx"}], "25"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[CapitalDelta]"}], "75"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[Theta]"}], "5"], "+", 
        FractionBox[
         RowBox[{"7", " ", "\[Sigma]xx"}], "5"]}]},
      {
       RowBox[{
        RowBox[{"mxyy", " ", 
         SqrtBox[
          FractionBox["\[Pi]", "2"]]}], "-", 
        FractionBox["\[Sigma]xx", "5"], "+", "\[Sigma]yy"}]},
      {
       RowBox[{"mxxy", "-", 
        FractionBox[
         RowBox[{"11", " ", "qy"}], "5"], "-", 
        RowBox[{
         SqrtBox[
          FractionBox["\[Pi]", "2"]], " ", "Rxy"}], "+", "vy"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.67991664653587*^9, 3.6799166581763277`*^9}, 
   3.679917079372077*^9, 3.679922859346602*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["check stability", "Subsection",
 CellChangeTimes->{{3.679916671371529*^9, 3.67991667358819*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BoundaryMatrices", "[", 
  RowBox[{"AxR13", ",", "BR13", ",", "17"}], "]"}]], "Input",
 CellChangeTimes->{{3.679916688528047*^9, 3.679916727726712*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.679916705886249*^9, 3.679916728192321*^9}, {
  3.6799229087863626`*^9, 3.679922919481242*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["entropy", "Subsection",
 CellChangeTimes->{{3.679928719836275*^9, 3.6799287213517103`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"entropyR13", " ", "=", " ", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[Rho]", "2"], "2"], "+", 
    RowBox[{
     FractionBox["3", "4"], 
     SuperscriptBox["\[Theta]", "2"]}], "+", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["vx", "2"], "+", 
       SuperscriptBox["vy", "2"]}], ")"}], "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Sigma]xx", "2"], "+", 
       SuperscriptBox["\[Sigma]yy", "2"], "+", 
       SuperscriptBox["\[Sigma]xy", "2"], "+", 
       RowBox[{"\[Sigma]xx", " ", "\[Sigma]yy"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "5"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetrizerR13", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"entropyR13", ",", 
       RowBox[{"{", "varConventional", "}"}]}], "]"}], ",", 
     RowBox[{"{", "varConventional", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"symmetrizerR13", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.679929501115718*^9, 3.679929656860326*^9}, {
  3.679929717572678*^9, 3.679929721277401*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["3", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "1", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox["2", "5"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["2", "5"], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6799296006987*^9, 3.679929657198167*^9}, 
   3.679929721577546*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rough Wok", "Title",
 CellChangeTimes->{{3.678991074719153*^9, 3.678991082679616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AxR13", ".", "varConventional"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.679916876672505*^9, 3.679916885545656*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"vx"},
      {
       RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]xx"}]},
      {"\[Sigma]xy"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "qx"}], "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "vx"}], "3"]}]},
      {
       RowBox[{"mxxx", "+", 
        FractionBox[
         RowBox[{"8", " ", "qx"}], "15"], "+", 
        FractionBox[
         RowBox[{"4", " ", "vx"}], "3"]}]},
      {
       RowBox[{"mxxy", "+", 
        FractionBox[
         RowBox[{"2", " ", "qy"}], "5"], "+", "vy"}]},
      {
       RowBox[{"mxyy", "-", 
        FractionBox[
         RowBox[{"4", " ", "qx"}], "15"], "-", 
        FractionBox[
         RowBox[{"2", " ", "vx"}], "3"]}]},
      {
       RowBox[{
        FractionBox["Rxx", "2"], "+", 
        FractionBox["\[CapitalDelta]", "6"], "+", 
        FractionBox[
         RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]xx"}]},
      {
       RowBox[{
        FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}]},
      {
       FractionBox[
        RowBox[{"9", " ", "\[Sigma]xx"}], "5"]},
      {
       FractionBox[
        RowBox[{"8", " ", "\[Sigma]xy"}], "5"]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[Sigma]xx"}], "5"]}], "+", "\[Sigma]yy"}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{"8", " ", "qx"}]},
      {
       FractionBox[
        RowBox[{"56", " ", "qx"}], "15"]},
      {
       FractionBox[
        RowBox[{"14", " ", "qy"}], "5"]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"28", " ", "qx"}], "15"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.679916885851033*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{228, Automatic}, {45, Automatic}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 103, 1, 64, "Section"],
Cell[686, 25, 141, 3, 28, "Input"],
Cell[830, 30, 528, 12, 87, "Text"],
Cell[1361, 44, 28245, 726, 2589, "Input"],
Cell[29609, 772, 4572, 112, 303, "Input"],
Cell[34184, 886, 1495, 39, 114, "Input"],
Cell[CellGroupData[{
Cell[35704, 929, 566, 15, 46, "Input"],
Cell[36273, 946, 3999, 121, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40309, 1072, 648, 16, 28, "Input"],
Cell[40960, 1090, 1903, 56, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42900, 1151, 884, 19, 28, "Input"],
Cell[43787, 1172, 912, 18, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44736, 1195, 472, 13, 46, "Input"],
Cell[45211, 1210, 545, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45793, 1226, 1206, 29, 114, "Input"],
Cell[47002, 1257, 563, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47602, 1275, 1391, 34, 114, "Input"],
Cell[48996, 1311, 679, 15, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[49724, 1332, 40, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[49789, 1336, 104, 1, 44, "Subsection"],
Cell[49896, 1339, 31939, 784, 2690, "Input"],
Cell[CellGroupData[{
Cell[81860, 2127, 1984, 49, 131, "Input"],
Cell[CellGroupData[{
Cell[83869, 2180, 1018, 17, 22, "Print"],
Cell[84890, 2199, 1544, 36, 38, "Print"],
Cell[86437, 2237, 901, 15, 21, "Print"],
Cell[87341, 2254, 903, 15, 21, "Print"],
Cell[88247, 2271, 903, 15, 21, "Print"],
Cell[89153, 2288, 945, 16, 21, "Print"]
}, Open  ]],
Cell[90113, 2307, 6480, 171, 694, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96630, 2483, 219, 3, 28, "Input"],
Cell[96852, 2488, 1776, 42, 63, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[98677, 2536, 113, 1, 36, "Subsection"],
Cell[98793, 2539, 9869, 268, 730, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[108699, 2812, 126, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[108850, 2817, 2071, 48, 131, "Input"],
Cell[110924, 2867, 281, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[111254, 2877, 109, 1, 36, "Subsection"],
Cell[111366, 2880, 9669, 255, 889, "Input"],
Cell[CellGroupData[{
Cell[121060, 3139, 1107, 27, 118, "Input"],
Cell[122170, 3168, 6406, 195, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128613, 3368, 137, 2, 28, "Input"],
Cell[128753, 3372, 234, 3, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[129036, 3381, 124, 1, 36, "Subsection"],
Cell[129163, 3384, 7545, 170, 675, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[136745, 3559, 123, 1, 36, "Subsection"],
Cell[136871, 3562, 8947, 210, 862, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145867, 3778, 114, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[146006, 3783, 208, 3, 44, "Subsection"],
Cell[146217, 3788, 4470, 138, 300, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[150724, 3931, 97, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[150846, 3936, 390, 9, 46, "Input"],
Cell[151239, 3947, 2100, 64, 180, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[153388, 4017, 102, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[153515, 4022, 176, 3, 28, "Input"],
Cell[153694, 4027, 1920, 55, 97, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[155663, 4088, 97, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[155785, 4093, 1330, 39, 89, "Input"],
Cell[157118, 4134, 2428, 53, 410, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[159607, 4194, 92, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[159724, 4199, 166, 3, 28, "Input"],
Cell[159893, 4204, 2323, 80, 413, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
