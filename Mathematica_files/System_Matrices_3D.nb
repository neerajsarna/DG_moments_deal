(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    530073,      12884]
NotebookOptionsPosition[    514106,      12388]
NotebookOutlinePosition[    514497,      12405]
CellTagsIndexPosition[    514454,      12402]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.710647908285541*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Ax", ",", "Ay", ",", "B", ",", "Binflow"}], "]"}]], "Input",
 CellChangeTimes->{{3.7069373568622417`*^9, 3.706937364315585*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input"],

Cell[BoxData["\<\"/Users/neerajsarna/sciebo/DG_moments_deal/Mathematica_files\
\"\>"], "Output",
 CellChangeTimes->{3.7069415461969767`*^9, 3.7072239588011417`*^9, 
  3.708919505631403*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Core Routines ", "Title",
 CellChangeTimes->{{3.706855001018561*^9, 3.706855002997157*^9}}],

Cell[CellGroupData[{

Cell["Index Notation and Summation Convention", "Section",
 CellChangeTimes->{{3.5360792581005783`*^9, 3.5360792676321945`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "ii", ",", "jj", ",", "ex", ",", "ex0", ",", "ex1", ",", "ex2", ",", 
    "idx1", ",", "idx2", ",", "rule", ",", "\[Delta]", ",", "pos", ",", "idx",
     ",", " ", "double", ",", "sidx", ",", "dummy", ",", "xx", ",", 
    "\[Delta]$", ",", "\[Delta]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StandardizeIdx", "[", 
    RowBox[{"ex_", ",", "flag_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ex0", ",", "ex1", ",", "pos", ",", "idx", ",", "double", ",", "dummy", 
       ",", 
       RowBox[{"sidx", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "s0", ",", "s1", ",", "s2", ",", "s3", ",", "s4", ",", "s5", ",", 
            "s6", ",", "s7", ",", "s8", ",", "s9"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "p0", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", 
            "p6", ",", "p7", ",", "p8", ",", "p9"}], "}"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ex0", "=", 
       RowBox[{"dummy", " ", "ex"}]}], ";", "    ", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "makes", " ", "sure", " ", "expression", " ", "is", " ", "a", " ", 
         "product"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"ex0", ",", "List"}], "]"}], ",", "None", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "     ", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "pos", " ", "identifies", " ", "all", " ", "lists", " ", "of", " ", 
         "indices", " ", "in", " ", "the", " ", "expression"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"idx", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"idx", ",", 
            RowBox[{"Extract", "[", 
             RowBox[{"ex0", ",", 
              RowBox[{
              "pos", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "pos", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
             "]"}], "\[Equal]", "3"}], ",", 
           RowBox[{"idx", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"idx", ",", 
              RowBox[{"Extract", "[", 
               RowBox[{"ex0", ",", 
                RowBox[{
                "pos", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "idx", " ", "contains", " ", "all", " ", "the", " ", "indices", " ", 
         "in", " ", "the", " ", "expression"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ex1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
         "ex0", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "ex0", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"double", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"idx", ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[Equal]", "2"}], "&&", 
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"double", ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], ",", 
          RowBox[{"double", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"double", ",", 
             RowBox[{"{", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
              "}"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "double", " ", "contains", " ", "all", " ", "the", " ", "double", " ",
          "indices"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"ex1", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"ex1", ",", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"ex1", ",", 
              RowBox[{
              "double", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[Rule]", 
            RowBox[{"sidx", "\[LeftDoubleBracket]", 
             RowBox[{"flag", ",", "ii"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "double", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"ex1", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"ex1", ",", 
           RowBox[{
            RowBox[{
            "pos", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "\[Rule]", 
            RowBox[{"Sort", "[", 
             RowBox[{"Extract", "[", 
              RowBox[{"ex1", ",", 
               RowBox[{
               "pos", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}]}], "]"}], "]"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", "ex1"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"dummy", "\[Rule]", "1"}], "}"}]}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Einstein1", "[", "ex_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ex0", ",", "ex1", ",", "ex2", ",", "idx1", ",", "idx2", ",", "rule", 
       ",", "dummy"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ex", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "ex", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ex0", "=", 
       RowBox[{"dummy", " ", "ex"}]}], ";", "  ", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "makes", " ", "sure", " ", "expression", " ", "is", " ", "a", " ", 
         "product"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ex0", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{
               "ex0", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
                "]"}], "===", "Power"}], "&&", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{
                 "ex0", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ",", "List"}], "]"}], "]"}], ">",
               "0"}]}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ex0", "\[LeftDoubleBracket]", 
               RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"jj", ",", "1", ",", 
                RowBox[{"ex0", "\[LeftDoubleBracket]", 
                 RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{
            "ex0", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "ex0", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "makes", " ", "sure", " ", "expression", " ", "is", " ", "a", " ", 
         "product"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ex1", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"ex0", ",", 
         RowBox[{"Position", "[", 
          RowBox[{"ex0", ",", 
           RowBox[{"\[Delta]", "[", "_", "]"}]}], "]"}]}], "]"}]}], ";", 
      "   ", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "list", " ", "all", " ", "\[Delta]", " ", "expressions", " ", "and", 
         " ", "corresponding", " ", "indices"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"idx1", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"ex1", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"ex1", ",", "List"}], "]"}], ",", "None", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ex2", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"ex0", ",", 
         RowBox[{"Position", "[", 
          RowBox[{"ex0", ",", 
           RowBox[{"\[Delta]", "[", "_", "]"}]}], "]"}]}], "]"}]}], ";", 
      "    ", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{
        "list", " ", "expressions", " ", "without", " ", "\[Delta]", " ", 
         "and", " ", "corresponding", " ", "indices"}],
        FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"idx2", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Extract", "[", 
         RowBox[{"ex2", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"ex2", ",", "List"}], "]"}], ",", "None", ",", 
              RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"rule", "=", 
          RowBox[{"{", "}"}]}], ";", "     ", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{
           "extract", " ", "of", " ", "index", " ", "replacement", " ", 
            "rule"}],
           FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"idx2", ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Delete", "[", 
                  RowBox[{"idx1", ",", 
                   RowBox[{"{", "ii", "}"}]}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"idx1", "\[LeftDoubleBracket]", 
               RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
            "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{"rule", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"idx1", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "->", 
               RowBox[{"idx1", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}]}], 
              "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"idx2", ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Delete", "[", 
                    RowBox[{"idx1", ",", 
                    RowBox[{"{", "ii", "}"}]}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"idx1", "\[LeftDoubleBracket]", 
                 RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}],
               "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{"rule", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"idx1", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "->", 
                 RowBox[{"idx1", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                "}"}]}], ";"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "rule", "]"}], "\[Equal]", "1"}], ",", 
           "     ", 
           RowBox[{"(*", 
            StyleBox[
             RowBox[{"apply", " ", "index", " ", "replacement", " ", "rule"}],
             
             FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ex1", "=", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"ex1", ",", 
                RowBox[{
                 RowBox[{"{", "ii", "}"}], "\[Rule]", "1"}]}], "]"}], "/.", 
              "rule"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ex2", "=", 
             RowBox[{"ex2", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"idx1", "=", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"idx1", ",", 
                RowBox[{
                 RowBox[{"{", "ii", "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], "/.", "rule"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"idx2", "/.", "rule"}]}], ";"}]}], "\[IndentingNewLine]",
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "idx1", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "idx1", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "]"}], ">", "0"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"idx1", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             RowBox[{"idx1", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"ex1", "=", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"ex1", ",", 
               RowBox[{
                RowBox[{"{", "ii", "}"}], "\[Rule]", "3"}]}], "]"}]}]}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "idx1", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"StandardizeIdx", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", 
           RowBox[{"Join", "[", 
            RowBox[{"ex1", ",", "ex2"}], "]"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"dummy", "\[Rule]", "1"}], "}"}]}], ",", "1"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Einstein", "[", "ex_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "ex", "]"}], "===", " ", "Plus"}], ",", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Einstein1", "[", 
          RowBox[{
          "ex", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"Einstein1", "[", "ex", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]$", "[", 
    RowBox[{"ii_", ",", "jj_"}], "]"}], "=", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "jj"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor", "[", "idx_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OddQ", "[", 
          RowBox[{"Length", "[", "idx", "]"}], "]"}], ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xx", "=", 
        RowBox[{"Permutations", "[", "idx", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"Length", "[", "idx", "]"}], "!"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"KroneckerDelta", "[", 
               RowBox[{
                RowBox[{"xx", "\[LeftDoubleBracket]", 
                 RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"xx", "\[LeftDoubleBracket]", 
                 RowBox[{"ii", ",", 
                  RowBox[{"jj", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"KroneckerDelta", "\[Rule]", "\[Delta]$"}], "}"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "1", ",", 
               RowBox[{"Length", "[", "idx", "]"}], ",", "2"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "idx", "]"}], "!"}]}], "}"}]}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sym1", "[", "ex_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ex0", "=", "ex"}], ",", "pos", ",", "idx", ",", "perm", ",", 
       "double", ",", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pos", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"ex0", ",", "List"}], "]"}], ",", "None", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"idx", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"idx", ",", 
            RowBox[{"Extract", "[", 
             RowBox[{"ex0", ",", 
              RowBox[{
              "pos", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "pos", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
             "]"}], "\[Equal]", "3"}], ",", 
           RowBox[{"idx", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"idx", ",", 
              RowBox[{"Extract", "[", 
               RowBox[{"ex0", ",", 
                RowBox[{
                "pos", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"double", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Tally", "[", "idx", "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">",
              "1"}], ")"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"idx", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"idx", ",", 
             RowBox[{
             "double", "\[LeftDoubleBracket]", "kk", 
              "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "double", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"perm", "=", 
       RowBox[{"Permutations", "[", "idx", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"ex0", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"idx", "\[Rule]", 
            RowBox[{
            "perm", "\[LeftDoubleBracket]", "kk", "\[RightDoubleBracket]"}]}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"kk", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "idx", "]"}], "!"}]}], "}"}]}], "]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StandardizeIdx", "[", 
          RowBox[{
           RowBox[{
           "tmp", "\[LeftDoubleBracket]", "kk", "\[RightDoubleBracket]"}], 
           ",", "2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"kk", ",", "1", ",", 
           RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"Length", "[", "perm", "]"}]], "tmp"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", "ex_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "ex", "]"}], "===", " ", "Plus"}], ",", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sym1", "[", 
         RowBox[{
         "ex", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
    
    RowBox[{"sym1", "[", "ex", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.535821055158787*^9, 3.535821066078806*^9}, {
   3.535821166901783*^9, 3.5358212958048096`*^9}, {3.5358214123838143`*^9, 
   3.5358214147862186`*^9}, {3.5358215618008766`*^9, 3.535821604123751*^9}, {
   3.535821698332317*^9, 3.5358217011715217`*^9}, {3.5358217447579985`*^9, 
   3.5358217566140194`*^9}, {3.535822680152241*^9, 3.535822696126669*^9}, {
   3.5358228323617086`*^9, 3.5358228417061253`*^9}, {3.5358231551106753`*^9, 
   3.535823169774701*^9}, {3.5358232120663757`*^9, 3.535823265168869*^9}, {
   3.5358233044185376`*^9, 3.53582333451099*^9}, {3.535823374915062*^9, 
   3.5358235131157045`*^9}, {3.5358235856090317`*^9, 3.5358236244219*^9}, {
   3.535823671143982*^9, 3.5358236829064026`*^9}, {3.5358237600797377`*^9, 
   3.535823791919394*^9}, {3.535823830810262*^9, 3.535823834351468*^9}, {
   3.535823891807369*^9, 3.5358239053637934`*^9}, {3.5358239420706577`*^9, 
   3.5358239633490953`*^9}, 3.535863647709474*^9, 3.535867745488166*^9, {
   3.535870455408924*^9, 3.535870473645012*^9}, {3.536173856347906*^9, 
   3.536173963457694*^9}, {3.536174014454184*^9, 3.536174027729807*^9}, {
   3.5361746053218217`*^9, 3.5361746149314384`*^9}, {3.5361749406132107`*^9, 
   3.5361749546688356`*^9}, {3.537099203659336*^9, 3.537099204123344*^9}, {
   3.537099273283682*^9, 3.5370992965788307`*^9}, 3.5371001026471033`*^9, {
   3.5371002063851147`*^9, 3.537100208309923*^9}, {3.537100238826915*^9, 
   3.5371004036702833`*^9}, {3.537100455360618*^9, 3.537100530540921*^9}, {
   3.537100577355506*^9, 3.53710059160116*^9}, {3.537109198461097*^9, 
   3.537109236618764*^9}, {3.537111875319599*^9, 3.537111966766959*^9}, {
   3.544510085142268*^9, 3.544510086491521*^9}, {3.544511135130258*^9, 
   3.544511149122176*^9}, {3.544511265775567*^9, 3.5445112663694477`*^9}, {
   3.544511306595739*^9, 3.544511450576692*^9}, {3.54451148203868*^9, 
   3.544511513829035*^9}, {3.544511554825622*^9, 3.544511571921101*^9}, {
   3.544589325870937*^9, 3.5445893449341707`*^9}, {3.545669873420969*^9, 
   3.5456699152446423`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor Definitions", "Section",
 CellChangeTimes->{{3.569139429210832*^9, 3.569139448895958*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.679824089018515*^9}],

Cell["\<\
Mathematica build-in function like \[OpenCurlyQuote]Symmetrize[]\
\[CloseCurlyQuote] and \[OpenCurlyQuote]TensorContract[]\[CloseCurlyQuote] \
seem 
to work really slow or fail due to memory requirements on fully symmetric \
tensors 
with degree >10.
We define our own functions below based on a simply array data structure for \
fully symmetric tensors.\
\>", "Text",
 CellChangeTimes->{{3.5691393015045276`*^9, 3.5691394253246098`*^9}, {
  3.569230437595318*^9, 3.569230461117482*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "n", ",", "degree", ",", "idx", ",", "idx1", ",", "A", ",", "b", ",", "id3",
    ",", "IDX"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "TensorDegree", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Every", " ", "symmetric", " ", "tensor", " ", "can", " ", "be", " ", 
     "identified", " ", "with", " ", "the", " ", "help", " ", "of", " ", "a", 
     " ", "2", "D", " ", "array", " ", "say", " ", 
     RowBox[{
      RowBox[{"a", "[", "N", "]"}], "[", "3", "]"}], " ", "where", " ", "N", 
     " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "indepedent", " ", "variables", " ", "it", " ", 
     RowBox[{"has", ".", " ", "So"}], " ", "every", " ", "row", " ", "ie", 
     " ", 
     RowBox[{"a", "[", "i", "]"}], " ", "store", " ", "the", " ", "number", 
     " ", "of", " ", "entries", " ", "for", " ", "x", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}]}], ",", 
    RowBox[{"for", " ", "y", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}], " ", "and", " ", "for", 
     " ", "z", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "3", "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", "ii"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "the", " ", "same", " ", "thing", " ", "as", " ", "IDXFull", 
    " ", "but", " ", "for", " ", "trace", " ", "free", " ", "tensors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXtrfFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"ii", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IDX", "[", "degree", "]"}], "=", 
      RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDXtrf", "[", "degree", "]"}], "=", 
      RowBox[{"IDXtrfFull", "[", "degree", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "0", ",", "40"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"given", " ", "an", " ", "array", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "counts", " ", "the", " ", 
     "number", " ", "of", " ", "1", "s"}], ",", " ", 
    RowBox[{"2", "s", " ", "and", " ", "3", "s"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX1", "[", "list_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Input", " ", "cartesean", " ", "indices"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "3"}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "Total", " ", "of", " ", "the", " ", "list", " ", "is", " ", 
     "the", " ", "tensorial", " ", "degree", " ", "we", " ", "are", " ", 
     "interested", " ", 
     RowBox[{"in", ".", " ", "So"}], " ", "list", " ", "should", " ", "be", 
     " ", "a", " ", "3", "X1", " ", "array", " ", "and", " ", "the", " ", 
     "following", " ", "function", " ", "will", " ", "give", " ", "us", " ", 
     "the", " ", "n", " ", "corresponding", " ", "to", " ", "which", " ", 
     RowBox[{"a", "[", "n", "]"}]}], " ", "=", " ", 
    RowBox[{"list", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX2", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDX", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX3", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDXtrfFull", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "tensor", " ", "degree", " ", "of", " ", "a", 
    " ", "symmetric", " ", 
    RowBox[{"tensor", ".", "\[IndentingNewLine]", 
     RowBox[{"CAUTION", ":", " ", 
      RowBox[{
      "the", " ", "formulae", " ", "is", " ", "not", " ", "valid", " ", "for",
        " ", "trace", " ", "free", " ", 
       RowBox[{"tensors", ".", " ", "The"}], " ", "input", " ", "argument", 
       " ", "\"\<A\>\"", " ", "is", " ", "a", " ", "list", " ", "containing", 
       " ", "all", " ", "the", " ", "components", " ", "of", " ", "the", " ", 
       "tensor"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorDegree", "[", "A_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         RowBox[{"Length", "[", "A", "]"}]}]}]]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"id3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaValues", "[", "list_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"b", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"c", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OddQ", "[", "a", "]"}], "||", 
         RowBox[{"OddQ", "[", "b", "]"}], "||", 
         RowBox[{"OddQ", "[", "c", "]"}]}], ",", "0", ",", 
        FractionBox[
         RowBox[{"Multinomial", "[", 
          RowBox[{
           FractionBox["a", "2"], ",", 
           FractionBox["b", "2"], ",", 
           FractionBox["c", "2"]}], "]"}], 
         RowBox[{"Multinomial", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "applied", " ", "deltavalues", " ", "to", " ", "all", " ", "the", " ", 
    "components", " ", "of", " ", "an", " ", "even", " ", "degree", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor2", "[", 
     RowBox[{"degree_", "?", "EvenQ"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"DeltaValues", ",", 
      RowBox[{"IDX", "[", "degree", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"What", " ", "does", " ", "this", " ", 
    RowBox[{"do", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTrace2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX2", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IDX", "[", 
                   RowBox[{"degree", "-", "2"}], "]"}], 
                  "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTraces", "[", 
     RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", "=", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"SymTrace2", "[", "res", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Assumes", " ", "3", " ", 
     RowBox[{"dimensions", ".", " ", "And"}], " ", "so"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contraction", " ", "of", " ", "a", " ", "symmetric", " ", "tensor", " ", 
    "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymDot2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Lets", " ", "take", " ", "a", " ", "particular", " ", "term", " ",
             "say", " ", "Ai1i2"}], ".."}], 
          RowBox[{"xbx", ".", " ", "In"}], " ", "the", " ", "result", " ", 
          "only", " ", "those", " ", "components", " ", "will", " ", "appear",
           " ", "in", " ", "which", " ", "x", " ", "atleast", " ", "appears", 
          " ", "once", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "why", " ", "the", " ", "addition",
           " ", "of", " ", 
          RowBox[{"id3", "[", 
           RowBox[{"[", "iis", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"toIDX2", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IDX", "[", 
                    RowBox[{"degree", "-", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                  "+", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "]"}], 
                "\[RightDoubleBracket]"}], 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "full", " ", "contraction", " ", "of", " ", "two", " ", "symmetric", " ", 
     "tensors", " ", "A"}], ",", " ", 
    RowBox[{"B", " ", "with", " ", "same", " ", "degree"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymFullDot", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TensorDegree", "[", "B", "]"}], "\[NotEqual]", "degree"}], 
         ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"idx", "=", 
           RowBox[{
            RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", "jj",
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "+=", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
              "]"}], 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{
            "B", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProduct2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"degree", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"degree", "+", "1"}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "1"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "b", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProductDelta2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"degree", "+", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"degree", "+", "1"}], ")"}]}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "2"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[GreaterEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}], 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "converts", " ", "a", " ", "symmetric", " ", "tensor", " ", "into", " ", 
    "a", " ", "trace", " ", "free", " ", "tensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "returns", " ", "the", " ", "tracefree", " ", "part", " ", "of", " ", "a",
      " ", "symmetric", " ", "tensor"}], ",", " ", 
    RowBox[{"but", " ", "with", " ", "all", " ", "components"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymTracefree", "[", "A_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
       RowBox[{"degree", "=", 
        RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", "res", 
       ",", "trace", ",", "res1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"trace", "=", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"trace", "=", 
           RowBox[{"SymTrace2", "[", "trace", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"res1", "=", 
            RowBox[{"SymProductDelta2", "[", "res1", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ll", ",", "1", ",", "kk"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "kk"], 
               RowBox[{"degree", "!"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"degree", "-", 
                  RowBox[{"2", "kk"}]}], ")"}], "!"}], 
               SuperscriptBox["2", "kk"], 
               RowBox[{"kk", "!"}]}]], 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"jj", "=", 
                RowBox[{"degree", "-", "kk"}]}], 
               RowBox[{"degree", "-", "1"}]], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", "jj"}], "+", "1"}]]}]}], ")"}], "res1"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"degree", "/", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5977647060562134`*^9, 3.5977647268750763`*^9}, {
   3.597764982828605*^9, 3.5977649884363317`*^9}, {3.676179501293851*^9, 
   3.6761796856337767`*^9}, {3.676179724780055*^9, 3.6761797401819553`*^9}, {
   3.6761800693011913`*^9, 3.67618009071702*^9}, {3.67618055987227*^9, 
   3.676180688136693*^9}, {3.676180727497422*^9, 3.676180773976479*^9}, {
   3.676181010436315*^9, 3.676181034457363*^9}, {3.676182895833144*^9, 
   3.676182910871441*^9}, {3.676183029280117*^9, 3.676183040299528*^9}, {
   3.676183109751354*^9, 3.676183133647092*^9}, {3.676184105172339*^9, 
   3.676184107563058*^9}, {3.676184447780569*^9, 3.676184559506366*^9}, 
   3.676184625341688*^9, {3.6761850010521708`*^9, 3.676185035780895*^9}, {
   3.6763163148181763`*^9, 3.676316347073567*^9}, {3.676316864163743*^9, 
   3.676316876694518*^9}, {3.706864139110922*^9, 3.706864154544766*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trfEvaluate", "[", 
     RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "m", ",", 
        RowBox[{"dim", "=", "3"}], ",", 
        RowBox[{"degree", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", 
          "2"}]}], ",", "length", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "list"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"c", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"toIDX3", "[", "list", "]"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Binomial", "[", 
               RowBox[{"m", ",", "i"}], "]"}], 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX3", "[", 
                RowBox[{"list", "+", 
                 RowBox[{"2", "i", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "i"}], ")"}], " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"2", "m", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "say", " ", "we", " ", "have", " ", "a", " ", "trace", " ", "free", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "whose", " ", "independent", " ", "components", " ", "are", " ", "given",
       " ", "then", " ", "the", " ", "following", " ", "function", " ", 
      "will", " ", "introduce", " ", "those", " ", "components", " ", "in", 
      " ", "the", " ", "list", " ", "which", " ", "have", " ", "been", " ", 
      "negelected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
      "free", " ", "nature", " ", "of", " ", "the", " ", 
      RowBox[{"tensor", ".", " ", "For"}], " ", 
      RowBox[{"eg", ".", " ", "it"}], " ", "will", " ", "introduce"}], " ", 
     "-", "Rxx", "-", 
     RowBox[{
     "Ryy", " ", "for", " ", "a", " ", "second", " ", "order", " ", 
      "tensor"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trf2sym", "[", "A_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"trfEvaluate", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
        "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", "2"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Pick", " ", "the", " ", "2", "D", " ", "variables", " ", "from", " ", "a",
     " ", "list", " ", "containing", " ", "all", " ", "the", " ", 
    RowBox[{"indices", ".", "The"}], " ", "list", " ", "will", " ", "be", " ",
     "obtained", " ", "from", " ", "the", " ", "IDXtrf", " ", 
    RowBox[{"routine", ".", " ", "freeindex"}], " ", "is", " ", "the", " ", 
    "total", " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in",
     " ", "the", " ", "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pick2D", "[", "freeindex_", "]"}], ":=", 
   RowBox[{"Pick", "[", 
    RowBox[{
     RowBox[{"IDXtrf", "[", "freeindex", "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "freeindex"}], "}"}]}], "]"}]}], "]"}],
       "]"}], ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592214156581615*^9, 3.5922142269069633`*^9}, {
  3.592214273648*^9, 3.592214321643592*^9}, {3.592214562691799*^9, 
  3.5922146307578783`*^9}, {3.5922150087114487`*^9, 3.5922151927530117`*^9}, {
  3.592215226866392*^9, 3.592215227208199*^9}, {3.5922152622517147`*^9, 
  3.592215315308941*^9}, {3.592215349687686*^9, 3.592215358801886*^9}, {
  3.59221558179191*^9, 3.592215608488448*^9}, {3.592215669267857*^9, 
  3.592215699095985*^9}, {3.676315905534268*^9, 3.676315915972599*^9}, {
  3.6763161617740183`*^9, 3.676316190517806*^9}, {3.67631623272976*^9, 
  3.676316302687489*^9}, {3.683806014488147*^9, 3.683806106724654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTensorForm", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
               RowBox[{
               "A", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               "}"}], "&"}], ",", 
            RowBox[{
             RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", 
             "ii", "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "length"}], "}"}]}], "]"}], "//", 
        "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.59211253078022*^9, 3.592112545437512*^9}, {
   3.5921125805422792`*^9, 3.5921127616337748`*^9}, {3.592112796427103*^9, 
   3.5921128146670732`*^9}, 3.597764731152925*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymProductDelta2", "[", 
  RowBox[{"SymProductDelta2", "[", 
   RowBox[{"SymProductDelta2", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
        "]"}], "&"}], ",", 
      RowBox[{"IDX", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516209179254*^9, 3.591516237845764*^9}, {
  3.591516279723213*^9, 3.591516319002157*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441912649*^9, 3.676179291151037*^9, 3.6762888609657383`*^9, 
   3.6763161356528177`*^9, 3.6779058949079237`*^9, 3.678529868398068*^9, 
   3.679117967252459*^9, 3.679318837538498*^9, {3.6793190558293753`*^9, 
   3.679319058380992*^9}, 3.679575273024575*^9, 3.679577657421208*^9, 
   3.679658895156467*^9, 3.6797228224020033`*^9, 3.6797482729168377`*^9, 
   3.6797526651898537`*^9, 3.679823747940913*^9, 3.679824094340494*^9, 
   3.679916332279891*^9, 3.67999882302528*^9, 3.6803172844933577`*^9, 
   3.6809502873032503`*^9, 3.681138707433749*^9, 3.6812109489012957`*^9, 
   3.68145797428557*^9, 3.6816993958050756`*^9, 3.6820486434762287`*^9, 
   3.682050102103993*^9, {3.682076336638524*^9, 3.682076355905759*^9}, 
   3.68208228870901*^9, 3.68224490278273*^9, 3.682512107741544*^9, 
   3.68370299060351*^9, 3.683804366294202*^9, 3.684500244083356*^9, 
   3.684575174210775*^9, 3.6845752161625957`*^9, 3.684660181849285*^9, 
   3.68467126128831*^9, 3.68481365641619*^9, 3.6851056524874783`*^9, 
   3.685123331713553*^9, 3.685262662109161*^9, 3.685424638158787*^9, 
   3.685966017058461*^9, 3.686220731045607*^9, 3.687236612952524*^9, 
   3.687495338270397*^9, 3.687982510093813*^9, 3.689512441442964*^9, 
   3.689942169390319*^9, 3.696227799336277*^9, {3.696227969057399*^9, 
   3.696227994050427*^9}, 3.696325209128666*^9, 3.697282978312483*^9, 
   3.6973464682351723`*^9, 3.697440910419991*^9, 3.697702353969549*^9, 
   3.698392885384088*^9, 3.701778681320677*^9, 3.70219127721093*^9, 
   3.702196459085004*^9, 3.702201311777804*^9, 3.702224873292901*^9, 
   3.7025494467971067`*^9, {3.70270311415604*^9, 3.70270313424642*^9}, 
   3.7029006783825207`*^9, 3.7032441009191227`*^9, 3.706706071012212*^9, 
   3.706842440298917*^9, 3.706934273089419*^9, 3.707224054652499*^9, 
   3.708672488599128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "2", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591517786313066*^9, 3.5915178359472446`*^9}, {
  3.591517885949567*^9, 3.591517930610208*^9}, {3.5977650183992825`*^9, 
  3.597765018845586*^9}, {3.676316092317675*^9, 3.6763161065616913`*^9}, {
  3.676316140175808*^9, 3.676316140772443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441957636*^9, 3.6761792911794147`*^9, 3.676288861012822*^9, {
   3.676316093569808*^9, 3.676316107287977*^9}, {3.676316137581958*^9, 
   3.6763161413544827`*^9}, 3.677905894933*^9, 3.678529868437419*^9, 
   3.679117967277781*^9, 3.6793188375764503`*^9, {3.6793190558584337`*^9, 
   3.679319058418271*^9}, 3.679575273045879*^9, 3.6795776574426947`*^9, 
   3.679658895200933*^9, 3.679722822451293*^9, 3.679748272951642*^9, 
   3.6797526652462883`*^9, 3.679823747962522*^9, 3.6798240943917*^9, 
   3.679916332302744*^9, 3.679998823059197*^9, 3.680317284526877*^9, 
   3.680950287334775*^9, 3.681138707474543*^9, 3.681210948938271*^9, 
   3.681457974307749*^9, 3.681699395843232*^9, 3.682048643515264*^9, 
   3.682050102123021*^9, {3.682076336676392*^9, 3.682076355939827*^9}, 
   3.682082288745886*^9, 3.682244902819724*^9, 3.682512107762454*^9, 
   3.683702990650755*^9, 3.6838043663292027`*^9, 3.684500244127709*^9, 
   3.6845751742446737`*^9, 3.6845752161992826`*^9, 3.6846601818893833`*^9, 
   3.684671261318471*^9, 3.6848136564349537`*^9, 3.685105652526771*^9, 
   3.6851233317512207`*^9, 3.6852626621474*^9, 3.6854246381976*^9, 
   3.685966017098112*^9, 3.686220731084846*^9, 3.6872366130034647`*^9, 
   3.687495338306348*^9, 3.687982510132082*^9, 3.689512441475595*^9, 
   3.689942169428029*^9, 3.696227799379738*^9, {3.696227969103997*^9, 
   3.696227994086108*^9}, 3.696325209168998*^9, 3.6972829783365297`*^9, 
   3.697346468260099*^9, 3.697440910455179*^9, 3.697702354005878*^9, 
   3.6983928854216537`*^9, 3.701778681352748*^9, 3.7021912772450867`*^9, 
   3.702196459122231*^9, 3.702201311811311*^9, 3.702224873327437*^9, 
   3.702549446834991*^9, {3.7027031141972847`*^9, 3.702703134265583*^9}, 
   3.702900678419382*^9, 3.703244100958321*^9, 3.706706071035109*^9, 
   3.706842440330564*^9, 3.706934273114991*^9, 3.707224054680538*^9, 
   3.70867248863596*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", 
          RowBox[{"2.", "#2"}], "-", 
          RowBox[{"3", "#3"}]}], "&"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "4", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516796847253*^9, 3.591516813094841*^9}, {
   3.5915174393368073`*^9, 3.5915174614075623`*^9}, {3.59151750012652*^9, 
   3.59151776014233*^9}, {3.591517814794807*^9, 3.5915178185262527`*^9}, {
   3.591517860691409*^9, 3.5915178802347727`*^9}, 3.591518123963479*^9, {
   3.5915182744621964`*^9, 3.591518302569395*^9}, {3.591526482595047*^9, 
   3.5915265043240232`*^9}, {3.591611217481101*^9, 3.591611231450076*^9}, {
   3.597765011088415*^9, 3.5977650116257725`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1428571428571423`"}], ",", "1.1428571428571432`", ",", 
   "2.571428571428571`", ",", "3.428571428571429`", ",", 
   "1.4285714285714286`", ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", "3.1428571428571432`", ",", 
   "2.857142857142857`", ",", 
   RowBox[{"-", "4.285714285714286`"}], ",", 
   RowBox[{"-", "5.428571428571429`"}], ",", 
   RowBox[{"-", "2.2857142857142847`"}], ",", "4.285714285714286`", ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "5.714285714285714`"}], ",", "3.428571428571427`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.675954442007567*^9, 3.67617929122402*^9, 3.676288861058632*^9, 
   3.677905894982387*^9, 3.678529868487091*^9, 3.679117967319182*^9, 
   3.6793188376105824`*^9, {3.679319055894771*^9, 3.679319058450843*^9}, 
   3.679575273094136*^9, 3.6795776574842777`*^9, 3.6796588952380247`*^9, 
   3.6797228224790287`*^9, 3.6797482729844093`*^9, 3.679752665267261*^9, 
   3.679823747991828*^9, 3.679824094441633*^9, 3.679916332335182*^9, 
   3.679998823098927*^9, 3.6803172845586*^9, 3.6809502873740597`*^9, 
   3.6811387075067053`*^9, 3.681210948971066*^9, 3.6814579743442507`*^9, 
   3.681699395875101*^9, 3.6820486435478983`*^9, 3.682050102157604*^9, {
   3.682076336706912*^9, 3.6820763559592457`*^9}, 3.682082288778234*^9, 
   3.6822449028531103`*^9, 3.682512107799152*^9, 3.683702990693994*^9, 
   3.683804366361187*^9, 3.6845002441605253`*^9, 3.6845751742821827`*^9, 
   3.684575216232545*^9, 3.684660181922132*^9, 3.684671261353323*^9, 
   3.684813656465918*^9, 3.685105652558341*^9, 3.6851233317891407`*^9, 
   3.685262662181744*^9, 3.685424638219063*^9, 3.685966017129785*^9, 
   3.6862207311299343`*^9, 3.687236613054021*^9, 3.687495338334983*^9, 
   3.687982510165078*^9, 3.689512441507597*^9, 3.689942169478065*^9, 
   3.696227799410926*^9, {3.696227969142024*^9, 3.696227994119534*^9}, 
   3.696325209212883*^9, 3.6972829783684263`*^9, 3.697346468285926*^9, 
   3.6974409104931707`*^9, 3.697702354039557*^9, 3.6983928854674597`*^9, 
   3.701778681377768*^9, 3.702191277294244*^9, 3.7021964591586027`*^9, 
   3.702201311847865*^9, 3.7022248733703136`*^9, 3.7025494468671007`*^9, {
   3.702703114230402*^9, 3.7027031342998667`*^9}, 3.702900678454741*^9, 
   3.70324410099473*^9, 3.7067060710661793`*^9, 3.7068424403635683`*^9, 
   3.706934273133008*^9, 3.707224054722398*^9, 3.708672488670072*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymFullDot", "[", 
   RowBox[{
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], "}"}], 
      "]"}], "]"}], ",", 
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], "}"}], 
      "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Rxx", " ", "Sxx"}], "+", 
  RowBox[{"Ryy", " ", "Sxx"}], "+", 
  RowBox[{"2", " ", "Rxy", " ", "Sxy"}], "+", 
  RowBox[{"Rxx", " ", "Syy"}], "+", 
  RowBox[{"2", " ", "Ryy", " ", "Syy"}]}]], "Output",
 CellChangeTimes->{
  3.675954442064178*^9, 3.676179291269311*^9, 3.676288861096998*^9, 
   3.6779058950315104`*^9, 3.6785298685371113`*^9, 3.679117967356577*^9, 
   3.6793188376487103`*^9, {3.679319055928149*^9, 3.6793190584906387`*^9}, 
   3.679575273127549*^9, 3.679577657522038*^9, 3.679658895273378*^9, 
   3.6797228225005693`*^9, 3.6797482730345907`*^9, 3.67975266531371*^9, 
   3.679823748014205*^9, 3.6798240944848623`*^9, 3.679916332363706*^9, 
   3.6799988231490192`*^9, 3.6803172845798607`*^9, 3.680950287417145*^9, 
   3.681138707540022*^9, 3.68121094899828*^9, 3.681457974376297*^9, 
   3.6816993958984547`*^9, 3.682048643582439*^9, 3.68205010219067*^9, {
   3.682076336726356*^9, 3.682076355994687*^9}, 3.682082288811843*^9, 
   3.682244902885347*^9, 3.682512107830677*^9, 3.683702990731329*^9, 
   3.6838043663945713`*^9, 3.684500244192729*^9, 3.6845751743152113`*^9, 
   3.684575216264653*^9, 3.684660181955201*^9, 3.684671261373692*^9, 
   3.684813656498608*^9, 3.6851056525783567`*^9, 3.685123331821924*^9, 
   3.685262662214212*^9, 3.6854246382596397`*^9, 3.685966017149164*^9, 
   3.6862207311629133`*^9, 3.687236613103174*^9, 3.6874953383576593`*^9, 
   3.687982510202093*^9, 3.689512441526951*^9, 3.6899421695113783`*^9, 
   3.696227799436955*^9, {3.696227969187942*^9, 3.696227994151021*^9}, 
   3.696325209245842*^9, 3.6972829784223833`*^9, 3.69734646831116*^9, 
   3.697440910524934*^9, 3.697702354067754*^9, 3.698392885512212*^9, 
   3.701778681424369*^9, 3.702191277327828*^9, 3.70219645919093*^9, 
   3.702201311884334*^9, 3.7022248734085083`*^9, 3.7025494468886223`*^9, {
   3.702703114258202*^9, 3.702703134332766*^9}, 3.7029006784898777`*^9, 
   3.703244101029738*^9, 3.706706071099662*^9, 3.706842440382248*^9, 
   3.706934273168437*^9, 3.707224054764183*^9, 3.708672488704077*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], 
               "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], 
               "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sxx", ",", "Sxy", ",", "Syy"}], "}"}]}], "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6759544421144657`*^9, 3.676179291324445*^9, 3.676288861145307*^9, 
   3.6779058950810213`*^9, 3.678529868586431*^9, 3.679117967407839*^9, 
   3.679318837688384*^9, {3.67931905596832*^9, 3.679319058536566*^9}, 
   3.679575273161376*^9, 3.679577657555993*^9, 3.679658895317548*^9, 
   3.6797228225355597`*^9, 3.6797482730705357`*^9, 3.67975266534791*^9, 
   3.679823748046441*^9, 3.679824094521659*^9, 3.679916332386283*^9, 
   3.6799988232008038`*^9, 3.680317284627035*^9, 3.680950287450737*^9, 
   3.68113870757331*^9, 3.681210949019701*^9, 3.681457974397373*^9, 
   3.68169939592647*^9, 3.682048643616544*^9, 3.682050102224084*^9, {
   3.682076336757115*^9, 3.68207635602658*^9}, 3.682082288844701*^9, 
   3.682244902922915*^9, 3.6825121078512993`*^9, 3.68370299076066*^9, 
   3.6838043664285183`*^9, 3.6845002442129803`*^9, 3.684575174348187*^9, 
   3.6845752162828074`*^9, 3.684660181989087*^9, 3.684671261401486*^9, 
   3.6848136565327787`*^9, 3.685105652608335*^9, 3.685123331854587*^9, 
   3.685262662247349*^9, 3.68542463829657*^9, 3.685966017179893*^9, 
   3.6862207311960363`*^9, 3.687236613153617*^9, 3.687495338388363*^9, 
   3.6879825102301826`*^9, 3.689512441559684*^9, 3.689942169545233*^9, 
   3.696227799483726*^9, {3.696227969226108*^9, 3.696227994172471*^9}, 
   3.6963252092941*^9, 3.697282978468988*^9, 3.697346468357728*^9, 
   3.697440910543648*^9, 3.697702354089707*^9, 3.698392885551806*^9, 
   3.701778681453361*^9, 3.7021912773622093`*^9, 3.702196459225028*^9, 
   3.702201311927372*^9, 3.702224873453492*^9, 3.702549446935582*^9, {
   3.702703114281065*^9, 3.702703134365402*^9}, 3.702900678533885*^9, 
   3.703244101076621*^9, 3.706706071131051*^9, 3.706842440417234*^9, 
   3.7069342732012*^9, 3.707224054811528*^9, 3.708672488736106*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "mxxx", ",", "mxxy", ",", "0", ",", "mxyy", ",", "0", ",", 
                "myyy", ",", "0"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "nxxx", ",", "nxxy", ",", "0", ",", "nxyy", ",", "0", ",", 
                "nyyy", ",", "0"}], "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy"}], "}"}]}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"nxxx", ",", "nxxy", ",", "nxyy", ",", "nyyy"}], "}"}]}], "]"}],
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}, {3.656607710425463*^9, 
  3.656607745128602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6759544421633577`*^9, 3.676179291374331*^9, 3.6762888611958103`*^9, 
   3.6779058951312113`*^9, 3.6785298686374598`*^9, 3.679117967455283*^9, 
   3.679318837730372*^9, {3.679319056013073*^9, 3.679319058585289*^9}, 
   3.679575273192576*^9, 3.6795776576017933`*^9, 3.679658895350123*^9, 
   3.679722822571162*^9, 3.679748273114377*^9, 3.679752665385249*^9, 
   3.679823748080174*^9, 3.6798240945561943`*^9, 3.679916332430656*^9, 
   3.67999882324424*^9, 3.6803172846583776`*^9, 3.68095028749041*^9, 
   3.6811387076070023`*^9, 3.681210949052898*^9, 3.6814579744431267`*^9, 
   3.681699395959167*^9, 3.682048643648769*^9, 3.682050102259828*^9, {
   3.682076336777141*^9, 3.68207635604613*^9}, 3.682082288878572*^9, 
   3.68224490295254*^9, 3.682512107880975*^9, 3.683702990795364*^9, 
   3.683804366461938*^9, 3.6845002442432127`*^9, 3.6845751743766327`*^9, 
   3.684575216310408*^9, 3.684660182022472*^9, 3.684671261435358*^9, 
   3.6848136565705357`*^9, 3.6851056526274567`*^9, 3.6851233318830767`*^9, 
   3.685262662282794*^9, 3.6854246383314543`*^9, 3.6859660172008753`*^9, 
   3.686220731229653*^9, 3.687236613204381*^9, 3.687495338407893*^9, 
   3.68798251025246*^9, 3.689512441588101*^9, 3.689942169595203*^9, 
   3.696227799529995*^9, {3.6962279692707663`*^9, 3.696227994214904*^9}, 
   3.696325209333612*^9, 3.697282978501671*^9, 3.697346468391983*^9, 
   3.6974409105755577`*^9, 3.697702354124016*^9, 3.698392885602257*^9, 
   3.701778681490099*^9, 3.70219127740726*^9, 3.702196459260594*^9, 
   3.7022013119612293`*^9, 3.702224873487791*^9, 3.702549446967301*^9, {
   3.7027031143138313`*^9, 3.702703134399701*^9}, 3.702900678570258*^9, 
   3.7032441011092367`*^9, 3.7067060711546993`*^9, 3.706842440441511*^9, 
   3.7069342732199173`*^9, 3.7072240548396797`*^9, 3.708672488756633*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Definitions", "Section",
 CellChangeTimes->{{3.679646970945805*^9, 3.6796469737833633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ref", " ", "to", " ", "manuels", " ", "paper", " ", "on", " ", "fluxes", 
    " ", "for", " ", "large", " ", "moment", " ", "system", " ", "for", " ", 
    "a", " ", "detailed", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "tensorial", " ", "degree", " ", "including", " ", 
    "traces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"iFullDegree", "[", "i_", "]"}], "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"4", "i"}], "-", "3"}]], "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "traces", " ", 
     RowBox[{"C", "^", "2"}], " ", "has", " ", "one", " ", "trace"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTraces", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"iFullDegree", "[", "i", "]"}]}]}], ")"}], "2"], "]"}], 
      "-", "i"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "tensorial", " ", "degree"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTensorDegree", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"iFullDegree", "[", "i", "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"iTraces", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ii", "[", 
      RowBox[{"s_", ",", "A_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"A", "+", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{"A", "+", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"s", "+", "1"}], ")"}]}], "-", 
         RowBox[{"Floor", "[", 
          FractionBox[
           RowBox[{"A", "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}]}], ")"}]}], "-",
       "s"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "i", " ", "is", " ", "as", " ", "defined", " ", "in", " ", "the", " ", 
     "reference"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables2D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iTensorDegree", "[", "i", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfFullTensors3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"iFullDegree", "[", "ntensors", "]"}]}], ",", "frac"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"m", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "3"}], ")"}]}], "6."], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", 
               RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}], "2"], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varName", "[", 
     RowBox[{"s_", ",", "ix_", ",", "iy_", ",", "iz_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\[Rho]\>\"", ",", 
      RowBox[{"ToString", "[", "s", "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<x\>\"", ",", "ix"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<y\>\"", ",", "iy"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<z\>\"", ",", "iz"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "not", " ", "the", " ", "norm", " ", "of", " ", 
      "\[Psi]"}], ",", " ", 
     RowBox[{"rather", " ", 
      RowBox[{"it", "'"}], "s", " ", "the", " ", "norm", " ", "of", " ", 
      "the", " ", "laguerre", " ", "polynomials"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm\[Psi]", "[", 
      RowBox[{"a_", ",", "deg_"}], "]"}], "=", 
     FractionBox[
      RowBox[{
       RowBox[{"deg", "!"}], 
       RowBox[{"a", "!"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"deg", "+", "a", "+", 
         RowBox[{"3", "/", "2"}]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"deg", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"given", " ", "a", " ", "symmetric", " ", "tensor", " ", "W"}], 
     ",", " ", 
     RowBox[{
     "the", " ", "following", " ", "function", " ", "returns", " ", "the", 
      " ", "independent", " ", "components", " ", "of", " ", "this", " ", 
      RowBox[{"tensor", ".", " ", "W"}], " ", "should", " ", "be", " ", 
      "already", " ", "trace", " ", "free", " ", "but", " ", "the", " ", 
      "input", " ", "should", " ", "be", " ", "such", " ", "that", " ", "it", 
      " ", "also", " ", "contains", " ", "those", " ", "components", " ", 
      "which", " ", "are", " ", "only", " ", "trace", " ", 
      RowBox[{"free", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trfComponents2D", "[", "W_", "]"}], ":=", 
     RowBox[{"Extract", "[", 
      RowBox[{"W", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"IDX", "[", 
              RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
            "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "&"}], ",", 
         RowBox[{"Pick", "[", 
          RowBox[{
           RowBox[{"IDXtrf", "[", 
            RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", 
                  RowBox[{"TensorDegree", "[", "W", "]"}]}], "}"}]}], "]"}]}],
              "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "the", " ", 
     "3", "D", " ", 
     RowBox[{"case", ".", " ", 
      RowBox[{"CAUTION", ":", " ", 
       RowBox[{
       "W", " ", "should", " ", "be", " ", "a", " ", "symmetric", " ", 
        "tensor"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trfComponents3D", "[", "W_", "]"}], ":=", 
     RowBox[{"Extract", "[", 
      RowBox[{"W", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"IDX", "[", 
              RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
            "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "&"}], ",", 
         RowBox[{"IDXtrf", "[", 
          RowBox[{"TensorDegree", "[", "W", "]"}], "]"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "total", " ", "number", " ", "of", " ", "trace", " ", "free", " ", 
      "variables", " ", "in", " ", "the", " ", "2", "D", " ", "case"}], " ", 
     "=", " ", 
     RowBox[{"deg", "+", "1"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trfVar2D", "[", 
      RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"name", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"deg", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "total", " ", "number", " ", "of", " ", "trace", " ", "free", " ", 
      "variables", " ", "in", " ", "the", " ", "3", "D", " ", "case"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"2", " ", "deg"}], " ", "+", " ", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trfVar3D", "[", 
      RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"name", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"2", "deg"}], "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "add", " ", "zero", " ", "to", " ", "locations", " ", "where", " ", "the",
      " ", "3", "D", " ", "components", " ", "existed"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"From2Dto3D", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "list", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gradients", " ", "of", " ", "a", " ", "zero", " ", "order", " ", 
     RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "3"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Given", " ", "the", " ", "components", " ", "of", " ", "a", " ", 
        "tensor", " ", "represented", " ", "by", " ", "B"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
       "then", " ", "tmp", " ", "collects", " ", "the", " ", "terms", " ", 
        "corresponding", " ", 
        RowBox[{"to", " ", "\\", "partial_x"}], " ", 
        RowBox[{"in", " ", "\\", "partial_x"}], "_", 
        RowBox[{"{", "ik", "}"}], " ", "w_", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i1", ".."}], "inik"}], "}"}], "\[IndentingNewLine]", "the",
         " ", "second", " ", "one", " ", "does", " ", "the", " ", "same", " ",
         "job", " ", "but", " ", "for", " ", "a", " ", "tensor", " ", 
        RowBox[{"product", ".", " ", "The"}], " ", "following", " ", 
        "routine", " ", 
        RowBox[{"trf2sym", "[", 
         RowBox[{"From2Dto3D", "[", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], " ", "does", " ", 
        "the", " ", 
        RowBox[{"following", ":", " ", 
         RowBox[{
         "1.", " ", "represent", " ", "the", " ", "components", " ", "of", 
          " ", "the", " ", "trace", " ", "free", " ", "variables", " ", "by", 
          " ", "B"}]}]}], ",", " ", 
       RowBox[{
       "then", " ", "place", " ", "zero", " ", "at", " ", "locations", " ", 
        "where", " ", "there", " ", "was", " ", "a", " ", "3", "D", " ", 
        "tensor", " ", "and", " ", "then", " ", "add", " ", "those", " ", 
        "elements", " ", "which", " ", "where", " ", "trace", " ", 
        RowBox[{"free", ".", " ", "The"}], " ", "resulting", " ", "tensor", 
        " ", "is", " ", "trace", " ", "free", " ", "and", " ", "therefore", 
        " ", "we", " ", "only", " ", "select", " ", "the", " ", "trace", " ", 
        "free", " ", 
        RowBox[{"components", ".", "trf2sym"}], " ", "routines", " ", "is", 
        " ", "used", " ", "to", " ", "consider", " ", "also", " ", "those", 
        " ", "components", " ", "which", " ", "have", " ", "been", " ", 
        "neglected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
        "free", " ", "nature", " ", "of", " ", "the", " ", 
        RowBox[{"moments", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents3D", "[", 
             RowBox[{"SymDot2", "[", 
              RowBox[{
               RowBox[{"trf2sym", "[", 
                RowBox[{"trfVar3D", "[", 
                 RowBox[{"d", ",", "B"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficient", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar3D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", 
         "tensor", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents3D", "[", 
             RowBox[{"SymTracefree", "[", 
              RowBox[{"SymProduct2", "[", 
               RowBox[{
                RowBox[{"trf2sym", "[", 
                 RowBox[{"trfVar3D", "[", 
                  RowBox[{"d", ",", "B"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}]}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficients", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar3D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "15"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "following", " ", "is", " ", "the", " ", "main", " ", 
      "moment", " ", "equation"}], ",", " ", 
     RowBox[{
     "flag", " ", "is", " ", "the", " ", "dimension", " ", "for", " ", 
      "which", " ", "we", " ", "wish", " ", "to", " ", "develop", " ", "the", 
      " ", "flux", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"recursion1", "[", 
     RowBox[{"a_", ",", "deg_", ",", "flag_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "deg"}], "+", "2"}], 
         RowBox[{
          RowBox[{"2", "deg"}], "+", "3"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"deg", "+", "a", "+", 
            FractionBox["3", "2"]}]], 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar3D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", "a", ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
         RowBox[{
          SqrtBox["a"], " ", 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar3D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", 
                RowBox[{"a", "-", "1"}], ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
        ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"deg", ">", "0"}], ",", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", "deg"}], 
           RowBox[{
            RowBox[{"2", "deg"}], "+", "1"}]]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SqrtBox[
             RowBox[{"(", 
              RowBox[{"deg", "+", "a", "+", 
               FractionBox["1", "2"]}], ")"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar3D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
           RowBox[{
            SqrtBox[
             RowBox[{"a", "+", "1"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar3D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"a", "+", "1"}], ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
          ")"}]}], ",", "0"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox[
      RowBox[{
       RowBox[{"Give", " ", "two", " ", "Laguerre", " ", "polynomials", " ", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["L", 
           RowBox[{"(", "n", ")"}]], ")"}], 
         RowBox[{"a", " "}]], "and", " ", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["L", 
           RowBox[{"(", "m", ")"}]], ")"}], 
         RowBox[{"b", " "}]], "then", " ", "the", " ", "following", " ", 
        "routine", " ", "computes", " ", 
        RowBox[{
         SubscriptBox[
          SuperscriptBox["\[Integral]", "\[Infinity]"], "0"], 
         RowBox[{
          SubscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["L", 
              RowBox[{"(", "n", ")"}]], 
             RowBox[{"(", 
              FractionBox[
               SuperscriptBox["x", "2"], "2"], ")"}]}], ")"}], 
           RowBox[{"a", " "}]], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["L", 
             RowBox[{"(", "m", ")"}]], 
            RowBox[{"(", 
             FractionBox[
              SuperscriptBox["x", "2"], "2"], ")"}]}], ")"}]}]}]}], ")"}], 
      RowBox[{"b", " "}]], 
     SuperscriptBox["x", "2"], 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"-", 
        SuperscriptBox["x", "2"]}], "2"]], 
     RowBox[{"dx", ".", " ", "Uses"}], " ", "the", " ", "Laguerre", " ", 
     "polynomials", " ", "used", " ", "in", " ", "file", " ", 
     RowBox[{"CompleteGenericMatrices1D", ".", "nb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mixed", "[", 
      RowBox[{"a_", ",", "n_", ",", "b_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Expand", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"n", "-", 
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"], "+", "a", "-", "c1", "-", "1"}], 
           ",", 
           RowBox[{"a", "-", "c1"}]}], "]"}], 
         FractionBox[
          RowBox[{"a", "!"}], 
          RowBox[{"c1", "!"}]], 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"m", "-", 
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"], "+", "b", "-", "c1", "-", "1"}], 
           ",", 
           RowBox[{"b", "-", "c1"}]}], "]"}], 
         FractionBox[
          RowBox[{"b", "!"}], 
          RowBox[{"c1", "!"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c1", "!"}], 
           SqrtBox["2"], 
           RowBox[{"Gamma", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"n", "+", "m"}], "2"], "+", "c1", "+", 
             RowBox[{"3", "/", "2"}]}], "]"}], 
           SuperscriptBox["2", 
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"]]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"c1", ",", "0", ",", 
          RowBox[{"Min", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "ratio", " ", "between", " ", "the", " ", "new", " ", "and", " ", "old", 
     " ", "laguerre", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"factorLaguerre", "[", 
      RowBox[{"a_", ",", "n_"}], "]"}], ":=", 
     SqrtBox[
      FractionBox[
       RowBox[{"Gamma", "[", 
        RowBox[{"n", "+", 
         FractionBox["3", "2"]}], "]"}], 
       RowBox[{
        RowBox[{"n", "!"}], 
        RowBox[{"a", "!"}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"n", "+", "a", "+", 
          FractionBox["3", "2"]}], "]"}]}]]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "Laguerre", 
     " ", "polynomials", " ", "used", " ", "in", " ", "the", " ", "Boundary", 
     " ", "Value", " ", "problem", " ", "paper"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mixed2", "[", 
      RowBox[{"a_", ",", "n_", ",", "b_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"mixed", "[", 
        RowBox[{"a", ",", "n", ",", "b", ",", "m"}], "]"}], 
       RowBox[{"factorLaguerre", "[", 
        RowBox[{"a", ",", "n"}], "]"}], 
       RowBox[{"factorLaguerre", "[", 
        RowBox[{"b", ",", "m"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "The", " ", "following", " ", "function", " ", "integrates", " ", 
        "expressions", " ", "of", " ", "the", " ", "kind", " ", 
        RowBox[{"\[Integral]", 
         RowBox[{
          SuperscriptBox["\[Nu]x", "m"], 
          SuperscriptBox["\[Nu]y", "p"], 
          SuperscriptBox["\[Nu]z", "n"], "d\[Nu]", " ", "but", " ", "the", 
          " ", "integration", " ", "is", " ", "such", " ", "that", " ", 
          "only", " ", "\[Nu]x"}]}]}], " ", ">", 
       RowBox[{
       "0.", " ", "Making", " ", "the", " ", "transformation", " ", "to", " ",
         "spherical", " ", "coordinates", " ", 
        RowBox[{"i", ".", "e", ".", " ", "\[Nu]x"}]}]}], " ", "=", " ", 
      RowBox[{"Sin", " ", "\[Nu]", " ", "Cos", " ", "\[Theta]"}]}], ",", " ", 
     
     RowBox[{"\[Nu]y", " ", "=", " ", 
      RowBox[{
       RowBox[{
       "Sin", " ", "\[Nu]", " ", "Sin", " ", "\[Theta]", " ", "and", " ", 
        "\[Nu]z"}], " ", "=", " ", 
       RowBox[{"Cos", " ", "\[Nu]", " ", "we", " ", "have", " ", 
        RowBox[{
         SubscriptBox[
          SuperscriptBox["\[Integral]", 
           RowBox[{
            RowBox[{"+", "\[Pi]"}], "/", "2"}]], 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}]], 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Integral]", "0"], "\[Pi]"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Sin\[Nu]", 
              RowBox[{"mm", "+", "nn", "+", "1"}]], 
             SuperscriptBox["Cos\[Nu]", "pp"], 
             SuperscriptBox["Sin\[Theta]", "nn"], 
             SuperscriptBox["Cos\[Theta]", "mm"]}], ")"}], 
           "d\[Nu]d\[Theta]"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNz1", "[", "ex_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2", ",", "pos3", ",", 
        RowBox[{"mm", "=", "0"}], ",", 
        RowBox[{"nn", "=", "0"}], ",", 
        RowBox[{"pp", "=", "0"}], ",", "res", ",", 
        RowBox[{"res1", "=", 
         RowBox[{"\[Nu]x", " ", "\[Nu]y", " ", "\[Nu]z", " ", "ex"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos1", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]x", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos2", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]y", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos3", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]z", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], ">", "0"}], ",", 
         RowBox[{"mm", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], ">", "0"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos2", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], ">", "0"}], ",", 
         RowBox[{"pp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos3", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{"res1", ",", 
           RowBox[{"Join", "[", 
            RowBox[{"pos1", ",", "pos2", ",", "pos3"}], "]"}]}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OddQ", "[", "nn", "]"}], "||", 
            RowBox[{"OddQ", "[", "pp", "]"}]}], ",", "0", ",", 
           RowBox[{"2", "\[Pi]", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nn", "-", "1"}], ")"}], "!!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"mm", "-", "1"}], ")"}], "!!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pp", "-", "1"}], ")"}], "!!"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nn", "+", "mm", "+", "pp", "+", "1"}], ")"}], 
              "!!"}]]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]x"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]y"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]z"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "applies", " ", "integrate", " ", "halfnxnynz1", " ", "to", " ", "a", " ",
      "long", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNz", "[", "ex_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "ex", "]"}], "===", " ", "Plus"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"IntegrateHalfNxNyNz1", "[", 
           RowBox[{
           "ex", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"IntegrateHalfNxNyNz1", "[", "ex", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "input", " ", "of", " ", "the", " ", "following", " ", 
      "function", " ", 
      RowBox[{"i", ".", "e"}], " ", "idx1", " ", "and", " ", "idx2", " ", 
      "are", " ", "arrays", " ", "such", " ", "that", " ", 
      RowBox[{"idx1", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#xcomponents", ",", "#ycomponents", ",", "#zcomponents"}], 
         "}"}], ".", " ", "The"}], " ", "following", " ", "function", " ", 
       "computes", " ", "the", " ", "half", " ", "integrals", " ", "of", " ", 
       "the", " ", "form", " ", 
       RowBox[{"\[Integral]", " ", 
        RowBox[{
        "\[Psi]", " ", "fdc", " ", "where", " ", "\[Psi]", " ", "is", " ", 
         "the", " ", "basis", " ", "function", " ", "and", " ", "the", " ", 
         "integral", " ", "is", " ", "only", " ", "over", " ", "the", " ", 
         "half", " ", 
         RowBox[{"space", ".", " ", "The"}], " ", "\[Psi]", " ", "is", " ", 
         "represented", " ", "by", " ", "one", " ", "of", " ", "the", " ", 
         "input", " ", "parameters", " ", "and", " ", "the", " ", "basis", 
         " ", "functions", " ", "in", " ", "f", " ", "are", " ", 
         "represented", " ", "by", " ", "one", " ", "of", " ", "the", " ", 
         "input", " ", 
         RowBox[{
         "parameters", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "idx1"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
       "index", " ", "for", " ", "the", " ", "testfunction", 
        "\[IndentingNewLine]", "\t   ", "ix2"}], " ", "=", " ", 
       RowBox[{
       "index", " ", "for", " ", "the", " ", "basis", " ", "of", " ", "the", 
        " ", "distribution", " ", "function"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfIntegrate", "[", 
     RowBox[{"idx1_", ",", "idx2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Int1", ",", "Int2", ",", 
        RowBox[{"deg1", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx1", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", 
        RowBox[{"deg2", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx2", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "f0"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "following", " ", "term", " ", "develops", " ", "terms", 
        " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         SubscriptBox["\[Nu]", 
          RowBox[{"<", 
           RowBox[{
            SuperscriptBox["x", "m"], 
            SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "The"}], " ", 
        "algorithm", " ", "is", " ", "as", " ", "follows", 
        "\[IndentingNewLine]", "1.", " ", "Extract", " ", "the", " ", "total",
         " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in", 
        " ", "the", " ", "tensor", "\[IndentingNewLine]", "2.", " ", 
        "Develop", " ", "the", " ", "full", " ", "sym", " ", "trace", " ", 
        "free", " ", "tensor", " ", 
        RowBox[{"i", ".", "e"}], " ", "develop", " ", "all", " ", "the", " ", 
        "components", " ", "of", " ", 
        SubscriptBox["\[Nu]", 
         RowBox[{"<", 
          RowBox[{
           SubscriptBox["i", 
            RowBox[{"1", "..."}]], 
           SubscriptBox["i", "n"]}], ">"}]], "\[IndentingNewLine]", "3.", " ",
         "Extract", " ", "the", " ", "component", " ", "corresponding", " ", 
        "to", " ", 
        RowBox[{"idx1", ".", "\[IndentingNewLine]", "4."}], " ", "The", " ", 
        "Routine", " ", "SymTraceFree", " ", "converts", " ", "a", " ", 
        "symmetric", " ", "tensor", " ", "to", " ", "trace", " ", "free"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Int1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"SymTracefree", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Nu]x", "#1"], 
                  SuperscriptBox["\[Nu]y", "#2"], 
                  SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
              "&"}], ",", 
             RowBox[{"IDX", "[", "deg1", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"toIDX2", "[", 
           RowBox[{"idx1", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
            "\[RightDoubleBracket]"}], "]"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "Let", " ", "us", " ", "consider", " ", "the", " ", "part", " ",
                "of", " ", "the", " ", "distribution", " ", "function", " ", 
               "which", " ", "comes", " ", "from", " ", 
               RowBox[{"Rij", ".", " ", "This"}], " ", "part", " ", "will", 
               " ", "be", " ", "of", " ", "the", " ", "form", " ", "Rxx"}], 
              "..."}], "+", "Rzz"}], "..."}], ".", " ", "But"}], " ", "Rzz"}],
          " ", "=", " ", 
         RowBox[{
          RowBox[{"-", "Rxx"}], "-", 
          RowBox[{
          "Ryy", " ", "and", " ", "therefore", " ", "Int2", " ", "is", " ", 
           "not", " ", "simply", " ", "the", " ", "tensorised", " ", 
           RowBox[{
            SubscriptBox["\[Nu]", 
             RowBox[{"<", 
              RowBox[{
               SuperscriptBox["x", "m"], 
               SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "A"}], " ", 
           "part", " ", "of", " ", "the", " ", "following", " ", "routines", 
           " ", "takes", " ", "care", " ", "of", " ", "the", " ", "trace", 
           " ", "free", " ", "natrue", " ", "of", " ", "the", " ", 
           RowBox[{"tensors", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Int2", "=", 
        RowBox[{"SymFullDot", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Nu]x", "#1"], 
                 SuperscriptBox["\[Nu]y", "#2"], 
                 SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"IDX", "[", "deg2", "]"}]}], "]"}], ",", 
          RowBox[{"trf2sym", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "\[Equal]", 
                    RowBox[{"idx2", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], ",", "1", ",", "0"}], "]"}], 
                 "&"}], ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"IDXtrf", "[", "deg2", "]"}]}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"f0", "=", " ", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Pi]"}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"mixed2", "[", 
          RowBox[{
           RowBox[{
           "idx1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg1", ",", 
           RowBox[{
           "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg2"}], "]"}], "f0", " ", 
         RowBox[{"IntegrateHalfNxNyNz", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Int1", " ", "Int2"}], "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.679121885999333*^9, 
   3.679121891174914*^9}, {3.679122262361793*^9, 3.679122267112525*^9}, {
   3.679133059362032*^9, 3.679133059631439*^9}, {3.679133589038743*^9, 
   3.67913360936185*^9}, {3.679133640904398*^9, 3.6791336831388493`*^9}, {
   3.6791337141082077`*^9, 3.679133874437611*^9}, {3.679135482134459*^9, 
   3.679135484173957*^9}, {3.6792156676707373`*^9, 3.679215704456918*^9}, {
   3.6792240744446783`*^9, 3.67922407965063*^9}, {3.679224862877001*^9, 
   3.679224873400732*^9}, {3.679225442671756*^9, 3.679225466025872*^9}, {
   3.679226905039249*^9, 3.679226910362652*^9}, {3.6792317958716917`*^9, 
   3.679231814488446*^9}, {3.679234365577106*^9, 3.67923455103795*^9}, {
   3.679234637556697*^9, 3.679234658998818*^9}, {3.67923481326576*^9, 
   3.6792349261248913`*^9}, {3.67930698033679*^9, 3.679307111509572*^9}, 
   3.6793079545705748`*^9, {3.679307990942153*^9, 3.6793080003912067`*^9}, {
   3.6793080728155317`*^9, 3.67930812133251*^9}, {3.679308193672022*^9, 
   3.6793081992657127`*^9}, {3.679308266611847*^9, 3.6793082780834208`*^9}, {
   3.67930833570712*^9, 3.679308473366946*^9}, {3.679308542688333*^9, 
   3.679308586584567*^9}, 3.67931011500143*^9, {3.679316283604321*^9, 
   3.6793164193343067`*^9}, {3.679316950785508*^9, 3.679317078760085*^9}, {
   3.679317115961516*^9, 3.679317148087328*^9}, {3.679317186721846*^9, 
   3.679317202807983*^9}, {3.679317250901362*^9, 3.679317253339156*^9}, {
   3.679577712229986*^9, 3.679577715509426*^9}, {3.679577809486747*^9, 
   3.679577809636169*^9}, {3.6795856251725492`*^9, 3.679585640933337*^9}, {
   3.679637631192264*^9, 3.679637681544441*^9}, {3.679637722657783*^9, 
   3.679637838534441*^9}, {3.6796380620381813`*^9, 3.679638062453928*^9}, {
   3.6796381418023863`*^9, 3.67963814848005*^9}, {3.6796382255962143`*^9, 
   3.679638259265773*^9}, {3.6796382978240213`*^9, 3.679638422576579*^9}, {
   3.679645489712325*^9, 3.679645490928825*^9}, {3.679645528417181*^9, 
   3.679645538219562*^9}, {3.6796456043820677`*^9, 3.679645689824514*^9}, {
   3.679645765050008*^9, 3.67964580304412*^9}, {3.679645835164995*^9, 
   3.679645838423962*^9}, {3.679645957213408*^9, 3.679645981843093*^9}, {
   3.6796460142235928`*^9, 3.679646072405961*^9}, {3.679646113923502*^9, 
   3.679646146851458*^9}, {3.679646953690811*^9, 3.679646955349524*^9}, {
   3.7068634068077803`*^9, 3.706863421362707*^9}, {3.7068642726062317`*^9, 
   3.7068643503469152`*^9}, {3.706864423124673*^9, 3.7068644478163147`*^9}, {
   3.706864635512862*^9, 3.7068646514202957`*^9}, {3.706864790874284*^9, 
   3.706864856012247*^9}, {3.706864944340926*^9, 3.706864947881872*^9}, {
   3.706864990220438*^9, 3.7068650394220743`*^9}, {3.706871480328793*^9, 
   3.7068715001349697`*^9}, {3.706873314443365*^9, 3.7068733292209473`*^9}, {
   3.7068733602963963`*^9, 3.706873450847706*^9}, {3.706873678965983*^9, 
   3.7068737553896503`*^9}, {3.706873814399115*^9, 3.7068738175958967`*^9}, {
   3.7068738802234707`*^9, 3.706873923486217*^9}, {3.7068744966802883`*^9, 
   3.7068745032569237`*^9}, {3.706874766252406*^9, 3.706874769973401*^9}, {
   3.706875152871194*^9, 3.706875213408064*^9}, {3.706936743385553*^9, 
   3.706936811683461*^9}, {3.7069370560518503`*^9, 3.706937077448599*^9}, {
   3.7069371715569687`*^9, 3.706937219270533*^9}, 3.706937914547908*^9, {
   3.708669698778667*^9, 3.708669723040941*^9}, {3.7087489826302767`*^9, 
   3.708748997069284*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["develop sparsity and write matrix", "Section",
 CellChangeTimes->{{3.6681731720116997`*^9, 3.66817319332295*^9}, {
   3.668228151665504*^9, 3.668228156542235*^9}, 3.668228799380147*^9, {
   3.668228831468952*^9, 3.66822883407552*^9}}],

Cell["\<\
Use this function to create the entries of the sparse matrix. The first value \
written to the file is the number of non zeros. Incase of symbolic matrices, \
the entries are considered to be 1. flag = 0 for symbolic, flag = 1 for \
constant matrices.

1) flag = 0: in the case one only needs the location of the non zeros entries
2) flag = 1; in the case when one also needs the values of the entries

Caution: always send N[a].
CAUTION: not be used for symbolic matrices\
\>", "Text",
 CellChangeTimes->{{3.66822884187737*^9, 3.668228941383243*^9}, {
  3.668229646182706*^9, 3.668229661478045*^9}, {3.67605131615924*^9, 
  3.676051363867848*^9}, {3.68109883176829*^9, 3.6810988329113503`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"developsparsity2", "[", 
    RowBox[{"a_", ",", "filename_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nnz", ",", "indicies", ",", "rowindicies", ",", "colindicies", ",", 
       "entries", ",", "str", ",", "numzeros"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"total", " ", "number", " ", "of", " ", "non"}], "-", 
       RowBox[{"zeros", " ", "in", " ", "the", " ", "matrix"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indicies", " ", "=", " ", 
       RowBox[{
        RowBox[{"ArrayRules", "[", "a", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nnz", " ", "=", " ", 
       RowBox[{"Length", "[", "indicies", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowindicies", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "indicies", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colindicies", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "indicies", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"entries", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "indicies", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rowindicies", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"indicies", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "indicies", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"colindicies", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"indicies", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "indicies", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"entries", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"indicies", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "indicies", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"str", " ", "=", " ", 
       RowBox[{"OpenWrite", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<../system_matrices/\>\"", ",", "filename"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"str", ",", 
        RowBox[{"ToString", "[", "nnz", "]"}], ",", "\"\<\\n\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"str", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"rowindicies", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\< \>\"", " ", 
          ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"colindicies", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\< \>\"", " ", 
          ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"entries", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "rowindicies", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "str", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "a", " ", "vector", " ", "to", " ", "a", " ", "file"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"writeVector", "[", 
   RowBox[{"vec_", ",", "filename_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NumEntries", ",", "str", ",", "destination"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NumEntries", " ", "=", " ", 
      RowBox[{"Length", "[", "vec", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"destination", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<../system_matrices/\>\"", ",", "filename"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "first", " ", "open", " ", "the", " ", "file", " ", "to", " ", 
       "write"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"OpenWrite", "[", "destination", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "first", " ", "write", " ", "the", " ", "number", " ", "of", " ", 
       "entries", " ", "to", " ", "the", " ", "file"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", 
       RowBox[{"ToString", "[", "NumEntries", "]"}], ",", "\"\<\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "write", " ", "the", " ", "vector", " ", "to", " ", "the", " ", 
       "opened", " ", "file"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Minus", " ", "1", " ", "to", " ", "take", " ", "care", " ", "of", " ", 
       "the", " ", "C", " ", "indices"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"WriteString", "[", 
        RowBox[{"str", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"vec", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "-", "1"}], "]"}], ",", 
         "\"\<\\n\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "vec", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "str", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.668173195704064*^9, 3.668173232725699*^9}, {
   3.668226970770607*^9, 3.6682270927202587`*^9}, {3.6682271428666363`*^9, 
   3.668227155768401*^9}, {3.668227193724353*^9, 3.668227323574191*^9}, {
   3.668227415971815*^9, 3.668227421857192*^9}, {3.668227680651102*^9, 
   3.668227718490542*^9}, {3.6682279731791277`*^9, 3.668228105520145*^9}, {
   3.6682289471772957`*^9, 3.668229088847966*^9}, {3.6682292584757767`*^9, 
   3.668229263653676*^9}, {3.6682295296762543`*^9, 3.66822953308567*^9}, {
   3.668229643177256*^9, 3.6682296763141413`*^9}, {3.6687889038876867`*^9, 
   3.668788918608638*^9}, {3.668788982206395*^9, 3.668788982557585*^9}, {
   3.669542397774646*^9, 3.6695424007824087`*^9}, {3.673546457950383*^9, 
   3.673546508015944*^9}, {3.673546540275446*^9, 3.673546541600737*^9}, {
   3.673546630590992*^9, 3.673546644517036*^9}, {3.673546700847164*^9, 
   3.6735467447817373`*^9}, {3.6735467809068527`*^9, 3.673546800850913*^9}, {
   3.6737833736618633`*^9, 3.6737833844718313`*^9}, {3.6737834589232492`*^9, 
   3.673783472382395*^9}, {3.673783544019918*^9, 3.673783550374506*^9}, {
   3.676051104710444*^9, 3.676051192186738*^9}, {3.6811033215469847`*^9, 
   3.681103385614745*^9}, {3.684816328390649*^9, 3.6848163547682447`*^9}, {
   3.684816407503681*^9, 3.6848164953687487`*^9}, {3.6848165429710073`*^9, 
   3.6848166261264467`*^9}, 3.684816930538732*^9, {3.684816974440692*^9, 
   3.684817079486958*^9}, {3.687501396233433*^9, 3.687501416097817*^9}, {
   3.687501595246122*^9, 3.68750160655971*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Projector ", "Section",
 CellChangeTimes->{{3.70685502245157*^9, 3.706855024064803*^9}}],

Cell[CellGroupData[{

Cell["Projector, particular moment 3D", "Subsection",
 CellChangeTimes->{{3.706843453970489*^9, 3.706843463988358*^9}, {
  3.7069352804930353`*^9, 3.706935290052938*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coeffEntropySym", "[", "a_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"Total", "[", "a", "]"}], "!"}], 
    RowBox[{
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "!"}], 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "!"}], 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      "!"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.706845491469307*^9, 3.70684550445793*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "given", " ", "a", " ", "particular", " ", "list", " ", "containing", 
      " ", "the", " ", "number", " ", "of", " ", "x", " ", "y", " ", "and", 
      " ", "z", " ", 
      RowBox[{"indices", ".", " ", "The"}], " ", "following", " ", "function",
       " ", "returns", " ", "a", " ", "list", " ", "of", " ", "the", " ", 
      "form", " ", 
      SubscriptBox["i", "1"]}], "..."}], 
    SubscriptBox["i", "n"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IndexList", "[", "idx_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"if", " ", "the", " ", "value", " ", "of", " ", 
         RowBox[{
         "idx", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}], 
        " ", ">", " ", 
        RowBox[{
        "0", " ", "then", " ", "simply", " ", "repeat", " ", "1", " ", 
         "those", " ", "many", " ", "times"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "idx", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ">", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "result", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"ii", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                  "idx", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], "]"}]}], 
            ";"}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"result", ",", "0"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.706847293238171*^9, 3.706847576285672*^9}, {
  3.7068476225525618`*^9, 3.706847624771399*^9}, {3.706938476833153*^9, 
  3.706938506776931*^9}, {3.7069385471464157`*^9, 3.7069385498341103`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "idx2", " ", "determines", " ", "the", " ", "type", " ", "of", " ", 
     "vector", " ", "and", " ", "idx", " ", "1", " ", "determines", " ", 
     "the", " ", 
     RowBox[{"indices", ".", "\[IndentingNewLine]", "n"}], " ", "appears", 
     " ", 
     RowBox[{"idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     " ", "times"}], ",", " ", 
    RowBox[{
     RowBox[{"t", " ", "appears", " ", 
      RowBox[{"idx2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      " ", "times", " ", "and", " ", "r", " ", "appears", " ", 
      RowBox[{"idx2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      " ", 
      RowBox[{"times", ".", " ", "So"}], " ", "if", " ", "idx2"}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "0"}], "}"}], " ", "then", " ", "the", " ",
       "unit", " ", "vector", " ", "is", " ", 
      SubscriptBox["n", "i"], 
      SubscriptBox["t", "j"], 
      SubscriptBox["t", "k"]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"UnitVectorDev", "[", 
     RowBox[{"indexList_", ",", " ", "idx2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"the", " ", "contribution", " ", "from", " ", "n", " ", 
         RowBox[{"i", ".", "e"}], " ", "the", " ", "number", " ", "of", " ", 
         "powers", " ", "of", " ", "n"}], " ", "=", " ", 
        RowBox[{
        "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{
           "indexList", "\[LeftDoubleBracket]", "ii", 
            "\[RightDoubleBracket]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{
            "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"the", " ", "contribution", " ", "from", " ", "t", " ", 
          RowBox[{"i", ".", "e"}], " ", "the", " ", "number", " ", "of", " ", 
          "powers", " ", "of", " ", "t"}], " ", "=", " ", 
         RowBox[{
         "idx2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"indexList", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
              "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", "ii"}], "\[RightDoubleBracket]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{
             "idx2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
             "}"}]}], "]"}], "*", "result"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"the", " ", "contribution", " ", "from", " ", "r", " ", 
          RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "number", " ", "of", 
          " ", "powers", " ", "of", " ", "n"}], " ", "=", " ", 
         RowBox[{
         "idx2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"indexList", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
              "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "idx2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "+", "ii"}], "\[RightDoubleBracket]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{
             "idx2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
             "}"}]}], "]"}], "*", "result"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "we", " ", "need", " ", "to", " ", "consider", " ", "the", " ", 
     "symmetric", " ", "part", " ", "of", " ", "the", " ", "unitvector", " ", 
     "developed", " ", "in", " ", "the", " ", "previous", " ", "routine"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SymUnitVector", "[", 
     RowBox[{"idx1_", ",", "idx2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indexList", ",", "result"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indexList", " ", "=", " ", 
        RowBox[{"Permutations", "[", 
         RowBox[{"IndexList", "[", "idx1", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"result", "+=", 
          RowBox[{"UnitVectorDev", "[", 
           RowBox[{"ii", ",", "idx2"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "indexList"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.706846837328972*^9, 3.7068468759078703`*^9}, {
   3.706847636600621*^9, 3.7068476476444273`*^9}, 3.706847719427375*^9, {
   3.706847800095038*^9, 3.706847809372593*^9}, {3.706848033332095*^9, 
   3.706848065514636*^9}, {3.706848126969302*^9, 3.706848359311112*^9}, {
   3.706853991733176*^9, 3.706854105877345*^9}, {3.7068541517838297`*^9, 
   3.706854155269806*^9}, {3.706854202617259*^9, 3.706854300155015*^9}, {
   3.7069386335907707`*^9, 3.706938684445912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "transfer", " ", "vector", " ", "for", " ", "unit", " ", "vectors"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"transfUnitVector", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "[", "1", "]"}], "\[Rule]", "nx"}], ",", 
       RowBox[{
        RowBox[{"n", "[", "2", "]"}], "\[Rule]", "ny"}], ",", 
       RowBox[{
        RowBox[{"n", "[", "3", "]"}], "\[Rule]", "nz"}], ",", 
       RowBox[{
        RowBox[{"t", "[", "1", "]"}], "\[Rule]", "tx"}], ",", 
       RowBox[{
        RowBox[{"t", "[", "2", "]"}], "\[Rule]", "ty"}], ",", 
       RowBox[{
        RowBox[{"t", "[", "3", "]"}], "\[Rule]", "tz"}], ",", 
       RowBox[{
        RowBox[{"r", "[", "1", "]"}], "\[Rule]", "rx"}], ",", 
       RowBox[{
        RowBox[{"r", "[", "2", "]"}], "\[Rule]", "ry"}], ",", 
       RowBox[{
        RowBox[{"r", "[", "3", "]"}], "\[Rule]", "rz"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"transfUnitVectorInv", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "[", "1", "]"}], "\[Rule]", "nx"}], ",", 
       RowBox[{
        RowBox[{"n", "[", "2", "]"}], "\[Rule]", "tx"}], ",", 
       RowBox[{
        RowBox[{"n", "[", "3", "]"}], "\[Rule]", "rx"}], ",", 
       RowBox[{
        RowBox[{"t", "[", "1", "]"}], "\[Rule]", "ny"}], ",", 
       RowBox[{
        RowBox[{"t", "[", "2", "]"}], "\[Rule]", "ty"}], ",", 
       RowBox[{
        RowBox[{"t", "[", "3", "]"}], "\[Rule]", "ry"}], ",", 
       RowBox[{
        RowBox[{"r", "[", "1", "]"}], "\[Rule]", "nz"}], ",", 
       RowBox[{
        RowBox[{"r", "[", "2", "]"}], "\[Rule]", "tz"}], ",", 
       RowBox[{
        RowBox[{"r", "[", "3", "]"}], "\[Rule]", "rz"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.706852087774352*^9, 3.7068521555811043`*^9}, {
  3.7087680284361773`*^9, 3.708768075076548*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProjectorGeneral3D", "[", 
    RowBox[{"deg_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "idxFull", ",", "idxTrf", ",", "positionTrf", ",", "idxtrf2sym", ",", 
       "Projector", ",", "varSym", ",", "varTrf", ",", "ReplaceTrf", ",", 
       "var3D", ",", "Reductions2D", ",", "position2D", ",", "var2D"}], "}"}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "the", " ", "following", " ", "list", " ", "includes", " ", "the", " ", 
       "indices", " ", "which", " ", "are", " ", "tracefree"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idxFull", " ", "=", " ", 
       RowBox[{"IDXFull", "[", "deg", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"varSym", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "#", "]"}], "&"}], ",", "idxFull"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "replacing", " ", "the", " ", "tracefree", " ", "indices", " ", "by", 
        " ", "there", " ", "corresponding", " ", "relations"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"idxtrf2sym", " ", "=", " ", 
       RowBox[{"trf2sym", "[", 
        RowBox[{"IDXtrf", "[", "deg", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "variables", " ", "with", " ", "definitions", " ", "of", " ", "the", 
        " ", "trace", " ", "free", " ", "variables"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"varTrf", " ", "=", 
       RowBox[{"trf2sym", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"IDXtrf", "[", "deg", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "final", " ", "variables", " ", "we", " ", "need", " ", 
        "to", " ", "consider", " ", "in", " ", "the", " ", "system"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"var3D", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"IDXtrf", "[", "deg", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"var2D", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"var3D", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "deg"}], "}"}]}], "]"}]}], "]"}], 
          "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "replacement", " ", "for", " ", "all", " ", "the", " ", "tracefree", 
        " ", "tensors"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ReplaceTrf", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ReplaceTrf", "\[LeftDoubleBracket]", "ii", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{
          "varSym", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
          "\[Rule]", 
          RowBox[{
          "varTrf", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "ReplaceTrf", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "indices", " ", "of", " ", "the", " ", "trace", " ", "free", " ", 
        "indices"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"idxTrf", " ", "=", " ", 
       RowBox[{"IDXtrf", "[", "deg", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"positionTrf", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "locate", " ", "the", " ", "position", " ", "of", " ", "trace", " ", 
        "free", " ", "indices", " ", "in", " ", "IDXFull"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "positionTrf", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "idxFull", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}], "\[Equal]", 
             RowBox[{
             "idxtrf2sym", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}]}], ",", "0", ",", "1"}], "]"}]}], 
         ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"positionTrf", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"positionTrf", ",", "0"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "develop", " ", "the", " ", "projector", " ", "component", " ", "for", 
        " ", "a", " ", "symmetric", " ", "tensor"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Projector", " ", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Projector", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
          "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "varSym", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{"SymUnitVector", "[", 
             RowBox[{
              RowBox[{
              "idxFull", "\[LeftDoubleBracket]", "jj", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "idxFull", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Reductions", " ", "for", " ", "2", "D"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
        RowBox[{"Reductions2D", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nz", "\[Rule]", "0"}], ",", 
           RowBox[{"tz", "\[Rule]", "0"}], ",", 
           RowBox[{"rx", "\[Rule]", "0"}], ",", 
           RowBox[{"ry", "\[Rule]", "0"}], ",", 
           RowBox[{"rz", "\[Rule]", "0"}]}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"tx", "\[Rule]", 
             RowBox[{"-", "ny"}]}], ",", 
            RowBox[{"ty", "\[Rule]", "nx"}]}], "*)"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Projector", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dim", "\[Equal]", "2"}], ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "Projector", "\[LeftDoubleBracket]", "positionTrf", 
               "\[RightDoubleBracket]"}], "/.", "ReplaceTrf"}], "/.", 
             "transfUnitVector"}], "/.", "Reductions2D"}], ",", "0"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Projector", "\[LeftDoubleBracket]", "positionTrf", 
            "\[RightDoubleBracket]"}], "/.", "ReplaceTrf"}], "/.", 
          "transfUnitVector"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Projector", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dim", "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ii", "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "Projector"}], "}"}]}], "]"}], ",", 
            "var2D"}], "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ii", "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "Projector"}], "}"}]}], "]"}], ",", 
            "var3D"}], "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "Projector"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.706843466233976*^9, 3.706843668014666*^9}, {
   3.7068437034721537`*^9, 3.70684372602949*^9}, {3.706843797902206*^9, 
   3.706843813003474*^9}, {3.7068438459426737`*^9, 3.706843849710662*^9}, {
   3.706843924195794*^9, 3.7068440748749733`*^9}, {3.706844106349483*^9, 
   3.7068441086188097`*^9}, {3.706844221029008*^9, 3.7068442282243977`*^9}, {
   3.706844815847879*^9, 3.7068450194799223`*^9}, {3.706845122952248*^9, 
   3.706845348535447*^9}, {3.7068453793431807`*^9, 3.706845380414936*^9}, {
   3.7068454154175*^9, 3.706845437525878*^9}, {3.706845566596426*^9, 
   3.7068457032072563`*^9}, {3.7068457337746077`*^9, 
   3.7068457380934553`*^9}, {3.7068467926322927`*^9, 
   3.7068468302635098`*^9}, {3.7068484413084908`*^9, 3.706848455807726*^9}, {
   3.706848644875471*^9, 3.706848653029265*^9}, {3.706848733238694*^9, 
   3.706848759507926*^9}, {3.7068488010654507`*^9, 3.706849213144986*^9}, {
   3.706849252133972*^9, 3.706849265126646*^9}, {3.7068518356666727`*^9, 
   3.706851839606822*^9}, {3.706851876539351*^9, 3.7068519615772543`*^9}, {
   3.7068520251557817`*^9, 3.706852077638056*^9}, {3.706852164954729*^9, 
   3.7068521663796587`*^9}, {3.706852259030628*^9, 3.7068522677906017`*^9}, {
   3.706852352279284*^9, 3.706852441332061*^9}, {3.706852516071705*^9, 
   3.70685252570562*^9}, {3.706852557078573*^9, 3.706852564732663*^9}, {
   3.7068526874068413`*^9, 3.706852689940261*^9}, {3.706852765442226*^9, 
   3.706852766984907*^9}, {3.706852799254745*^9, 3.70685282013549*^9}, {
   3.7068528788554296`*^9, 3.706853036592548*^9}, {3.706853206503236*^9, 
   3.706853213264654*^9}, {3.706853252820312*^9, 3.7068532915621347`*^9}, 
   3.706853659642322*^9, 3.706853804088809*^9, {3.706854326143828*^9, 
   3.706854342991077*^9}, 3.706939287635744*^9, 3.7070265791491547`*^9, {
   3.707026626423736*^9, 3.707026632674123*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Inverse of the Projector", "Subsection",
 CellChangeTimes->{{3.7087681160361347`*^9, 3.708768119099462*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvProjectorGeneral3D", "[", 
   RowBox[{"deg_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxFull", ",", "idxTrf", ",", "positionTrf", ",", "idxtrf2sym", ",", 
      "Projector", ",", "varSym", ",", "varTrf", ",", "ReplaceTrf", ",", 
      "var3D", ",", "Reductions2D", ",", "position2D", ",", "var2D"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "the", " ", "following", " ", "list", " ", "includes", " ", "the", " ", 
      "indices", " ", "which", " ", "are", " ", "tracefree"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"idxFull", " ", "=", " ", 
      RowBox[{"IDXFull", "[", "deg", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varSym", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", "#", "]"}], "&"}], ",", "idxFull"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "replacing", " ", "the", " ", "tracefree", " ", "indices", " ", "by", 
       " ", "there", " ", "corresponding", " ", "relations"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"idxtrf2sym", " ", "=", " ", 
      RowBox[{"trf2sym", "[", 
       RowBox[{"IDXtrf", "[", "deg", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "variables", " ", "with", " ", "definitions", " ", "of", " ", "the", 
       " ", "trace", " ", "free", " ", "variables"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"varTrf", " ", "=", 
      RowBox[{"trf2sym", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"IDXtrf", "[", "deg", "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "final", " ", "variables", " ", "we", " ", "need", " ", 
       "to", " ", "consider", " ", "in", " ", "the", " ", "system"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"var3D", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"IDXtrf", "[", "deg", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"var2D", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"var3D", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "deg"}], "}"}]}], "]"}]}], "]"}], 
         "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "replacement", " ", "for", " ", "all", " ", "the", " ", "tracefree", 
       " ", "tensors"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ReplaceTrf", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "ReplaceTrf", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
         "=", 
        RowBox[{
         RowBox[{
         "varSym", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
         "\[Rule]", 
         RowBox[{
         "varTrf", "\[LeftDoubleBracket]", "ii", 
          "\[RightDoubleBracket]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "ReplaceTrf", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "indices", " ", "of", " ", "the", " ", "trace", " ", "free", " ", 
       "indices"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idxTrf", " ", "=", " ", 
      RowBox[{"IDXtrf", "[", "deg", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"positionTrf", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "locate", " ", "the", " ", "position", " ", "of", " ", "trace", " ", 
       "free", " ", "indices", " ", "in", " ", "IDXFull"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "positionTrf", "\[LeftDoubleBracket]", "ii", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "idxFull", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}], "\[Equal]", 
            RowBox[{
            "idxtrf2sym", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}]}], ",", "0", ",", "1"}], "]"}]}], 
        ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"positionTrf", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"positionTrf", ",", "0"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "develop", " ", "the", " ", "projector", " ", "component", " ", "for", 
       " ", "a", " ", "symmetric", " ", "tensor"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Projector", " ", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Projector", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "varSym", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           
           RowBox[{"SymUnitVector", "[", 
            RowBox[{
             RowBox[{
             "idxFull", "\[LeftDoubleBracket]", "jj", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "idxFull", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "1", ",", 
            RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}]}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "idxFull", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Reductions", " ", "for", " ", "2", "D"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
       RowBox[{"Reductions2D", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nz", "\[Rule]", "0"}], ",", 
          RowBox[{"tz", "\[Rule]", "0"}], ",", 
          RowBox[{"rx", "\[Rule]", "0"}], ",", 
          RowBox[{"ry", "\[Rule]", "0"}], ",", 
          RowBox[{"rz", "\[Rule]", "0"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"tx", "\[Rule]", 
            RowBox[{"-", "ny"}]}], ",", 
           RowBox[{"ty", "\[Rule]", "nx"}]}], "*)"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Projector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "2"}], ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "Projector", "\[LeftDoubleBracket]", "positionTrf", 
              "\[RightDoubleBracket]"}], "/.", "ReplaceTrf"}], "/.", 
            "transfUnitVectorInv"}], "/.", "Reductions2D"}], ",", "0"}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Projector", "\[LeftDoubleBracket]", "positionTrf", 
           "\[RightDoubleBracket]"}], "/.", "ReplaceTrf"}], "/.", 
         "transfUnitVectorInv"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Projector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "2"}], ",", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ii", "\[Equal]", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "Projector"}], "}"}]}], "]"}], ",", 
           "var2D"}], "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ii", "\[Equal]", "0"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "Projector"}], "}"}]}], "]"}], ",", 
           "var3D"}], "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "Projector"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708768127470511*^9, 3.7087681390953817`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Projector, complete moment system", "Subsection",
 CellChangeTimes->{{3.706935295350643*^9, 3.70693530286931*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GenerateProjector3D", "[", 
    RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "deg", ",", "size", ",", "numVar", ",", "locDiagonal", ",", 
       "symmetrizer", ",", "location2DVar"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "degrees", " ", "corresponding", " ", "to", " ", "different", " ", 
       "tensors"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"deg", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"iTensorDegree", "[", "ii", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "size", " ", "corresponding", " ", "to", " ", "every", " ", "tensor", 
        " ", "degree"}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
        RowBox[{
         RowBox[{"size", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"IDXtrf", "[", "jj", "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "jj"}], "}"}]}], "]"}]}], 
                 "]"}], "]"}], ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", "deg"}], "}"}]}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"size", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"IDXtrf", "[", 
              RowBox[{
              "deg", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
              "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Total", " ", "number", " ", "of", " ", "variables"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"numVar", " ", "=", " ", 
       RowBox[{"Total", "[", "size", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "location", " ", "at", " ", "the", " ", "diagonal", " ", "for", " ", 
        "the", " ", "symmetrizer"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"locDiagonal", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "size", "]"}], "+", "1"}]}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"locDiagonal", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", "1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"locDiagonal", "[", 
          RowBox[{"[", 
           RowBox[{"ii", "+", "1"}], "]"}], "]"}], "+=", 
         RowBox[{
          RowBox[{
          "locDiagonal", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "+", 
          RowBox[{
          "size", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "size", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"symmetrizer", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"numVar", ",", "numVar"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"symmetrizer", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"locDiagonal", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"locDiagonal", "\[LeftDoubleBracket]", 
                RowBox[{"ii", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
               "1"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"locDiagonal", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"locDiagonal", "\[LeftDoubleBracket]", 
                RowBox[{"ii", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
               "1"}]}], "]"}]}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"ProjectorGeneral3D", "[", 
           RowBox[{
            RowBox[{
            "deg", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ",", "dim"}], "]"}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "size", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "symmetrizer"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateInvProjector3D", "[", 
    RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "deg", ",", "size", ",", "numVar", ",", "locDiagonal", ",", 
       "symmetrizer", ",", "location2DVar"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "degrees", " ", "corresponding", " ", "to", " ", "different", " ", 
       "tensors"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"deg", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"iTensorDegree", "[", "ii", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "size", " ", "corresponding", " ", "to", " ", "every", " ", "tensor", 
        " ", "degree"}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
        RowBox[{
         RowBox[{"size", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"IDXtrf", "[", "jj", "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "jj"}], "}"}]}], "]"}]}], 
                 "]"}], "]"}], ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", "deg"}], "}"}]}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"size", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"IDXtrf", "[", 
              RowBox[{
              "deg", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
              "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Total", " ", "number", " ", "of", " ", "variables"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"numVar", " ", "=", " ", 
       RowBox[{"Total", "[", "size", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "location", " ", "at", " ", "the", " ", "diagonal", " ", "for", " ", 
        "the", " ", "symmetrizer"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"locDiagonal", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "size", "]"}], "+", "1"}]}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"locDiagonal", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", "1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"locDiagonal", "[", 
          RowBox[{"[", 
           RowBox[{"ii", "+", "1"}], "]"}], "]"}], "+=", 
         RowBox[{
          RowBox[{
          "locDiagonal", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "+", 
          RowBox[{
          "size", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "size", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"symmetrizer", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"numVar", ",", "numVar"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"symmetrizer", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"locDiagonal", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"locDiagonal", "\[LeftDoubleBracket]", 
                RowBox[{"ii", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
               "1"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"locDiagonal", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"locDiagonal", "\[LeftDoubleBracket]", 
                RowBox[{"ii", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
               "1"}]}], "]"}]}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"InvProjectorGeneral3D", "[", 
           RowBox[{
            RowBox[{
            "deg", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ",", "dim"}], "]"}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "size", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "symmetrizer"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7069353112090683`*^9, 3.706935328398961*^9}, {
  3.708921337806747*^9, 3.7089213690200367`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["n,t and r vectors", "Subsection",
 CellChangeTimes->{{3.706934754097108*^9, 3.7069347598967237`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LocalCoordinates", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "nx", ",", "ny", ",", "nz", ",", "nDott"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nx", " ", "=", " ", 
       RowBox[{"n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ny", " ", "=", " ", 
       RowBox[{"n", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nz", " ", "=", " ", 
       RowBox[{"n", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "ny"}], ",", 
         RowBox[{"nx", "-", "nz"}], ",", "ny"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nDott", " ", "=", " ", 
       RowBox[{"Chop", "[", 
        RowBox[{"t", ".", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nDott", " ", "\[NotEqual]", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Incorrect tangential direction\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       FractionBox["t", 
        RowBox[{"Norm", "[", 
         RowBox[{"t", ",", "2"}], "]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"n", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       FractionBox["r", 
        RowBox[{"Norm", "[", "r", "]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "r"}], "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReplacementList", "[", 
   RowBox[{"n_", ",", "t_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "replacement", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"replacement", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nx", "\[Rule]", 
         RowBox[{
         "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"ny", "\[Rule]", 
         RowBox[{
         "n", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"nz", "\[Rule]", 
         RowBox[{
         "n", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"tx", "\[Rule]", 
         RowBox[{
         "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"ty", "\[Rule]", 
         RowBox[{
         "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"tz", "\[Rule]", 
         RowBox[{
         "t", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"rx", "\[Rule]", 
         RowBox[{
         "r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"ry", "\[Rule]", 
         RowBox[{
         "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"rz", "\[Rule]", 
         RowBox[{
         "r", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "replacement"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.706934764128067*^9, 3.706934806531196*^9}, {
  3.706934925666273*^9, 3.706935094918432*^9}, {3.706935509166235*^9, 
  3.706935593296335*^9}, {3.706941019257159*^9, 3.706941021433728*^9}, {
  3.706978540296576*^9, 3.7069785830816*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relaxation Rates for Maxwell Molecules", "Section",
 CellChangeTimes->{{3.706950434810873*^9, 3.706950437407902*^9}, {
  3.706956692414647*^9, 3.706956696213153*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Relaxation", " ", "rates", " ", "for", " ", "different", " ", "tensors"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RelaxationRate", "[", "idx_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"deg", ",", "a", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"deg", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idx", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
       "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "\[Equal]", "2"}], " ", "&&", 
         RowBox[{"a", " ", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "1"}], " ", "&&", 
         RowBox[{"a", " ", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "0.6666666666666666"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", " ", "\[Equal]", "3"}], " ", "&&", " ", 
         RowBox[{"a", " ", "\[Equal]", " ", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1.5"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "0.6666666666666666"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", " ", "\[Equal]", " ", "2"}], "&&", 
         RowBox[{"a", " ", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1.1666666666666667"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "4"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1.8731315588479967"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", " ", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1.0"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "3"}], " ", "&&", 
         RowBox[{"a", " ", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1.5703608907702838"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "5"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", "2.182828897119992"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "0"}], "&&", 
         RowBox[{"a", "\[Equal]", "3"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", "1.0"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "2"}], "&&", 
         RowBox[{"a", "\[Equal]", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", "1.34221653446217"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "4"}], "&&", 
         RowBox[{"a", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", "1.910620894297899"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "6"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", "2.453229536334916"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "1"}], "&&", 
         RowBox[{"a", "\[Equal]", "3"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", "1.228144356308114"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "3"}], " ", "&&", " ", 
         RowBox[{"a", "\[Equal]", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", "1.667019025796873"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "5"}], "&&", 
         RowBox[{"a", "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", "2.206589244499908"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "\[Equal]", "7"}], "&&", 
         RowBox[{"a", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", "2.69640223725223"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "result"}]}],
     "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.706950440062537*^9, 3.706950461481052*^9}, {
   3.70695159924743*^9, 3.7069518606959267`*^9}, {3.706951912400951*^9, 
   3.7069520261535063`*^9}, {3.7069520657433043`*^9, 3.706952076652809*^9}, 
   3.706952285249942*^9, {3.7069538289881067`*^9, 3.706953839490399*^9}, {
   3.706954525307959*^9, 3.706954567523394*^9}, {3.706955858140421*^9, 
   3.706955877068265*^9}, {3.706955941280237*^9, 3.706955957006246*^9}, {
   3.706955990401135*^9, 3.7069559937362747`*^9}, {3.7069561015889387`*^9, 
   3.706956109019918*^9}, {3.706956147528982*^9, 3.706956148613214*^9}, {
   3.706956234289405*^9, 3.706956244455566*^9}, {3.706956285690933*^9, 
   3.706956331436042*^9}, {3.70695636836429*^9, 3.706956372509521*^9}, {
   3.7069564863924007`*^9, 3.706956574108863*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Symmetrizer ", "Section",
 CellChangeTimes->{{3.706855032010274*^9, 3.706855033699513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coeffEntropySym", "[", "a_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"Total", "[", "a", "]"}], "!"}], 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "!"}], 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "!"}], 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "!"}]}]]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Individual tensor", "Subsection",
 CellChangeTimes->{{3.706856244804042*^9, 3.7068562480301733`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Symmetrizer3D", "[", 
    RowBox[{"deg_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Entropy", ",", "varFull", ",", "varTrf", ",", "TransfTrf", ",", "var", 
       ",", "location2DVar"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"all", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varFull", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"IDXFull", "[", "deg", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"trace", " ", "free", " ", "variables"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"varTrf", " ", "=", " ", 
       RowBox[{"trf2sym", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"IDXtrf", "[", "deg", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "final", " ", "variables", " ", "which", " ", "appear", " ", "in", " ",
         "the", " ", "system"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"var", " ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "#", "]"}], "&"}], ",", " ", 
         RowBox[{"IDXtrf", "[", "deg", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"location2DVar", " ", "=", 
       RowBox[{"Flatten", "[", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "location2DVar", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}], ",", "1", ",", "0"}], "]"}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"location2DVar", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"location2DVar", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Entropy", " ", "functional", " ", "considering", " ", "the", " ", 
        "variables", " ", "to", " ", "be", " ", "symmetric"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Entropy", " ", "=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"Plus", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ii", "^", "2"}], " ", 
            RowBox[{"coeffEntropySym", "[", 
             RowBox[{
             "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "varFull"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "variable", " ", "transformations", " ", "for", " ", "trace", " ", 
        "free", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"TransfTrf", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "varFull", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
          "\[Rule]", 
          RowBox[{
          "varTrf", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
          ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "varFull", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Entropy", " ", "for", " ", "trace", " ", "free", " ", "variables"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Entropy", " ", "=", " ", 
       RowBox[{"Entropy", "/.", "TransfTrf"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "differentiate", " ", "the", " ", "entropy", " ", "functional", " ", 
        "to", " ", "obtain", " ", "the", " ", "symmetrizer"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Entropy", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"D", "[", 
           RowBox[{"Entropy", ",", 
            RowBox[{"{", 
             RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"D", "[", 
           RowBox[{"Entropy", ",", 
            RowBox[{"{", 
             RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
        RowBox[{"Entropy", "\[LeftDoubleBracket]", 
         RowBox[{"location2DVar", ",", "location2DVar"}], 
         "\[RightDoubleBracket]"}], ",", "Entropy"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.706855078173911*^9, 3.7068550974273643`*^9}, {
  3.706855180103898*^9, 3.706855233850751*^9}, {3.706855277643297*^9, 
  3.706855296763294*^9}, {3.7068553446156807`*^9, 3.706855424677989*^9}, {
  3.706855543432597*^9, 3.706855667673723*^9}, {3.706855771417171*^9, 
  3.706855976687718*^9}, {3.706857653352854*^9, 3.7068576673184032`*^9}, {
  3.706857898480301*^9, 3.706858032286787*^9}, {3.70685807810963*^9, 
  3.706858142906753*^9}, {3.7068581760381517`*^9, 3.706858176949957*^9}, {
  3.706858334355558*^9, 3.706858351347683*^9}, {3.706858509681435*^9, 
  3.706858608187498*^9}, {3.706939421672989*^9, 3.706939422118788*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check Symmetrizer 2D for individual tensors", "Subsection",
 CellChangeTimes->{{3.7068586233153687`*^9, 3.706858627423506*^9}, {
  3.706858853228948*^9, 3.7068588580168667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{"Symmetrizer", "[", "ii", "]"}], "-", 
     RowBox[{"Symmetrizer3D", "[", 
      RowBox[{"ii", ",", "2"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"2", ",", "10", ",", "1"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706858629870317*^9, 3.706858673129725*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7068586601281757`*^9, 3.706858675469696*^9}, 
   3.706876648442225*^9, 3.7069344624098577`*^9, 3.707224059083646*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Complete moment system", "Subsection",
 CellChangeTimes->{{3.7068562551209087`*^9, 3.7068562577465057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateSymmetrizer3D", "[", 
   RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "deg", ",", "size", ",", "numVar", ",", "locDiagonal", ",", 
      "symmetrizer", ",", "location2DVar"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "degrees", " ", "corresponding", " ", "to", " ", "different", " ", 
      "tensors"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"deg", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"iTensorDegree", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "size", " ", "corresponding", " ", "to", " ", "every", " ", "tensor", 
       " ", "degree"}], "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dim", " ", "\[Equal]", " ", "2"}], ",", 
       RowBox[{
        RowBox[{"size", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Pick", "[", 
             RowBox[{
              RowBox[{"IDXtrf", "[", "jj", "]"}], ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "jj"}], "}"}]}], "]"}]}], 
                "]"}], "]"}], ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "deg"}], "}"}]}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"size", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"IDXtrf", "[", 
             RowBox[{
             "deg", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Total", " ", "number", " ", "of", " ", "variables"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numVar", " ", "=", " ", 
      RowBox[{"Total", "[", "size", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "location", " ", "at", " ", "the", " ", "diagonal", " ", "for", " ", 
       "the", " ", "symmetrizer"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"locDiagonal", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "size", "]"}], "+", "1"}]}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"locDiagonal", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"locDiagonal", "[", 
         RowBox[{"[", 
          RowBox[{"ii", "+", "1"}], "]"}], "]"}], "+=", 
        RowBox[{
         RowBox[{
         "locDiagonal", "\[LeftDoubleBracket]", "ii", 
          "\[RightDoubleBracket]"}], "+", 
         RowBox[{
         "size", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "size", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"symmetrizer", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"numVar", ",", "numVar"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"symmetrizer", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"locDiagonal", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"locDiagonal", "\[LeftDoubleBracket]", 
               RowBox[{"ii", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "1"}]}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"locDiagonal", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"locDiagonal", "\[LeftDoubleBracket]", 
               RowBox[{"ii", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "1"}]}], "]"}]}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Symmetrizer3D", "[", 
          RowBox[{
           RowBox[{
           "deg", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           ",", "dim"}], "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "size", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "symmetrizer"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.706856019704764*^9, 3.706856031408064*^9}, {
  3.706856061712641*^9, 3.706856148401292*^9}, {3.706856183950777*^9, 
  3.706856233199876*^9}, {3.7068562943703136`*^9, 3.706856302312154*^9}, {
  3.706857683881324*^9, 3.706857702845892*^9}, {3.706857848466464*^9, 
  3.706857888039713*^9}, {3.706858688712628*^9, 3.706858777224873*^9}, {
  3.70685881008702*^9, 3.706858840888598*^9}, {3.706901363063386*^9, 
  3.706901410359124*^9}, {3.7069015169761343`*^9, 3.706901549742948*^9}, {
  3.706901595200667*^9, 3.7069016164301977`*^9}, {3.7069018959677267`*^9, 
  3.7069020001569633`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check symmetrizer for 2D moment systems", "Subsection",
 CellChangeTimes->{{3.7068588705103893`*^9, 3.7068588782252197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{"GenerateSymmetrizer3D", "[", 
      RowBox[{"ii", ",", "2"}], "]"}], "-", 
     RowBox[{"GenerateSymmetrizer2D", "[", "ii", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"6", ",", "14", ",", "1"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7068588799439573`*^9, 3.706858942397447*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.70685893657584*^9, 3.7068589431537037`*^9}, 
   3.706876649019505*^9, 3.7069013259948*^9, 3.706902008893119*^9, 
   3.706934467780199*^9, 3.707224059678129*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GenerateSymmetrizer3D", "[", 
  RowBox[{"6", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.706901333482893*^9, 3.70690136736084*^9}, {
  3.7069016062800694`*^9, 3.7069016063795137`*^9}, {3.706901834455853*^9, 
  3.7069018403706837`*^9}, {3.7069019709685163`*^9, 3.706901971294941*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", ",", "0", ",", "0",
      ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0",
      ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "4", ",", "0", 
     ",", "0", ",", "3", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "6", 
     ",", "0", ",", "0", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "4", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "3", ",", "0", 
     ",", "0", ",", "6", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "6", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "3", 
     ",", "0", ",", "0", ",", "0", ",", "4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1", ",", "0", ",", "0", ",", "0", ",", "4"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.706901912161413*^9, {3.706901962176346*^9, 3.7069019714329042`*^9}, 
   3.70690200370026*^9, 3.706934467849697*^9, 3.707224059718465*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Proj", "*", 
   RowBox[{"(", 
    RowBox[{"S", "^", 
     RowBox[{"-", "0.5"}]}], ")"}], " ", "and", " ", 
   RowBox[{"S", "^", "0.5"}], "*", 
   SuperscriptBox["Proj", 
    RowBox[{"-", "1"}]]}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Section",
 CellChangeTimes->{{3.70697619565606*^9, 3.706976244813696*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProjS", "[", "deg_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"result", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"ProjectorGeneral3D", "[", 
        RowBox[{"deg", ",", "3"}], "]"}], ".", 
       RowBox[{"Symmetrizer3D", "[", 
        RowBox[{"deg", ",", "2"}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProjS", "[", "deg_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"result", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"ProjectorGeneral3D", "[", 
        RowBox[{"deg", ",", "3"}], "]"}], ".", 
       RowBox[{"Symmetrizer3D", "[", 
        RowBox[{"deg", ",", "2"}], "]"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.706976248464476*^9, 3.706976307628159*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Get Matrices 3D", "Section",
 CellChangeTimes->{{3.706862984225787*^9, 3.706862989008758*^9}}],

Cell[CellGroupData[{

Cell["General Routine", "Subsection",
 CellChangeTimes->{{3.706878970863859*^9, 3.706878974292638*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetMatrices3D", "[", 
    RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "varIdx", ",", "varIdxComplete", ",", "var", ",", "Ax", ",", "Ay", ",", 
       "Az", ",", "\[IndentingNewLine]", "location2DVar", ",", "varIdxWall", 
       ",", "BCvar", ",", "varOdd", ",", "varIdxCompleteEven", ",", 
       "varIdxCompleteOdd", ",", "IntWall", ",", "IntGasEven", ",", 
       "IntGasOdd", ",", "location2DVarOdd"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varIdx", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iTraces", "[", "i", "]"}], ",", 
           RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"varIdxComplete", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                  RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"IDXtrf", "[", 
              RowBox[{"varIdx", "\[LeftDoubleBracket]", 
               RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"location2DVar", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"varIdxComplete", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"variables", " ", "for", " ", "the", " ", 
        RowBox[{"wall", ".", " ", "Density"}], " ", "and", " ", 
        RowBox[{"Temperature", ".", "The"}], " ", "velocity", " ", "has", " ",
         "been", " ", "considered", " ", "to", " ", "be", " ", "zero"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxWall", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "the", " ", "result", " ", "from", " ", "var", " ", "consists", " ", 
         "of", " ", "the", " ", "form", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"n", ",", "a", ",", "deg"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"where", " ", "a"}], " ", "=", " ", "#traces"}], ",", " ", 
        RowBox[{"deg", " ", "=", " ", 
         RowBox[{
          RowBox[{
          "#free", " ", "tensors", " ", "and", " ", "n", " ", "is", " ", 
           "the", " ", "name", " ", "for", " ", "eg", " ", "vx"}], " ", "=", 
          " ", 
          RowBox[{
           RowBox[{"1", " ", "and", " ", "vy"}], " ", "=", " ", 
           RowBox[{
           "2", " ", "or", " ", "\[Theta]", " ", "is", " ", "simply", " ", 
            "1"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "deg"}], "}"}], ",", 
             RowBox[{"trfVar3D", "[", 
              RowBox[{"deg", ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", "deg"}], "]"}], "&"}]}], "]"}]}],
             "]"}], ",", "item"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ax", "=", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "deg"}], "}"}], ",", 
                 RowBox[{"recursion1", "[", 
                  RowBox[{"a", ",", "deg", ",", "1"}], "]"}]}], "]"}], ",", 
               "item"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ay", "=", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "deg"}], "}"}], ",", 
                 RowBox[{"recursion1", "[", 
                  RowBox[{"a", ",", "deg", ",", "2"}], "]"}]}], "]"}], ",", 
               "item"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Az", "=", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "deg"}], "}"}], ",", 
                 RowBox[{"recursion1", "[", 
                  RowBox[{"a", ",", "deg", ",", "3"}], "]"}]}], "]"}], ",", 
               "item"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Picks", " ", "out", " ", "the", " ", "even", " ", "components"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxCompleteEven", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"varIdxComplete", ",", 
         RowBox[{
          RowBox[{"EvenQ", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Picks", " ", "out", " ", "the", " ", "odd", " ", "variables"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxCompleteOdd", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"varIdxComplete", ",", 
         RowBox[{
          RowBox[{"OddQ", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"location2DVarOdd", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"varIdxCompleteOdd", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BCvar", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OddQ", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ",", "1", ",", "0"}], "]"}], "&"}], ",", 
         "varIdxComplete"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"the", " ", "position", " ", "of", " ", "odd", " ", 
        RowBox[{"variables", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varOdd", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"BCvar", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Integrate", " ", "the", " ", "even", " ", "part", " ", "of", " ", 
        "the", " ", "basis", " ", "functions", " ", "with", " ", "respect", 
        " ", "to", " ", "the", " ", "odd", " ", "basis"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"IntGasEven", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"HalfIntegrate", "[", 
               RowBox[{"idx", ",", "#"}], "]"}], 
              RowBox[{"Apply", "[", 
               RowBox[{"w", ",", "#"}], "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"idx2", ",", 
              RowBox[{"{", 
               RowBox[{"idx2", ",", "varIdxCompleteEven"}], "}"}]}], "]"}]}], 
           "]"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"idx", ",", "varIdxCompleteOdd"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IntGasOdd", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"HalfIntegrate", "[", 
               RowBox[{"idx", ",", "#"}], "]"}], 
              RowBox[{"Apply", "[", 
               RowBox[{"w", ",", "#"}], "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"idx2", ",", 
              RowBox[{"{", 
               RowBox[{"idx2", ",", "varIdxCompleteOdd"}], "}"}]}], "]"}]}], 
           "]"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"idx", ",", "varIdxCompleteOdd"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IntWall", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"HalfIntegrate", "[", 
               RowBox[{"idx", ",", "#"}], "]"}], 
              RowBox[{"Apply", "[", 
               RowBox[{
                SubscriptBox["w", "wall"], ",", "#"}], "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"idx2", ",", 
              RowBox[{"{", 
               RowBox[{"idx2", ",", "varIdxWall"}], "}"}]}], "]"}]}], "]"}], 
          "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"idx", ",", "varIdxCompleteOdd"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", " ", "\[Equal]", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Ax", "\[LeftDoubleBracket]", 
           RowBox[{"location2DVar", ",", "location2DVar"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Ay", "\[LeftDoubleBracket]", 
           RowBox[{"location2DVar", ",", "location2DVar"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Az", "\[LeftDoubleBracket]", 
           RowBox[{"location2DVar", ",", "location2DVar"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"IntGasOdd", "-", "IntGasEven", "+", "IntWall"}], "]"}], 
           "\[LeftDoubleBracket]", "location2DVarOdd", 
           "\[RightDoubleBracket]"}], ",", "varIdxComplete", ",", "varOdd"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ax", ",", "Ay", ",", "Az", ",", 
          RowBox[{"Expand", "[", 
           RowBox[{"IntGasOdd", "-", "IntGasEven", "+", "IntWall"}], "]"}], 
          ",", "varIdxComplete", ",", "varOdd"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.70686300067988*^9, 3.70686305298323*^9}, 
   3.706863100942678*^9, {3.70686313922329*^9, 3.706863191306183*^9}, {
   3.706875356050213*^9, 3.706875406323625*^9}, {3.706875598740552*^9, 
   3.706875598842598*^9}, {3.706876413031699*^9, 3.7068764293213873`*^9}, {
   3.706876482859963*^9, 3.706876517043075*^9}, {3.7068767480316353`*^9, 
   3.706876751466771*^9}, {3.706876969927178*^9, 3.70687713747468*^9}, {
   3.706877178265107*^9, 3.706877358097227*^9}, {3.706877539697266*^9, 
   3.706877649588025*^9}, {3.706878133086423*^9, 3.70687813355345*^9}, {
   3.706878367767593*^9, 3.706878372885964*^9}, {3.706878420244791*^9, 
   3.706878420706822*^9}, {3.706878456433509*^9, 3.706878478989753*^9}, {
   3.7068786259930773`*^9, 3.706878662420086*^9}, {3.706898663911419*^9, 
   3.706898716000956*^9}, {3.706899883159359*^9, 3.706899894335806*^9}, {
   3.70690056872078*^9, 3.7069005812569113`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary Matrices", "Section",
 CellChangeTimes->{{3.706878683704298*^9, 3.706878687741251*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Develop", " ", "Boundary", " ", "Conditions", " ", "in", " ", "the", " ",
      "form", " ", "of", " ", "BU"}], " ", "=", " ", "g"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DevelopBC", "[", 
     RowBox[{"data_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqn\[Rho]W", ",", "transform\[Rho]W"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqn\[Rho]W", "=", 
        RowBox[{
         RowBox[{
         "data", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
           "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"transform\[Rho]W", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"eqn\[Rho]W", "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["w", "wall"], "[", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}], "}"}]}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"data", "/.", "transform\[Rho]W"}], ",", "var"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.706878744962336*^9, 3.7068788211884203`*^9}, {
   3.706878857784356*^9, 3.706878866604755*^9}, {3.706878897303796*^9, 
   3.706878942039587*^9}, 3.706879009618318*^9, {3.70689781418995*^9, 
   3.706897962310277*^9}, {3.70689813874965*^9, 3.706898144252046*^9}, {
   3.7068981791648912`*^9, 3.706898194628915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Prepare", " ", "boundary", " ", "conditions", " ", "for", " ", "the", " ",
     "inflow"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DevelopBCInflow", "[", 
     RowBox[{"data_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqn\[Rho]W", ",", "transform\[Rho]W"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"data", ",", "var"}], "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.706897986582156*^9, 3.706897996749668*^9}, {
  3.7068980328002567`*^9, 3.7068980692880993`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Distribution function", "Section",
 CellChangeTimes->{{3.7086947519262047`*^9, 3.708694754486557*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f0", "=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], 
      FractionBox["3", "2"]]], 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Cx", "2"], "+", 
         SuperscriptBox["Cy", "2"], "+", 
         SuperscriptBox["Cz", "2"]}], ")"}]}], "2"], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffSym", "[", "a_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"a", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], "!"}], 
    RowBox[{
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "!"}], 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      "!"}], 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
      "!"}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7088354400274487`*^9, 3.7088354402285223`*^9}}],

Cell[CellGroupData[{

Cell["Radial Part", "Subsection",
 CellChangeTimes->{{3.708694763525173*^9, 3.708694765308877*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Laguerre", "[", 
     RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"n", "/", "2"}]], 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"n", "+", 
          FractionBox["3", "2"]}], "]"}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"n", "+", "s", "+", 
          FractionBox["3", "2"]}], "]"}]}], 
       RowBox[{
        RowBox[{"n", "!"}], 
        RowBox[{"s", "!"}]}]]], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "p"], 
         RowBox[{"Gamma", "[", 
          RowBox[{"(", 
           RowBox[{"n", "+", "p", "+", 
            FractionBox["3", "2"]}], ")"}], "]"}]], 
        RowBox[{"Binomial", "[", 
         RowBox[{"s", ",", "p"}], "]"}], 
        SuperscriptBox["x", 
         RowBox[{"(", 
          RowBox[{"p", "+", 
           FractionBox["n", "2"]}], ")"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sonine", "[", 
     RowBox[{"s_", ",", "n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"s", "!"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "s"}], ")"}], "!"}]}]], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "p"], 
         RowBox[{
          RowBox[{"p", "!"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"s", "-", "p"}], ")"}], "!"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "+", "n"}], ")"}], "!"}]}]], 
        SuperscriptBox["x", "p"]}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Quasi", " ", "Sonine", " ", "polynomial", " ", "taken", " ", "from", " ", 
    
    RowBox[{"Manuel", "'"}], "s", " ", "paper", " ", "on", " ", "explicit", 
    " ", "fluxes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QuasiSonine", "[", 
    RowBox[{"n_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}], ")"}], "!!"}], 
       RowBox[{"2", 
        RowBox[{"n", "!"}]}]], 
      SqrtBox["\[Pi]"]}]], 
    RowBox[{"Sonine", "[", 
     RowBox[{"s", ",", 
      RowBox[{"n", "+", 
       RowBox[{"1", "/", "2"}]}], ",", 
      FractionBox[
       RowBox[{
        SuperscriptBox["Cx", "2"], "+", 
        SuperscriptBox["Cy", "2"], "+", 
        SuperscriptBox["Cz", "2"]}], "2"]}], "]"}], 
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       SqrtBox["2"], ")"}], "n"]]}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Angular Part", "Subsection",
 CellChangeTimes->{{3.708694789588792*^9, 3.708694791534696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TraceFreeCoord", "[", "idx_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nx", "=", 
        RowBox[{
        "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"ny", "=", 
        RowBox[{
        "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"nz", "=", 
        RowBox[{
        "idx", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"n", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"idx", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Expand", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "n"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "n"}], "-", "1"}], ")"}], "!!"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}]], ")"}], 
        RowBox[{"n", "+", "1"}]], 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             FractionBox["1", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["Cx", "2"], "+", 
                SuperscriptBox["Cy", "2"], "+", 
                SuperscriptBox["Cz", "2"]}]]], ",", 
             RowBox[{"{", 
              RowBox[{"Cx", ",", "nx"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Cy", ",", "ny"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cz", ",", "nz"}], "}"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708698717263309*^9, 3.7086987341472807`*^9}, 
   3.7086991458306313`*^9, 3.708699177958251*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Psi", "Subsection",
 CellChangeTimes->{{3.7032356706983833`*^9, 3.703235671042835*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", "idx_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "s", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "number", " ", "of", " ", "traces", " ", "in", " ", "the", 
      " ", "tensor"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"The", " ", "total", " ", "tensorial", " ", "degree"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"idx", "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"Laguerre", "[", 
        RowBox[{"n", ",", "s", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Cx", "2"], "+", 
            SuperscriptBox["Cy", "2"], "+", 
            SuperscriptBox["Cz", "2"]}], ")"}], 
          RowBox[{"2", "\[Theta]0"}]]}], "]"}], "*", 
       RowBox[{"TraceFreeCoord", "[", "idx", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.702874818878413*^9, 3.702874918692904*^9}, {
   3.702875502560156*^9, 3.702875508662217*^9}, 3.702880303790532*^9, {
   3.70288216411967*^9, 3.702882165537266*^9}, {3.7032353145143347`*^9, 
   3.703235325496441*^9}, {3.708668941479587*^9, 3.70866896067179*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Distribution function in local coordinates", "Subsection",
 CellChangeTimes->{{3.708835206917625*^9, 3.7088352157976294`*^9}}],

Cell[CellGroupData[{

Cell["Symmetrizer matrix for full product of two tensors", "Subsubsection",
 CellChangeTimes->{{3.7088352552995033`*^9, 3.708835262466633*^9}, {
  3.708837684896616*^9, 3.708837685499774*^9}, {3.708840224910203*^9, 
  3.708840233636722*^9}, {3.708862384960622*^9, 3.708862396118363*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "A", " ", "matrix", " ", "which", " ", "performs", " ", "a", " ", "full", 
    " ", "dot", " ", "product", " ", "between", " ", "two", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullDotTrf", "[", 
    RowBox[{"n_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tensor1", ",", "Tensor2", ",", "Symmetrizer", ",", "DotProd", ",", 
       "idxTrf", ",", "idxTrf2D"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "we", " ", "do", " ", "not", " ", "want", " ", "to", " ", "emply", " ", 
       "the", " ", "trace", " ", "free", " ", "property", " ", "of", " ", 
       "the", " ", "second", " ", "tensor"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tensor1", " ", "=", " ", 
       RowBox[{"trf2sym", "[", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Alpha]", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"IDXtrf", "[", "n", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tensor2", " ", "=", " ", 
       RowBox[{"trf2sym", "[", 
        RowBox[{"Map", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"IDXtrf", "[", "n", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Extract", " ", "the", " ", "position", " ", "of", " ", "2", "D", " ", 
        "elements"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"idxTrf", " ", "=", " ", 
       RowBox[{"IDXtrf", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idxTrf2D", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"idxTrf", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", "0"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "coefficients", " ", "for", " ", "a", " ", "symmetric", " ", 
        "tensor"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Symmetrizer", " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"coeffSym", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "ii"}], "}"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"IDXFull", "[", "n", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DotProd", " ", "=", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{"Tensor1", ".", "Symmetrizer", ".", "Tensor2"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "we", " ", "now", " ", "take", " ", "the", " ", "derivative", " ", 
        "to", " ", "obtain", " ", "the", " ", "matrix", " ", "in", " ", "the",
         " ", "quadratic", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "3"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"DotProd", ",", 
            RowBox[{"{", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Alpha]", "[", "#", "]"}], "&"}], ",", "idxTrf"}], 
              "]"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Beta]", "[", "#", "]"}], "&"}], ",", "idxTrf"}], 
            "]"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"DotProd", ",", 
             RowBox[{"{", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Alpha]", "[", "#", "]"}], "&"}], ",", "idxTrf"}], 
               "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Map", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Beta]", "[", "#", "]"}], "&"}], ",", "idxTrf"}], 
             "]"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"idxTrf2D", ",", "idxTrf2D"}], "\[RightDoubleBracket]"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.708835218124036*^9, 3.708835362026863*^9}, 
   3.708835402219426*^9, {3.7088354525420647`*^9, 3.7088355211004972`*^9}, {
   3.708835594216723*^9, 3.708835627619499*^9}, {3.708835704283455*^9, 
   3.7088357468104153`*^9}, {3.708835779845181*^9, 3.708835842909181*^9}, {
   3.708835920361188*^9, 3.708835936088521*^9}, {3.7088370319159393`*^9, 
   3.7088370727863083`*^9}, 3.7088377507600327`*^9, {3.708837859759284*^9, 
   3.7088380366787643`*^9}, 3.708838116669424*^9, {3.708838156180294*^9, 
   3.708838173080216*^9}, {3.708838300561623*^9, 3.708838386492893*^9}, {
   3.708840241807075*^9, 3.7088402787733183`*^9}, {3.708840318762477*^9, 
   3.7088403501519413`*^9}, {3.708840469057729*^9, 3.7088407193471403`*^9}, {
   3.708840795370263*^9, 3.708840832433505*^9}, {3.708841326602363*^9, 
   3.708841328812459*^9}, {3.708862445085904*^9, 3.708862452709483*^9}, {
   3.708862567368444*^9, 3.708862597923148*^9}, {3.708862668239909*^9, 
   3.7088629302602587`*^9}, {3.708863026363553*^9, 3.708863065488894*^9}, {
   3.708863101687161*^9, 3.70886310797208*^9}, {3.708863198582549*^9, 
   3.708863214324785*^9}, {3.708868324124078*^9, 3.708868437560453*^9}, {
   3.708868750603426*^9, 3.708868828373252*^9}, {3.708868904483021*^9, 
   3.708868928883931*^9}, 3.7088690600895977`*^9, {3.708869817815926*^9, 
   3.7088699875513372`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["The Symmetry of the Projector", "Subsubsection",
 CellChangeTimes->{{3.708869068014484*^9, 3.708869079459426*^9}, 
   3.70886913244812*^9, {3.708869213431917*^9, 3.7088692136815577`*^9}, {
   3.708870316354588*^9, 3.7088703245174093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckProjSym", "[", 
   RowBox[{"degree_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tVec", ",", "rVec", ",", "Proj", ",", "Sym", ",", "nVec"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nVec", " ", "=", " ", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "dim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", "\[Equal]", "2"}], ",", 
          RowBox[{"nVec", " ", "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"nVec", ",", "0"}], "}"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nVec", " ", "=", 
         RowBox[{"nVec", " ", "/", 
          RowBox[{"Norm", "[", "nVec", "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"tVec", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
               "nVec", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
              "nVec", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "0"}], "}"}]}], ";", 
           RowBox[{"rVec", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tVec", ",", "rVec"}], "}"}], "=", 
           RowBox[{"LocalCoordinates", "[", "nVec", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Proj", " ", "=", " ", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"ProjectorGeneral3D", "[", 
            RowBox[{"degree", ",", "dim"}], "]"}], "]"}], "/.", 
          RowBox[{"ReplacementList", "[", 
           RowBox[{"nVec", ",", "tVec", ",", "rVec"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Sym", " ", "=", " ", 
         RowBox[{"FullDotTrf", "[", 
          RowBox[{"degree", ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Norm of the Difference\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Chop", "[", 
          RowBox[{"Norm", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "Proj", "]"}], ".", "Sym", ".", 
              "Proj"}], "-", "Sym"}], "]"}], "]"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Chop", "[", 
            RowBox[{"Norm", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "Proj", "]"}], ".", "Sym", ".", 
                "Proj"}], "-", "Sym"}], "]"}], "]"}], "]"}], "\[Equal]", 
           "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Good Bird\>\"", ",", 
             RowBox[{"FontColor", "\[Rule]", "Cyan"}]}], "]"}], "]"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Bad Bird\>\"", ",", 
             RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}]}], "]"}],
         ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "3"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708869084306397*^9, 3.708869155696786*^9}, {
  3.70886922344641*^9, 3.7088693530971203`*^9}, {3.708869458894589*^9, 
  3.708869667255733*^9}, {3.708869998783445*^9, 3.70887002592622*^9}, {
  3.708870775586784*^9, 3.7088708033733463`*^9}, {3.708870840679899*^9, 
  3.708870984863652*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CheckProjSym", "[", 
  RowBox[{"6", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.708870011765119*^9, 3.7088700319220657`*^9}, {
  3.708871008029249*^9, 3.708871012014708*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Norm of the Difference\"\>"], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.708871012958104*^9}}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.708871012972988*^9}}],

Cell[BoxData[
 StyleBox["\<\"Good Bird\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 1]]], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.708871012987001*^9}}],

Cell[BoxData["\<\"Norm of the Difference\"\>"], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.7088710137047167`*^9}}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.708871013716963*^9}}],

Cell[BoxData[
 StyleBox["\<\"Good Bird\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 1]]], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.708871013729743*^9}}],

Cell[BoxData["\<\"Norm of the Difference\"\>"], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.7088710144554043`*^9}}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.70887101446776*^9}}],

Cell[BoxData[
 StyleBox["\<\"Good Bird\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 1]]], "Print",
 CellChangeTimes->{{3.7088700188705587`*^9, 3.708870032156741*^9}, {
   3.708870821340145*^9, 3.7088708701198606`*^9}, 3.7088709053846273`*^9, {
   3.708871000918631*^9, 3.7088710144807158`*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetic Fluxes with spherical Harmonics", "Section",
 CellChangeTimes->{{3.708672165598906*^9, 3.708672173410204*^9}}],

Cell[CellGroupData[{

Cell["Half Integrals which vary with directions", "Subsection",
 CellChangeTimes->{{3.7087796285414133`*^9, 3.7087796353812847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "following", " ", "are", " ", "the", " ", "routines", " ", "for", " ", 
    "half", " ", "integrals", " ", "of", " ", "spherical", " ", "harmonics", 
    " ", "where", " ", "one", " ", "change", " ", "the", " ", "direction", 
    " ", "which", " ", "should", " ", "be", " ", "kept", " ", 
    RowBox[{"positive", ".", " ", "Dim"}], " ", "is", " ", "the", " ", 
    "direction", " ", "which", " ", "we", " ", "want", " ", "to", " ", "be", 
    " ", "positive"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNzdim1", "[", 
     RowBox[{"ex_", ",", "dim_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2", ",", "pos3", ",", 
        RowBox[{"mm", "=", "0"}], ",", 
        RowBox[{"nn", "=", "0"}], ",", 
        RowBox[{"pp", "=", "0"}], ",", "res", ",", 
        RowBox[{"res1", "=", 
         RowBox[{"\[Nu]x", " ", "\[Nu]y", " ", "\[Nu]z", " ", "ex"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos1", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]x", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos2", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]y", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos3", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]z", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], ">", "0"}], ",", 
         RowBox[{"mm", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], ">", "0"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos2", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], ">", "0"}], ",", 
         RowBox[{"pp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos3", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{"res1", ",", 
           RowBox[{"Join", "[", 
            RowBox[{"pos1", ",", "pos2", ",", "pos3"}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dim", "\[Equal]", "1"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OddQ", "[", "nn", "]"}], "||", 
              RowBox[{"OddQ", "[", "pp", "]"}]}], ",", "0", ",", 
             RowBox[{"2", "\[Pi]", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"nn", "-", "1"}], ")"}], "!!"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"mm", "-", "1"}], ")"}], "!!"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pp", "-", "1"}], ")"}], "!!"}]}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "+", "mm", "+", "pp", "+", "1"}], ")"}], 
                "!!"}]]}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OddQ", "[", "mm", "]"}], "||", 
              RowBox[{"OddQ", "[", "pp", "]"}]}], ",", "0", ",", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "mm"], "2", "\[Pi]", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"nn", "-", "1"}], ")"}], "!!"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"mm", "-", "1"}], ")"}], "!!"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pp", "-", "1"}], ")"}], "!!"}]}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "+", "mm", "+", "pp", "+", "1"}], ")"}], 
                "!!"}]]}]}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]x"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]y"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]z"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "applies", " ", "integrate", " ", "halfnxnynz1", " ", "to", " ", "a", " ",
      "long", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNzdim", "[", 
     RowBox[{"ex_", ",", "dim_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "ex", "]"}], "===", " ", "Plus"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"IntegrateHalfNxNyNzdim1", "[", 
           RowBox[{
            RowBox[{
            "ex", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ",", "dim"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"IntegrateHalfNxNyNzdim1", "[", 
       RowBox[{"ex", ",", "dim"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfIntegratedim", "[", 
     RowBox[{"idx1_", ",", "idx2_", ",", "dim_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Int1", ",", "Int2", ",", 
        RowBox[{"deg1", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx1", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", 
        RowBox[{"deg2", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx2", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "f0"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "following", " ", "term", " ", "develops", " ", "terms", 
        " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         SubscriptBox["\[Nu]", 
          RowBox[{"<", 
           RowBox[{
            SuperscriptBox["x", "m"], 
            SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "The"}], " ", 
        "algorithm", " ", "is", " ", "as", " ", "follows", 
        "\[IndentingNewLine]", "1.", " ", "Extract", " ", "the", " ", "total",
         " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in", 
        " ", "the", " ", "tensor", "\[IndentingNewLine]", "2.", " ", 
        "Develop", " ", "the", " ", "full", " ", "sym", " ", "trace", " ", 
        "free", " ", "tensor", " ", 
        RowBox[{"i", ".", "e"}], " ", "develop", " ", "all", " ", "the", " ", 
        "components", " ", "of", " ", 
        SubscriptBox["\[Nu]", 
         RowBox[{"<", 
          RowBox[{
           SubscriptBox["i", 
            RowBox[{"1", "..."}]], 
           SubscriptBox["i", "n"]}], ">"}]], "\[IndentingNewLine]", "3.", " ",
         "Extract", " ", "the", " ", "component", " ", "corresponding", " ", 
        "to", " ", 
        RowBox[{"idx1", ".", "\[IndentingNewLine]", "4."}], " ", "The", " ", 
        "Routine", " ", "SymTraceFree", " ", "converts", " ", "a", " ", 
        "symmetric", " ", "tensor", " ", "to", " ", "trace", " ", "free"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Int1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"SymTracefree", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Nu]x", "#1"], 
                  SuperscriptBox["\[Nu]y", "#2"], 
                  SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
              "&"}], ",", 
             RowBox[{"IDX", "[", "deg1", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"toIDX2", "[", 
           RowBox[{"idx1", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
            "\[RightDoubleBracket]"}], "]"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "Let", " ", "us", " ", "consider", " ", "the", " ", "part", " ",
                "of", " ", "the", " ", "distribution", " ", "function", " ", 
               "which", " ", "comes", " ", "from", " ", 
               RowBox[{"Rij", ".", " ", "This"}], " ", "part", " ", "will", 
               " ", "be", " ", "of", " ", "the", " ", "form", " ", "Rxx"}], 
              "..."}], "+", "Rzz"}], "..."}], ".", " ", "But"}], " ", "Rzz"}],
          " ", "=", " ", 
         RowBox[{
          RowBox[{"-", "Rxx"}], "-", 
          RowBox[{
          "Ryy", " ", "and", " ", "therefore", " ", "Int2", " ", "is", " ", 
           "not", " ", "simply", " ", "the", " ", "tensorised", " ", 
           RowBox[{
            SubscriptBox["\[Nu]", 
             RowBox[{"<", 
              RowBox[{
               SuperscriptBox["x", "m"], 
               SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "A"}], " ", 
           "part", " ", "of", " ", "the", " ", "following", " ", "routines", 
           " ", "takes", " ", "care", " ", "of", " ", "the", " ", "trace", 
           " ", "free", " ", "natrue", " ", "of", " ", "the", " ", 
           RowBox[{"tensors", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Int2", "=", 
        RowBox[{"SymFullDot", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Nu]x", "#1"], 
                 SuperscriptBox["\[Nu]y", "#2"], 
                 SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"IDX", "[", "deg2", "]"}]}], "]"}], ",", 
          RowBox[{"trf2sym", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "\[Equal]", 
                    RowBox[{"idx2", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], ",", "1", ",", "0"}], "]"}], 
                 "&"}], ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"IDXtrf", "[", "deg2", "]"}]}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"f0", "=", " ", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Pi]"}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"mixed2", "[", 
          RowBox[{
           RowBox[{
           "idx1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg1", ",", 
           RowBox[{
           "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg2"}], "]"}], "f0", " ", 
         RowBox[{"IntegrateHalfNxNyNzdim", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"Int1", " ", "Int2"}], "]"}], ",", "dim"}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.708779658872768*^9, 3.7087796812083387`*^9}, {
  3.708779739596031*^9, 3.708779808783887*^9}, {3.708779839927189*^9, 
  3.708779893522808*^9}, {3.708781310682704*^9, 3.7087813161116447`*^9}, {
  3.708781799735463*^9, 3.708781834678666*^9}, {3.7087818798044*^9, 
  3.708781939386437*^9}, {3.708784159749436*^9, 3.7087841660595293`*^9}, {
  3.708784210317135*^9, 3.708784223930094*^9}, {3.708784325588299*^9, 
  3.70878432569048*^9}, {3.708926664929566*^9, 3.7089266725517263`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Trace free part of a symmetric tensor", "Subsection",
 CellChangeTimes->{{3.708698584866458*^9, 3.708698602339699*^9}, {
  3.7087009996330347`*^9, 3.708701003321566*^9}, {3.708713711873979*^9, 
  3.70871372281115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Computes", " ", "the", " ", "trace", " ", "free", " ", "velocity", " ", 
    RowBox[{"vector", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TraceFreeVelocity", "[", "idx_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nx", "=", 
         RowBox[{
         "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"ny", "=", 
         RowBox[{
         "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"nz", "=", 
         RowBox[{
         "idx", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx", "\[LeftDoubleBracket]", 
           RowBox[{"2", ";;", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Expand", "[", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "n"], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "-", "1"}], ")"}], "!!"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["Cx", "2"], "+", 
            SuperscriptBox["Cy", "2"], "+", 
            SuperscriptBox["Cz", "2"]}]], ")"}], 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}]], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              FractionBox["1", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["Cx", "2"], "+", 
                 SuperscriptBox["Cy", "2"], "+", 
                 SuperscriptBox["Cz", "2"]}]]], ",", 
              RowBox[{"{", 
               RowBox[{"Cx", ",", "nx"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Cy", ",", "ny"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Cz", ",", "nz"}], "}"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7086992658114*^9, 3.7086993031092367`*^9}, {
  3.708713071925295*^9, 3.708713073320601*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Given", " ", "the", " ", "idx", " ", "of", " ", "a", " ", "symmetric"}], 
    ",", " ", 
    RowBox[{
    "return", " ", "the", " ", "idx", " ", "which", " ", "appears", " ", "in",
      " ", "the", " ", "trace", " ", "free", " ", "version"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ReturnTraceFree", "[", "idx_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "traceFreeVelocity", ",", "polyVelocity", ",", "n", ",", "s", ",", 
       "coeffs", ",", "SymmIndices", ",", "tempCoeffs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "total", " ", "number", " ", "of", " ", "free", " ", "degrees"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idx", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Total", " ", "number", " ", "of", " ", "traces"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{
       "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "indices", " ", "corresponding", " ", "to", " ", "the", 
        " ", "symmetric", " ", "indices"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SymmIndices", " ", "=", " ", 
       RowBox[{"IDXFull", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "SymmIndices", "\[LeftDoubleBracket]", "ii", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{
            "SymmIndices", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "SymmIndices", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"traceFreeVelocity", " ", "=", " ", 
       RowBox[{"TraceFreeVelocity", "[", "idx", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "different", " ", "polynomials", " ", "of", " ", 
        "velocity", " ", "which", " ", "can", " ", "be", " ", "present", " ", 
        "in", " ", "traceFreeVelocity"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"polyVelocity", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Cx", 
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
          SuperscriptBox["Cy", 
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]], 
          SuperscriptBox["Cz", 
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "SymmIndices"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"coeffs", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"traceFreeVelocity", ",", "ii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "polyVelocity"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "coeffs", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "SymmIndices", "\[LeftDoubleBracket]", "ii", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "[", "coeffs", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tempCoeffs", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[NotEqual]", "0"}], ",", 
          RowBox[{"tempCoeffs", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"tempCoeffs", ",", "ii", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "coeffs"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "tempCoeffs"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7086986037732162`*^9, 3.708698631429556*^9}, {
   3.708699192898144*^9, 3.708699248222189*^9}, {3.708699308228738*^9, 
   3.708699318793087*^9}, {3.7086994918352623`*^9, 3.7086996230264997`*^9}, {
   3.708699659230076*^9, 3.708699678887896*^9}, {3.708699888323744*^9, 
   3.7086999587018547`*^9}, {3.708700001641308*^9, 3.708700010800809*^9}, {
   3.708700990867465*^9, 3.708700993228119*^9}, {3.708701065807876*^9, 
   3.7087011014644403`*^9}, {3.708701135398322*^9, 3.708701146285757*^9}, {
   3.708708138967231*^9, 3.708708208313118*^9}, {3.7087127142675743`*^9, 
   3.708712715216899*^9}, {3.708713038404811*^9, 3.7087130638766003`*^9}, 
   3.708937787685321*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Routines", "Subsection",
 CellChangeTimes->{{3.708672188830401*^9, 3.7086722007841578`*^9}, {
  3.708761645231573*^9, 3.7087616480785017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coeffSym", "[", "a_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"a", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}], "!"}], 
    RowBox[{
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "!"}], 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      "!"}], 
     RowBox[{
      RowBox[{"a", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
      "!"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.708761653175378*^9, 3.708761678369297*^9}, {
  3.708766170888441*^9, 3.708766177622995*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CreateReplacement", "[", "indexList_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<i\>\"", ",", 
             RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "indexList", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "list", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
          "\[Rule]", 
          RowBox[{
          "indexList", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "particular", " ", "idx"}], ",", " ", 
     RowBox[{
     "the", " ", "following", " ", "routine", " ", "returns", " ", "the", " ",
       "list", " ", "of", " ", "indices", " ", "for", " ", "a", " ", 
      "symmetric", " ", "tensor"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IdxToIndex", "[", "idx_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "indexList", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "we", " ", "first", " ", "convert", " ", "idx", " ", "into", " ", "an",
         " ", "index", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indexList", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"2", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"3", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "indexList"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Given", " ", "an", " ", "index", " ", "find", " ", "the", " ", "idx", 
     " ", "corresponding", " ", "to", " ", "that", " ", 
     RowBox[{"index", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndexToIdx", "[", "index_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "idx", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"idx", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"index", ",", "1"}], "]"}], ",", 
         RowBox[{"Count", "[", 
          RowBox[{"index", ",", "2"}], "]"}], ",", 
         RowBox[{"Count", "[", 
          RowBox[{"index", ",", "3"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndexNames", "[", "list_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<i\>\"", ",", 
             RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "list"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Given", " ", "the", " ", "degree"}], ",", " ", 
     RowBox[{
     "the", " ", "following", " ", "operation", " ", "creates", " ", "a", " ",
       "list", " ", "of", " ", "symmetric", " ", "indices", " ", "of", " ", 
      "tensor", " ", 
      RowBox[{"degree", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SymmetricIndex", "[", "degree_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indexNames", ",", "PermIndex"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indexNames", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<i\>\"", ",", 
             RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "degree"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PermIndex", " ", "=", " ", 
        RowBox[{"Permutations", "[", "indexNames", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"degree", "!"}]], ",", "ii"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "PermIndex"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.708341603891811*^9, 3.7083416748100357`*^9}, {
   3.708341973921307*^9, 3.708342092599224*^9}, {3.708342133432755*^9, 
   3.708342179385436*^9}, 3.708342212512907*^9, {3.708342349823142*^9, 
   3.7083423682450447`*^9}, {3.708342738184887*^9, 3.708342792586594*^9}, {
   3.708343128268573*^9, 3.708343158708784*^9}, {3.708343189541664*^9, 
   3.7083435564535513`*^9}, {3.708343588493886*^9, 3.708343614288334*^9}, {
   3.708343646309781*^9, 3.708343681150502*^9}, {3.708343719199747*^9, 
   3.708343719279415*^9}, {3.708348347176156*^9, 3.708348421499115*^9}, {
   3.7083484650133667`*^9, 3.7083485662791157`*^9}, {3.70834862320466*^9, 
   3.708348627106968*^9}, {3.708348661432066*^9, 3.7083487297168303`*^9}, {
   3.708348910536384*^9, 3.708348958275464*^9}, {3.7083492354044123`*^9, 
   3.708349330622682*^9}, {3.708429007388589*^9, 3.708429152168544*^9}, 
   3.7084323645946302`*^9, {3.7087011887582273`*^9, 3.708701267314039*^9}, {
   3.708701301038022*^9, 3.708701304863543*^9}, {3.708701355910348*^9, 
   3.708701384610087*^9}, {3.708707343276742*^9, 3.708707592329995*^9}, {
   3.708707623916692*^9, 3.708707630273877*^9}, {3.708707662176746*^9, 
   3.7087076720473967`*^9}, {3.708707738327681*^9, 3.708707761624518*^9}, 
   3.7087079353673143`*^9, {3.708708018573925*^9, 3.7087080280400877`*^9}, {
   3.708710747510324*^9, 3.708710752772935*^9}, {3.708711040909357*^9, 
   3.7087110519890413`*^9}, 3.7087120653074923`*^9, {3.708761624980558*^9, 
   3.708761625985352*^9}, {3.708940135351636*^9, 3.708940180022759*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.708927755825469*^9, 3.708927765762643*^9}, {
   3.708938018386767*^9, 3.7089380707432747`*^9}, 3.708939909386634*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "SymmetricIndexPsiDelta", "]"}]], "Input",
 CellChangeTimes->{{3.7089398897348967`*^9, 3.708939898497384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Symmetric", " ", "Index", " ", "specifically", " ", "for", " ", "the", 
    " ", "Psi", " ", "and", " ", "delta", " ", "Product"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SymmetricIndexPsiDelta", "[", "degree_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"indexNames", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indexNames", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IndexNames", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"ii", "-", "1"}]}], "]"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"ii", "+", "1"}], ",", "degree"}], "]"}]}], "}"}], 
              "]"}], "]"}], ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<i\>\"", ",", 
               RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "degree"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", "degree"], ",", "ii"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "indexNames"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.708938710855*^9, 3.708938735651478*^9}, {
  3.7089387758091307`*^9, 3.708938918229653*^9}, {3.708939630941619*^9, 
  3.708939655827104*^9}, {3.708939743179511*^9, 3.708939905675919*^9}, {
  3.708939966950016*^9, 3.708940013524364*^9}, {3.708940196010477*^9, 
  3.7089403081274652`*^9}, {3.708940344554495*^9, 3.708940438582011*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SymInd", "[", "ii", "]"}], "=", 
     RowBox[{"SymmetricIndexPsiDelta", "[", "ii", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "0", ",", "9"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.708939956528426*^9, 3.7089399573569517`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Products of the basis functions with Delta", "Subsection",
 CellChangeTimes->{{3.708700043806613*^9, 3.70870005011642*^9}, {
  3.708700658461532*^9, 3.708700658556395*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Given", " ", "a", " ", "particular", " ", "idx", " ", "for", " ", "a", 
     " ", "basis", " ", "function", " ", "\[Psi]"}], ",", " ", 
    RowBox[{"the", " ", "following", " ", "routine", " ", "computes", " ", 
     SubscriptBox["\[Psi]", 
      RowBox[{
       RowBox[{"<", 
        SubscriptBox["i", "1"]}], ".."}]], 
     SubscriptBox["\[Delta]", 
      RowBox[{
       SubscriptBox["i", "n"], ">", 
       SubscriptBox["i", 
        RowBox[{"k", ".", " "}]]}]], "It", " ", "returns", " ", "the", " ", 
     "coefficients", " ", "infront", " ", "of", " ", "the", " ", "different", 
     " ", "basis", " ", 
     RowBox[{"functions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProdPsiDelta", "[", 
    RowBox[{"idx_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trfIdx", ",", "SymmetricPsiDelta", ",", "n", ",", "temp", ",", "s"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "trfIdx", " ", "and", " ", "the", " ", "different"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trfIdx", " ", "=", " ", 
       RowBox[{"ReturnTraceFree", "[", "idx", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "tensorial", " ", "degree", " ", "of", " ", "the", " ", 
        "idx", " ", "given"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idx", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{
       "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "we", " ", "need", " ", "to", " ", "account", " ", "for", 
        " ", "the", " ", "fact", " ", "that", " ", "ProdPsiDelta", " ", "is", 
        " ", "not", " ", "a", " ", "symmetric", " ", 
        RowBox[{"tensor", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SymmetricPsiDelta", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "trfIdx", "]"}]}], "}"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "SymmetricPsiDelta", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"SymInd", "[", "n", "]"}], "/.", 
           RowBox[{"CreateReplacement", "[", 
            RowBox[{"IdxToIndex", "[", 
             RowBox[{
              RowBox[{
              "trfIdx", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "]"}], "]"}]}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "trfIdx", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "now", " ", "we", " ", "need", " ", "to", " ", "account", " ", "for", 
        " ", "the", " ", "part", " ", "which", " ", "is", " ", "coming", " ", 
        "from", " ", "the", " ", "trace", " ", "free", " ", "nature", " ", 
        "of", " ", "the", " ", 
        RowBox[{"tensors", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "SymmetricPsiDelta", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "jj", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "*=", 
            RowBox[{"trfIdx", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
              "SymmetricPsiDelta", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "SymmetricPsiDelta", "]"}]}], "}"}]}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SymmetricPsiDelta", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"SymmetricPsiDelta", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temp", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "we", " ", "convert", " ", "back", " ", "to", " ", "idx", 
        " ", "and", " ", "store", " ", "it", " ", "in", " ", "a", " ", 
        "temporary", " ", 
        RowBox[{"variable", ".", " ", "We"}], " ", "need", " ", "to", " ", 
        "remove", " ", "the", " ", "part", " ", "which", " ", "goes", " ", 
        "with", " ", "the", " ", 
        RowBox[{"delta", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", "k"}],
            ",", 
           RowBox[{"temp", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"temp", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", 
                   RowBox[{"IndexToIdx", "[", 
                    RowBox[{
                    RowBox[{
                    "ii", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"1", ";;", 
                    RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
                  "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "SymmetricPsiDelta"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "temp"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.708700051157131*^9, 3.7087000868613*^9}, {
   3.708700632506361*^9, 3.7087006478732033`*^9}, {3.7087006781482983`*^9, 
   3.708700746901997*^9}, {3.708700793399631*^9, 3.7087008275409203`*^9}, 
   3.708700863188595*^9, {3.7087082427464437`*^9, 3.708708256637671*^9}, {
   3.70870829315232*^9, 3.7087084194448*^9}, {3.708708466034006*^9, 
   3.70870848284429*^9}, {3.7087085881521387`*^9, 3.7087086030611143`*^9}, {
   3.708708636734274*^9, 3.708708693697667*^9}, {3.7087087395097837`*^9, 
   3.7087087662299013`*^9}, 3.708708814797214*^9, {3.70870884668742*^9, 
   3.708708892612969*^9}, {3.708708934116157*^9, 3.7087089360864277`*^9}, {
   3.7087102906821737`*^9, 3.708710304890304*^9}, {3.7087103374592133`*^9, 
   3.708710577356306*^9}, {3.708710619909047*^9, 3.7087106943491707`*^9}, {
   3.708710992608424*^9, 3.70871099608106*^9}, {3.708711068050454*^9, 
   3.708711072603956*^9}, {3.708711891926309*^9, 3.708711920220261*^9}, {
   3.708713172807867*^9, 3.708713200079207*^9}, {3.708713254067401*^9, 
   3.708713334101489*^9}, {3.708938255419938*^9, 3.708938258365109*^9}, {
   3.70893829279053*^9, 3.708938309398266*^9}, {3.7089384540089617`*^9, 
   3.7089385015714827`*^9}, {3.708940532119625*^9, 3.708940532272935*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Contributions from different terms", "Subsection",
 CellChangeTimes->{{3.7086722567182198`*^9, 3.70867226288457*^9}}],

Cell[CellGroupData[{

Cell["Contribution A0", "Subsubsection",
 CellChangeTimes->{{3.708673972223172*^9, 3.708673974671239*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Contribution", " ", "from", " ", "A0"}], ",", " ", 
    RowBox[{
     RowBox[{
     "see", " ", "the", " ", "notes", " ", "on", " ", "derivation", " ", "of",
       " ", "moment", " ", 
      RowBox[{"systems", ".", " ", "The"}], " ", "input", " ", "arguments", 
      " ", "are", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
      "test", " ", "functions", " ", "and", " ", "the", " ", "degree"}], " ", 
     "+", " ", 
     RowBox[{
     "traces", " ", "which", " ", "contribute", " ", "into", " ", "the", " ", 
      "distribution", " ", 
      RowBox[{"function", ".", "idxTest"}], " ", "contains", " ", "the", " ", 
      "index", " ", "of", " ", "the", " ", "test", " ", "functions", " ", 
      "and", " ", "data", " ", "Basis", " ", "is", " ", "a", " ", "2", "D", 
      " ", "array", " ", "which", " ", "contains", " ", "the", " ", 
      "tensorial", " ", "degree", " ", "and", " ", "the", " ", "number", " ", 
      "of", " ", "traces", " ", "for", " ", "a", " ", "particular", " ", 
      "basis", " ", "function"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ContributionA0", "[", 
     RowBox[{"idxTest_", ",", "idxBasis_", ",", "dim_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nTest", ",", "sTest", ",", "varIdxBasis", ",", "varIdxBasisTrf", ",", 
        "idxTemp1", ",", "idxTemp2", ",", "fac1", ",", "fac2", ",", "fac3", 
        ",", "result", ",", "coeffsSym"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "tensorial", " ", "degree", " ", "of", " ", "the", " ", 
        "test", " ", "function", " ", "and", " ", "the", " ", "corresponding",
         " ", "number", " ", "of", " ", 
        RowBox[{"traces", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nTest", " ", "=", " ", 
        RowBox[{"Total", "[", 
         RowBox[{"idxTest", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sTest", " ", "=", " ", 
        RowBox[{
        "idxTest", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"idxTemp1", " ", "=", " ", "idxTest"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"idxTemp2", " ", "=", " ", "idxTest"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Increase", " ", "the", " ", "tensorial", " ", "degree", " ", "and", 
         " ", "keep", " ", "the", " ", "s", " ", "to", " ", "be", " ", "the", 
         " ", 
         RowBox[{"same", ".", " ", "Increase"}], " ", "the", " ", "number", 
         " ", "of", " ", "x", " ", "components"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idxTemp1", "\[LeftDoubleBracket]", 
         RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}], " ", "+=", 
        "1"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "reduces", " ", "the", " ", "value", " ", "of", " ", "s", " ", "and", 
         " ", "also", " ", "increase", " ", "the", " ", "tensorial", " ", 
         "degree"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idxTemp2", "\[LeftDoubleBracket]", 
         RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}], "+=", "1"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "idxTemp2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[GreaterEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{
          "idxTemp2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "-=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "different", " ", "factors", " ", "which", " ", "appear", " ", "in", 
         " ", "the", " ", "recursion", " ", "relation"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"fac1", " ", "=", " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", "nTest"}], "+", "2"}], 
          RowBox[{
           RowBox[{"2", " ", "nTest"}], "+", "3"}]]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fac2", " ", "=", " ", 
        SqrtBox[
         RowBox[{"nTest", "+", "sTest", "+", 
          FractionBox["3", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fac3", " ", "=", " ", 
        SqrtBox["sTest"]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "2", " ", "comes", " ", "from", " ", "the", " ", "absolute", " ", 
         "value", " ", "of", " ", "the", " ", 
         RowBox[{"integral", ".", " ", "The"}], " ", "integral", " ", "is", 
         " ", "zero", " ", "if", " ", "either", " ", "the", " ", "test", " ", 
         "function", " ", "of", " ", "the", " ", "Basis", " ", "do", " ", 
         "not", " ", "belong", " ", "to", " ", "the", " ", "same", " ", 
         "class", " ", "of", " ", "natural", " ", 
         RowBox[{"numbers", ".", " ", "Since"}], " ", "the", " ", "number", 
         " ", "of", " ", "x", " ", "components", " ", "are", " ", "the", " ", 
         "same", " ", "for", " ", "idxTemp1", " ", "and", " ", "idxTemp2", 
         " ", "therefore", " ", "we", " ", "only", " ", "need", " ", "to", 
         " ", "check", " ", 
         RowBox[{"them", "."}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{
         RowBox[{"fac1", " ", "*", " ", "fac2", " ", "*", " ", 
          RowBox[{"HalfIntegratedim", "[", 
           RowBox[{"idxTemp1", ",", "idxBasis", ",", "dim"}], "]"}]}], "-", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"sTest", ">", "0"}], ",", 
           RowBox[{"fac1", "*", "fac3", " ", "*", 
            RowBox[{"HalfIntegratedim", "[", 
             RowBox[{"idxTemp2", ",", "idxBasis", ",", "dim"}], "]"}]}], ",", 
           "0"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7086722647827797`*^9, 3.7086723163301477`*^9}, {
   3.708672380422621*^9, 3.7086725823773203`*^9}, {3.708672624387116*^9, 
   3.708672701387848*^9}, {3.708672759175871*^9, 3.708672796432262*^9}, {
   3.7086728339932747`*^9, 3.708673057249508*^9}, {3.7086731040462837`*^9, 
   3.708673131205572*^9}, {3.708673425453926*^9, 3.70867350360966*^9}, {
   3.7086736354084263`*^9, 3.7086736385996857`*^9}, {3.7086738414430113`*^9, 
   3.708673942593895*^9}, {3.708673986938367*^9, 3.7086739905968122`*^9}, {
   3.708675677721231*^9, 3.708675715189749*^9}, {3.7086758399668293`*^9, 
   3.708675912142474*^9}, {3.708675953952498*^9, 3.708675968910617*^9}, {
   3.7086761440441303`*^9, 3.708676149080565*^9}, {3.708676219582633*^9, 
   3.708676300164864*^9}, {3.708676385125944*^9, 3.708676390147409*^9}, {
   3.708676514723318*^9, 3.708676524829774*^9}, {3.708676556539939*^9, 
   3.7086766866140757`*^9}, {3.708676732376041*^9, 3.708676734108411*^9}, {
   3.708694500706428*^9, 3.708694525215002*^9}, {3.7087471504463263`*^9, 
   3.708747160150509*^9}, {3.70875050378349*^9, 3.708750555991088*^9}, {
   3.708750586714157*^9, 3.708750696824338*^9}, {3.708751836078362*^9, 
   3.708751860501254*^9}, {3.7087519523199453`*^9, 3.708751957143907*^9}, {
   3.7087519903377447`*^9, 3.708751993121373*^9}, {3.708760311895859*^9, 
   3.708760319335124*^9}, 3.7087606800623283`*^9, {3.708761863626233*^9, 
   3.708761982090625*^9}, {3.708763113582334*^9, 3.708763131574482*^9}, {
   3.708779917277019*^9, 3.708779945113576*^9}, {3.7087802474112988`*^9, 
   3.708780268750615*^9}, {3.708783565796268*^9, 3.708783568755782*^9}, {
   3.7087844241274357`*^9, 3.708784425524172*^9}, {3.708786780138233*^9, 
   3.70878686903642*^9}, {3.7087869093982763`*^9, 3.708786918267538*^9}, {
   3.708786975395793*^9, 3.708786988539361*^9}, {3.708787055483593*^9, 
   3.708787057264452*^9}, {3.7087873758380547`*^9, 3.70878743488148*^9}, {
   3.708927037336691*^9, 3.708927045269558*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Contribution from A1", "Subsubsection",
 CellChangeTimes->{{3.708673999961767*^9, 3.708674004331999*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Contribution", " ", "from", " ", "A1"}], ",", " ", 
    RowBox[{"see", " ", "the", " ", 
     RowBox[{"notes", ".", " ", "The"}], " ", "following", " ", 
     "contribution", " ", "contains", " ", "the", " ", "contribution", " ", 
     "from", " ", "the", " ", "delta", " ", 
     RowBox[{"tensor", ".", " ", "dim"}], " ", "is", " ", "the", " ", 
     "component", " ", "of", " ", "the", " ", "velocity"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContributionA1", "[", 
    RowBox[{"idxTest_", ",", "idxBasis_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nTest", ",", "sTest", ",", "idxTemp1", ",", "fac1", ",", "fac2", ",", 
       "fac3", ",", "phiDelta1", ",", "phiDelta2", ",", "Integral1", ",", 
       "Integral2", ",", "result", ",", "coeffsSym", ",", "time1", ",", 
       "time2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "the", " ", "tensorial", " ", "degree", " ", "of", " ", "the", " ", 
       "test", " ", "function", " ", "and", " ", "the", " ", "corresponding", 
       " ", "number", " ", "of", " ", 
       RowBox[{"traces", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nTest", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idxTest", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sTest", " ", "=", " ", 
       RowBox[{
       "idxTest", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"idxTemp1", " ", "=", " ", "idxTest"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Increase", " ", "the", " ", "value", " ", "of", " ", "\"\<s\>\"", " ",
         "and", " ", "keep", " ", "everything", " ", "the", " ", 
        RowBox[{"same", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "idxTemp1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       " ", "+=", "1"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fac1", " ", "=", " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"2", " ", "nTest"}], 
         RowBox[{
          RowBox[{"2", "nTest"}], "+", "1"}]]]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fac2", " ", "=", " ", 
       SqrtBox[
        RowBox[{"nTest", "+", "sTest", "+", 
         FractionBox["1", "2"]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fac3", " ", "=", " ", 
       SqrtBox[
        RowBox[{"sTest", "+", "1"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"The", " ", "trace", " ", "of", " ", "phi", " ", "*", " ", 
        RowBox[{"Delta", ".", " ", "The"}], " ", "test", " ", "function", " ",
         "*", " ", "Delta"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"time1", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{
         RowBox[{"phiDelta1", " ", "=", " ", 
          RowBox[{"ProdPsiDelta", "[", 
           RowBox[{"idxTest", ",", "dim"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Second", " ", "contribution", " ", "from", " ", "\[Psi]"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"phiDelta2", " ", "=", " ", 
          RowBox[{"ProdPsiDelta", "[", 
           RowBox[{"idxTemp1", ",", "dim"}], "]"}]}], ";"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Integral", " ", "from", " ", "the", " ", "first", " ", "phi", " ", 
        "Delta", " ", "product"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"time2", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{
         RowBox[{"Integral1", " ", "=", 
          RowBox[{"fac1", "*", "fac2", "*", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "jj", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              RowBox[{"HalfIntegratedim", "[", 
               RowBox[{
                RowBox[{
                "jj", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", "idxBasis", ",", "dim"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "phiDelta1"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Integral2", " ", "=", " ", 
          RowBox[{"fac1", "*", "fac3", "*", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "jj", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              RowBox[{"HalfIntegratedim", "[", 
               RowBox[{
                RowBox[{
                "jj", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", "idxBasis", ",", "dim"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "phiDelta2"}], "}"}]}], "]"}]}]}], ";"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Integral1", "-", "Integral2"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7086740203906097`*^9, 3.708674036977275*^9}, {
   3.708674078091181*^9, 3.708674109893599*^9}, {3.708674159427196*^9, 
   3.708674252990252*^9}, {3.708674379486662*^9, 3.708674453932214*^9}, {
   3.708674518281172*^9, 3.7086746383809023`*^9}, 3.708674754859185*^9, {
   3.7086747988059*^9, 3.708674960014612*^9}, {3.7086808699475613`*^9, 
   3.7086808732708607`*^9}, {3.708680940147476*^9, 3.708680944243415*^9}, {
   3.708694530752083*^9, 3.7086945330667963`*^9}, {3.708713448182057*^9, 
   3.708713495206544*^9}, {3.7087135708683777`*^9, 3.70871357310364*^9}, {
   3.708747304910192*^9, 3.708747341236043*^9}, {3.7087513940248127`*^9, 
   3.708751446730295*^9}, {3.708751774250806*^9, 3.708751821820389*^9}, {
   3.7087603328689737`*^9, 3.7087603337782993`*^9}, 3.708760670898878*^9, {
   3.7087620057249613`*^9, 3.70876202632369*^9}, {3.708762056406809*^9, 
   3.7087620678404217`*^9}, {3.708763171272862*^9, 3.708763188022677*^9}, {
   3.708779953021462*^9, 3.708779975030781*^9}, {3.708786447834113*^9, 
   3.708786451188204*^9}, {3.708787445727085*^9, 3.7087875368147573`*^9}, {
   3.708928284645431*^9, 3.708928381420854*^9}, {3.708928414886322*^9, 
   3.7089284184942913`*^9}, {3.708928451347693*^9, 3.708928475069722*^9}, {
   3.708928507847603*^9, 3.7089285086250772`*^9}, {3.7089371816703587`*^9, 
   3.708937197292862*^9}, 3.708937279316977*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Contribution from A1 Faster", "Subsubsection",
 CellChangeTimes->{{3.708673999961767*^9, 3.708674004331999*^9}, {
  3.708936059560581*^9, 3.708936060545021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Contribution", " ", "from", " ", "A1"}], ",", " ", 
    RowBox[{"see", " ", "the", " ", 
     RowBox[{"notes", ".", " ", "The"}], " ", "following", " ", 
     "contribution", " ", "contains", " ", "the", " ", "contribution", " ", 
     "from", " ", "the", " ", "delta", " ", 
     RowBox[{"tensor", ".", " ", "dim"}], " ", "is", " ", "the", " ", 
     "component", " ", "of", " ", "the", " ", "velocity"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContributionA1Faster", "[", 
    RowBox[{"idxTest_", ",", "idxBasis_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nTest", ",", "sTest", ",", "idxTemp1", ",", "fac1", ",", "fac2", ",", 
       "fac3", ",", "phiDelta1", ",", "phiDelta2", ",", "Integral1", ",", 
       "Integral2", ",", "result", ",", "coeffsSym", ",", "time1", ",", 
       "time2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "the", " ", "tensorial", " ", "degree", " ", "of", " ", "the", " ", 
       "test", " ", "function", " ", "and", " ", "the", " ", "corresponding", 
       " ", "number", " ", "of", " ", 
       RowBox[{"traces", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nTest", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idxTest", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sTest", " ", "=", " ", 
       RowBox[{
       "idxTest", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"idxTemp1", " ", "=", " ", "idxTest"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Increase", " ", "the", " ", "value", " ", "of", " ", "\"\<s\>\"", " ",
         "and", " ", "keep", " ", "everything", " ", "the", " ", 
        RowBox[{"same", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "idxTemp1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       " ", "+=", "1"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fac1", " ", "=", " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"2", " ", "nTest"}], 
         RowBox[{
          RowBox[{"2", "nTest"}], "+", "1"}]]]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fac2", " ", "=", " ", 
       SqrtBox[
        RowBox[{"nTest", "+", "sTest", "+", 
         FractionBox["1", "2"]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fac3", " ", "=", " ", 
       SqrtBox[
        RowBox[{"sTest", "+", "1"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"The", " ", "trace", " ", "of", " ", "phi", " ", "*", " ", 
        RowBox[{"Delta", ".", " ", "The"}], " ", "test", " ", "function", " ",
         "*", " ", "Delta"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"time1", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{
         RowBox[{"phiDelta1", " ", "=", " ", 
          RowBox[{"ProdPsiDelta", "[", 
           RowBox[{"idxTest", ",", "dim"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Second", " ", "contribution", " ", "from", " ", "\[Psi]"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"phiDelta2", " ", "=", " ", 
          RowBox[{"ProdPsiDelta", "[", 
           RowBox[{"idxTemp1", ",", "dim"}], "]"}]}], ";"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "idx", " ", "are", " ", "equal", " ", "then", " ", "the", 
        " ", "result", " ", "is", " ", "just", " ", 
        RowBox[{
         FractionBox["1", "2"], ".", " ", "If"}], " ", "the", " ", "indices", 
        " ", "are", " ", "different", " ", "but", " ", "the", " ", "product", 
        " ", "is", " ", "even", " ", "then", " ", "also", " ", "the", " ", 
        "integral", " ", "is", " ", 
        RowBox[{"zero", ".", "Only"}], " ", "if", " ", "the", " ", 
        "summation", " ", "is", " ", "odd", " ", "will", " ", "there", " ", 
        "be", " ", "a", " ", "value"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"time2", " ", "=", " ", 
       RowBox[{"Timing", "[", 
        RowBox[{
         RowBox[{"Integral1", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[Equal]", "idxBasis"}], ",", 
              RowBox[{
               RowBox[{
               "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               FractionBox["1", "2"]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"EvenQ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "ii", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                   RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}], "+", 
                  
                  RowBox[{"idxBasis", "\[LeftDoubleBracket]", 
                   RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], ",", "0", ",", 
                RowBox[{
                 RowBox[{
                 "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 RowBox[{"HalfIntegratedim", "[", 
                  RowBox[{
                   RowBox[{
                   "ii", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "idxBasis", ",", "dim"}], 
                  "]"}]}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "phiDelta1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Integral2", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[Equal]", "idxBasis"}], ",", 
              RowBox[{
               RowBox[{
               "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               FractionBox["1", "2"]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"EvenQ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "ii", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                   RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}], "+", 
                  
                  RowBox[{"idxBasis", "\[LeftDoubleBracket]", 
                   RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], ",", "0", ",", 
                RowBox[{
                 RowBox[{
                 "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 RowBox[{"HalfIntegratedim", "[", 
                  RowBox[{
                   RowBox[{
                   "ii", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "idxBasis", ",", "dim"}], 
                  "]"}]}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "phiDelta2"}], "}"}]}], "]"}]}], ";"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Integral", " ", "from", " ", "the", " ", "first", " ", "phi", " ", 
        "Delta", " ", "product"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Integral1", " ", "=", 
       RowBox[{"fac1", "*", "fac2", "*", 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", "Integral1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Integral2", " ", "=", " ", 
       RowBox[{"fac1", "*", "fac3", "*", 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", "Integral2"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Producing Psi Delta\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "time1", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Half Integrals\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "time2", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Integral1", "-", "Integral2"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7086740203906097`*^9, 3.708674036977275*^9}, {
   3.708674078091181*^9, 3.708674109893599*^9}, {3.708674159427196*^9, 
   3.708674252990252*^9}, {3.708674379486662*^9, 3.708674453932214*^9}, {
   3.708674518281172*^9, 3.7086746383809023`*^9}, 3.708674754859185*^9, {
   3.7086747988059*^9, 3.708674960014612*^9}, {3.7086808699475613`*^9, 
   3.7086808732708607`*^9}, {3.708680940147476*^9, 3.708680944243415*^9}, {
   3.708694530752083*^9, 3.7086945330667963`*^9}, {3.708713448182057*^9, 
   3.708713495206544*^9}, {3.7087135708683777`*^9, 3.70871357310364*^9}, {
   3.708747304910192*^9, 3.708747341236043*^9}, {3.7087513940248127`*^9, 
   3.708751446730295*^9}, {3.708751774250806*^9, 3.708751821820389*^9}, {
   3.7087603328689737`*^9, 3.7087603337782993`*^9}, 3.708760670898878*^9, {
   3.7087620057249613`*^9, 3.70876202632369*^9}, {3.708762056406809*^9, 
   3.7087620678404217`*^9}, {3.708763171272862*^9, 3.708763188022677*^9}, {
   3.708779953021462*^9, 3.708779975030781*^9}, {3.708786447834113*^9, 
   3.708786451188204*^9}, {3.708787445727085*^9, 3.7087875368147573`*^9}, {
   3.708928284645431*^9, 3.708928381420854*^9}, {3.708928414886322*^9, 
   3.7089284184942913`*^9}, {3.708928451347693*^9, 3.708928475069722*^9}, {
   3.708928507847603*^9, 3.7089285086250772`*^9}, {3.708936065319458*^9, 
   3.708936066140087*^9}, {3.708936123300509*^9, 3.70893616191197*^9}, {
   3.708936201609507*^9, 3.708936457670703*^9}, {3.708936503984634*^9, 
   3.708936540152256*^9}, {3.708936617626089*^9, 3.708936651292955*^9}, {
   3.70893672074043*^9, 3.70893673541193*^9}, 3.7089371899701357`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.7089368732663927`*^9, 3.708936875586771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestingContributionA1", "[", 
   RowBox[{"degree_", ",", "dir_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"varIdx", ",", "result", ",", "result2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"varIdx", "=", 
      RowBox[{"IDXtrf", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "varIdx", "]"}], ",", 
          RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result2", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "varIdx", "]"}], ",", 
          RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"ContributionA1", "[", 
           RowBox[{
            RowBox[{
            "varIdx", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
             ",", 
            RowBox[{
            "varIdx", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}],
             ",", "dir"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", 
           RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result2", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"ContributionA1Faster", "[", 
           RowBox[{
            RowBox[{
            "varIdx", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
             ",", 
            RowBox[{
            "varIdx", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}],
             ",", "dir"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", 
           RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Norm", "[", 
       RowBox[{"result", "-", "result2"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708936927351707*^9, 3.708937155555601*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Amod Using Kinetic flux", "Subsection",
 CellChangeTimes->{{3.708919571512474*^9, 3.70891957552032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "using", " ", "the", " ", "above", " ", "defined", " ", 
    "routines", " ", "we", " ", "can", " ", "compute", " ", "the", " ", 
    "numerical", " ", "flux", " ", "matrix", " ", "using", " ", "a", " ", 
    "kinetic", " ", 
    RowBox[{"scheme", ".", "Dir"}], " ", "Flux", " ", "is", " ", "the", " ", 
    "direction", " ", "of", " ", "the", " ", "normal", " ", "in", " ", 
    "which", " ", "the", " ", "flux", " ", "has", " ", "to", " ", "be", " ", 
    "computed"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ComputeKineticAmod", "[", 
    RowBox[{"Ntensors_", ",", "dim_", ",", "dirFlux_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "varIdx", ",", "varIdxComplete", ",", "FluxMatrix", ",", "filename", 
       ",", 
       RowBox[{"precision", "=", "16"}], ",", "time"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varIdx", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iTraces", "[", "i", "]"}], ",", 
           RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"varIdxComplete", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dim", "\[Equal]", "3"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}],
                   ",", "#"}], "]"}], "&"}], ",", 
               RowBox[{"IDXtrf", "[", 
                RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}],
                   ",", "#"}], "]"}], "&"}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"IDXtrf", "[", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
                 ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Flux", " ", "matrix", " ", "for", " ", "only", " ", "the", " ", 
         "x"}], "-", 
        RowBox[{
         RowBox[{"direction", ".", " ", "For"}], " ", "all", " ", "the", " ", 
         "other", " ", "directions", " ", "we", " ", "can", " ", "simply", 
         " ", "rotate", " ", "using", " ", "a", " ", "projector", " ", 
         "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FluxMatrix", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "varIdxComplete", "]"}], ",", 
           RowBox[{"Length", "[", "varIdxComplete", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "ii", " ", "is", " ", "the", " ", "test", " ", "function", " ", "and", 
        " ", "jj", " ", "is", " ", "the", " ", "basis", " ", "function", " ", 
        "of", " ", "the", " ", "distribution", " ", 
        RowBox[{"function", ".", "The"}], " ", "factor", " ", "of", " ", "2", 
        " ", "comes", " ", "from", " ", "the", " ", "absolute", " ", "value", 
        " ", "of", " ", "the", " ", 
        RowBox[{"velocity", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FluxMatrix", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"EvenQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "varIdxComplete", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"dirFlux", "+", "1"}], "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{
                  RowBox[{
                  "varIdxComplete", "\[LeftDoubleBracket]", "jj", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"dirFlux", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                "]"}], ",", 
               RowBox[{"Simplify", "[", 
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ContributionA0", "[", 
                    RowBox[{
                    RowBox[{
                    "varIdxComplete", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "varIdxComplete", "\[LeftDoubleBracket]", "jj", 
                    "\[RightDoubleBracket]"}], ",", "dirFlux"}], "]"}], "+", 
                   RowBox[{"ContributionA1Faster", "[", 
                    RowBox[{
                    RowBox[{
                    "varIdxComplete", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "varIdxComplete", "\[LeftDoubleBracket]", "jj", 
                    "\[RightDoubleBracket]"}], ",", "dirFlux"}], "]"}]}], 
                  ")"}]}], "]"}], ",", "0"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", "1", ",", 
              RowBox[{"Length", "[", "varIdxComplete", "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "varIdxComplete", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "time", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"filename", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<kineticAmod_\>\"", ",", 
         RowBox[{"ToString", "[", "dim", "]"}], ",", "\"\<D_\>\"", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "FluxMatrix", "]"}], "]"}], ",", 
         "\"\<.txt\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Writting matrix to\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Style", "[", 
        RowBox[{"filename", ",", 
         RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"developsparsity2", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"FluxMatrix", ",", "precision"}], "]"}], ",", "filename"}], 
       "]"}], " ", ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.70891957796742*^9, 3.708919651339514*^9}, {
   3.708919698146699*^9, 3.708919726500087*^9}, {3.708919770790544*^9, 
   3.7089197722054663`*^9}, {3.7089198025035057`*^9, 
   3.7089198934207907`*^9}, {3.7089199261298656`*^9, 3.708920023819615*^9}, {
   3.708920067930059*^9, 3.708920115555698*^9}, {3.7089201468852663`*^9, 
   3.7089201970070057`*^9}, {3.708920369823366*^9, 3.708920451686884*^9}, {
   3.7089207350720367`*^9, 3.708920739086849*^9}, {3.708926205810869*^9, 
   3.708926212069021*^9}, {3.708926372065035*^9, 3.708926378896215*^9}, {
   3.708926450229168*^9, 3.708926498877832*^9}, {3.70892655485533*^9, 
   3.7089265788774843`*^9}, {3.708926838406636*^9, 3.708926890211638*^9}, {
   3.708927050970601*^9, 3.708927054901845*^9}, {3.708927085851016*^9, 
   3.708927131773657*^9}, 3.708927410469405*^9, 3.7089285684869204`*^9, {
   3.708937356374942*^9, 3.708937357209345*^9}, 3.7089374335243053`*^9, {
   3.708941401248157*^9, 3.7089414130047693`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListNtensors", "=", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8", ",", "9", ",", "11", ",", "12", ",", "15"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ComputeKineticAmod", "[", 
     RowBox[{"ii", ",", "3", ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "ListNtensors"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ComputeKineticAmod", "[", 
     RowBox[{"ii", ",", "2", ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "ListNtensors"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.708926518130048*^9, 3.7089265323546953`*^9}, 
   3.708927127336609*^9, 3.708927414087247*^9, 3.7089279326819677`*^9, 
   3.7089279825571117`*^9, {3.7089409586164227`*^9, 3.708940962985091*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941441123878*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.423977`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941441136754*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414411521177`*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_3D_20.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941441168013*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414435062227`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.378268`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414435213623`*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414435378733`*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_3D_26.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941443554956*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941451825251*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.309903`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941451844618*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414518629503`*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_3D_35.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.70894145188135*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941465347966*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.516183`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414653631983`*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941465377586*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_3D_45.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089414653920527`*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941512510501*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"45.746148`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941512528347*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941512544434*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_3D_56.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941512558963*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941597918412*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"80.8345`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941597950284*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941597985511*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_3D_71.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089415980092287`*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941598902029*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.855522`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089415989321203`*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941598964513*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_2D_13.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089415989977827`*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941600575989*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.503069`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941600603764*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.70894160062626*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_2D_17.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941600647826*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089416049548597`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.289089`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.70894160501364*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089416050579863`*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_2D_22.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089416051235723`*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089416131437397`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.611459`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941613169745*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941613192563*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_2D_28.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941613220051*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941633575232*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19.872742`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.7089416335961037`*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941633615261*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_2D_34.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941633635192*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941664888133*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"31.060385`", ",", "Null"}], "}"}]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941664923541*^9}],

Cell[BoxData["\<\"Writting matrix to\"\>"], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941664961915*^9}],

Cell[BoxData[
 StyleBox["\<\"kineticAmod_2D_43.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708937453590307*^9, 3.7089406980698757`*^9, 
  3.70894096516364*^9, 3.708941664990899*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.708941532083004*^9, 3.70894153375403*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["RhoW for spherical Harmonics", "Subsection",
 CellChangeTimes->{{3.708915867128243*^9, 3.7089158751495037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeRhoW", "[", 
   RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "varIdx", ",", "varIdxComplete", ",", "varIdxCompleteWall", ",", 
      "HalfIntegralWall", ",", "HalfIntegralGas", ",", "varWall", ",", 
      "varGas", ",", "WallVelocity", ",", "rhoW", ",", "coeffRhoW", ",", 
      "filenameRhoW", ",", 
      RowBox[{"precision", "=", "16"}]}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"varIdx", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"iTraces", "[", "i", "]"}], ",", 
          RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"varIdxComplete", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "3"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                 ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"IDXtrf", "[", 
               RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
          "1"}], "]"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                 ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"IDXtrf", "[", 
                 RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                  RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
                ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Following", " ", "are", " ", "the", " ", "indices", " ", "for", " ", 
        "the", " ", 
        RowBox[{"wall", ".", " ", "So"}], " ", "we", " ", "have", " ", 
        "density"}], ",", " ", 
       RowBox[{"tangential", " ", "velocities", " ", "and", " ", 
        RowBox[{"temperature", ".", " ", "Only"}], " ", "one", " ", 
        "component", " ", "for", " ", "the", " ", "tangential", " ", 
        "velocity", " ", "in", " ", "the", " ", "2", "D", " ", 
        RowBox[{"case", ".", " ", "For"}], " ", "the", " ", "3", "D", " ", 
        "case", " ", "there", " ", "are", " ", "two", " ", 
        RowBox[{"components", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"varIdxCompleteWall", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Moments", " ", "for", " ", "the", " ", 
       RowBox[{"gas", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"varGas", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", "#", "]"}], "&"}], ",", "varIdxComplete"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varWall", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["w", "w"], "[", "#", "]"}], "&"}], ",", 
        "varIdxCompleteWall"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"HalfIntegrals", " ", "for", " ", "the", " ", "Gas"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"HalfIntegralGas", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"HalfIntegrate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{
           "varIdxComplete", "\[LeftDoubleBracket]", "ii", 
            "\[RightDoubleBracket]"}]}], "]"}], 
         RowBox[{
         "varGas", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "varIdxComplete", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Half", " ", "Integrals", " ", "for", " ", "the", " ", "wall"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"HalfIntegralWall", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"HalfIntegrate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{
           "varIdxCompleteWall", "\[LeftDoubleBracket]", "ii", 
            "\[RightDoubleBracket]"}]}], "]"}], 
         RowBox[{
         "varWall", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
         ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "varIdxCompleteWall", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "negative", " ", "comes", " ", "from", " ", "the", " ", 
       "integral", " ", "over", " ", "the", " ", "negative", " ", "velocity", 
       " ", "space"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WallVelocity", " ", "=", " ", 
      RowBox[{"HalfIntegralGas", "-", "HalfIntegralWall"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rhoW", " ", "=", 
      RowBox[{"Simplify", "[", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"WallVelocity", "\[Equal]", "0"}], ",", 
           RowBox[{
            SubscriptBox["w", "w"], "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}]}], 
          "]"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"coeffRhoW", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "varGas", "]"}], ",", 
          RowBox[{"Length", "[", "varGas", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Now", " ", "we", " ", "develop", " ", "a", " ", "coefficient", " ", 
       "matrix", " ", "for", " ", "the", " ", "density", " ", "of", " ", 
       "the", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "coeffRhoW", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      " ", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"rhoW", "\[Equal]", "0"}], ",", "varGas"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"filenameRhoW", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<rhoW_\>\"", ",", 
        RowBox[{"ToString", "[", "dim", "]"}], ",", "\"\<D_\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "varIdxComplete", "]"}], "]"}], ",", 
        "\"\<.txt\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{"filenameRhoW", ",", 
        RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"coeffRhoW", ",", "precision"}], "]"}], ",", "filenameRhoW"}],
       "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708916111734625*^9, 3.7089161397002697`*^9}, {
   3.708916177512166*^9, 3.708916195903976*^9}, {3.708916246212901*^9, 
   3.708916431893997*^9}, {3.708916490419373*^9, 3.708916533987549*^9}, {
   3.708916588711051*^9, 3.708916757886992*^9}, {3.708916822336344*^9, 
   3.708916856231584*^9}, {3.7089168893741827`*^9, 3.708916895659522*^9}, {
   3.708916939430595*^9, 3.708916985232394*^9}, {3.708917018749826*^9, 
   3.708917150251844*^9}, {3.708917188179145*^9, 3.7089172030520782`*^9}, {
   3.708917321580881*^9, 3.708917376461906*^9}, {3.708917423589355*^9, 
   3.708917449434126*^9}, {3.7089175117633142`*^9, 3.708917569209321*^9}, {
   3.708917683333804*^9, 3.70891768628823*^9}, {3.7089180549549627`*^9, 
   3.7089180696841908`*^9}, {3.708918185393805*^9, 3.708918191754375*^9}, {
   3.7089182350314293`*^9, 3.708918268402626*^9}, {3.70891832911033*^9, 
   3.7089183618149347`*^9}, {3.7089184464117327`*^9, 3.708918446683159*^9}, 
   3.7089185881251793`*^9, {3.7089423260471897`*^9, 3.708942339675658*^9}, {
   3.708942832008314*^9, 3.708942834766222*^9}, {3.708942873418833*^9, 
   3.70894288900659*^9}, {3.709124367664706*^9, 3.7091243853311768`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "Ntensors"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ListNtensors", "=", 
     RowBox[{"{", 
      RowBox[{"6", ",", "8", ",", "9", ",", "11", ",", "12", ",", "15"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ComputeRhoW", "[", 
       RowBox[{"ii", ",", "3"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "ListNtensors"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ComputeRhoW", "[", 
       RowBox[{"ii", ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "ListNtensors"}], "}"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.708917967511465*^9, 3.708918057816752*^9}, 
   3.7089265066055813`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"rhoW_3D_20.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.7089429262876177`*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_3D_26.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926337288*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_3D_35.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926387726*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_3D_45.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.7089429264529676`*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_3D_56.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926552956*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_3D_71.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926683947*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_2D_13.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.7089429267204647`*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_2D_17.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926735066*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_2D_22.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.70894292678948*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_2D_28.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.7089429268473597`*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_2D_34.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926897561*^9}],

Cell[BoxData[
 StyleBox["\<\"rhoW_2D_43.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[0, 1, 0]]], "Print",
 CellChangeTimes->{3.708942894514091*^9, 3.708942926967577*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing Routines", "Subsection",
 CellChangeTimes->{{3.7087135927367973`*^9, 3.708713596180746*^9}}],

Cell[CellGroupData[{

Cell["Testing Recursion", "Subsubsection",
 CellChangeTimes->{{3.708747420904963*^9, 3.708747423556695*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TestA0", "[", "idx_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "s", ",", "fac", ",", "result", ",", "idx1", ",", "idx2"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "the", " ", "tensorial", " ", "degree", " ", "of", " ", "the", " ", 
       "test", " ", "function", " ", "and", " ", "the", " ", "corresponding", 
       " ", "number", " ", "of", " ", 
       RowBox[{"traces", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idx", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{
       "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fac", " ", "=", 
       RowBox[{"{", " ", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"2", " ", "n"}], "+", "2"}], 
           RowBox[{
            RowBox[{"2", " ", "n"}], "+", "3"}]]], ",", 
         SqrtBox[
          RowBox[{"n", "+", "s", "+", 
           FractionBox["3", "2"]}]], ",", 
         SqrtBox["s"]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"idx1", " ", "=", " ", "idx"}], ";", "\[IndentingNewLine]", 
      RowBox[{"idx2", " ", "=", " ", "idx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"increaes", " ", "the", " ", "x", " ", "index"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "+=", "1"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "-=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "+=", "1"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "fac", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "*", 
         RowBox[{
         "fac", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*", 
         RowBox[{"\[Psi]", "[", "idx1", "]"}]}], "-", 
        RowBox[{
         RowBox[{
         "fac", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         RowBox[{
         "fac", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[GreaterEqual]", "0"}], ",", 
           RowBox[{"\[Psi]", "[", "idx2", "]"}], ",", "0"}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", "result", "]"}], "/.", 
       RowBox[{"\[Theta]0", "\[Rule]", "1"}]}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TestA1", "[", "idx_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "s", ",", "fac", ",", "result", ",", "idx1", ",", "idx2", ",", 
      "phiDelta1", ",", "phiDelta2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"idx", "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"fac", " ", "=", 
      RowBox[{"{", " ", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"2", " ", "n"}], 
          RowBox[{
           RowBox[{"2", "n"}], "+", "1"}]]], ",", 
        SqrtBox[
         RowBox[{"n", "+", "s", "+", 
          FractionBox["1", "2"]}]], ",", 
        SqrtBox[
         RowBox[{"s", "+", "1"}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"idx1", " ", "=", " ", "idx"}], ";", "\[IndentingNewLine]", 
     RowBox[{"idx2", " ", "=", " ", "idx"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "+=", "1"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"phiDelta1", "=", 
      RowBox[{"ProdPsiDelta", "[", 
       RowBox[{"idx1", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phiDelta2", "=", 
      RowBox[{"ProdPsiDelta", "[", 
       RowBox[{"idx2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"phiDelta1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "*", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{
          "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "phiDelta1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phiDelta2", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "*", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{
          "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "phiDelta2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"fac", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         "*", 
        RowBox[{"fac", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "*", "phiDelta1"}], "-", 
       RowBox[{
        RowBox[{"fac", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         "*", 
        RowBox[{"fac", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
         "*", "phiDelta2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", "result", "]"}], "/.", 
      RowBox[{"\[Theta]0", "\[Rule]", "1"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7087460318298893`*^9, 3.7087462742721453`*^9}, {
  3.708746351983541*^9, 3.7087464116336184`*^9}, {3.708746475939587*^9, 
  3.708746486965826*^9}, {3.708746519073187*^9, 3.7087465283582983`*^9}, {
  3.708746572112363*^9, 3.708746745285904*^9}, {3.708760474323186*^9, 
  3.70876050747488*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "test", " ", "the", " ", "above", " ", "implementation", " ", 
    "of", " ", "the", " ", "recursion", " ", 
    RowBox[{"relations", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TestRecursion", "[", "idx_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "s", ",", "fac", ",", "A0", ",", "A1"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "the", " ", "tensorial", " ", "degree", " ", "of", " ", "the", " ", 
       "test", " ", "function", " ", "and", " ", "the", " ", "corresponding", 
       " ", "number", " ", "of", " ", 
       RowBox[{"traces", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"idx", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{
       "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "list", " ", "containing", " ", "all", " ", "the", " ", "factors", " ",
         "which", " ", "appear", " ", "in", " ", "the", " ", "recursion"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"TestA0", "[", "idx", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A1", "=", 
       RowBox[{"TestA1", "[", "idx", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"A0", "+", "A1", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]", "[", "idx", "]"}], "Cx"}], "/.", 
          RowBox[{"\[Theta]0", "\[Rule]", "1"}]}], ")"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.708713597698147*^9, 3.7087136613369713`*^9}, {
  3.7087139490813932`*^9, 3.7087140026602793`*^9}, {3.7087457512189083`*^9, 
  3.708745862877181*^9}, {3.70874589500263*^9, 3.708745980449835*^9}, {
  3.7087468123377934`*^9, 3.708746891106324*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Half Space Integrals", "Subsubsection",
 CellChangeTimes->{{3.708747430557729*^9, 3.708747435668944*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestHalfSpaceIntegrals", "[", 
   RowBox[{"idxTest_", ",", "dataBasis_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "s", ",", "varIdx", ",", "result", ",", "resultManual", ",", 
      "psiTest", ",", "psiBasis", ",", "varIdxFull", ",", "varIdxTrf", ",", 
      "coeffsSym"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{
      "dataBasis", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
      "dataBasis", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"varIdxFull", " ", "=", " ", 
      RowBox[{"IDXFull", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varIdxTrf", " ", "=", " ", 
      RowBox[{"IDXtrf", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"varIdxFull", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"s", ",", "ii"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "varIdxFull"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"varIdxTrf", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"s", ",", "ii"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "varIdxTrf"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"coeffsSym", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"coeffSym", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "varIdxFull"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"psiTest", "=", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "idxTest", "]"}], "/.", 
       RowBox[{"\[Theta]0", "\[Rule]", "1"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"psiBasis", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "ii", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "varIdxFull"}], "}"}]}], "]"}], "/.", 
       RowBox[{"\[Theta]0", "\[Rule]", "1"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"ContributionA0", "[", 
        RowBox[{"idxTest", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "s"}], "}"}]}], "]"}], "+", 
       RowBox[{"ContributionA1", "[", 
        RowBox[{"idxTest", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "s"}], "}"}], ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"k", "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"resultManual", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"ii", " ", "f0", " ", "psiTest", " ", "Cx"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cx", ",", "0", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cy", ",", 
                RowBox[{"-", "8"}], ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cz", ",", 
                RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "psiBasis"}], "}"}]}], "]"}]}], ";"}], ",", 
       RowBox[{"k", "\[Equal]", "2"}], ",", 
       RowBox[{
        RowBox[{"resultManual", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"ii", " ", "f0", " ", "psiTest", " ", "Cy"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cy", ",", "0", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cx", ",", 
                RowBox[{"-", "8"}], ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cz", ",", 
                RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "psiBasis"}], "}"}]}], "]"}]}], ";"}], ",", 
       RowBox[{"k", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"resultManual", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"ii", " ", "f0", " ", "psiTest", " ", "Cz"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cz", ",", "0", ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cx", ",", 
                RowBox[{"-", "8"}], ",", "8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cy", ",", 
                RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "psiBasis"}], "}"}]}], "]"}]}], ";"}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"resultManual", " ", "=", " ", 
      RowBox[{"resultManual", "*", "coeffsSym"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"resultManual", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"resultManual", ".", 
         RowBox[{"trf2sym", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "\[Equal]", 
                   RowBox[{"ii", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], ",", "1", ",", "0"}], "]"}], 
                "&"}], ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"IDXtrf", "[", "n", "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "varIdxTrf"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"result", "-", "resultManual"}], "]"}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "8"}]]}], "]"}], "*)"}], "\[IndentingNewLine]", 
     "resultManual"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.708747438589925*^9, 3.708747445344009*^9}, {
   3.7087474846238403`*^9, 3.708747646326476*^9}, {3.708749176258472*^9, 
   3.708749193328802*^9}, {3.708749254995591*^9, 3.7087493059883423`*^9}, {
   3.708749350014985*^9, 3.708749389470088*^9}, {3.708749444936777*^9, 
   3.708749453273773*^9}, {3.708749487538047*^9, 3.7087495548530083`*^9}, {
   3.7087499166306343`*^9, 3.7087499296213303`*^9}, {3.708749963686198*^9, 
   3.708749965925541*^9}, {3.708751511316957*^9, 3.708751619677245*^9}, {
   3.708751651983807*^9, 3.708751716368126*^9}, {3.708752041890449*^9, 
   3.708752176275282*^9}, {3.708752255902821*^9, 3.708752292269526*^9}, {
   3.7087526417372713`*^9, 3.708752645095808*^9}, {3.708752888319001*^9, 
   3.7087528930220633`*^9}, {3.708753142908111*^9, 3.708753168495516*^9}, 
   3.708759959446796*^9, 3.708760041236814*^9, {3.7087602650879602`*^9, 
   3.708760270013075*^9}, 3.7087606930203876`*^9, {3.708762159415474*^9, 
   3.7087622149837008`*^9}, 3.708762455576476*^9, 3.708762490399926*^9, {
   3.708763279937248*^9, 3.7087633002244453`*^9}, 3.708763627699568*^9, {
   3.708764006024029*^9, 3.708764012005204*^9}, 3.70876565165877*^9, {
   3.708765814240294*^9, 3.708765849207796*^9}, 3.708765916047633*^9, {
   3.708765968314843*^9, 3.7087659709046717`*^9}, {3.708766006946653*^9, 
   3.708766010604175*^9}, {3.70876605449874*^9, 3.708766070531633*^9}, {
   3.708766188887479*^9, 3.708766197391067*^9}, {3.708766242864551*^9, 
   3.708766263834052*^9}, {3.708766586486607*^9, 3.708766663457696*^9}, {
   3.708767038504447*^9, 3.708767045259502*^9}, {3.708770910681066*^9, 
   3.708770911222426*^9}, {3.708770960545354*^9, 3.708771062981839*^9}, {
   3.7087711321550093`*^9, 3.7087711433729258`*^9}, 3.7087712728780746`*^9, {
   3.708771449198978*^9, 3.708771454004354*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Test rotational Invariance", "Subsubsection",
 CellChangeTimes->{{3.708766503039988*^9, 3.708766503895446*^9}, {
  3.708766568356534*^9, 3.7087665739221973`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TestRotInvarHalfIntegrals", "[", 
    RowBox[{"dataBasis_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "s", ",", "varBasis", ",", "nVec", ",", "tVec", ",", "rVec", 
       ",", "xDirFlux", ",", "Proj", ",", "InvProj", ",", "Flux"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{
       "dataBasis", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{
       "dataBasis", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"unit", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"nVec", "=", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], ",", 
        RowBox[{"dim", "\[Equal]", "2"}], ",", 
        RowBox[{
         RowBox[{"nVec", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], ",", 
        RowBox[{"dim", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"nVec", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tVec", ",", "rVec"}], "}"}], "=", 
       RowBox[{"LocalCoordinates", "[", "nVec", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"varBasis", " ", "=", " ", 
       RowBox[{"IDXtrf", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"varBasis", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "ii"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "varBasis"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Flux", " ", "in", " ", "the", " ", "x", " ", "direction"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xDirFlux", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "varBasis", "]"}], ",", 
           RowBox[{"Length", "[", "varBasis", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xDirFlux", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"ContributionA0", "[", 
              RowBox[{
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "jj", 
                "\[RightDoubleBracket]"}], ",", "1"}], "]"}], "+", 
             RowBox[{"ContributionA1", "[", 
              RowBox[{
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "jj", 
                "\[RightDoubleBracket]"}], ",", "1"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", "varBasis", "]"}]}], "}"}]}], "]"}], 
         ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "varBasis", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Flux", " ", "corresponding", " ", "to", " ", "a", " ", "particular", 
        " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Flux", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "varBasis", "]"}], ",", 
           RowBox[{"Length", "[", "varBasis", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Flux", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"ContributionA0", "[", 
              RowBox[{
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "jj", 
                "\[RightDoubleBracket]"}], ",", "dim"}], "]"}], "+", 
             RowBox[{"ContributionA1", "[", 
              RowBox[{
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "varBasis", "\[LeftDoubleBracket]", "jj", 
                "\[RightDoubleBracket]"}], ",", "dim"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", "varBasis", "]"}]}], "}"}]}], "]"}], 
         ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "varBasis", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Proj", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"ProjectorGeneral3D", "[", 
          RowBox[{"n", ",", "3"}], "]"}], "]"}], "/.", 
        RowBox[{"ReplacementList", "[", 
         RowBox[{"nVec", ",", "tVec", ",", "rVec"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"InvProj", " ", "=", 
       RowBox[{
        RowBox[{"Normal", "[", " ", 
         RowBox[{"InvProjectorGeneral3D", "[", 
          RowBox[{"n", ",", "3"}], "]"}], "]"}], "/.", 
        RowBox[{"ReplacementList", "[", 
         RowBox[{"nVec", ",", "tVec", ",", "rVec"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"InvProj", ".", "xDirFlux", ".", "Proj"}], "-", "Flux"}], 
        "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"N", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"InvProj", ".", "xDirFlux", ".", "Proj"}], ",", "Flux"}], 
       "}"}], "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TestRotInvarKineticAmod", "[", 
   RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nVec", ",", "tVec", ",", "rVec", ",", "xDirFlux", ",", "Proj", ",", 
      "InvProj", ",", "Flux"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xDirFlux", " ", "=", " ", 
      RowBox[{"ComputeKineticAmod", "[", 
       RowBox[{"Ntensors", ",", "dim", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flux", " ", "=", " ", 
      RowBox[{"ComputeKineticAmod", "[", 
       RowBox[{"Ntensors", ",", "dim", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"unit", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"dim", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nVec", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tVec", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rVec", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dim", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nVec", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tVec", ",", "rVec"}], "}"}], "=", 
         RowBox[{"LocalCoordinates", "[", "nVec", "]"}]}], ";"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Proj", "=", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"GenerateProjector3D", "[", 
         RowBox[{"Ntensors", ",", "dim"}], "]"}], "]"}], "/.", 
       RowBox[{"ReplacementList", "[", 
        RowBox[{"nVec", ",", "tVec", ",", "rVec"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InvProj", " ", "=", 
      RowBox[{
       RowBox[{"Normal", "[", " ", 
        RowBox[{"GenerateInvProjector3D", "[", 
         RowBox[{"Ntensors", ",", "dim"}], "]"}], "]"}], "/.", 
       RowBox[{"ReplacementList", "[", 
        RowBox[{"nVec", ",", "tVec", ",", "rVec"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{"Chop", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"InvProj", ".", "xDirFlux", ".", "Proj"}], "-", "Flux"}], 
        "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"N", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InvProj", ".", "xDirFlux", ".", "Proj"}], ",", "Flux"}], 
      "}"}], "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.708766803101984*^9, 3.708766906923644*^9}, {
   3.70876705225098*^9, 3.708767154614601*^9}, {3.7087672485892143`*^9, 
   3.708767323837975*^9}, {3.708767431100319*^9, 3.7087674967176657`*^9}, {
   3.708768270622575*^9, 3.708768380360093*^9}, {3.708768427053659*^9, 
   3.708768444108186*^9}, {3.708768494023773*^9, 3.708768501422182*^9}, {
   3.70876872047058*^9, 3.708768737168007*^9}, {3.708768776255513*^9, 
   3.7087688140572777`*^9}, {3.7087704934521933`*^9, 3.708770535461134*^9}, {
   3.7087705873756113`*^9, 3.7087706171285973`*^9}, 3.708770652627206*^9, {
   3.708770824197217*^9, 3.7087708304454203`*^9}, {3.708771480109355*^9, 
   3.708771485010597*^9}, {3.7087715358920527`*^9, 3.708771540580995*^9}, {
   3.708780032617778*^9, 3.7087801148471537`*^9}, {3.7087804140692253`*^9, 
   3.708780428904009*^9}, {3.708781363135571*^9, 3.708781364882637*^9}, {
   3.708785861139906*^9, 3.708785874068797*^9}, {3.708786470623358*^9, 
   3.708786472312965*^9}, {3.708787597418591*^9, 3.70878765586103*^9}, {
   3.7087877577750673`*^9, 3.708787871994114*^9}, {3.7089207736533823`*^9, 
   3.708920908264083*^9}, {3.708920959787839*^9, 3.70892096838593*^9}, {
   3.708921044254929*^9, 3.708921067760116*^9}, {3.708921132847694*^9, 
   3.7089211357232933`*^9}, {3.7089214026136103`*^9, 3.708921409372816*^9}, 
   3.7089214834579983`*^9, {3.70892154272462*^9, 3.708921706952392*^9}, 
   3.70892178116914*^9, {3.708921881237575*^9, 3.70892190060172*^9}, {
   3.708921945010358*^9, 3.7089219961839743`*^9}, {3.7089262397471533`*^9, 
   3.708926242397493*^9}}]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Matrices", "Section",
 CellChangeTimes->{{3.706898221740512*^9, 3.7068982246042767`*^9}}],

Cell[CellGroupData[{

Cell["Sorting routines for eigenvalues", "Subsection",
 CellChangeTimes->{{3.680249246085958*^9, 3.680249249027594*^9}, {
  3.680256060552952*^9, 3.680256062997087*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "following", " ", "routines", " ", "sorts", " ", "the", " ", 
    "eigen", " ", "values", " ", "and", " ", "the", " ", "eigenvectors", " ", 
    "in", " ", "proper", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SortEigenDecomp", "[", 
    RowBox[{"X_", ",", "\[Lambda]_", ",", "Ax_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Position\[Lambda]neg", ",", "num\[Lambda]neg", ",", 
       "Position\[Lambda]pos", ",", "num\[Lambda]pos", ",", 
       "Position\[Lambda]zero", ",", "num\[Lambda]zero", ",", "Xsorted", ",", 
       "\[Lambda]plus", ",", "\[Lambda]minus", ",", "nEqn", ",", 
       "\[Lambda]sorted"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nEqn", " ", "=", " ", 
       RowBox[{"Length", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Position\[Lambda]neg", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "<", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num\[Lambda]neg", " ", "=", " ", 
       RowBox[{"Length", "[", "Position\[Lambda]neg", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Position\[Lambda]pos", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num\[Lambda]pos", " ", "=", " ", 
       RowBox[{"Length", "[", "Position\[Lambda]pos", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Position\[Lambda]zero", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "==", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num\[Lambda]zero", " ", "=", " ", 
       RowBox[{"Length", "[", "Position\[Lambda]zero", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"sorting", " ", "the", " ", "eigen", " ", "vectors"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Xsorted", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"nEqn", ",", "nEqn"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Xsorted", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", "num\[Lambda]neg"}]}], "]"}], "]"}], "=", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "Position\[Lambda]neg"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Xsorted", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"num\[Lambda]neg", "+", "1"}], ";;", 
           RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero"}]}]}], "]"}], 
        "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"NullSpace", "[", "Ax", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Xsorted", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero", "+", "1"}], ";;",
            "nEqn"}]}], "]"}], "]"}], "=", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "Position\[Lambda]pos"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"sorting", " ", "the", " ", "eigenvalues"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]sorted", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "nEqn"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]plus", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"[", "Position\[Lambda]pos", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]minus", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"[", "Position\[Lambda]neg", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Lambda]sorted", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "num\[Lambda]neg"}], "]"}], "]"}], "=", 
       "\[Lambda]minus"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Lambda]sorted", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero", "+", "1"}], ";;",
           "nEqn"}], "]"}], "]"}], "=", "\[Lambda]plus"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Xsorted", ",", "\[Lambda]sorted", ",", 
        RowBox[{"Xsorted", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", "num\[Lambda]neg"}]}], "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{"Xsorted", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"-", "num\[Lambda]pos"}], ";;", 
           RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], ",", 
        "\[Lambda]minus", ",", "\[Lambda]plus"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680249250841631*^9, 3.6802492908741713`*^9}, {
  3.680250814414568*^9, 3.680251053208439*^9}, {3.6802511937776833`*^9, 
  3.680251218953314*^9}, {3.680251255945776*^9, 3.680251257401301*^9}, {
  3.680251355927329*^9, 3.680251363210842*^9}, {3.680251399268958*^9, 
  3.680251451223506*^9}, {3.680251508074215*^9, 3.680251523353497*^9}, {
  3.680251559507114*^9, 3.680251581536899*^9}, {3.6802560492994213`*^9, 
  3.680256056665092*^9}, {3.687503117792045*^9, 3.68750323719375*^9}, {
  3.6875033287436457`*^9, 3.687503337926175*^9}, {3.706934658864352*^9, 
  3.706934658965435*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking boundary Stability", "Subsection",
 CellChangeTimes->{{3.7068994714365807`*^9, 3.706899475587823*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CheckSPD", "[", 
    RowBox[{"Mat_", ",", "matrixname_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"entries", ",", "error", ",", "EV", ",", 
       RowBox[{"$MaxExtraPrecision", "=", "150"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"Style", "[", 
        RowBox[{"matrixname", ",", 
         RowBox[{"FontColor", "\[Rule]", "Magenta"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"entries", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", "Mat", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Mat", "-", 
          RowBox[{"Transpose", "[", "Mat", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EV", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"N", "[", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"N", "[", "Mat", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "check", " ", "for", " ", "the", " ", "symmetricity", " ", "of", " ", 
         "the", " ", "matrices", " ", "by", " ", "computing", " ", "A"}], " ",
         "-", " ", 
        RowBox[{"Transpose", "[", "A", "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "error", "]"}], ",", "0"}], "]"}], 
         "\[NotEqual]", "entries"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Not Symmetric\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Symmetric\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "compute", " ", "the", " ", "positive", " ", "definetness", " ", "by", 
        " ", "computing", " ", "the", " ", "eigenvalues"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"EV", ",", 
            RowBox[{
             RowBox[{"#", "<=", "0"}], "&"}]}], "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Negative Definite\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Positive Definite\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}]}], "]"}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "symmetric", " ", "positive", " ", "semi", " ", "definite"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckSPSD", "[", 
    RowBox[{"Mat_", ",", "matrixname_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"entries", ",", "error", ",", "EV", ",", 
       RowBox[{"$MaxExtraPrecision", "=", "150"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"Style", "[", 
        RowBox[{"matrixname", ",", 
         RowBox[{"FontColor", "\[Rule]", "Magenta"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"entries", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", "Mat", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Mat", "-", 
          RowBox[{"Transpose", "[", "Mat", "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EV", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"N", "[", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"N", "[", "Mat", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "error", "]"}], ",", "0"}], "]"}], 
         "\[NotEqual]", "entries"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Not Symmetric\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Symmetric\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"EV", ",", 
            RowBox[{
             RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], ">", "0"}], ",", 
        
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Negative Definite\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Positive Definite\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}]}], "]"}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Checks", " ", "whether", " ", "the", " ", "Null", " ", "Space", " ", "of",
     " ", "Mat2", " ", "is", " ", "included", " ", "in", " ", "the", " ", 
    "Null", " ", "space", " ", "of", " ", "Mat1", " ", "or", " ", "not"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckNullSpaceInclusion", "[", 
    RowBox[{"Mat1_", ",", "Mat2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "entries", ",", 
       RowBox[{"$MaxExtraPrecision", "=", "150"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Mat1", ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"NullSpace", "[", "Mat2", "]"}], "]"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"entries", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", "result", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "result", "]"}], ",", "0"}], "]"}], 
         "\[NotEqual]", "entries"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Null Space Not Included\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Null Space Included\>\"", ",", 
           RowBox[{"FontColor", "\[Rule]", "Green"}]}], "]"}], "]"}]}], "]"}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryMatrices", "[", 
   RowBox[{"Ax_", ",", "B_", ",", "nEqn_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "X", ",", "\[Lambda]Ax", ",", "Position\[Lambda]neg", ",", 
      "num\[Lambda]neg", ",", "Position\[Lambda]pos", ",", "num\[Lambda]pos", 
      ",", "Position\[Lambda]zero", ",", "num\[Lambda]zero", ",", "Xsorted", 
      ",", "Xplus", ",", "Xminus", ",", "Bminus", ",", "Bplus", ",", 
      "Bhatplus", ",", "Btemp", ",", "\[Lambda]plus", ",", "\[Lambda]minus"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "nomenclature", " ", "matches", " ", "with", " ", "the", " ",
       "DG", " ", 
      RowBox[{"paper", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]Ax", ",", "X"}], "}"}], " ", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"Eigensystem", "[", "Ax", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", 
      RowBox[{"Transpose", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "X", ",", "\[Lambda]Ax", ",", "Xminus", ",", "Xplus", ",", 
        "\[Lambda]minus", ",", "\[Lambda]plus"}], "}"}], "=", 
      RowBox[{"SortEigenDecomp", "[", 
       RowBox[{"X", ",", "\[Lambda]Ax", ",", "Ax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]plus", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", "\[Lambda]plus", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]minus", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", "\[Lambda]minus", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Bminus", " ", "=", " ", 
      RowBox[{"B", ".", "Xminus"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bplus", " ", "=", " ", 
      RowBox[{"B", ".", "Xplus"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Bhatplus", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Inverse", "[", "Bminus", "]"}], ".", "Bplus"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"CheckSPSD", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "Bhatplus", "]"}], ".", "\[Lambda]minus", 
         ".", "Bhatplus"}], "+", "\[Lambda]plus"}], ",", 
       "\"\<Norsdtom Condition\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.70689950059396*^9, 3.706899501098318*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Permutation matrix", "Subsection",
 CellChangeTimes->{{3.680327984984622*^9, 3.680327987665279*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "transformation", " ", "matrix", " ", "from", 
     " ", "var2", " ", "to", " ", "var1", " ", 
     RowBox[{"i", ".", "e", ".", " ", "var1"}]}], "=", 
    RowBox[{"Perm", " ", "v2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PermuteVar", "[", 
    RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "nEqn", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nEqn", " ", "=", " ", 
       RowBox[{"Length", "[", "var1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"nEqn", ",", "nEqn"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", " ", "=", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"var2", ",", 
             RowBox[{"var1", "[", 
              RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "pos"}], "\[RightDoubleBracket]"}], "=", 
          "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", "nEqn"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.68032799203395*^9, 3.680328159490745*^9}, {
  3.680328224863463*^9, 3.680328228463756*^9}, {3.680328262829427*^9, 
  3.6803282757897787`*^9}, {3.6803283197812233`*^9, 3.680328410397325*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Final Routine", "Subsection",
 CellChangeTimes->{{3.70689908725886*^9, 3.7068990893035097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FinalMatrices3D", "[", 
   RowBox[{"Ntensors_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ax", ",", "Ay", ",", "Az", ",", "BC", ",", "varOdd", ",", "var", ",", 
      "B", ",", "Binflow", ",", "S", ",", "Shalf", ",", "ShalfInv", ",", 
      "nEqn", ",", "varEven", ",", "varRearranged", ",", "PermuteMatrix", ",",
       "PermuteMatInv", ",", "EntropyMat", ",", "Soe", ",", "Sigma", ",", 
      "Boe", ",", "Boeinflow", ",", "OnsagerMat", ",", "OnsagerMatInflow", 
      ",", "filenameAx", ",", "\[IndentingNewLine]", "filenameAy", ",", 
      "filenameAz", ",", "filenameB", ",", "filenameOddID", ",", 
      "filenameSigma", ",", "\[IndentingNewLine]", "filenameBinflow", ",", 
      "percision"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Ax", ",", "Ay", ",", "Az", ",", "BC", ",", "var", ",", "varOdd"}], 
       "}"}], "=", 
      RowBox[{"GetMatrices3D", "[", 
       RowBox[{"Ntensors", ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"var", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"w", ",", "#"}], "]"}], "&"}], ",", "var"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nEqn", " ", "=", " ", 
      RowBox[{"Length", "[", "Ax", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varEven", " ", "=", " ", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "nEqn"}], "]"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], ",", "varOdd"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"varRearranged", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
         "var", "\[LeftDoubleBracket]", "varOdd", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
         "var", "\[LeftDoubleBracket]", "varEven", 
          "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"B", "=", " ", 
      RowBox[{"DevelopBC", "[", 
       RowBox[{"BC", ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Binflow", " ", "=", " ", 
      RowBox[{"DevelopBCInflow", "[", 
       RowBox[{"BC", ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"GenerateSymmetrizer3D", "[", 
       RowBox[{"Ntensors", ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Shalf", " ", "=", " ", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"S", ",", "0.5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ShalfInv", " ", "=", " ", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{"S", ",", 
        RowBox[{"-", "0.5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"var", " ", "=", " ", 
       RowBox[{"PermuteMatrix", ".", "varRearranged"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"PermuteMatrix", " ", "=", " ", 
      RowBox[{"PermuteVar", "[", 
       RowBox[{"var", ",", "varRearranged"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"varRearranged", " ", "=", " ", 
       RowBox[{"PermuteMatInv", ".", "var"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PermuteMatInv", "=", 
      RowBox[{"PermuteVar", "[", 
       RowBox[{"varRearranged", ",", "var"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"EntropyMat", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "PermuteMatrix", "]"}], ".", "S", ".", "Ax", 
       ".", "PermuteMatrix"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Soe", " ", "=", " ", 
      RowBox[{"EntropyMat", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"Length", "[", "varOdd", "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Length", "[", "varEven", "]"}]}], ";;", 
         RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Penalty", " ", "matrix", " ", "for", " ", "the", " ", "weak", " ", 
       "implementation", " ", "of", " ", "the", " ", "boundary", " ", 
       "conditions"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Sigma", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "PermuteMatInv", "]"}], ".", 
       RowBox[{"EntropyMat", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", 
          RowBox[{"Length", "[", "varOdd", "]"}]}]}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Permute", " ", "B", " ", "using", " ", "even", " ", "and", " ", "odd", 
       " ", "splitting"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"B", ".", "PermuteMatrix"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Binflow", " ", "=", " ", 
      RowBox[{"Binflow", ".", "PermuteMatrix"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"Boe", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"B", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "varOdd", "]"}]}]}], 
          "\[RightDoubleBracket]"}], "]"}], ".", 
        RowBox[{"B", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "varOdd", "]"}], "+", "1"}], ";;", 
           RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Boeinflow", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Binflow", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "varOdd", "]"}]}]}], 
          "\[RightDoubleBracket]"}], "]"}], ".", 
        RowBox[{"Binflow", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "varOdd", "]"}], "+", "1"}], ";;", 
           RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"OnsagerMat", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Boe", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"1", ";;", 
           RowBox[{"Length", "[", "Boe", "]"}]}]}], "\[RightDoubleBracket]"}],
         ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Soe", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "Soe", "]"}]}]}], 
          "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OnsagerMatInflow", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Boeinflow", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"1", ";;", 
           RowBox[{"Length", "[", "Boeinflow", "]"}]}]}], 
         "\[RightDoubleBracket]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Soe", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"1", ";;", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "Soe", "]"}]}]}], 
          "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Now", " ", "we", " ", "fix", " ", "the", " ", "normal", " ", 
       "velocity", " ", "by", " ", "considering", " ", "the", " ", "first", 
       " ", "row", " ", "of", " ", "Soe", " ", "to", " ", "be", " ", "the", 
       " ", "boundary", " ", "condition", " ", "for", " ", "the", " ", 
       "normal", " ", "velocity"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OnsagerMat", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"CheckSPD", "[", 
        RowBox[{"OnsagerMat", ",", "\"\<Onsager Mat\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckSPD", "[", 
        RowBox[{"OnsagerMatInflow", ",", "\"\<Onsager Mat Inflow\>\""}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Finally", " ", "we", " ", "have", " ", "the", " ", "new", " ", 
        "boundary", " ", "conditions", " ", "in", " ", "the", " ", "form", 
        " ", "Uo"}], " ", "=", " ", 
       RowBox[{"Boe", " ", "Ue"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Boe", "=", 
      RowBox[{"OnsagerMat", ".", "Soe"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Boeinflow", " ", "=", " ", 
      RowBox[{"OnsagerMatInflow", ".", "Soe"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"B", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Length", "[", "varOdd", "]"}]}]}], 
       "\[RightDoubleBracket]"}], "=", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "varOdd", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"B", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "varOdd", "]"}], "+", "1"}], ";;", 
         RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"-", "Boe"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Binflow", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Length", "[", "varOdd", "]"}]}]}], 
       "\[RightDoubleBracket]"}], "=", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"Length", "[", "varOdd", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Binflow", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "varOdd", "]"}], "+", "1"}], ";;", 
         RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"-", "Boeinflow"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"B", ".", "PermuteMatInv"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Binflow", "=", 
      RowBox[{"Binflow", ".", "PermuteMatInv"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Null Space Condition\>\"", ",", 
          RowBox[{"FontColor", "\[Rule]", "Magenta"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CheckNullSpaceInclusion", "[", 
        RowBox[{"B", ",", "Ax"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"BoundaryMatrices", "[", 
        RowBox[{
         RowBox[{"Shalf", ".", "Ax", ".", "ShalfInv"}], ",", 
         RowBox[{"B", ".", "ShalfInv"}], ",", "nEqn"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"filenameAx", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<A1_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameAy", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<A2_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameAz", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<A3_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameB", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<B_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameOddID", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<odd_ID_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameSigma", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<Sigma_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameBinflow", " ", "=", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<Binflow_3D_\>\"", ",", 
        RowBox[{"ToString", "[", "nEqn", "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"percision", "=", "16"}], ";", "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Ax", ",", "percision"}], "]"}], ",", "filenameAx"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Ay", ",", "percision"}], "]"}], ",", "filenameAy"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Az", ",", "percision"}], "]"}], ",", "filenameAz"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"B", ",", "percision"}], "]"}], ",", "filenameB"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"writeVector", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"varOdd", ",", "percision"}], "]"}], ",", "filenameOddID"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Sigma", ",", "percision"}], "]"}], ",", "filenameSigma"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{"filenameBinflow", ",", 
        RowBox[{"FontColor", "\[Rule]", "Magenta"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Binflow", ",", "percision"}], "]"}], ",", 
       "filenameBinflow"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "B", ",", "Binflow", ",", "var", ",", 
       "varOdd"}], "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.706898291677534*^9, 3.706898361136879*^9}, {
   3.70689840655457*^9, 3.706898455024098*^9}, {3.706898528945284*^9, 
   3.706898639028118*^9}, {3.7068987032852497`*^9, 3.706898709470127*^9}, {
   3.706898773872024*^9, 3.7068989170286283`*^9}, {3.706898959118149*^9, 
   3.706899052705182*^9}, {3.706899113795452*^9, 3.7068992353267107`*^9}, {
   3.7068992857764874`*^9, 3.7068993996068573`*^9}, {3.7068994444388437`*^9, 
   3.706899444792417*^9}, {3.706899827866371*^9, 3.706899830692712*^9}, {
   3.70690001109408*^9, 3.706900063776382*^9}, {3.70690022995508*^9, 
   3.70690026946878*^9}, 3.7069003043918037`*^9, 3.706900462211639*^9, {
   3.706900596815346*^9, 3.706900606555875*^9}, {3.706900904114937*^9, 
   3.706900983218504*^9}, {3.7069010628991823`*^9, 3.706901065159358*^9}, {
   3.706901104793578*^9, 3.7069011213567657`*^9}, {3.706901197314809*^9, 
   3.706901199073554*^9}, {3.7069012400939207`*^9, 3.706901262254469*^9}, {
   3.706902034190754*^9, 3.706902042952503*^9}, {3.70693569707165*^9, 
   3.706935698054179*^9}, {3.706941608998479*^9, 3.7069417621747503`*^9}, 
   3.706941826829961*^9, {3.7072240141983128`*^9, 3.707224020960636*^9}, {
   3.707307392675474*^9, 3.7073073979414177`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Production Terms", "Subsection",
 CellChangeTimes->{{3.706952401125399*^9, 3.706952403612158*^9}}],

Cell[CellGroupData[{

Cell["Develop Matrix from Triplet", "Subsubsection",
 CellChangeTimes->{{3.7069528945190153`*^9, 3.706952899899891*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatfromTriplet", "[", 
   RowBox[{"Row_", ",", "Col_", ",", "Val_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mat", ",", 
      RowBox[{"precision", "=", "16"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mat", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "Row", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "Col", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}], 
           "}"}], "\[Rule]", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{
            "Val", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            ",", "precision"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "Row", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "mat"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.706952961110161*^9, 3.706952963715104*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production term Matrix", "Subsubsection",
 CellChangeTimes->{{3.7069529215818853`*^9, 3.706952929380528*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProductionMM", "[", "var_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Row", ",", "Col", ",", "Val", ",", "result", ",", "filename"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "first", " ", "5", " ", "variables", " ", "are", " ", "the", 
      " ", "conserved", " ", "ones"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"row", " ", "indices"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Row", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"6", ",", 
        RowBox[{"Length", "[", "var", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Col", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"6", ",", 
        RowBox[{"Length", "[", "var", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "values", " ", "of", " ", "the", " ", "prodution", " ", "terms"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Val", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RelaxationRate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "6", ",", 
          RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"MatfromTriplet", "[", 
       RowBox[{"Row", ",", "Col", ",", "Val"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"filename", " ", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<MM_P_3D_\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "var", "]"}], "]"}], ",", "\"\<.txt\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"developsparsity2", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"result", ",", "16"}], "]"}], ",", "filename"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.706952492726486*^9, 3.706952599547318*^9}, {
  3.706952643805915*^9, 3.7069526438765917`*^9}, {3.706952708752337*^9, 
  3.706952743399866*^9}, {3.7069527817609863`*^9, 3.706952888660912*^9}, {
  3.706952935901987*^9, 3.706952994432269*^9}, {3.706953028067327*^9, 
  3.706953076915023*^9}, {3.70695317882167*^9, 3.706953245763342*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing Routines", "Section",
 CellChangeTimes->{{3.706939481295164*^9, 3.7069394837340593`*^9}}],

Cell[CellGroupData[{

Cell["Trial Matrices", "Subsection",
 CellChangeTimes->{{3.706940590266222*^9, 3.706940592568643*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
     "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
   RowBox[{"FinalMatrices3D", "[", 
    RowBox[{"6", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.706940563850215*^9, 3.7069405836489077`*^9}}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_20.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706940584177647*^9, 3.7069787313725147`*^9, 
  3.707224060264296*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking the Projector", "Subsection",
 CellChangeTimes->{{3.706935108415584*^9, 3.706935112317752*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Trialn", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Trialn", " ", "=", " ", 
     FractionBox["Trialn", 
      RowBox[{"Norm", "[", "Trialn", "]"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Trialt", ",", "Trialr"}], "}"}], "=", 
     RowBox[{"LocalCoordinates", "[", "Trialn", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"InvVecn", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Trialn", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "Trialt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "Trialr", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"InvVect", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Trialn", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "Trialt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "Trialr", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"InvVecr", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "Trialn", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "Trialt", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
       
       RowBox[{
       "Trialr", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<n.t\>\"", ",", 
       RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Trialn", ".", "Trialt"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<r.t\>\"", ",", 
       RowBox[{"FontColor", "\[Rule]", "Black"}]}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Trialr", ".", "Trialt"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"TrialProj", " ", "=", " ", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"GenerateProjector3D", "[", 
        RowBox[{"6", ",", "3"}], "]"}], "/.", 
       RowBox[{"ReplacementList", "[", 
        RowBox[{"Trialn", ",", "Trialt", ",", "Trialr"}], "]"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"InvTrialProj", "=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"GenerateProjector3D", "[", 
         RowBox[{"6", ",", "3"}], "]"}], "]"}], "/.", 
       RowBox[{"ReplacementList", "[", 
        RowBox[{"InvVecn", ",", "InvVect", ",", "InvVecr"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Rotational Invariance\>\"", ",", 
       RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"InvTrialProj", ".", "TrialAx", ".", "TrialProj"}], " ", "-", 
        " ", 
        RowBox[{"TrialAx", " ", 
         RowBox[{
         "Trialn", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "-", 
        RowBox[{"TrialAy", " ", 
         RowBox[{
         "Trialn", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "-", 
        RowBox[{"TrialAz", " ", 
         RowBox[{
         "Trialn", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}],
        "]"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "1", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706935138440701*^9, 3.706935147399735*^9}, {
  3.706935702335464*^9, 3.706935703668076*^9}, {3.7069406089789867`*^9, 
  3.706940835305357*^9}, {3.706940888237455*^9, 3.706941143253171*^9}, {
  3.706983918088853*^9, 3.706984014511002*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"n.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.70722406038301*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.7072240603926287`*^9}],

Cell[BoxData[
 StyleBox["\<\"r.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060414514*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060428664*^9}],

Cell[BoxData[
 StyleBox["\<\"Rotational Invariance\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.70722406044419*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060457099*^9}],

Cell[BoxData[
 StyleBox["\<\"n.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060473167*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060487874*^9}],

Cell[BoxData[
 StyleBox["\<\"r.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.7072240605040903`*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.7072240605190153`*^9}],

Cell[BoxData[
 StyleBox["\<\"Rotational Invariance\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.7072240605351667`*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060551383*^9}],

Cell[BoxData[
 StyleBox["\<\"n.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060563458*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060576247*^9}],

Cell[BoxData[
 StyleBox["\<\"r.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060592852*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060606202*^9}],

Cell[BoxData[
 StyleBox["\<\"Rotational Invariance\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.70722406061747*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060628894*^9}],

Cell[BoxData[
 StyleBox["\<\"n.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060640082*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060651269*^9}],

Cell[BoxData[
 StyleBox["\<\"r.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.70722406066256*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.7072240606737413`*^9}],

Cell[BoxData[
 StyleBox["\<\"Rotational Invariance\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.7072240606850357`*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060696672*^9}],

Cell[BoxData[
 StyleBox["\<\"n.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060707855*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060719078*^9}],

Cell[BoxData[
 StyleBox["\<\"r.t\"\>",
  StripOnInput->False,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060730197*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060768401*^9}],

Cell[BoxData[
 StyleBox["\<\"Rotational Invariance\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060779963*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{{3.7069409864957447`*^9, 3.706941043826874*^9}, {
   3.706941110693473*^9, 3.7069411437792*^9}, 3.706978737409058*^9, {
   3.7069839889999123`*^9, 3.7069840147980757`*^9}, 3.707224060791422*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking the Symmetrizer", "Subsection",
 CellChangeTimes->{{3.706941160284952*^9, 3.7069411690995703`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TrialS", " ", "=", " ", 
   RowBox[{"GenerateSymmetrizer3D", "[", 
    RowBox[{"6", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialSAx", " ", "=", " ", 
   RowBox[{"TrialS", ".", "TrialAx"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialSAy", " ", "=", " ", 
   RowBox[{"TrialS", ".", "TrialAy"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialSAz", " ", "=", " ", 
   RowBox[{"TrialS", ".", "TrialAz"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.70694117045542*^9, 3.7069412056934566`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Norm", "[", 
  RowBox[{"TrialSAx", "-", 
   RowBox[{"Transpose", "[", "TrialSAx", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{"TrialSAy", "-", 
   RowBox[{"Transpose", "[", "TrialSAy", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{"TrialSAz", "-", 
   RowBox[{"Transpose", "[", "TrialSAz", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.706941210667018*^9, 3.706941241686472*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.706941242128784*^9, 3.707224060863947*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.706941242128784*^9, 3.7072240608722343`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.706941242128784*^9, 3.707224060879695*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results", "Title",
 CellChangeTimes->{{3.707223979455613*^9, 3.707223980229142*^9}}],

Cell[CellGroupData[{

Cell["Results", "Section",
 CellChangeTimes->{{3.706941785456902*^9, 3.706941786263466*^9}}],

Cell[CellGroupData[{

Cell["G20", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
     "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
   RowBox[{"FinalMatrices3D", "[", 
    RowBox[{"6", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.706953138694345*^9, 3.706953152212236*^9}}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_20.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.70694183439056*^9, 3.706953153428626*^9, 
  3.706953627043118*^9, 3.707049072814831*^9, 3.707224072190878*^9, 
  3.7073074584821587`*^9, 3.707314077322424*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G26", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
     "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
   RowBox[{"FinalMatrices3D", "[", 
    RowBox[{"8", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706953635684238*^9, 3.706953635981244*^9}}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_26.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.70694183439056*^9, 3.706942080363449*^9, 
  3.706953637948739*^9, 3.707224079239052*^9, 3.7073074592515783`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G35", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"9", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_35.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.70694183439056*^9, 3.706942080363449*^9, 
  3.7069424287869177`*^9, 3.70695364475703*^9, 3.7072240855922003`*^9, 
  3.70730746086826*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Trialvar"], "Input",
 CellChangeTimes->{{3.7069419164843397`*^9, 3.706941917627962*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "3", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "2", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "4", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "3", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "3", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "3", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "2", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "4", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "3", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.706941918166306*^9, 3.70694208506052*^9, 
  3.706942431554439*^9, 3.707224085660387*^9, 3.707307460951994*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G45", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}, {3.7069567558630667`*^9, 3.7069567563441143`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"11", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}, {3.706956766713423*^9, 3.706956768311955*^9}}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", \
SqrtBox[\\\"2\\\"]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"15\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", RowBox[{\\\"3\\\", \\\" \\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", RowBox[{RowBox[{FractionBox[\\\"1\\\", \\\"3\\\"], \\\" \
\\\", SqrtBox[FractionBox[\\\"2\\\", RowBox[{\\\"21\\\", \\\" \\\", \\\"\[Pi]\
\\\"}]]]}], \\\"-\\\", FractionBox[\\\"17\\\", RowBox[{\\\"3\\\", \\\" \\\", \
SqrtBox[RowBox[{\\\"42\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", FractionBox[\\\"16\\\", RowBox[{\\\"27\\\", \\\" \\\", \
SqrtBox[\\\"\[Pi]\\\"]}]], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,1125,
   113,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.707224089880763*^9, 3.7073074640228653`*^9}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_45.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706956781471635*^9, 3.707224089923441*^9, 
  3.707307464036356*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Trialvar"], "Input",
 CellChangeTimes->{{3.7069419164843397`*^9, 3.706941917627962*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "3", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "2", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "4", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "3", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "3", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "3", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "1", ",", "2", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "4", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"0", ",", "0", ",", "3", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "3", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "3", ",", "0"}], "]"}], ",", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.706941918166306*^9, 3.70694208506052*^9, 
  3.706942431554439*^9, 3.707224089987054*^9, 3.70730746413899*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G56", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}, {3.7069567558630667`*^9, 3.7069567563441143`*^9}, {
  3.7069567893859663`*^9, 3.706956790056671*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"12", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}, {3.706956766713423*^9, 3.706956768311955*^9}, {
  3.706956809179194*^9, 3.706956809289912*^9}}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", \
SqrtBox[\\\"2\\\"]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"6\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\
\[Pi]\\\"]]}], \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"43\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"6\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"19\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", RowBox[{\\\"3\\\", \\\" \\\", \
SqrtBox[RowBox[{\\\"30\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"6\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,1128,114,
   19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956816252301*^9, 3.7072241019140873`*^9, 3.7073074728568077`*^9}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_56.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706956781471635*^9, 3.7069568159737988`*^9, 
  3.7072241019387007`*^9, 3.7073074728746157`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G71", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}, {3.7069567558630667`*^9, 3.7069567563441143`*^9}, {
  3.706956832219182*^9, 3.7069568329060993`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"15", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}, {3.706956766713423*^9, 3.706956768311955*^9}, {
  3.706956849356389*^9, 3.70695684983531*^9}}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", \
SqrtBox[\\\"2\\\"]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"21\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"21\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"24\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\
\\\", \\\"14\\\"]}], \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", RowBox[{\\\"22\
\\\", \\\" \\\", \\\"\[Pi]\\\"}]]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"30\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{RowBox[{FractionBox[\\\"83\\\", \\\"441\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"2\\\", RowBox[{\\\"11\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\"-\\\", FractionBox[\\\"3125\\\", \
RowBox[{\\\"882\\\", \\\" \\\", SqrtBox[RowBox[{\\\"22\\\", \\\" \\\", \\\"\
\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{FractionBox[\\\"5\\\", \\\"231\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"5\\\", RowBox[{\\\"11\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"21\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,1130,115,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.707224111498061*^9, 3.70730748429071*^9}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_71.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706956781471635*^9, 3.706956859412837*^9, 
  3.7072241115199413`*^9, 3.7073074843107653`*^9}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"\[Pi]\\\"]]}], \\\",\\\", \\\"1\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", FractionBox[\\\"1\\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]], \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\[Pi]\\\"]]}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"2\\\"]}], \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", RowBox[{\\\"5\\\", \\\
\" \\\", \\\"\[Pi]\\\"}]]]}], \\\"+\\\", FractionBox[\\\"2\\\", \
SqrtBox[RowBox[{\\\"15\\\", \\\" \\\", \\\"\[Pi]\\\"}]]]}], \\\",\\\", \
RowBox[{RowBox[{FractionBox[\\\"6\\\", \\\"5\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"2\\\", RowBox[{\\\"7\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\"-\\\", FractionBox[SqrtBox[FractionBox[\\\"14\\\", \
\\\"\[Pi]\\\"]], \\\"5\\\"], \\\"-\\\", FractionBox[\\\"3\\\", \
RowBox[{\\\"5\\\", \\\" \\\", SqrtBox[RowBox[{\\\"14\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"2\\\", \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", \\\"\
\[Pi]\\\"]]}], \\\"5\\\"]}], \\\"+\\\", FractionBox[\\\"17\\\", \
RowBox[{\\\"10\\\", \\\" \\\", SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"21\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"26\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \\\"14\\\"]}], \\\" \\\", \
SqrtBox[FractionBox[\\\"3\\\", RowBox[{\\\"22\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"38\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{FractionBox[\\\"5\\\", \\\"231\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"5\\\", RowBox[{\\\"11\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"21\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,1130,116,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.707224111498061*^9, 3.7073074843625107`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G84", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}, {3.7069567558630667`*^9, 3.7069567563441143`*^9}, {
  3.706956832219182*^9, 3.7069568329060993`*^9}, {3.706956924797134*^9, 
  3.706956925956312*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"16", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}, {3.706956766713423*^9, 3.706956768311955*^9}, {
  3.706956849356389*^9, 3.70695684983531*^9}, {3.7069569285658712`*^9, 
  3.706956928917832*^9}}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", \
SqrtBox[\\\"2\\\"]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\
\[Pi]\\\"]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"42\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"30\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
RowBox[{\\\"66\\\", \\\" \\\", SqrtBox[RowBox[{\\\"10\\\", \\\" \\\", \\\"\
\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"38\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", FractionBox[\\\"1\\\", RowBox[{\\\"264\\\", \\\" \\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]], \\\",\\\", \\\"0\\\
\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,
   1132,117,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.706956949588702*^9, 3.707224135021708*^9, 
   3.707307506539344*^9}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_84.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706956781471635*^9, 3.706956859412837*^9, 
  3.706956948972166*^9, 3.7072241351010523`*^9, 3.7073075065630608`*^9}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"\[Pi]\\\"]]}], \\\",\\\", \\\"1\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", FractionBox[\\\"1\\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]], \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\[Pi]\\\"]]}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"2\\\"]}], \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", RowBox[{\\\"5\\\", \\\
\" \\\", \\\"\[Pi]\\\"}]]]}], \\\"+\\\", FractionBox[\\\"2\\\", \
SqrtBox[RowBox[{\\\"15\\\", \\\" \\\", \\\"\[Pi]\\\"}]]]}], \\\",\\\", \
RowBox[{RowBox[{FractionBox[\\\"6\\\", \\\"5\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"2\\\", RowBox[{\\\"7\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\"-\\\", FractionBox[SqrtBox[FractionBox[\\\"14\\\", \
\\\"\[Pi]\\\"]], \\\"5\\\"], \\\"-\\\", FractionBox[\\\"3\\\", \
RowBox[{\\\"5\\\", \\\" \\\", SqrtBox[RowBox[{\\\"14\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"2\\\", \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", \\\"\
\[Pi]\\\"]]}], \\\"5\\\"]}], \\\"+\\\", FractionBox[\\\"17\\\", \
RowBox[{\\\"10\\\", \\\" \\\", SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"31\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", \
FractionBox[\\\"1\\\", RowBox[{\\\"66\\\", \\\" \\\", \
SqrtBox[RowBox[{\\\"10\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"39\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", FractionBox[\\\"1\\\", RowBox[{\\\"264\\\", \\\" \\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]], \\\",\\\", \\\"0\\\
\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"34\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,
   1132,118,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.706956949588702*^9, 3.707224135021708*^9, 
   3.707307506592173*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G105", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}, {3.7069567558630667`*^9, 3.7069567563441143`*^9}, {
  3.706956832219182*^9, 3.7069568329060993`*^9}, {3.706956924797134*^9, 
  3.706956925956312*^9}, {3.706956959935111*^9, 3.7069569607895937`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"19", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}, {3.706956766713423*^9, 3.706956768311955*^9}, {
  3.706956849356389*^9, 3.70695684983531*^9}, {3.7069569285658712`*^9, 
  3.706956928917832*^9}, {3.706956967464632*^9, 3.706956967830909*^9}}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", \
SqrtBox[\\\"2\\\"]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"55\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\
\[Pi]\\\"]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"42\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"55\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"39\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", RowBox[{\\\"2\\\", \\\" \
\\\", SqrtBox[RowBox[{\\\"195\\\", \\\" \\\", \\\"\[Pi]\\\"}]]}]]}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"55\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \
\\\"}\\\"}]\\).\"",2,1134,119,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.706956949588702*^9, 3.706957005165524*^9, 
   3.707224168922431*^9, 3.70730753762222*^9}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_105.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706956781471635*^9, 3.706956859412837*^9, 
  3.706956948972166*^9, 3.7069570016052837`*^9, 3.707224168961478*^9, 
  3.707307537698017*^9}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"\[Pi]\\\"]]}], \\\",\\\", \\\"1\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", FractionBox[\\\"1\\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]], \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\[Pi]\\\"]]}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"2\\\"]}], \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", RowBox[{\\\"5\\\", \\\
\" \\\", \\\"\[Pi]\\\"}]]]}], \\\"+\\\", FractionBox[\\\"2\\\", \
SqrtBox[RowBox[{\\\"15\\\", \\\" \\\", \\\"\[Pi]\\\"}]]]}], \\\",\\\", \
RowBox[{RowBox[{FractionBox[\\\"6\\\", \\\"5\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"2\\\", RowBox[{\\\"7\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\"-\\\", FractionBox[SqrtBox[FractionBox[\\\"14\\\", \
\\\"\[Pi]\\\"]], \\\"5\\\"], \\\"-\\\", FractionBox[\\\"3\\\", \
RowBox[{\\\"5\\\", \\\" \\\", SqrtBox[RowBox[{\\\"14\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"2\\\", \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", \\\"\
\[Pi]\\\"]]}], \\\"5\\\"]}], \\\"+\\\", FractionBox[\\\"17\\\", \
RowBox[{\\\"10\\\", \\\" \\\", SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"55\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"55\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"39\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"33\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"55\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \
\\\"}\\\"}]\\).\"",2,1134,120,19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.706956949588702*^9, 3.706957005165524*^9, 
   3.707224168922431*^9, 3.70730753773547*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G120", "Subsection",
 CellChangeTimes->{{3.706941793409205*^9, 3.706941794719562*^9}, {
  3.706942059377305*^9, 3.706942059759757*^9}, {3.7069424125242558`*^9, 
  3.7069424137050743`*^9}, {3.7069567558630667`*^9, 3.7069567563441143`*^9}, {
  3.706956832219182*^9, 3.7069568329060993`*^9}, {3.706956924797134*^9, 
  3.706956925956312*^9}, {3.706956959935111*^9, 3.7069569607895937`*^9}, {
  3.70695704530477*^9, 3.7069570458809*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TrialAx", ",", "TrialAy", ",", "TrialAz", ",", "TrialB", ",", 
      "TrialBinflow", ",", "Trialvar", ",", "TrialvarOdd"}], "}"}], "=", 
    RowBox[{"FinalMatrices3D", "[", 
     RowBox[{"20", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialProduction", "=", 
   RowBox[{"ProductionMM", "[", "Trialvar", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7069420787144823`*^9, 3.706942079296685*^9}, {
  3.706942426503188*^9, 3.70694242685139*^9}, {3.7069536423726587`*^9, 
  3.706953642885586*^9}, {3.706956766713423*^9, 3.706956768311955*^9}, {
  3.706956849356389*^9, 3.70695684983531*^9}, {3.7069569285658712`*^9, 
  3.706956928917832*^9}, {3.706956967464632*^9, 3.706956967830909*^9}, {
  3.706957050755652*^9, 3.706957051306057*^9}}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", \
SqrtBox[\\\"2\\\"]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"70\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\
\[Pi]\\\"]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"42\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"70\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"47\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"3\
\\\", \\\"286\\\"]}], \\\" \\\", SqrtBox[FractionBox[\\\"5\\\", RowBox[{\\\"7\
\\\", \\\" \\\", \\\"\[Pi]\\\"}]]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"18\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"70\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\).\"",2,1136,121,
   19580952476786720770,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.706956949588702*^9, 3.706957005165524*^9, 
   3.706957126030464*^9, 3.707224239507832*^9, 3.7073076124525623`*^9}],

Cell[BoxData[
 StyleBox["\<\"Binflow_3D_120.txt\"\>",
  StripOnInput->False,
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.706956781471635*^9, 3.706956859412837*^9, 
  3.706956948972166*^9, 3.7069570016052837`*^9, 3.706957124278913*^9, 
  3.7072242395471163`*^9, 3.7073076124913263`*^9}],

Cell[BoxData[
 TemplateBox[{
  "N","meprec",
   "\"Internal precision limit $MaxExtraPrecision = \\!\\(\\*RowBox[{\\\"50.`\
\\\"}]\\) reached while evaluating \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[FractionBox[\\\"2\\\", \\\"\[Pi]\\\"]]}], \\\",\\\", \\\"1\\\", \\\",\
\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", FractionBox[\\\"1\\\", \
SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \\\"\[Pi]\\\"}]]], \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"\[Pi]\\\"]]}], \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"2\\\"]}], \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", RowBox[{\\\"5\\\", \\\
\" \\\", \\\"\[Pi]\\\"}]]]}], \\\"+\\\", FractionBox[\\\"2\\\", \
SqrtBox[RowBox[{\\\"15\\\", \\\" \\\", \\\"\[Pi]\\\"}]]]}], \\\",\\\", \
RowBox[{RowBox[{FractionBox[\\\"6\\\", \\\"5\\\"], \\\" \\\", \
SqrtBox[FractionBox[\\\"2\\\", RowBox[{\\\"7\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]]}], \\\"-\\\", FractionBox[SqrtBox[FractionBox[\\\"14\\\", \
\\\"\[Pi]\\\"]], \\\"5\\\"], \\\"-\\\", FractionBox[\\\"3\\\", \
RowBox[{\\\"5\\\", \\\" \\\", SqrtBox[RowBox[{\\\"14\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"2\\\", \\\" \\\", SqrtBox[FractionBox[\\\"3\\\", \\\"\
\[Pi]\\\"]]}], \\\"5\\\"]}], \\\"+\\\", FractionBox[\\\"17\\\", \
RowBox[{\\\"10\\\", \\\" \\\", SqrtBox[RowBox[{\\\"3\\\", \\\" \\\", \
\\\"\[Pi]\\\"}]]}]]}], \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"70\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"49\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\).\"",2,1136,122,19580952476786720770,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7069567702980423`*^9, 3.7069567816566133`*^9}, 
   3.706956859898047*^9, 3.706956949588702*^9, 3.706957005165524*^9, 
   3.706957126030464*^9, 3.707224239507832*^9, 3.70730761257204*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1060, 710},
WindowMargins->{{64, Automatic}, {Automatic, 12}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 69, 1, 39, "Input"],
Cell[630, 23, 177, 3, 39, "Input"],
Cell[CellGroupData[{
Cell[832, 30, 104, 2, 39, "Input"],
Cell[939, 34, 189, 3, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1165, 42, 97, 1, 114, "Title"],
Cell[CellGroupData[{
Cell[1287, 47, 128, 1, 80, "Section"],
Cell[1418, 50, 26193, 665, 6258, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[27648, 720, 103, 1, 62, "Section"],
Cell[27754, 723, 141, 3, 60, "Input"],
Cell[27898, 728, 528, 12, 170, "Text"],
Cell[28429, 742, 28510, 729, 5831, "Input"],
Cell[56942, 1473, 5782, 139, 1457, "Input"],
Cell[62727, 1614, 1495, 39, 413, "Input"],
Cell[CellGroupData[{
Cell[64247, 1657, 566, 15, 158, "Input"],
Cell[64816, 1674, 5500, 143, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70353, 1822, 648, 16, 60, "Input"],
Cell[71004, 1840, 3405, 77, 147, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74446, 1922, 884, 19, 60, "Input"],
Cell[75333, 1943, 2434, 39, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77804, 1987, 472, 13, 102, "Input"],
Cell[78279, 2002, 2059, 32, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80375, 2039, 1206, 29, 265, "Input"],
Cell[81584, 2070, 2052, 34, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83673, 2109, 1391, 34, 265, "Input"],
Cell[85067, 2145, 2188, 36, 60, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[87304, 2187, 104, 1, 62, "Section"],
Cell[87411, 2190, 47705, 1168, 6212, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[135153, 3363, 240, 3, 62, "Section"],
Cell[135396, 3368, 705, 14, 318, "Text"],
Cell[136104, 3384, 8725, 198, 1971, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[144866, 3587, 94, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[144985, 3592, 170, 2, 54, "Subsection"],
Cell[145158, 3596, 576, 17, 96, "Input"],
Cell[145737, 3615, 2840, 72, 508, "Input"],
Cell[148580, 3689, 6285, 144, 1202, "Input"],
Cell[154868, 3835, 1965, 54, 225, "Input"],
Cell[156836, 3891, 12050, 282, 2052, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[168923, 4178, 114, 1, 43, "Subsection"],
Cell[169040, 4181, 9992, 258, 2012, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[179069, 4444, 120, 1, 43, "Subsection"],
Cell[179192, 4447, 11505, 288, 2500, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[190734, 4740, 107, 1, 43, "Subsection"],
Cell[190844, 4743, 3877, 92, 981, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194770, 4841, 172, 2, 80, "Section"],
Cell[194945, 4845, 6230, 136, 4315, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[201212, 4986, 97, 1, 62, "Section"],
Cell[201312, 4989, 457, 16, 77, "Input"],
Cell[CellGroupData[{
Cell[201794, 5009, 107, 1, 67, "Subsection"],
Cell[201904, 5012, 6603, 160, 1301, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[208544, 5177, 184, 2, 53, "Subsection"],
Cell[CellGroupData[{
Cell[208753, 5183, 440, 12, 60, "Input"],
Cell[209196, 5197, 290, 6, 60, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[209535, 5209, 114, 1, 53, "Subsection"],
Cell[209652, 5212, 6102, 150, 1200, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[215791, 5367, 131, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[215947, 5372, 460, 12, 675, "Input"],
Cell[216410, 5386, 333, 7, 210, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216780, 5398, 314, 5, 282, "Input"],
Cell[217097, 5405, 5338, 106, 210, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[222496, 5518, 374, 10, 61, "Section"],
Cell[222873, 5530, 987, 26, 445, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[223897, 5561, 100, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[224022, 5566, 103, 1, 83, "Subsection"],
Cell[224128, 5569, 14102, 329, 2743, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[238279, 5904, 102, 1, 62, "Section"],
Cell[238384, 5907, 1976, 48, 1470, "Input"],
Cell[240363, 5957, 794, 21, 695, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[241194, 5983, 108, 1, 62, "Section"],
Cell[241305, 5986, 1161, 37, 208, "Input"],
Cell[CellGroupData[{
Cell[242491, 6027, 99, 1, 83, "Subsection"],
Cell[242593, 6030, 3102, 105, 566, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[245732, 6140, 100, 1, 66, "Subsection"],
Cell[245835, 6143, 2138, 64, 238, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[248010, 6212, 93, 1, 66, "Subsection"],
Cell[248106, 6215, 1815, 42, 583, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[249958, 6262, 132, 1, 66, "Subsection"],
Cell[CellGroupData[{
Cell[250115, 6267, 287, 3, 66, "Subsubsection"],
Cell[250405, 6272, 6006, 133, 833, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[256448, 6410, 245, 3, 52, "Subsubsection"],
Cell[256696, 6415, 4247, 103, 875, "Input"],
Cell[CellGroupData[{
Cell[260968, 6522, 205, 4, 60, "Input"],
Cell[CellGroupData[{
Cell[261198, 6530, 250, 3, 45, "Print"],
Cell[261451, 6535, 221, 3, 45, "Print"],
Cell[261675, 6540, 304, 6, 45, "Print"],
Cell[261982, 6548, 252, 3, 45, "Print"],
Cell[262237, 6553, 221, 3, 45, "Print"],
Cell[262461, 6558, 304, 6, 45, "Print"],
Cell[262768, 6566, 252, 3, 45, "Print"],
Cell[263023, 6571, 220, 3, 45, "Print"],
Cell[263246, 6576, 306, 6, 45, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[263637, 6591, 124, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[263786, 6596, 133, 1, 54, "Subsection"],
Cell[263922, 6599, 14686, 355, 2475, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[278645, 6959, 224, 3, 43, "Subsection"],
Cell[278872, 6964, 2380, 67, 400, "Input"],
Cell[281255, 7033, 5687, 135, 1158, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[286979, 7173, 155, 2, 43, "Subsection"],
Cell[287137, 7177, 743, 21, 96, "Input"],
Cell[287883, 7200, 7833, 179, 1753, "Input"],
Cell[295719, 7381, 166, 2, 60, "Input"],
Cell[295888, 7385, 147, 2, 60, "Input"],
Cell[296038, 7389, 2194, 54, 495, "Input"],
Cell[298235, 7445, 342, 9, 60, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[298614, 7459, 178, 2, 43, "Subsection"],
Cell[298795, 7463, 8338, 186, 1447, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[307170, 7654, 123, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[307318, 7659, 106, 1, 66, "Subsubsection"],
Cell[307427, 7662, 8474, 165, 1947, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[315938, 7832, 111, 1, 52, "Subsubsection"],
Cell[316052, 7835, 6972, 144, 1825, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[323061, 7984, 167, 2, 52, "Subsubsection"],
Cell[323231, 7988, 10759, 224, 2475, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[334027, 8217, 100, 1, 52, "Subsubsection"],
Cell[334130, 8220, 3023, 76, 590, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[337202, 8302, 110, 1, 43, "Subsection"],
Cell[337315, 8305, 9756, 212, 1565, "Input"],
Cell[CellGroupData[{
Cell[347096, 8521, 892, 23, 143, "Input"],
Cell[CellGroupData[{
Cell[348013, 8548, 150, 2, 45, "Print"],
Cell[348166, 8552, 195, 4, 45, "Print"],
Cell[348364, 8558, 166, 2, 45, "Print"],
Cell[348533, 8562, 234, 5, 45, "Print"],
Cell[348770, 8569, 152, 2, 45, "Print"],
Cell[348925, 8573, 197, 4, 45, "Print"],
Cell[349125, 8579, 166, 2, 45, "Print"],
Cell[349294, 8583, 234, 5, 45, "Print"],
Cell[349531, 8590, 150, 2, 45, "Print"],
Cell[349684, 8594, 195, 4, 45, "Print"],
Cell[349882, 8600, 166, 2, 45, "Print"],
Cell[350051, 8604, 233, 5, 45, "Print"],
Cell[350287, 8611, 150, 2, 45, "Print"],
Cell[350440, 8615, 198, 4, 45, "Print"],
Cell[350641, 8621, 164, 2, 45, "Print"],
Cell[350808, 8625, 236, 5, 45, "Print"],
Cell[351047, 8632, 150, 2, 45, "Print"],
Cell[351200, 8636, 196, 4, 45, "Print"],
Cell[351399, 8642, 164, 2, 45, "Print"],
Cell[351566, 8646, 234, 5, 45, "Print"],
Cell[351803, 8653, 150, 2, 45, "Print"],
Cell[351956, 8657, 194, 4, 45, "Print"],
Cell[352153, 8663, 164, 2, 45, "Print"],
Cell[352320, 8667, 236, 5, 45, "Print"],
Cell[352559, 8674, 150, 2, 45, "Print"],
Cell[352712, 8678, 197, 4, 45, "Print"],
Cell[352912, 8684, 164, 2, 45, "Print"],
Cell[353079, 8688, 236, 5, 45, "Print"],
Cell[353318, 8695, 150, 2, 45, "Print"],
Cell[353471, 8699, 195, 4, 45, "Print"],
Cell[353669, 8705, 163, 2, 45, "Print"],
Cell[353835, 8709, 234, 5, 45, "Print"],
Cell[354072, 8716, 152, 2, 45, "Print"],
Cell[354227, 8720, 194, 4, 45, "Print"],
Cell[354424, 8726, 166, 2, 45, "Print"],
Cell[354593, 8730, 236, 5, 45, "Print"],
Cell[354832, 8737, 152, 2, 45, "Print"],
Cell[354987, 8741, 195, 4, 45, "Print"],
Cell[355185, 8747, 164, 2, 45, "Print"],
Cell[355352, 8751, 234, 5, 45, "Print"],
Cell[355589, 8758, 150, 2, 45, "Print"],
Cell[355742, 8762, 198, 4, 45, "Print"],
Cell[355943, 8768, 164, 2, 45, "Print"],
Cell[356110, 8772, 234, 5, 45, "Print"],
Cell[356347, 8779, 150, 2, 45, "Print"],
Cell[356500, 8783, 196, 4, 45, "Print"],
Cell[356699, 8789, 164, 2, 45, "Print"],
Cell[356866, 8793, 234, 5, 45, "Print"]
}, Open  ]]
}, Open  ]],
Cell[357127, 8802, 91, 1, 60, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[357255, 8808, 118, 1, 43, "Subsection"],
Cell[357376, 8811, 11458, 263, 1262, "Input"],
Cell[CellGroupData[{
Cell[368859, 9078, 904, 28, 118, "Input"],
Cell[CellGroupData[{
Cell[369788, 9110, 181, 4, 29, "Print"],
Cell[369972, 9116, 179, 4, 29, "Print"],
Cell[370154, 9122, 179, 4, 29, "Print"],
Cell[370336, 9128, 181, 4, 29, "Print"],
Cell[370520, 9134, 179, 4, 29, "Print"],
Cell[370702, 9140, 179, 4, 29, "Print"],
Cell[370884, 9146, 181, 4, 29, "Print"],
Cell[371068, 9152, 179, 4, 29, "Print"],
Cell[371250, 9158, 178, 4, 29, "Print"],
Cell[371431, 9164, 181, 4, 29, "Print"],
Cell[371615, 9170, 179, 4, 29, "Print"],
Cell[371797, 9176, 179, 4, 29, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[372037, 9187, 106, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[372168, 9192, 108, 1, 66, "Subsubsection"],
Cell[372279, 9195, 7090, 174, 1893, "Input"],
Cell[379372, 9371, 2327, 53, 631, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[381736, 9429, 116, 1, 52, "Subsubsection"],
Cell[381855, 9432, 8739, 195, 1740, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[390631, 9632, 168, 2, 52, "Subsubsection"],
Cell[390802, 9636, 11603, 272, 2418, "Input"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402466, 9915, 101, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[402592, 9920, 169, 2, 83, "Subsection"],
Cell[402764, 9924, 6437, 150, 2658, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[409238, 10079, 117, 1, 66, "Subsection"],
Cell[409358, 10082, 10417, 257, 11233, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[419812, 10344, 106, 1, 66, "Subsection"],
Cell[419921, 10347, 1910, 46, 2616, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[421868, 10398, 102, 1, 66, "Subsection"],
Cell[421973, 10401, 17059, 397, 3758, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[439069, 10803, 104, 1, 66, "Subsection"],
Cell[CellGroupData[{
Cell[439198, 10808, 120, 1, 197, "Subsubsection"],
Cell[439321, 10811, 1207, 33, 683, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[440565, 10849, 115, 1, 197, "Subsubsection"],
Cell[440683, 10852, 3345, 76, 2416, "Input"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[444089, 10935, 103, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[444217, 10940, 102, 1, 83, "Subsection"],
Cell[CellGroupData[{
Cell[444344, 10945, 364, 9, 246, "Input"],
Cell[444711, 10956, 209, 5, 210, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[444969, 10967, 110, 1, 66, "Subsection"],
Cell[CellGroupData[{
Cell[445104, 10972, 4790, 126, 2393, "Input"],
Cell[CellGroupData[{
Cell[449919, 11102, 312, 6, 87, "Print"],
Cell[450234, 11110, 243, 3, 87, "Print"],
Cell[450480, 11115, 313, 6, 87, "Print"],
Cell[450796, 11123, 241, 3, 87, "Print"],
Cell[451040, 11128, 335, 6, 87, "Print"],
Cell[451378, 11136, 241, 3, 87, "Print"],
Cell[451622, 11141, 313, 6, 87, "Print"],
Cell[451938, 11149, 241, 3, 87, "Print"],
Cell[452182, 11154, 315, 6, 87, "Print"],
Cell[452500, 11162, 243, 3, 87, "Print"],
Cell[452746, 11167, 338, 6, 87, "Print"],
Cell[453087, 11175, 241, 3, 87, "Print"],
Cell[453331, 11180, 313, 6, 87, "Print"],
Cell[453647, 11188, 241, 3, 87, "Print"],
Cell[453891, 11193, 313, 6, 87, "Print"],
Cell[454207, 11201, 241, 3, 87, "Print"],
Cell[454451, 11206, 335, 6, 87, "Print"],
Cell[454789, 11214, 241, 3, 87, "Print"],
Cell[455033, 11219, 313, 6, 87, "Print"],
Cell[455349, 11227, 241, 3, 87, "Print"],
Cell[455593, 11232, 312, 6, 87, "Print"],
Cell[455908, 11240, 243, 3, 87, "Print"],
Cell[456154, 11245, 338, 6, 87, "Print"],
Cell[456495, 11253, 241, 3, 87, "Print"],
Cell[456739, 11258, 313, 6, 87, "Print"],
Cell[457055, 11266, 241, 3, 87, "Print"],
Cell[457299, 11271, 313, 6, 87, "Print"],
Cell[457615, 11279, 241, 3, 87, "Print"],
Cell[457859, 11284, 336, 6, 87, "Print"],
Cell[458198, 11292, 241, 3, 87, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[458500, 11302, 114, 1, 66, "Subsection"],
Cell[458617, 11305, 585, 14, 695, "Input"],
Cell[CellGroupData[{
Cell[459227, 11323, 469, 12, 540, "Input"],
Cell[459699, 11337, 92, 1, 210, "Output"],
Cell[459794, 11340, 94, 1, 210, "Output"],
Cell[459891, 11343, 92, 1, 210, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[460056, 11352, 90, 1, 177, "Title"],
Cell[CellGroupData[{
Cell[460171, 11357, 92, 1, 125, "Section"],
Cell[CellGroupData[{
Cell[460288, 11362, 91, 1, 83, "Subsection"],
Cell[CellGroupData[{
Cell[460404, 11367, 493, 12, 143, "Input"],
Cell[460900, 11381, 299, 6, 45, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[461248, 11393, 140, 2, 66, "Subsection"],
Cell[CellGroupData[{
Cell[461413, 11399, 544, 13, 143, "Input"],
Cell[461960, 11414, 252, 5, 45, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[462261, 11425, 193, 3, 66, "Subsection"],
Cell[CellGroupData[{
Cell[462479, 11432, 640, 16, 183, "Input"],
Cell[463122, 11450, 277, 6, 45, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[463436, 11461, 102, 1, 60, "Input"],
Cell[463541, 11464, 3125, 74, 265, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[466715, 11544, 243, 3, 66, "Subsection"],
Cell[CellGroupData[{
Cell[466983, 11551, 687, 16, 183, "Input"],
Cell[467673, 11569, 3169, 44, 307, "Message"],
Cell[470845, 11615, 207, 5, 45, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[471089, 11625, 102, 1, 60, "Input"],
Cell[471194, 11628, 3964, 94, 346, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[475207, 11728, 294, 4, 66, "Subsection"],
Cell[CellGroupData[{
Cell[475526, 11736, 736, 17, 183, "Input"],
Cell[476265, 11755, 3361, 46, 281, "Message"],
Cell[479629, 11803, 235, 5, 45, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[479913, 11814, 294, 4, 66, "Subsection"],
Cell[CellGroupData[{
Cell[480232, 11822, 735, 17, 183, "Input"],
Cell[480970, 11841, 3489, 49, 350, "Message"],
Cell[484462, 11892, 233, 5, 45, "Print"],
Cell[484698, 11899, 3602, 51, 403, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[488349, 11956, 343, 5, 66, "Subsection"],
Cell[CellGroupData[{
Cell[488717, 11965, 786, 18, 356, "Input"],
Cell[489506, 11985, 3348, 47, 578, "Message"],
Cell[492857, 12034, 255, 5, 87, "Print"],
Cell[493115, 12041, 3839, 55, 731, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[497003, 12102, 392, 5, 66, "Subsection"],
Cell[CellGroupData[{
Cell[497420, 12111, 832, 18, 356, "Input"],
Cell[498255, 12131, 3547, 49, 578, "Message"],
Cell[501805, 12182, 279, 6, 87, "Print"],
Cell[502087, 12190, 3878, 55, 696, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[506014, 12251, 438, 6, 66, "Subsection"],
Cell[CellGroupData[{
Cell[506477, 12261, 881, 19, 183, "Input"],
Cell[507361, 12282, 3481, 48, 307, "Message"],
Cell[510845, 12332, 305, 6, 45, "Print"],
Cell[511153, 12340, 2901, 42, 293, "Message"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

