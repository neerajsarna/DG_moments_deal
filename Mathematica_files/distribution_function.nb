(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    191164,       4903]
NotebookOptionsPosition[    177081,       4551]
NotebookOutlinePosition[    177466,       4568]
CellTagsIndexPosition[    177423,       4565]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/neerajsarna/Dropbox/my_papers/Publications/entropy_stable_\
inflow_outflow/matrices\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.716402143217869*^9, 3.716402151629796*^9}, {
   3.716404292969915*^9, 3.716404314351687*^9}, 
   3.716404942290169*^9},ExpressionUUID->"b79c051c-2788-4eb4-9e68-\
4be2711bfe1d"],

Cell[BoxData["\<\"/Users/neerajsarna/Dropbox/my_papers/Publications/entropy_\
stable_inflow_outflow/matrices\"\>"], "Output",
 CellChangeTimes->{
  3.729936859822382*^9},ExpressionUUID->"f1d23f9f-830b-4739-9100-\
c3a253c9f6ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\"\</Users/neerajsarna/Dropbox/my_papers/Publications/entropy_\
stable_inflow_outflow/matrices\>\""], "Input",
 CellChangeTimes->{
  3.7299368576222982`*^9},ExpressionUUID->"e075c8d9-1965-4d21-a7af-\
9da65262129f"],

Cell[BoxData["\<\"/Users/neerajsarna/Dropbox/my_papers/Publications/entropy_\
stable_inflow_outflow/matrices\"\>"], "Output",
 CellChangeTimes->{{3.729936857707346*^9, 
  3.7299368624854803`*^9}},ExpressionUUID->"fa74f4f2-40e8-4256-88f0-\
98d058fae14d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Definitions", "Section",
 CellChangeTimes->{{3.569139429210832*^9, 3.569139448895958*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.679824089018515*^9},ExpressionUUID->"d3380932-9f3d-4aa6-938c-\
3f61a00ffef4"],

Cell["\<\
Mathematica build-in function like \[OpenCurlyQuote]Symmetrize[]\
\[CloseCurlyQuote] and \[OpenCurlyQuote]TensorContract[]\[CloseCurlyQuote] \
seem 
to work really slow or fail due to memory requirements on fully symmetric \
tensors 
with degree >10.
We define our own functions below based on a simply array data structure for \
fully symmetric tensors.\
\>", "Text",
 CellChangeTimes->{{3.5691393015045276`*^9, 3.5691394253246098`*^9}, {
  3.569230437595318*^9, 3.569230461117482*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "n", ",", "degree", ",", "idx", ",", "idx1", ",", "A", ",", "b", ",", "id3",
    ",", "IDX"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "TensorDegree", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Every", " ", "symmetric", " ", "tensor", " ", "can", " ", "be", " ", 
     "identified", " ", "with", " ", "the", " ", "help", " ", "of", " ", "a", 
     " ", "2", "D", " ", "array", " ", "say", " ", 
     RowBox[{
      RowBox[{"a", "[", "N", "]"}], "[", "3", "]"}], " ", "where", " ", "N", 
     " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "indepedent", " ", "variables", " ", "it", " ", 
     RowBox[{"has", ".", " ", "So"}], " ", "every", " ", "row", " ", "ie", 
     " ", 
     RowBox[{"a", "[", "i", "]"}], " ", "store", " ", "the", " ", "number", 
     " ", "of", " ", "entries", " ", "for", " ", "x", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}]}], ",", 
    RowBox[{"for", " ", "y", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}], " ", "and", " ", "for", 
     " ", "z", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "3", "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", "ii"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "the", " ", "same", " ", "thing", " ", "as", " ", "IDXFull", 
    " ", "but", " ", "for", " ", "trace", " ", "free", " ", "tensors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXtrfFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"ii", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IDX", "[", "degree", "]"}], "=", 
      RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDXtrf", "[", "degree", "]"}], "=", 
      RowBox[{"IDXtrfFull", "[", "degree", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "0", ",", "40"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"given", " ", "an", " ", "array", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "counts", " ", "the", " ", 
     "number", " ", "of", " ", "1", "s"}], ",", " ", 
    RowBox[{"2", "s", " ", "and", " ", "3", "s"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX1", "[", "list_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Input", " ", "cartesean", " ", "indices"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "3"}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "Total", " ", "of", " ", "the", " ", "list", " ", "is", " ", 
     "the", " ", "tensorial", " ", "degree", " ", "we", " ", "are", " ", 
     "interested", " ", 
     RowBox[{"in", ".", " ", "So"}], " ", "list", " ", "should", " ", "be", 
     " ", "a", " ", "3", "X1", " ", "array", " ", "and", " ", "the", " ", 
     "following", " ", "function", " ", "will", " ", "give", " ", "us", " ", 
     "the", " ", "n", " ", "corresponding", " ", "to", " ", "which", " ", 
     RowBox[{"a", "[", "n", "]"}]}], " ", "=", " ", 
    RowBox[{"list", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX2", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDX", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX3", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDXtrfFull", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "tensor", " ", "degree", " ", "of", " ", "a", 
    " ", "symmetric", " ", 
    RowBox[{"tensor", ".", "\[IndentingNewLine]", 
     RowBox[{"CAUTION", ":", " ", 
      RowBox[{
      "the", " ", "formulae", " ", "is", " ", "not", " ", "valid", " ", "for",
        " ", "trace", " ", "free", " ", 
       RowBox[{"tensors", "."}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorDegree", "[", "A_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         RowBox[{"Length", "[", "A", "]"}]}]}]]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"id3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaValues", "[", "list_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"b", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"c", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OddQ", "[", "a", "]"}], "||", 
         RowBox[{"OddQ", "[", "b", "]"}], "||", 
         RowBox[{"OddQ", "[", "c", "]"}]}], ",", "0", ",", 
        FractionBox[
         RowBox[{"Multinomial", "[", 
          RowBox[{
           FractionBox["a", "2"], ",", 
           FractionBox["b", "2"], ",", 
           FractionBox["c", "2"]}], "]"}], 
         RowBox[{"Multinomial", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "applied", " ", "deltavalues", " ", "to", " ", "all", " ", "the", " ", 
    "components", " ", "of", " ", "an", " ", "even", " ", "degree", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor2", "[", 
     RowBox[{"degree_", "?", "EvenQ"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"DeltaValues", ",", 
      RowBox[{"IDX", "[", "degree", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"What", " ", "does", " ", "this", " ", 
    RowBox[{"do", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTrace2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX2", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IDX", "[", 
                   RowBox[{"degree", "-", "2"}], "]"}], 
                  "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTraces", "[", 
     RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", "=", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"SymTrace2", "[", "res", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Assumes", " ", "3", " ", 
     RowBox[{"dimensions", ".", " ", "And"}], " ", "so"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contraction", " ", "of", " ", "a", " ", "symmetric", " ", "tensor", " ", 
    "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymDot2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Lets", " ", "take", " ", "a", " ", "particular", " ", "term", " ",
             "say", " ", "Ai1i2"}], ".."}], 
          RowBox[{"xbx", ".", " ", "In"}], " ", "the", " ", "result", " ", 
          "only", " ", "those", " ", "components", " ", "will", " ", "appear",
           " ", "in", " ", "which", " ", "x", " ", "atleast", " ", "appears", 
          " ", "once", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "why", " ", "the", " ", "addition",
           " ", "of", " ", 
          RowBox[{"id3", "[", 
           RowBox[{"[", "iis", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"toIDX2", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IDX", "[", 
                    RowBox[{"degree", "-", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                  "+", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "]"}], 
                "\[RightDoubleBracket]"}], 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "full", " ", "contraction", " ", "of", " ", "two", " ", "symmetric", " ", 
     "tensors", " ", "A"}], ",", " ", 
    RowBox[{"B", " ", "with", " ", "same", " ", "degree"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymFullDot", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TensorDegree", "[", "B", "]"}], "\[NotEqual]", "degree"}], 
         ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"idx", "=", 
           RowBox[{
            RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", "jj",
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "+=", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
              "]"}], 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{
            "B", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProduct2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"degree", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"degree", "+", "1"}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "1"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "b", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProductDelta2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"degree", "+", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"degree", "+", "1"}], ")"}]}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "2"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[GreaterEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}], 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "converts", " ", "a", " ", "symmetric", " ", "tensor", " ", "into", " ", 
    "a", " ", "trace", " ", "free", " ", "tensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "returns", " ", "the", " ", "tracefree", " ", "part", " ", "of", " ", "a",
      " ", "symmetric", " ", "tensor"}], ",", " ", 
    RowBox[{"but", " ", "with", " ", "all", " ", "components"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymTracefree", "[", "A_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
       RowBox[{"degree", "=", 
        RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", "res", 
       ",", "trace", ",", "res1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"trace", "=", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"trace", "=", 
           RowBox[{"SymTrace2", "[", "trace", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"res1", "=", 
            RowBox[{"SymProductDelta2", "[", "res1", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ll", ",", "1", ",", "kk"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "kk"], 
               RowBox[{"degree", "!"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"degree", "-", 
                  RowBox[{"2", "kk"}]}], ")"}], "!"}], 
               SuperscriptBox["2", "kk"], 
               RowBox[{"kk", "!"}]}]], 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"jj", "=", 
                RowBox[{"degree", "-", "kk"}]}], 
               RowBox[{"degree", "-", "1"}]], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", "jj"}], "+", "1"}]]}]}], ")"}], "res1"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"degree", "/", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5977647060562134`*^9, 3.5977647268750763`*^9}, {
   3.597764982828605*^9, 3.5977649884363317`*^9}, {3.676179501293851*^9, 
   3.6761796856337767`*^9}, {3.676179724780055*^9, 3.6761797401819553`*^9}, {
   3.6761800693011913`*^9, 3.67618009071702*^9}, {3.67618055987227*^9, 
   3.676180688136693*^9}, {3.676180727497422*^9, 3.676180773976479*^9}, {
   3.676181010436315*^9, 3.676181034457363*^9}, {3.676182895833144*^9, 
   3.676182910871441*^9}, {3.676183029280117*^9, 3.676183040299528*^9}, {
   3.676183109751354*^9, 3.676183133647092*^9}, {3.676184105172339*^9, 
   3.676184107563058*^9}, {3.676184447780569*^9, 3.676184559506366*^9}, 
   3.676184625341688*^9, {3.6761850010521708`*^9, 3.676185035780895*^9}, {
   3.6763163148181763`*^9, 3.676316347073567*^9}, {3.676316864163743*^9, 
   3.676316876694518*^9}},ExpressionUUID->"f1155200-b7fd-4445-b0c9-\
5ac00a2f7277"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trfEvaluate", "[", 
     RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "m", ",", 
        RowBox[{"dim", "=", "3"}], ",", 
        RowBox[{"degree", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", 
          "2"}]}], ",", "length", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "list"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"c", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"toIDX3", "[", "list", "]"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Binomial", "[", 
               RowBox[{"m", ",", "i"}], "]"}], 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX3", "[", 
                RowBox[{"list", "+", 
                 RowBox[{"2", "i", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "i"}], ")"}], " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"2", "m", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "say", " ", "we", " ", "have", " ", "a", " ", "trace", " ", "free", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "whose", " ", "independent", " ", "components", " ", "are", " ", "given",
       " ", "then", " ", "the", " ", "following", " ", "function", " ", 
      "will", " ", "introduce", " ", "those", " ", "components", " ", "in", 
      " ", "the", " ", "list", " ", "which", " ", "have", " ", "been", " ", 
      "negelected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
      "free", " ", "nature", " ", "of", " ", "the", " ", 
      RowBox[{"tensor", ".", " ", "For"}], " ", 
      RowBox[{"eg", ".", " ", "it"}], " ", "will", " ", "introduce"}], " ", 
     "-", "Rxx", "-", 
     RowBox[{
     "Ryy", " ", "for", " ", "a", " ", "second", " ", "order", " ", 
      "tensor"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trf2sym", "[", "A_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"trfEvaluate", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
        "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", "2"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Pick", " ", "the", " ", "2", "D", " ", "variables", " ", "from", " ", "a",
     " ", "list", " ", "containing", " ", "all", " ", "the", " ", 
    RowBox[{"indices", ".", "The"}], " ", "list", " ", "will", " ", "be", " ",
     "obtained", " ", "from", " ", "the", " ", "IDXtrf", " ", 
    RowBox[{"routine", ".", " ", "freeindex"}], " ", "is", " ", "the", " ", 
    "total", " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in",
     " ", "the", " ", "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pick2D", "[", "freeindex_", "]"}], ":=", 
   RowBox[{"Pick", "[", 
    RowBox[{
     RowBox[{"IDXtrf", "[", "freeindex", "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "freeindex"}], "}"}]}], "]"}]}], "]"}],
       "]"}], ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592214156581615*^9, 3.5922142269069633`*^9}, {
  3.592214273648*^9, 3.592214321643592*^9}, {3.592214562691799*^9, 
  3.5922146307578783`*^9}, {3.5922150087114487`*^9, 3.5922151927530117`*^9}, {
  3.592215226866392*^9, 3.592215227208199*^9}, {3.5922152622517147`*^9, 
  3.592215315308941*^9}, {3.592215349687686*^9, 3.592215358801886*^9}, {
  3.59221558179191*^9, 3.592215608488448*^9}, {3.592215669267857*^9, 
  3.592215699095985*^9}, {3.676315905534268*^9, 3.676315915972599*^9}, {
  3.6763161617740183`*^9, 3.676316190517806*^9}, {3.67631623272976*^9, 
  3.676316302687489*^9}, {3.683806014488147*^9, 
  3.683806106724654*^9}},ExpressionUUID->"3f00e438-6998-4986-8e2a-\
2ad88c064090"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTensorForm", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
               RowBox[{
               "A", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               "}"}], "&"}], ",", 
            RowBox[{
             RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", 
             "ii", "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "length"}], "}"}]}], "]"}], "//", 
        "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.59211253078022*^9, 3.592112545437512*^9}, {
   3.5921125805422792`*^9, 3.5921127616337748`*^9}, {3.592112796427103*^9, 
   3.5921128146670732`*^9}, 
   3.597764731152925*^9},ExpressionUUID->"eea245d8-482f-45be-8009-\
a2c5f784182e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymProductDelta2", "[", 
  RowBox[{"SymProductDelta2", "[", 
   RowBox[{"SymProductDelta2", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
        "]"}], "&"}], ",", 
      RowBox[{"IDX", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516209179254*^9, 3.591516237845764*^9}, {
  3.591516279723213*^9, 
  3.591516319002157*^9}},ExpressionUUID->"6e10c523-b20a-411d-82aa-\
0375a4404915"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441912649*^9, 3.676179291151037*^9, 3.6762888609657383`*^9, 
   3.6763161356528177`*^9, 3.6779058949079237`*^9, 3.678529868398068*^9, 
   3.679117967252459*^9, 3.679318837538498*^9, {3.6793190558293753`*^9, 
   3.679319058380992*^9}, 3.679575273024575*^9, 3.679577657421208*^9, 
   3.679658895156467*^9, 3.6797228224020033`*^9, 3.6797482729168377`*^9, 
   3.6797526651898537`*^9, 3.679823747940913*^9, 3.679824094340494*^9, 
   3.679916332279891*^9, 3.67999882302528*^9, 3.6803172844933577`*^9, 
   3.6809502873032503`*^9, 3.681138707433749*^9, 3.6812109489012957`*^9, 
   3.68145797428557*^9, 3.6816993958050756`*^9, 3.6820486434762287`*^9, 
   3.682050102103993*^9, {3.682076336638524*^9, 3.682076355905759*^9}, 
   3.68208228870901*^9, 3.68224490278273*^9, 3.682512107741544*^9, 
   3.68370299060351*^9, 3.683804366294202*^9, 3.684500244083356*^9, 
   3.684575174210775*^9, 3.6845752161625957`*^9, 3.684660181849285*^9, 
   3.68467126128831*^9, 3.68481365641619*^9, 3.6851056524874783`*^9, 
   3.685123331713553*^9, 3.685262662109161*^9, 3.685424638158787*^9, 
   3.685966017058461*^9, 3.686220731045607*^9, 3.687236612952524*^9, 
   3.687495338270397*^9, 3.687982510093813*^9, 3.689512441442964*^9, 
   3.689942169390319*^9, 3.696227799336277*^9, {3.696227969057399*^9, 
   3.696227994050427*^9}, 3.696325209128666*^9, 3.697282978312483*^9, 
   3.6973464682351723`*^9, 3.697440910419991*^9, 3.697702353969549*^9, 
   3.698392885384088*^9, 3.701778681320677*^9, 3.70219127721093*^9, 
   3.702196459085004*^9, 3.702201311777804*^9, 3.702224873292901*^9, 
   3.7025494467971067`*^9, {3.70270311415604*^9, 3.70270313424642*^9}, 
   3.7029071041295557`*^9, 3.7029071854722424`*^9, 3.70296092240806*^9, 
   3.7062443559478903`*^9, 3.708258563321875*^9, 3.7163748021316233`*^9, {
   3.7167907190978527`*^9, 3.71679073074477*^9}, 3.7192963560361233`*^9, 
   3.7303806026412773`*^9},ExpressionUUID->"1693c175-d2df-4336-aaf5-\
5ff17f9d09e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "2", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591517786313066*^9, 3.5915178359472446`*^9}, {
  3.591517885949567*^9, 3.591517930610208*^9}, {3.5977650183992825`*^9, 
  3.597765018845586*^9}, {3.676316092317675*^9, 3.6763161065616913`*^9}, {
  3.676316140175808*^9, 
  3.676316140772443*^9}},ExpressionUUID->"083899bf-6724-4e8d-b5c9-\
8ea76e3344dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441957636*^9, 3.6761792911794147`*^9, 3.676288861012822*^9, {
   3.676316093569808*^9, 3.676316107287977*^9}, {3.676316137581958*^9, 
   3.6763161413544827`*^9}, 3.677905894933*^9, 3.678529868437419*^9, 
   3.679117967277781*^9, 3.6793188375764503`*^9, {3.6793190558584337`*^9, 
   3.679319058418271*^9}, 3.679575273045879*^9, 3.6795776574426947`*^9, 
   3.679658895200933*^9, 3.679722822451293*^9, 3.679748272951642*^9, 
   3.6797526652462883`*^9, 3.679823747962522*^9, 3.6798240943917*^9, 
   3.679916332302744*^9, 3.679998823059197*^9, 3.680317284526877*^9, 
   3.680950287334775*^9, 3.681138707474543*^9, 3.681210948938271*^9, 
   3.681457974307749*^9, 3.681699395843232*^9, 3.682048643515264*^9, 
   3.682050102123021*^9, {3.682076336676392*^9, 3.682076355939827*^9}, 
   3.682082288745886*^9, 3.682244902819724*^9, 3.682512107762454*^9, 
   3.683702990650755*^9, 3.6838043663292027`*^9, 3.684500244127709*^9, 
   3.6845751742446737`*^9, 3.6845752161992826`*^9, 3.6846601818893833`*^9, 
   3.684671261318471*^9, 3.6848136564349537`*^9, 3.685105652526771*^9, 
   3.6851233317512207`*^9, 3.6852626621474*^9, 3.6854246381976*^9, 
   3.685966017098112*^9, 3.686220731084846*^9, 3.6872366130034647`*^9, 
   3.687495338306348*^9, 3.687982510132082*^9, 3.689512441475595*^9, 
   3.689942169428029*^9, 3.696227799379738*^9, {3.696227969103997*^9, 
   3.696227994086108*^9}, 3.696325209168998*^9, 3.6972829783365297`*^9, 
   3.697346468260099*^9, 3.697440910455179*^9, 3.697702354005878*^9, 
   3.6983928854216537`*^9, 3.701778681352748*^9, 3.7021912772450867`*^9, 
   3.702196459122231*^9, 3.702201311811311*^9, 3.702224873327437*^9, 
   3.702549446834991*^9, {3.7027031141972847`*^9, 3.702703134265583*^9}, 
   3.702907104169351*^9, 3.702907185508623*^9, 3.7029609224336643`*^9, 
   3.7062443559810123`*^9, 3.7082585633566008`*^9, 3.71637480216952*^9, {
   3.716790719132203*^9, 3.7167907307845163`*^9}, 3.7192963560601463`*^9, 
   3.7303806026781893`*^9},ExpressionUUID->"9aacd9f7-b39f-4111-9de7-\
2cbed4fe1f1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", 
          RowBox[{"2.", "#2"}], "-", 
          RowBox[{"3", "#3"}]}], "&"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "4", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516796847253*^9, 3.591516813094841*^9}, {
   3.5915174393368073`*^9, 3.5915174614075623`*^9}, {3.59151750012652*^9, 
   3.59151776014233*^9}, {3.591517814794807*^9, 3.5915178185262527`*^9}, {
   3.591517860691409*^9, 3.5915178802347727`*^9}, 3.591518123963479*^9, {
   3.5915182744621964`*^9, 3.591518302569395*^9}, {3.591526482595047*^9, 
   3.5915265043240232`*^9}, {3.591611217481101*^9, 3.591611231450076*^9}, {
   3.597765011088415*^9, 
   3.5977650116257725`*^9}},ExpressionUUID->"afec7cc1-691e-4cb1-b736-\
f930ea88a32c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1428571428571423`"}], ",", "1.1428571428571432`", ",", 
   "2.571428571428571`", ",", "3.428571428571429`", ",", 
   "1.4285714285714286`", ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", "3.1428571428571432`", ",", 
   "2.857142857142857`", ",", 
   RowBox[{"-", "4.285714285714286`"}], ",", 
   RowBox[{"-", "5.428571428571429`"}], ",", 
   RowBox[{"-", "2.2857142857142847`"}], ",", "4.285714285714286`", ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "5.714285714285714`"}], ",", "3.428571428571427`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.675954442007567*^9, 3.67617929122402*^9, 3.676288861058632*^9, 
   3.677905894982387*^9, 3.678529868487091*^9, 3.679117967319182*^9, 
   3.6793188376105824`*^9, {3.679319055894771*^9, 3.679319058450843*^9}, 
   3.679575273094136*^9, 3.6795776574842777`*^9, 3.6796588952380247`*^9, 
   3.6797228224790287`*^9, 3.6797482729844093`*^9, 3.679752665267261*^9, 
   3.679823747991828*^9, 3.679824094441633*^9, 3.679916332335182*^9, 
   3.679998823098927*^9, 3.6803172845586*^9, 3.6809502873740597`*^9, 
   3.6811387075067053`*^9, 3.681210948971066*^9, 3.6814579743442507`*^9, 
   3.681699395875101*^9, 3.6820486435478983`*^9, 3.682050102157604*^9, {
   3.682076336706912*^9, 3.6820763559592457`*^9}, 3.682082288778234*^9, 
   3.6822449028531103`*^9, 3.682512107799152*^9, 3.683702990693994*^9, 
   3.683804366361187*^9, 3.6845002441605253`*^9, 3.6845751742821827`*^9, 
   3.684575216232545*^9, 3.684660181922132*^9, 3.684671261353323*^9, 
   3.684813656465918*^9, 3.685105652558341*^9, 3.6851233317891407`*^9, 
   3.685262662181744*^9, 3.685424638219063*^9, 3.685966017129785*^9, 
   3.6862207311299343`*^9, 3.687236613054021*^9, 3.687495338334983*^9, 
   3.687982510165078*^9, 3.689512441507597*^9, 3.689942169478065*^9, 
   3.696227799410926*^9, {3.696227969142024*^9, 3.696227994119534*^9}, 
   3.696325209212883*^9, 3.6972829783684263`*^9, 3.697346468285926*^9, 
   3.6974409104931707`*^9, 3.697702354039557*^9, 3.6983928854674597`*^9, 
   3.701778681377768*^9, 3.702191277294244*^9, 3.7021964591586027`*^9, 
   3.702201311847865*^9, 3.7022248733703136`*^9, 3.7025494468671007`*^9, {
   3.702703114230402*^9, 3.7027031342998667`*^9}, 3.702907104209866*^9, 
   3.702907185537383*^9, 3.702960922480237*^9, 3.70624435601493*^9, 
   3.7082585633894997`*^9, 3.716374802203055*^9, {3.71679071917321*^9, 
   3.716790730835781*^9}, 3.71929635609239*^9, 
   3.7303806027094297`*^9},ExpressionUUID->"ea391449-082e-47e4-907e-\
81f6ca58bfe6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymFullDot", "[", 
   RowBox[{
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], "}"}], 
      "]"}], "]"}], ",", 
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], "}"}], 
      "]"}], "]"}]}], "]"}], "]"}]], "Input",ExpressionUUID->"6ad97654-c4fa-\
4527-9be6-034b0e540cbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Rxx", " ", "Sxx"}], "+", 
  RowBox[{"Ryy", " ", "Sxx"}], "+", 
  RowBox[{"2", " ", "Rxy", " ", "Sxy"}], "+", 
  RowBox[{"Rxx", " ", "Syy"}], "+", 
  RowBox[{"2", " ", "Ryy", " ", "Syy"}]}]], "Output",
 CellChangeTimes->{
  3.675954442064178*^9, 3.676179291269311*^9, 3.676288861096998*^9, 
   3.6779058950315104`*^9, 3.6785298685371113`*^9, 3.679117967356577*^9, 
   3.6793188376487103`*^9, {3.679319055928149*^9, 3.6793190584906387`*^9}, 
   3.679575273127549*^9, 3.679577657522038*^9, 3.679658895273378*^9, 
   3.6797228225005693`*^9, 3.6797482730345907`*^9, 3.67975266531371*^9, 
   3.679823748014205*^9, 3.6798240944848623`*^9, 3.679916332363706*^9, 
   3.6799988231490192`*^9, 3.6803172845798607`*^9, 3.680950287417145*^9, 
   3.681138707540022*^9, 3.68121094899828*^9, 3.681457974376297*^9, 
   3.6816993958984547`*^9, 3.682048643582439*^9, 3.68205010219067*^9, {
   3.682076336726356*^9, 3.682076355994687*^9}, 3.682082288811843*^9, 
   3.682244902885347*^9, 3.682512107830677*^9, 3.683702990731329*^9, 
   3.6838043663945713`*^9, 3.684500244192729*^9, 3.6845751743152113`*^9, 
   3.684575216264653*^9, 3.684660181955201*^9, 3.684671261373692*^9, 
   3.684813656498608*^9, 3.6851056525783567`*^9, 3.685123331821924*^9, 
   3.685262662214212*^9, 3.6854246382596397`*^9, 3.685966017149164*^9, 
   3.6862207311629133`*^9, 3.687236613103174*^9, 3.6874953383576593`*^9, 
   3.687982510202093*^9, 3.689512441526951*^9, 3.6899421695113783`*^9, 
   3.696227799436955*^9, {3.696227969187942*^9, 3.696227994151021*^9}, 
   3.696325209245842*^9, 3.6972829784223833`*^9, 3.69734646831116*^9, 
   3.697440910524934*^9, 3.697702354067754*^9, 3.698392885512212*^9, 
   3.701778681424369*^9, 3.702191277327828*^9, 3.70219645919093*^9, 
   3.702201311884334*^9, 3.7022248734085083`*^9, 3.7025494468886223`*^9, {
   3.702703114258202*^9, 3.702703134332766*^9}, 3.702907104243087*^9, 
   3.702907185559824*^9, 3.702960922514201*^9, 3.706244356046213*^9, 
   3.708258563424693*^9, 3.716374802236595*^9, {3.716790719216524*^9, 
   3.716790730880453*^9}, 3.7192963561353703`*^9, 
   3.730380602730439*^9},ExpressionUUID->"d84fd1ca-0073-43b1-90aa-\
0bafaa0e1e5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], 
               "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], 
               "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sxx", ",", "Sxy", ",", "Syy"}], "}"}]}], "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 
  3.6566052689034147`*^9}},ExpressionUUID->"d6e52790-cf0d-4e69-ab56-\
039e8daed450"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6759544421144657`*^9, 3.676179291324445*^9, 3.676288861145307*^9, 
   3.6779058950810213`*^9, 3.678529868586431*^9, 3.679117967407839*^9, 
   3.679318837688384*^9, {3.67931905596832*^9, 3.679319058536566*^9}, 
   3.679575273161376*^9, 3.679577657555993*^9, 3.679658895317548*^9, 
   3.6797228225355597`*^9, 3.6797482730705357`*^9, 3.67975266534791*^9, 
   3.679823748046441*^9, 3.679824094521659*^9, 3.679916332386283*^9, 
   3.6799988232008038`*^9, 3.680317284627035*^9, 3.680950287450737*^9, 
   3.68113870757331*^9, 3.681210949019701*^9, 3.681457974397373*^9, 
   3.68169939592647*^9, 3.682048643616544*^9, 3.682050102224084*^9, {
   3.682076336757115*^9, 3.68207635602658*^9}, 3.682082288844701*^9, 
   3.682244902922915*^9, 3.6825121078512993`*^9, 3.68370299076066*^9, 
   3.6838043664285183`*^9, 3.6845002442129803`*^9, 3.684575174348187*^9, 
   3.6845752162828074`*^9, 3.684660181989087*^9, 3.684671261401486*^9, 
   3.6848136565327787`*^9, 3.685105652608335*^9, 3.685123331854587*^9, 
   3.685262662247349*^9, 3.68542463829657*^9, 3.685966017179893*^9, 
   3.6862207311960363`*^9, 3.687236613153617*^9, 3.687495338388363*^9, 
   3.6879825102301826`*^9, 3.689512441559684*^9, 3.689942169545233*^9, 
   3.696227799483726*^9, {3.696227969226108*^9, 3.696227994172471*^9}, 
   3.6963252092941*^9, 3.697282978468988*^9, 3.697346468357728*^9, 
   3.697440910543648*^9, 3.697702354089707*^9, 3.698392885551806*^9, 
   3.701778681453361*^9, 3.7021912773622093`*^9, 3.702196459225028*^9, 
   3.702201311927372*^9, 3.702224873453492*^9, 3.702549446935582*^9, {
   3.702703114281065*^9, 3.702703134365402*^9}, 3.7029071042804003`*^9, 
   3.702907185587825*^9, 3.702960922558852*^9, 3.706244356066287*^9, 
   3.7082585634566402`*^9, 3.716374802268155*^9, {3.7167907192658987`*^9, 
   3.7167907309184437`*^9}, 3.719296356175041*^9, 
   3.730380602778154*^9},ExpressionUUID->"b73d5fbd-74c5-462a-8b79-\
949cb9100742"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "mxxx", ",", "mxxy", ",", "0", ",", "mxyy", ",", "0", ",", 
                "myyy", ",", "0"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "nxxx", ",", "nxxy", ",", "0", ",", "nxyy", ",", "0", ",", 
                "nyyy", ",", "0"}], "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy"}], "}"}]}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"nxxx", ",", "nxxy", ",", "nxyy", ",", "nyyy"}], "}"}]}], "]"}],
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}, {3.656607710425463*^9, 
  3.656607745128602*^9}},ExpressionUUID->"75a72f51-6bbd-4763-bfee-\
9c6adb97c4c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6759544421633577`*^9, 3.676179291374331*^9, 3.6762888611958103`*^9, 
   3.6779058951312113`*^9, 3.6785298686374598`*^9, 3.679117967455283*^9, 
   3.679318837730372*^9, {3.679319056013073*^9, 3.679319058585289*^9}, 
   3.679575273192576*^9, 3.6795776576017933`*^9, 3.679658895350123*^9, 
   3.679722822571162*^9, 3.679748273114377*^9, 3.679752665385249*^9, 
   3.679823748080174*^9, 3.6798240945561943`*^9, 3.679916332430656*^9, 
   3.67999882324424*^9, 3.6803172846583776`*^9, 3.68095028749041*^9, 
   3.6811387076070023`*^9, 3.681210949052898*^9, 3.6814579744431267`*^9, 
   3.681699395959167*^9, 3.682048643648769*^9, 3.682050102259828*^9, {
   3.682076336777141*^9, 3.68207635604613*^9}, 3.682082288878572*^9, 
   3.68224490295254*^9, 3.682512107880975*^9, 3.683702990795364*^9, 
   3.683804366461938*^9, 3.6845002442432127`*^9, 3.6845751743766327`*^9, 
   3.684575216310408*^9, 3.684660182022472*^9, 3.684671261435358*^9, 
   3.6848136565705357`*^9, 3.6851056526274567`*^9, 3.6851233318830767`*^9, 
   3.685262662282794*^9, 3.6854246383314543`*^9, 3.6859660172008753`*^9, 
   3.686220731229653*^9, 3.687236613204381*^9, 3.687495338407893*^9, 
   3.68798251025246*^9, 3.689512441588101*^9, 3.689942169595203*^9, 
   3.696227799529995*^9, {3.6962279692707663`*^9, 3.696227994214904*^9}, 
   3.696325209333612*^9, 3.697282978501671*^9, 3.697346468391983*^9, 
   3.6974409105755577`*^9, 3.697702354124016*^9, 3.698392885602257*^9, 
   3.701778681490099*^9, 3.70219127740726*^9, 3.702196459260594*^9, 
   3.7022013119612293`*^9, 3.702224873487791*^9, 3.702549446967301*^9, {
   3.7027031143138313`*^9, 3.702703134399701*^9}, 3.7029071043275843`*^9, 
   3.702907185611267*^9, 3.702960922597355*^9, 3.70624435609759*^9, 
   3.708258563494005*^9, 3.7163748022874813`*^9, {3.716790719297876*^9, 
   3.7167907309687567`*^9}, 3.71929635620811*^9, 
   3.730380602826968*^9},ExpressionUUID->"9569f68f-d0fb-4fb3-b261-\
339f8fd9c3e3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Definitions", "Section",
 CellChangeTimes->{{3.679646970945805*^9, 3.6796469737833633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ref", " ", "to", " ", "manuels", " ", "paper", " ", "on", " ", "fluxes", 
    " ", "for", " ", "large", " ", "moment", " ", "system", " ", "for", " ", 
    "a", " ", "detailed", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "tensorial", " ", "degree", " ", "including", " ", 
    "traces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"iFullDegree", "[", "i_", "]"}], "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"4", "i"}], "-", "3"}]], "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "traces", " ", 
     RowBox[{"C", "^", "2"}], " ", "has", " ", "one", " ", "trace"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTraces", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"iFullDegree", "[", "i", "]"}]}]}], ")"}], "2"], "]"}], 
      "-", "i"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "tensorial", " ", "degree"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTensorDegree", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"iFullDegree", "[", "i", "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"iTraces", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ii", "[", 
      RowBox[{"s_", ",", "A_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"A", "+", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{"A", "+", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"s", "+", "1"}], ")"}]}], "-", 
         RowBox[{"Floor", "[", 
          FractionBox[
           RowBox[{"A", "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}]}], ")"}]}], "-",
       "s"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "i", " ", "is", " ", "as", " ", "defined", " ", "in", " ", "the", " ", 
     "reference"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables2D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iTensorDegree", "[", "i", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfFullTensors3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"iFullDegree", "[", "ntensors", "]"}]}], ",", "frac"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"m", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "3"}], ")"}]}], "6."], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", 
               RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}], "2"], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varName", "[", 
     RowBox[{"s_", ",", "ix_", ",", "iy_", ",", "iz_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\[Rho]\>\"", ",", 
      RowBox[{"ToString", "[", "s", "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<x\>\"", ",", "ix"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<y\>\"", ",", "iy"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<z\>\"", ",", "iz"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "given", " ", "a", " ", "tensor", " ", "W", " ", "extract", " ", "all", 
     " ", "the", " ", "independed", " ", "components", " ", "in", " ", "2", 
     "D", " ", "in", " ", "case", " ", "of", " ", "trace", " ", "free", " ", 
     "situation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfComponents2D", "[", "W_", "]"}], ":=", 
    RowBox[{"Extract", "[", 
     RowBox[{"W", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"IDX", "[", 
             RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}], ",", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"IDXtrf", "[", 
           RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"TensorDegree", "[", "W", "]"}]}], "}"}]}], "]"}]}], 
            "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfVar2D", "[", 
     RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"name", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"deg", "+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"From2Dto3D", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "list", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.679121885999333*^9, 
   3.679121891174914*^9}, {3.679122262361793*^9, 3.679122267112525*^9}, {
   3.679133059362032*^9, 3.679133059631439*^9}, {3.679133589038743*^9, 
   3.67913360936185*^9}, {3.679133640904398*^9, 3.6791336831388493`*^9}, {
   3.6791337141082077`*^9, 3.679133874437611*^9}, {3.679135482134459*^9, 
   3.679135484173957*^9}, {3.6792156676707373`*^9, 3.679215704456918*^9}, {
   3.6792240744446783`*^9, 3.67922407965063*^9}, {3.679224862877001*^9, 
   3.679224873400732*^9}, {3.679225442671756*^9, 3.679225466025872*^9}, {
   3.679226905039249*^9, 3.679226910362652*^9}, {3.6792317958716917`*^9, 
   3.679231814488446*^9}, {3.679234365577106*^9, 3.67923455103795*^9}, {
   3.679234637556697*^9, 3.679234658998818*^9}, {3.67923481326576*^9, 
   3.6792349261248913`*^9}, {3.67930698033679*^9, 3.679307111509572*^9}, 
   3.6793079545705748`*^9, {3.679307990942153*^9, 3.6793080003912067`*^9}, {
   3.6793080728155317`*^9, 3.67930812133251*^9}, {3.679308193672022*^9, 
   3.6793081992657127`*^9}, {3.679308266611847*^9, 3.6793082780834208`*^9}, {
   3.67930833570712*^9, 3.679308473366946*^9}, {3.679308542688333*^9, 
   3.679308586584567*^9}, 3.67931011500143*^9, {3.679316283604321*^9, 
   3.6793164193343067`*^9}, {3.679316950785508*^9, 3.679317078760085*^9}, {
   3.679317115961516*^9, 3.679317148087328*^9}, {3.679317186721846*^9, 
   3.679317202807983*^9}, {3.679317250901362*^9, 3.679317253339156*^9}, {
   3.679577712229986*^9, 3.679577715509426*^9}, {3.679577809486747*^9, 
   3.679577809636169*^9}, {3.6795856251725492`*^9, 3.679585640933337*^9}, {
   3.679637631192264*^9, 3.679637681544441*^9}, {3.679637722657783*^9, 
   3.679637838534441*^9}, {3.6796380620381813`*^9, 3.679638062453928*^9}, {
   3.6796381418023863`*^9, 3.67963814848005*^9}, {3.6796382255962143`*^9, 
   3.679638259265773*^9}, {3.6796382978240213`*^9, 3.679638422576579*^9}, {
   3.679645489712325*^9, 3.679645490928825*^9}, {3.679645528417181*^9, 
   3.679645538219562*^9}, {3.6796456043820677`*^9, 3.679645689824514*^9}, {
   3.679645765050008*^9, 3.67964580304412*^9}, {3.679645835164995*^9, 
   3.679645838423962*^9}, {3.679645957213408*^9, 3.679645981843093*^9}, {
   3.6796460142235928`*^9, 3.679646072405961*^9}, {3.679646113923502*^9, 
   3.679646146851458*^9}, {3.679646953690811*^9, 3.679646955349524*^9}, {
   3.702907251519321*^9, 
   3.702907328586878*^9}},ExpressionUUID->"e01a9b14-8fa7-49c0-8a9b-\
61b02855b0b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Create VarIdx", "Section",
 CellChangeTimes->{{3.702874444060791*^9, 3.702874449659627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetVarIdxComplete", "[", "Ntensors_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"varIdx", ",", "varIdxComplete"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "compute", " ", "the", " ", "tensor", " ", "degree", " ", "and", " ", 
       "the", " ", "number", " ", "of", " ", "traces", " ", "for", " ", 
       "every", " ", "tensor", " ", "in", " ", "the", " ", 
       RowBox[{"system", ".", "\[IndentingNewLine]", "In"}], " ", "all", " ", 
       "the", " ", "coming", " ", "computations"}], ",", " ", 
      RowBox[{
      "iTraces", " ", "will", " ", "be", " ", "represented", " ", "by", " ", 
       RowBox[{"a", ".", "sa"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"varIdx", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"iTraces", "[", "i", "]"}], ",", 
          RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "same", " ", "as", " ", "IDXFull", " ", "but", " ", "instead", " ", 
       "stores", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
       "number", " ", "of", " ", "traces", " ", "in", " ", "the", " ", 
       "first", " ", "argument", " ", "of", " ", "every", " ", "list"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"varIdxComplete", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
               ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"IDXFull", "[", 
             RowBox[{"varIdx", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"varIdx", ",", "varIdxComplete"}], "}"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.702874512779085*^9, 3.7028745341017027`*^9}, {
   3.7028747769543533`*^9, 3.702874781554521*^9}, {3.7032271807712173`*^9, 
   3.703227182459196*^9}, {3.703227267083943*^9, 3.7032273161431704`*^9}, {
   3.703227346436442*^9, 3.703227350698045*^9}, 3.703227393971726*^9, {
   3.7032274355965147`*^9, 3.703227449426923*^9}, {3.703227501766261*^9, 
   3.703227503452258*^9}},ExpressionUUID->"f77d6753-dca7-484e-b31c-\
e49b8bdce2f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Radial Part", "Section",
 CellChangeTimes->{{3.7028726601686697`*^9, 3.702872663432705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "quasi"}], "-", 
    RowBox[{
    "laguerre", " ", "polynomial", " ", "given", " ", "in", " ", 
     "Convergence", " ", "of", " ", "boundary", " ", "value", " ", "problem", 
     " ", "paper"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Laguerre", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", 
           FractionBox["3", "2"]}], "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", "s", "+", 
           FractionBox["3", "2"]}], "]"}]}], 
        RowBox[{
         RowBox[{"n", "!"}], 
         RowBox[{"s", "!"}]}]]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          RowBox[{"Gamma", "[", 
           RowBox[{"(", 
            RowBox[{"n", "+", "p", "+", 
             FractionBox["3", "2"]}], ")"}], "]"}]], 
         RowBox[{"Binomial", "[", 
          RowBox[{"s", ",", "p"}], "]"}], 
         SuperscriptBox["x", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            FractionBox["n", "2"]}], ")"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sonine", "[", 
      RowBox[{"s_", ",", "n_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"s", "!"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "s"}], ")"}], "!"}]}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          RowBox[{
           RowBox[{"p", "!"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "-", "p"}], ")"}], "!"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "+", "n"}], ")"}], "!"}]}]], 
         SuperscriptBox["x", "p"]}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Quasi", " ", "Sonine", " ", "polynomial", " ", "taken", " ", "from", " ", 
     RowBox[{"Manuel", "'"}], "s", " ", "paper", " ", "on", " ", "explicit", 
     " ", "fluxes"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QuasiSonine", "[", 
      RowBox[{"n_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}], "!!"}], 
         RowBox[{"2", 
          RowBox[{"n", "!"}]}]], 
        SqrtBox["\[Pi]"]}]], 
      RowBox[{"Sonine", "[", 
       RowBox[{"s", ",", 
        RowBox[{"n", "+", 
         RowBox[{"1", "/", "2"}]}], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["Cx", "2"], "+", 
          SuperscriptBox["Cy", "2"], "+", 
          SuperscriptBox["Cz", "2"]}], "2"]}], "]"}], 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox["2"], ")"}], "n"]]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7028728511158543`*^9, 3.702872887317387*^9}, {
  3.702872931375309*^9, 3.7028730615303793`*^9}, {3.702876328863618*^9, 
  3.702876335657948*^9}, {3.702876475615584*^9, 3.702876507095752*^9}, {
  3.702876542089323*^9, 3.702876618109435*^9}, {3.702876843421177*^9, 
  3.7028768448715343`*^9}, {3.702877366875778*^9, 3.702877371146081*^9}, {
  3.7028774613329678`*^9, 3.7028774617875957`*^9}, {3.702879445750956*^9, 
  3.702879454733035*^9}},ExpressionUUID->"8541a0c7-d11b-4b59-b962-\
17bc0fb2e96a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Angular part", "Section",
 CellChangeTimes->{{3.7028731196425343`*^9, 3.702873121927855*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TraceFreeCoord", "[", "idx_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nx", "=", 
        RowBox[{
        "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"ny", "=", 
        RowBox[{
        "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"nz", "=", 
        RowBox[{
        "idx", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"n", "=", 
        RowBox[{"Total", "[", 
         RowBox[{"idx", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Expand", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "n"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "n"}], "-", "1"}], ")"}], "!!"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}]], ")"}], 
        RowBox[{"n", "+", "1"}]], 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             FractionBox["1", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["Cx", "2"], "+", 
                SuperscriptBox["Cy", "2"], "+", 
                SuperscriptBox["Cz", "2"]}]]], ",", 
             RowBox[{"{", 
              RowBox[{"Cx", ",", "nx"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Cy", ",", "ny"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cz", ",", "nz"}], "}"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7028731309337463`*^9, 3.7028731384393787`*^9}, {
   3.702873333673411*^9, 3.702873389790502*^9}, 3.702876837779868*^9, 
   3.702877467269362*^9, 
   3.702879464085073*^9},ExpressionUUID->"7abbfed4-25a0-42db-ae7e-\
c3764f481fc5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hermite Basis", "Section",
 CellChangeTimes->{{3.702888880190898*^9, 3.702888882287998*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"i_", ",", "c_"}], "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SqrtBox[
        RowBox[{"Gamma", "[", 
         RowBox[{"i", "+", "1"}], "]"}]], 
       SuperscriptBox["2", 
        RowBox[{"i", "/", "2"}]]}]], 
     RowBox[{"HermiteH", "[", 
      RowBox[{"i", ",", 
       RowBox[{"c", "/", 
        SqrtBox["2"]}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HSpcInt", "[", 
     RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"m", "\[Equal]", "n"}], ",", 
      FractionBox["1", "2"], ",", 
      RowBox[{"OddQ", "[", 
       RowBox[{"m", "-", "n"}], "]"}], ",", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{"2", " ", "\[Pi]"}]]], 
       FractionBox[
        SqrtBox[
         RowBox[{
          RowBox[{"n", "!"}], 
          RowBox[{"m", "!"}]}]], 
        RowBox[{"n", "!"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "n"], 
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "i"}], "+", "m", "+", "n"}], ")"}]}]], " ", 
            "\[Pi]"}], 
           RowBox[{
            RowBox[{"Gamma", "[", 
             FractionBox[
              RowBox[{"i", "-", "m"}], "2"], "]"}], " ", 
            RowBox[{"Gamma", "[", 
             RowBox[{"2", "-", "i", "+", "m"}], "]"}], " ", 
            RowBox[{"Gamma", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "i", "-", "n"}], ")"}]}], "]"}]}]]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "n", "-", "2"}], ")"}], "!!"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "n", "-", "1"}], ")"}], "/", "2"}]]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "-", "n"}], ")"}], "!"}]]}], ")"}]}], ",", 
      RowBox[{"EvenQ", "[", 
       RowBox[{"m", "-", "n"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\[Theta]0", " ", "has", " ", "been", " ", "considered", " ", "to", " ", 
    "be", " ", "1"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HermiteTuple", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"a", ",", "Cx"}], "]"}], 
     RowBox[{"H", "[", 
      RowBox[{"b", ",", "Cy"}], "]"}], 
     RowBox[{"H", "[", 
      RowBox[{"c", ",", "Cz"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HermiteBasis", "[", "Degree_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tuple", ",", "basis"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tuple", " ", "=", " ", 
       RowBox[{"IDXFull", "[", "Degree", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"basis", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"HermiteTuple", "[", 
          RowBox[{
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "tuple"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Project", " ", "a", " ", "function", " ", "on", " ", "a", " ", "given", 
    " ", "set", " ", "of", " ", "Hermite", " ", "basis"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjectOnHermite", "[", 
    RowBox[{"fun_", ",", "Basis_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "weighting", " ", "function", " ", "for", " ", "our", " ", "space"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"w", " ", "=", " ", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], 
          FractionBox["3", "2"]]], 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}]}], "2"], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"w", " ", "fun", " ", 
            RowBox[{
            "Basis", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Cx", ",", 
             RowBox[{"-", "8"}], ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Cy", ",", 
             RowBox[{"-", "8"}], ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Cz", ",", 
             RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "Basis", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"coeffs", " ", "=", " ", 
    RowBox[{
     RowBox[{
     "expansion", " ", "of", " ", "coefficients", " ", "and", " ", "degree"}],
      " ", "=", " ", 
     RowBox[{
     "degree", " ", "of", " ", "hermit", " ", "basis", " ", "with", " ", 
      "which", " ", "the", " ", "quantity", " ", "has", " ", "been", " ", 
      "projected"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckProjection", "[", 
    RowBox[{"coeffs_", ",", "Degree_", ",", "fun_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tuple", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Chop", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"coeffs", ".", 
         RowBox[{"HermiteBasis", "[", "Degree", "]"}]}], "-", "fun"}], "]"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "the", " ", "maximum", " ", "degree", " ", "of", " ", "a", 
    " ", "multivariate", " ", "polynomial"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReturnMaxDegree", "[", "fun_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Plus", "@@@", 
       RowBox[{
        RowBox[{"CoefficientRules", "[", "#", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
    "fun"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.702888891991782*^9, 3.702888927814279*^9}, {
   3.702888963662809*^9, 3.7028889902312403`*^9}, {3.702889266948463*^9, 
   3.702889294820554*^9}, {3.7028893347276917`*^9, 3.702889377708426*^9}, {
   3.702889685695413*^9, 3.702889796125764*^9}, {3.7028898530469427`*^9, 
   3.702889863380225*^9}, {3.702889907243827*^9, 3.7028899268264847`*^9}, {
   3.702889976275649*^9, 3.702890104905972*^9}, {3.7028901733667383`*^9, 
   3.702890215372579*^9}, {3.7028902568041067`*^9, 3.7028903433162327`*^9}, {
   3.702890439892123*^9, 3.702890483088418*^9}, {3.702890545209263*^9, 
   3.702890642882091*^9}, {3.702890733191538*^9, 3.702890796150978*^9}, {
   3.702890875511977*^9, 3.7028908921499434`*^9}, {3.7028909448999767`*^9, 
   3.702890953805914*^9}, {3.702891021460165*^9, 3.7028911292926826`*^9}, 
   3.702891347293109*^9, {3.702891641525897*^9, 3.702891668536646*^9}, {
   3.702891848488892*^9, 3.702892003973239*^9}, {3.702892054348402*^9, 
   3.7028921127540417`*^9}, {3.702892423712371*^9, 3.7028924447866497`*^9}, {
   3.702892833889174*^9, 3.7028928484290943`*^9}, {3.702899577962532*^9, 
   3.70289957997208*^9}, {3.703693104196599*^9, 3.7036931260336227`*^9}, {
   3.7062443989995403`*^9, 3.706244440325964*^9}, {3.719299570294915*^9, 
   3.719299600453465*^9}, {3.72993724522507*^9, 
   3.729937245399053*^9}},ExpressionUUID->"c388e1a5-0ce2-43db-be7d-\
dbeb06650762"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gauss Hermite Quadrature Routines", "Section",
 CellChangeTimes->{{3.700501892096177*^9, 3.7005018987210608`*^9}, {
  3.7005033709818687`*^9, 3.70050337322683*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "N", " ", "is", " ", "the", " ", "number", " ", "of", " ", "quadrature", 
    " ", "points", " ", 
    RowBox[{"needed", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GaussHermiteQuadrature", "[", "points_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"locations", ",", "weights", ",", "f0"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f0", "[", "c_", "]"}], "=", 
        RowBox[{
         FractionBox["1", 
          SqrtBox[
           RowBox[{"2", "\[Pi]"}]]], 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"-", 
            SuperscriptBox["c", "2"]}], "2"], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "location", " ", "of", " ", "the", " ", "gauss", " ", "quadrautre", 
         " ", "points"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"locations", " ", "=", 
        RowBox[{"Chop", "[", " ", 
         RowBox[{"N", "[", 
          RowBox[{"x", "/.", 
           RowBox[{"{", 
            RowBox[{"ToRules", "@", 
             RowBox[{"Roots", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"H", "[", 
                 RowBox[{"points", ",", "x"}], "]"}], "\[Equal]", "0"}], ",", 
               "x"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "weights", " ", "of", " ", "the", " ", "gauss", " ", "quadrature"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"points", " ", "\[Equal]", " ", "1"}], ",", 
         RowBox[{"weights", " ", "=", " ", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"weights", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"H", "[", 
                  RowBox[{"points", ",", "c"}], "]"}], ",", 
                 SuperscriptBox["c", "points"]}], "]"}], 
               RowBox[{"Integrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"f0", "[", "c", "]"}], 
                  SuperscriptBox[
                   RowBox[{"H", "[", 
                    RowBox[{
                    RowBox[{"points", "-", "1"}], ",", "c"}], "]"}], "2"]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", 
                   RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                  "}"}]}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"H", "[", 
                  RowBox[{
                   RowBox[{"points", "-", "1"}], ",", "c"}], "]"}], ",", 
                 SuperscriptBox["c", 
                  RowBox[{"points", "-", "1"}]]}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"H", "[", 
                    RowBox[{"points", ",", "c"}], "]"}], ",", "c"}], "]"}], "/.", 
                 RowBox[{"c", "\[Rule]", 
                  RowBox[{
                  "locations", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"H", "[", 
                  RowBox[{
                   RowBox[{"points", "-", "1"}], ",", "c"}], "]"}], "/.", 
                 RowBox[{"c", "\[Rule]", 
                  RowBox[{
                  "locations", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", "points"}], "}"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"locations", ",", "weights"}], "}"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "f", " ", "is", " ", "the", " ", "function", " ", "which", " ", "we", " ",
      "wish", " ", "to", " ", "integrate", " ", "and", " ", "N", " ", "is", 
     " ", "the", " ", "number", " ", "of", " ", "quadrature", " ", "points", 
     " ", "which", " ", "we", " ", "want", " ", "to", " ", "use", " ", "in", 
     " ", "order", " ", "to", " ", "integrate"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerformNumericalIntegration1D", "[", 
     RowBox[{"f_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"points", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", " ", "=", " ", 
        RowBox[{
        "GaussHermitePoints", "\[LeftDoubleBracket]", "M", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"result", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", "f", " ", ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"c", "\[Rule]", 
                RowBox[{
                 RowBox[{
                 "points", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}]}], "}"}]}], ")"}], "*", 
            RowBox[{
             RowBox[{
             "points", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
              "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "points", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", "result"}]}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PerformNumericalIntegration3D", "[", 
     RowBox[{"f_", ",", "GaussPoints_", ",", "Weights_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"result", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", "f", " ", ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cx", "\[Rule]", 
                 RowBox[{
                  RowBox[{
                  "GaussPoints", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"Cy", "\[Rule]", 
                 RowBox[{
                  RowBox[{
                  "GaussPoints", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"Cz", "\[Rule]", 
                 RowBox[{
                  RowBox[{
                  "GaussPoints", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}], "}"}]}], ")"}], "*", 
            RowBox[{
            "Weights", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "GaussPoints", "]"}]}], "}"}]}], "]"}], ";",
        "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7005019656804132`*^9, 3.700502042721283*^9}, {
   3.70050207372581*^9, 3.700502087459856*^9}, {3.700502837270446*^9, 
   3.700502872206249*^9}, {3.700502938016624*^9, 3.700502983655097*^9}, {
   3.700503020753676*^9, 3.700503087756496*^9}, {3.7005033778565893`*^9, 
   3.700503441383716*^9}, {3.700503477097069*^9, 3.700503558317155*^9}, {
   3.7005036156564817`*^9, 3.7005036276304207`*^9}, {3.700503667898871*^9, 
   3.7005036781956673`*^9}, {3.700503777104319*^9, 3.700503784402934*^9}, 
   3.700504145455936*^9, {3.700505505470524*^9, 3.700505551661944*^9}, {
   3.700505604276986*^9, 3.700505616749926*^9}, {3.70066644004778*^9, 
   3.700666445820112*^9}, 3.700666754817018*^9, {3.700674580983697*^9, 
   3.700674585047731*^9}, {3.7006746280324173`*^9, 3.700674657485847*^9}, {
   3.700674696595334*^9, 3.700674857871071*^9}, {3.700675928845469*^9, 
   3.7006759510006447`*^9}, {3.700676165521497*^9, 3.700676168930189*^9}, 
   3.700805940652087*^9, {3.700822998133315*^9, 3.7008229987397623`*^9}, {
   3.700825021831339*^9, 3.700825097189197*^9}, {3.7008251367279453`*^9, 
   3.700825281051448*^9}, {3.700825402961584*^9, 3.700825406886374*^9}, {
   3.700825454501305*^9, 3.700825484507186*^9}, {3.703253901995244*^9, 
   3.703253906717003*^9}, {3.7032539763342247`*^9, 3.70325397689491*^9}, {
   3.703302044922247*^9, 3.703302106656348*^9}, {3.7033024244280863`*^9, 
   3.703302427360207*^9}, {3.70330254105164*^9, 3.703302544174*^9}, {
   3.703302797032897*^9, 3.703302889189802*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussHermitePoints", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GaussHermiteQuadrature", "[", "ii", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "20"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703302134821973*^9, 3.703302134917593*^9}}],

Cell[CellGroupData[{

Cell["Gauss Hermite points 3D", "Subsection",
 CellChangeTimes->{{3.703254028525326*^9, 3.703254033500255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Gauss", " ", "Hermite", " ", "Quadrature", " ", "points", " ", "based", 
    " ", "upon", " ", "the", " ", "tensor", " ", "product", " ", "of", " ", 
    "quadrature", " ", "rules", " ", "in", " ", "1", "D"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GaussHermite3DGrid", "[", "N_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "points", ",", "weights", ",", "GaussPoints", ",", "GaussWeights"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", " ", "=", " ", 
        RowBox[{
         RowBox[{
         "GaussHermitePoints", "\[LeftDoubleBracket]", "N", 
          "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"weights", " ", "=", " ", 
        RowBox[{
         RowBox[{
         "GaussHermitePoints", "\[LeftDoubleBracket]", "N", 
          "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"GaussPoints", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "points", "]"}], "*", 
             RowBox[{"Length", "[", "points", "]"}], "*", 
             RowBox[{"Length", "[", "points", "]"}]}], ",", "3"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"GaussWeights", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "points", "]"}], "*", 
              RowBox[{"Length", "[", "points", "]"}], "*", 
              RowBox[{"Length", "[", "points", "]"}]}], ",", "1"}], "}"}]}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"convert", " ", "to", " ", 
         RowBox[{"(", 
          RowBox[{"x", ",", "y", ",", "z"}], ")"}], " ", "3", "D"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"GaussPoints", "\[LeftDoubleBracket]", 
                RowBox[{"kk", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"jj", "-", "1"}], ")"}], "*", 
                  RowBox[{"Length", "[", "points", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ii", "-", "1"}], ")"}], "*", 
                  SuperscriptBox[
                   RowBox[{"Length", "[", "points", "]"}], "2"]}]}], 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "points", "\[LeftDoubleBracket]", "kk", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "points", "\[LeftDoubleBracket]", "jj", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "points", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"GaussWeights", "\[LeftDoubleBracket]", 
                RowBox[{"kk", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"jj", "-", "1"}], ")"}], "*", 
                  RowBox[{"Length", "[", "points", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ii", "-", "1"}], ")"}], "*", 
                  SuperscriptBox[
                   RowBox[{"Length", "[", "points", "]"}], "2"]}]}], 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                "weights", "\[LeftDoubleBracket]", "kk", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "weights", "\[LeftDoubleBracket]", "jj", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "weights", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}]}]}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"kk", ",", "1", ",", 
               RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"jj", ",", "1", ",", 
             RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GaussPoints", ",", "GaussWeights"}], "}"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gauss", " ", "Hermite", " ", "Quadrature", " ", "points", " ", "based", 
     " ", "upon", " ", "a", " ", "line", " ", "in", " ", "3", "D"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GaussHermite3DLine", "[", "N_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "points", ",", "weights", ",", "GaussPoints", ",", "GaussWeights"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", " ", "=", " ", 
        RowBox[{
         RowBox[{
         "GaussHermitePoints", "\[LeftDoubleBracket]", "N", 
          "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"weights", " ", "=", " ", 
        RowBox[{
         RowBox[{
         "GaussHermitePoints", "\[LeftDoubleBracket]", "N", 
          "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"convert", " ", "to", " ", 
         RowBox[{"(", 
          RowBox[{"x", ",", "y", ",", "z"}], ")"}], " ", "3", "D"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "points", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "points", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "points", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "points", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "weights", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
            "=", 
           SuperscriptBox[
            RowBox[{
            "weights", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}], "3"]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "points", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"points", ",", "weights"}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.703254034722149*^9, 3.703254219582464*^9}, {
   3.703302567960511*^9, 3.7033025702476187`*^9}, {3.7033032780872726`*^9, 
   3.7033032998706093`*^9}, {3.7033033578564653`*^9, 3.703303477166462*^9}, {
   3.703303566727583*^9, 3.703303596985087*^9}, {3.703303665072945*^9, 
   3.703303671276155*^9}, {3.703303702315963*^9, 3.703303724187664*^9}, 
   3.703303770142724*^9, {3.703303963633415*^9, 3.7033039667491207`*^9}, {
   3.7033040482976294`*^9, 3.7033041387162037`*^9}, {3.7033042202253857`*^9, 
   3.7033042258518143`*^9}, {3.703304672113559*^9, 3.703304802785891*^9}, {
   3.703305935355095*^9, 3.703305962569726*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basis function (Spherical Harmonics)", "Section",
 CellChangeTimes->{{3.702874812295278*^9, 3.702874814219966*^9}, {
  3.7086680990845203`*^9, 3.7086681035798473`*^9}}],

Cell[CellGroupData[{

Cell["Psi", "Subsection",
 CellChangeTimes->{{3.7032356706983833`*^9, 3.703235671042835*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]", "[", "idx_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "s", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "number", " ", "of", " ", "traces", " ", "in", " ", "the", 
      " ", "tensor"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"The", " ", "total", " ", "tensorial", " ", "degree"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"idx", "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"Laguerre", "[", 
        RowBox[{"n", ",", "s", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Cx", "2"], "+", 
            SuperscriptBox["Cy", "2"], "+", 
            SuperscriptBox["Cz", "2"]}], ")"}], 
          RowBox[{"2", "\[Theta]0"}]]}], "]"}], "*", 
       RowBox[{"TraceFreeCoord", "[", "idx", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.702874818878413*^9, 3.702874918692904*^9}, {
   3.702875502560156*^9, 3.702875508662217*^9}, 3.702880303790532*^9, {
   3.70288216411967*^9, 3.702882165537266*^9}, {3.7032353145143347`*^9, 
   3.703235325496441*^9}, {3.708668941479587*^9, 
   3.70866896067179*^9}},ExpressionUUID->"314b8b96-88d7-46b8-bdf3-\
23a0abb8aa9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution function", "Subsection",
 CellChangeTimes->{{3.703223886411585*^9, 3.703223888913001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "get", " ", "the", " ", "contribution", " ", "into", " ", "the", " ", 
    "distribution", " ", "function", " ", "from", " ", "a", " ", "particular",
     " ", "tensor", " ", "degree"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetfTensor", "[", 
     RowBox[{"n_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allComponents", ",", "allComponentsTrf", ",", "varIdxComplete", ",", 
        "PsiList", ",", "coeffSym", ",", "replaceTrf", ",", "result", ",", 
        "Var2D"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "all", " ", "components", " ", "in", " ", "the", " ", "tensors"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allComponents", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"IDX", "[", "n", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "conversion", " ", "to", " ", "trace", " ", "free", " ", "tensors"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allComponentsTrf", " ", "=", " ", 
        RowBox[{"trf2sym", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
           RowBox[{"IDXtrf", "[", "n", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "trace", " ", "free", " ", "variables", " ", "in", " ", "2", "D"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Var2D", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"w", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"IDXtrf", "[", "n", "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}], 
             "]"}], ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "replacement", " ", "for", " ", "trace", " ", "free", " ", 
         "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"replaceTrf", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "allComponents", "\[LeftDoubleBracket]", "ii", 
            "\[RightDoubleBracket]"}], "\[Rule]", 
           RowBox[{
           "allComponentsTrf", "\[LeftDoubleBracket]", "ii", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "allComponents", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"varIdxComplete", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "s", "}"}], ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"IDXFull", "[", "n", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "list", " ", "of", " ", "all", " ", "the", " ", "basis", " ", 
         "functions"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"PsiList", " ", "=", 
        RowBox[{"Simplify", "[", " ", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Psi]", "[", "#", "]"}], "&"}], ",", 
            "varIdxComplete"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Theta]0", "\[Rule]", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Coefficients", " ", "for", " ", "the", " ", "symmetric", " ", 
         "tensors"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coeffSym", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"coeffEntropySym", "[", 
           RowBox[{
           "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "allComponents"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "contribution", " ", "into", " ", "the", " ", "distribution", " ", 
         "function", " ", "from", " ", "this", " ", "particular", " ", 
         "tensor"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"allComponents", "*", "PsiList"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "account", " ", "for", " ", "the", " ", "symmetricity", " ", "of", 
         " ", "the", " ", "tensors"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"result", "*", "coeffSym"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "account", " ", "for", " ", "the", " ", "trace", " ", "free", " ", 
         "nature", " ", "of", " ", "the", " ", "tensors"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"result", "/.", "replaceTrf"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"result", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Total", "[", "result", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Pick", " ", "up", " ", "only", " ", "those", " ", "components", " ", 
         "which", " ", "have", " ", "a", " ", "2", "D", " ", "contribution"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"result", ",", "Var2D"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Getf", "[", "Ntensors_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "varIdx", ",", "varIdxComplete", ",", "result", ",", "coeffSym", ",", 
        "varTrf", ",", "n", ",", "s", ",", "tempvarTrf"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"varIdx", ",", "varIdxComplete"}], " ", "}"}], "=", " ", 
        RowBox[{"GetVarIdxComplete", "[", "Ntensors", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"GetfTensor", "[", 
             RowBox[{
              RowBox[{
              "ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "varIdx"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "result"}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.703223894535555*^9, 3.703224274192367*^9}, {
   3.7032244588619547`*^9, 3.703224658357339*^9}, {3.703224699846962*^9, 
   3.703224822483651*^9}, {3.703227532302396*^9, 3.70322758411055*^9}, {
   3.703227642807871*^9, 3.703227723899852*^9}, {3.70322781768716*^9, 
   3.70322783671107*^9}, {3.703227881194302*^9, 3.7032279027215557`*^9}, {
   3.7032280072792883`*^9, 3.703228108775384*^9}, {3.703233802640625*^9, 
   3.703233806469386*^9}, {3.70323398616538*^9, 3.703234011661083*^9}, {
   3.703234251909965*^9, 3.703234265390959*^9}, {3.703234408532296*^9, 
   3.703234413196313*^9}, {3.703234577650338*^9, 3.703234729107506*^9}, {
   3.70323515797987*^9, 3.703235286792285*^9}, {3.703235367645755*^9, 
   3.703235469700438*^9}, {3.7032355798667593`*^9, 3.703235970504035*^9}, {
   3.7032360446973124`*^9, 3.7032360907004013`*^9}, {3.703236157038116*^9, 
   3.703236159765036*^9}, {3.703236265580188*^9, 3.703236308962956*^9}, {
   3.703236350757448*^9, 3.703236424294524*^9}, {3.703236491562531*^9, 
   3.703236553939185*^9}, {3.703236591126752*^9, 3.7032366654362907`*^9}, {
   3.703236715306178*^9, 3.7032367451601763`*^9}, {3.703236777204185*^9, 
   3.7032368084967403`*^9}, {3.703237285310266*^9, 3.703237304996217*^9}, {
   3.7032375329821997`*^9, 3.7032375613743477`*^9}, {3.7032376255792522`*^9, 
   3.703237663504218*^9}, {3.70323982568587*^9, 3.703239838115862*^9}, {
   3.703239961073092*^9, 3.7032399625264673`*^9}, {3.7032417447108*^9, 
   3.703241774897367*^9}, {3.7192964292555103`*^9, 3.719296440355136*^9}, 
   3.719298266143148*^9, {3.719298411526724*^9, 3.719298414527423*^9}, 
   3.719299127200379*^9},ExpressionUUID->"6b2bdafe-fd81-4926-91e5-\
f181c78557dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution function", "Section",
 CellChangeTimes->{{3.702874658866312*^9, 3.7028746617901363`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "f0", "]"}]], "Input",
 CellChangeTimes->{{3.702889049432107*^9, 3.702889052022496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f0", "=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], 
       FractionBox["3", "2"]]], 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Cx", "2"], "+", 
          SuperscriptBox["Cy", "2"], "+", 
          SuperscriptBox["Cz", "2"]}], ")"}]}], "2"], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.702874667191607*^9, 3.7028747383215027`*^9}, {
   3.702874785169264*^9, 3.702874791772883*^9}, {3.702874927463479*^9, 
   3.702874953153973*^9}, {3.7028752104942503`*^9, 3.702875228871706*^9}, {
   3.702875368241096*^9, 3.70287538511117*^9}, {3.7028755342447033`*^9, 
   3.702875589401476*^9}, 3.702880576686365*^9, {3.702889037387216*^9, 
   3.702889086680552*^9}, {3.7028891192830963`*^9, 3.7028891200569487`*^9}, {
   3.702889945437752*^9, 3.7028899545318823`*^9}, 3.702890821925127*^9, {
   3.702890961640257*^9, 3.7028909709396553`*^9}, {3.702896181288187*^9, 
   3.702896181511057*^9}, {3.7028965018006363`*^9, 3.702896507716464*^9}, {
   3.7028986737668123`*^9, 3.702898693252862*^9}}],

Cell[CellGroupData[{

Cell["G20", "Subsection",
 CellChangeTimes->{{3.7028987142127867`*^9, 3.7028987150112963`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "a", " ", "list", " ", "of", " ", "all", " ", "the", " ", "basis", " ", 
    "functions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"List\[Psi]", " ", "=", " ", 
     RowBox[{"Getf", "[", "6", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "coefficients", " ", "appearing", " ", "in", " ", "the", " ", 
     "hermite", " ", "expansion"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coefficients", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ProjectOnHermite", "[", 
         RowBox[{
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"HermiteBasis", "[", 
           RowBox[{"ReturnMaxDegree", "[", 
            RowBox[{
            "List\[Psi]", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "List\[Psi]", "]"}]}], "}"}]}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.702898724978167*^9, 3.702898763645198*^9}, {
   3.702907148559223*^9, 3.702907149683569*^9}, {3.702907689373975*^9, 
   3.702907695019992*^9}, 3.703223917169389*^9, {3.703242080840464*^9, 
   3.703242099864204*^9}, 3.7192991544117403`*^9, 3.719299649109208*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CheckProjection", "[", 
      RowBox[{
       RowBox[{
       "coefficients", "\[LeftDoubleBracket]", "ii", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ReturnMaxDegree", "[", 
        RowBox[{
        "List\[Psi]", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
         "]"}], ",", 
       RowBox[{
       "List\[Psi]", "\[LeftDoubleBracket]", "ii", 
        "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "coefficients", "]"}]}], "}"}]}], "]"}], ",", 
   SuperscriptBox["10", 
    RowBox[{"-", "7"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.702899194361072*^9, 3.7028992039268217`*^9}, {
   3.702907377660018*^9, 3.702907388263061*^9}, {3.70290742304985*^9, 
   3.7029074578196907`*^9}, {3.702907878065878*^9, 3.702907964506894*^9}, 
   3.7192995199733553`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.702899204260998*^9, 3.702907389412211*^9, {3.702907427617725*^9, 
   3.702907461144915*^9}, {3.7029079533991547`*^9, 3.702907964793704*^9}, 
   3.7029609759383087`*^9, 3.702961147225647*^9, 3.703242149672483*^9, 
   3.7032423564594088`*^9, 3.719299025245265*^9, 3.719299297389679*^9, 
   3.719299463235818*^9, 3.71929961628327*^9, 3.719299914407077*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transfer matrix", "Subsection",
 CellChangeTimes->{{3.7029060727959967`*^9, 3.702906074900257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Transf", " ", "Part", " ", "for", " ", "the", " ", "nth", " ", "degree", 
    " ", "tensors", " ", "appearing", " ", "in", " ", "G20"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Transf0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transf1", "=", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transf2", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"coefficients", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "6"}], "}"}]}], 
       "\[RightDoubleBracket]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transf3", " ", "=", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"coefficients", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"8", ";;", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "7", ",", "9"}], 
         "}"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.702899311478176*^9, 3.702899433243243*^9}, {
  3.702899467842958*^9, 3.702899515924094*^9}, {3.702899907720839*^9, 
  3.7028999348841543`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TransfMat20", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "13"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransfMat20", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=", "Transf0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransfMat20", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
   "Transf1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransfMat20", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], 
    "\[RightDoubleBracket]"}], "=", "Transf2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransfMat20", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13"}], 
      "}"}]}], "\[RightDoubleBracket]"}], "=", "Transf3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.702899766121787*^9, 3.702899885155458*^9}, {
  3.702899945691063*^9, 3.702900038686163*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TransfMat20", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7028995837450047`*^9, 3.702899585175202*^9}, {
  3.702899864242119*^9, 3.702899868714603*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "0.5773502685006732`"}], "0.9999999593534532`", "0.`", 
      "2.6155408311263905`*^-13", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0.`", "0.`", "1.4142135557845188`", "0.`", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "0.5773502685006738`"}], "2.615532147715192`*^-13", "0.`", 
      "0.9999999593534534`", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "0.5773502685006736`"}], 
      RowBox[{"-", "0.9999999593534532`"}], "0.`", 
      RowBox[{"-", "0.9999999593534534`"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.7745966668711454`"}], "0.`", "0.9999999973985395`", 
      "1.283935348849659`*^-23", "2.716491222128382`*^-16", 
      "1.0019845423746601`*^-23"},
     {"0", "0", "0", "0", "0", "0", "0", "0.`", 
      RowBox[{"-", "0.4472135949267823`"}], "0.`", "1.7320507895205466`", 
      "0.`", 
      RowBox[{"-", "8.762553407175332`*^-11"}]},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.44721359492678214`"}], "0.`", 
      RowBox[{"-", "8.762558679193099`*^-11"}], "0.`", "1.732050789552103`", 
      "0.`"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.44721359492678214`"}], "0.`", 
      RowBox[{"-", "1.7320508055370483`"}], "0.`", 
      RowBox[{"-", "1.7320507895521042`"}], "0.`"},
     {"0", "0", "0", "0", "0", "0", "0", "0.`", 
      RowBox[{"-", "0.7745966668711447`"}], "4.53417058619682`*^-23", 
      "3.5586265662156433`*^-10", "4.610578192639192`*^-22", 
      "0.9999999973985391`"},
     {"0", "0", "0", "0", "0", "0", "0", "0.`", 
      RowBox[{"-", "0.4472135949267827`"}], "0.`", 
      RowBox[{"-", "1.7320507895521036`"}], "0.`", 
      RowBox[{"-", "1.7320508055370483`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.702899869039124*^9, 3.702899939280897*^9}, 
   3.70289999167598*^9, 3.702900040911316*^9, 3.702908030548215*^9, 
   3.703242374203801*^9, 3.719299933243546*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flux Matrix Transformation", "Subsection",
 CellChangeTimes->{{3.703244299848589*^9, 3.703244305400457*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AxHermite", " ", "=", " ", 
   RowBox[{"TransfMat20", ".", "Ax20New", ".", 
    RowBox[{"Inverse", "[", "TransfMat20", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AyHermite", "=", 
   RowBox[{"TransfMat20", ".", "Ay20New", ".", 
    RowBox[{"Inverse", "[", "TransfMat20", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7032444231287117`*^9, 3.7032444437268867`*^9}, {
  3.703245013012339*^9, 3.703245046466568*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"AxHermite", ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.703244445284617*^9, 3.7032444719430113`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"1.`", "0", "0", "1.4142136012576794`", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "1.000000004658827`", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1.4142135234885125`", "0", "0", "0", "0", "0", 
      "1.732050764927671`", "0", "0", "0", "0", "0"},
     {"0", "0", "0.999999995341173`", "0", "0", "0", "0", "0", 
      "1.4142135678932195`", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0.9999999810520175`", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0.9999999755451114`",
       "0", "0"},
     {"0", "0", "0", "1.732050850210085`", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1.4142135568529708`", "0", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "1.0000000189479832`", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1.0000000244548892`", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.703244456152766*^9, 3.7032444723089*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"AyHermite", ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.703244538543651*^9, 3.703244542545649*^9}, {
  3.7032450524734287`*^9, 3.703245054475079*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1.000000004658827`", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1.`", "0", "0", "0", "0", "1.4142136012576785`", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0.999999981066592`", "0", "0", 
      "0", "0"},
     {"0", "0.999999995341173`", "0", "0", "0", "0", "0", "0", "0", 
      "1.414213567872607`", "0", "0", "0"},
     {"0", "0", "1.4142135234885131`", "0", "0", "0", "0", "0", "0", "0", "0",
       "1.7320507650509476`", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0.9999999755451113`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1.0000000189334084`", "0", "0", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "1.414213556873583`", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1.7320508500868088`", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1.0000000244548894`", "0", "0", "0", "0",
       "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.703244542911963*^9, 3.703245055238694*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["GenerateProjector2D"], "Input",
 CellChangeTimes->{{3.703244977407742*^9, 3.703245008632675*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["nx", "2"], ",", 
     RowBox[{"2", " ", "nx", " ", "ny"}], ",", 
     SuperscriptBox["ny", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "nx"}], " ", "ny"}], ",", 
     RowBox[{
      SuperscriptBox["nx", "2"], "-", 
      SuperscriptBox["ny", "2"]}], ",", 
     RowBox[{"nx", " ", "ny"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["ny", "2"], ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "nx", " ", "ny"}], ",", 
     SuperscriptBox["nx", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.703244981932785*^9, 3.703244985913365*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Roots", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"4", ",", "c"}], "]"}], "\[Equal]", "0"}], ",", "c"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.703245977259166*^9, 3.703245978864518*^9}, {
  3.703246021194854*^9, 3.7032460383233633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "\[Equal]", "0.741963784302726`"}], "||", 
  RowBox[{"c", "\[Equal]", 
   RowBox[{"-", "0.741963784302726`"}]}], "||", 
  RowBox[{"c", "\[Equal]", "2.3344142183389773`"}], "||", 
  RowBox[{"c", "\[Equal]", 
   RowBox[{"-", "2.3344142183389773`"}]}]}]], "Output",
 CellChangeTimes->{{3.7032460337604322`*^9, 3.703246038756844*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"N", "[", 
   RowBox[{"Eigenvalues", "[", "AxHermite", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7032460427033987`*^9, 3.703246054819358*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.3344142183389804`", ",", 
   RowBox[{"-", "2.334414218338978`"}], ",", "1.7320508075688783`", ",", 
   RowBox[{"-", "1.7320508075688765`"}], ",", "1.0000000000000002`", ",", 
   RowBox[{"-", "0.9999999999999999`"}], ",", "0.9999999999999998`", ",", 
   RowBox[{"-", "0.9999999999999993`"}], ",", 
   RowBox[{"-", "0.7419637843027259`"}], ",", "0.7419637843027257`", ",", "0",
    ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.70324604843734*^9, 3.7032460552385798`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Roots", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"3", ",", "c"}], "]"}], "\[Equal]", "0"}], ",", "c"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.703246078405554*^9, 3.703246078932488*^9}, 
   3.716805933092701*^9, {3.716810123827962*^9, 3.716810123901585*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "\[Equal]", "0.`"}], "||", 
  RowBox[{"c", "\[Equal]", "1.7320508075688772`"}], "||", 
  RowBox[{"c", "\[Equal]", 
   RowBox[{"-", "1.7320508075688772`"}]}]}]], "Output",
 CellChangeTimes->{3.703246080399279*^9, 3.716805933457336*^9, 
  3.7168101242746887`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Roots", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"2", ",", "c"}], "]"}], "\[Equal]", "0"}], ",", "c"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.703246093408258*^9, 3.703246100268764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "\[Equal]", "1.`"}], "||", 
  RowBox[{"c", "\[Equal]", 
   RowBox[{"-", "1.`"}]}]}]], "Output",
 CellChangeTimes->{3.703246100842045*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Roots", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"1", ",", "c"}], "]"}], "\[Equal]", "0"}], ",", "c"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.703247913667161*^9, 3.703247913978085*^9}}],

Cell[BoxData[
 RowBox[{"c", "\[Equal]", "0.`"}]], "Output",
 CellChangeTimes->{3.703247914347636*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tuple Indices", "Subsection",
 CellChangeTimes->{{3.70330621461551*^9, 3.703306217310791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indexG20", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IDXFull", "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"IDXFull", "[", "1", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"IDXFull", "[", "2", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "6"}], "}"}], 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"IDXFull", "[", "3", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "7", ",", "9"}], 
         "}"}], "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "1"}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.703306240572254*^9, 3.703306345710232*^9}, 
   3.703307240900606*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.703306266486949*^9, 3.703306280125222*^9}, {
  3.703306319488226*^9, 3.703306346194125*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OddindexG20", " ", "=", " ", 
   RowBox[{"indexG20", "\[LeftDoubleBracket]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "5", ",", "8", ",", "10", ",", "11"}], "}"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EvenindexG20", " ", "=", " ", 
   RowBox[{"indexG20", "\[LeftDoubleBracket]", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "3", ",", "4", ",", "6", ",", "7", ",", "9", ",", "12", ",", 
      "13"}], "}"}], "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7033949980454807`*^9, 3.703395074703518*^9}}],

Cell[CellGroupData[{

Cell[BoxData["OddindexG20"], "Input",
 CellChangeTimes->{{3.703395076651004*^9, 3.7033950781115427`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7033950785219584`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["EvenindexG20"], "Input",
 CellChangeTimes->{{3.7033950808782463`*^9, 3.70339508561395*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.703395086248275*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quadrature points", "Subsection",
 CellChangeTimes->{{3.7032516672107973`*^9, 3.70325167024275*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EigenVector", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"HermiteTuple", "[", 
      RowBox[{
       RowBox[{"ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"ii", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"ii", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "indexG20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EigenValues", " ", "=", " ", 
   RowBox[{"Chop", "[", 
    RowBox[{"N", "[", 
     RowBox[{"Eigenvalues", "[", "AxHermite", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.703251755576676*^9, 3.703251761800585*^9}, {
  3.703251798824518*^9, 3.703251940022538*^9}, {3.703251978634465*^9, 
  3.703252060771037*^9}, {3.703252114635437*^9, 3.703252295306676*^9}, {
  3.703252359356172*^9, 3.703252388454323*^9}, {3.7032543129639387`*^9, 
  3.7032543978690643`*^9}, {3.703302580389524*^9, 3.703302580501258*^9}, {
  3.703302681953298*^9, 3.7033027630358257`*^9}, {3.703304245281636*^9, 
  3.70330427236768*^9}, {3.703304334339511*^9, 3.703304335784769*^9}, {
  3.703304425149802*^9, 3.703304428836534*^9}, {3.703304479471052*^9, 
  3.7033044828782787`*^9}, {3.703304522283918*^9, 3.703304535656097*^9}, {
  3.7033048099475403`*^9, 3.703304864355288*^9}, {3.703304906720099*^9, 
  3.703304918814856*^9}, {3.703319026001895*^9, 3.7033191348425293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AxHermite", ".", "EigenVector"}], "-", 
        RowBox[{
         RowBox[{
         "EigenValues", "\[LeftDoubleBracket]", "3", 
          "\[RightDoubleBracket]"}], "EigenVector"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"Cx", "\[Rule]", 
        RowBox[{
        "EigenValues", "\[LeftDoubleBracket]", "3", 
         "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.703319138552155*^9, 3.703319200053445*^9}, {
  3.7033192683908577`*^9, 3.703319269640999*^9}, {3.7033193314508467`*^9, 
  3.7033193355697937`*^9}, {3.703319675360426*^9, 3.703319698790049*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"2.449489835525184`"},
      {"0"},
      {
       RowBox[{"1.4142135460170497`", "\[VeryThinSpace]", "-", 
        RowBox[{"1.4142135489748497`", " ", 
         SuperscriptBox["Cy", "2"]}]}]},
      {
       RowBox[{"1.4142135226532275`", "\[VeryThinSpace]", "-", 
        RowBox[{"1.4142135450808793`", " ", 
         SuperscriptBox["Cz", "2"]}]}]},
      {
       RowBox[{
        RowBox[{"2.1213203435730934`", " ", "Cy"}], "-", 
        RowBox[{"0.707106781186548`", " ", 
         SuperscriptBox["Cy", "3"]}]}]},
      {
       RowBox[{"Cy", " ", 
        RowBox[{"(", 
         RowBox[{"1.2247448894232957`", "\[VeryThinSpace]", "-", 
          RowBox[{"1.2247448713915896`", " ", 
           SuperscriptBox["Cz", "2"]}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.703319178325429*^9, 3.703319200428259*^9}, 
   3.70331927041431*^9, 3.7033193360013027`*^9, {3.703319678165543*^9, 
   3.703319699150405*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.703319113398388*^9, 3.703319119732656*^9}}],

Cell[CellGroupData[{

Cell[BoxData["EigenValues"], "Input",
 CellChangeTimes->{{3.7033195265178833`*^9, 3.7033195335851994`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.3344142183389804`", ",", 
   RowBox[{"-", "2.334414218338978`"}], ",", "1.7320508075688783`", ",", 
   RowBox[{"-", "1.7320508075688765`"}], ",", "1.0000000000000002`", ",", 
   RowBox[{"-", "0.9999999999999999`"}], ",", "0.9999999999999998`", ",", 
   RowBox[{"-", "0.9999999999999993`"}], ",", 
   RowBox[{"-", "0.7419637843027259`"}], ",", "0.7419637843027257`", ",", "0",
    ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.703319528769154*^9, 3.703319534174652*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PerformNumericalIntegration3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "List\[Psi]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
    RowBox[{
    "List\[Psi]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
   ",", "QuadPoints", ",", "QuadWeights"}], "]"}]], "Input",
 CellChangeTimes->{{3.703302711736684*^9, 3.7033027385556383`*^9}, {
   3.703302916963584*^9, 3.703302991196656*^9}, {3.7033030235019817`*^9, 
   3.703303025596773*^9}, 3.703304300602845*^9, {3.703304421192689*^9, 
   3.703304451197266*^9}, {3.703304549298327*^9, 3.7033045567855453`*^9}, {
   3.703304597348034*^9, 3.703304598914426*^9}, {3.703304643310768*^9, 
   3.70330464498846*^9}, {3.703304937265237*^9, 3.70330499039958*^9}, {
   3.70330597452357*^9, 3.703305976328891*^9}}],

Cell[BoxData["2.993055555555555`"], "Output",
 CellChangeTimes->{{3.703302713888019*^9, 3.70330273899439*^9}, 
   3.70330299167214*^9, 3.703303025994429*^9, {3.703304278050487*^9, 
   3.7033043011314793`*^9}, 3.703304338547447*^9, {3.703304421992713*^9, 
   3.703304451624194*^9}, 3.703304485883472*^9, {3.703304526904439*^9, 
   3.703304557116434*^9}, 3.703304601625523*^9, 3.703304645415905*^9, 
   3.7033048716441193`*^9, {3.703304931332533*^9, 3.703304990637517*^9}, {
   3.703305971520239*^9, 3.7033059766968527`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7032520190955553`*^9, 3.7032520296001463`*^9}, {
   3.703252397518149*^9, 3.703252402269301*^9}, {3.703252432407864*^9, 
   3.703252435383442*^9}, 3.703302706483596*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "List\[Psi]", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
    RowBox[{
    "List\[Psi]", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
    "f0"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cx", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cy", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Cz", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.703302970527689*^9, 3.703302975867231*^9}, 
   3.703304565906996*^9, {3.703304608833263*^9, 3.703304651924357*^9}, {
   3.703304973385219*^9, 3.7033049759514723`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.703302976195322*^9, 3.703304566401781*^9, {3.7033046391057663`*^9, 
   3.7033046535141277`*^9}, 3.7033049777601833`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3 moment quadrature", "Subsection",
 CellChangeTimes->{{3.7033114895772343`*^9, 3.703311495527669*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrialA", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "Cx", " ", 
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "f0"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cx", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cy", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cz", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "Cx", " ", 
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "f0"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cx", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cy", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cz", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "ii", 
           "\[RightDoubleBracket]"}], "Cx", " ", 
          RowBox[{
          "List\[Psi]", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], "f0"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cx", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cy", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Cz", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703311496522131*^9, 3.703311589245722*^9}, {
  3.7033116389618998`*^9, 3.703311660375471*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrialA", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.70331159547789*^9, 3.703311598640439*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"1", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7033115988970833`*^9, 3.703311664039627*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"List\[Psi]", "\[LeftDoubleBracket]", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.7033116146685333`*^9, 3.7033116231191673`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "Cx", ",", "Cy"}], "}"}]], "Output",
 CellChangeTimes->{3.70331162351585*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Eigenvalues", "[", "TrialA", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7033116707769613`*^9, 3.703311678057496*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.`"}], ",", "1.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.703311678690372*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TrialEigenVector", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "Cy"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrialA", ".", "TrialEigenVector"}], "-", 
  "TrialEigenVector"}]}], "Input",
 CellChangeTimes->{{3.703313490870736*^9, 3.70331349647647*^9}, {
  3.70331353886977*^9, 3.703313672122213*^9}, {3.703318574005034*^9, 
  3.703318592066502*^9}, {3.703318698647047*^9, 3.703318708644154*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"-", "Cy"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.703313673191757*^9, 3.7033185926091833`*^9, {3.703318699229924*^9, 
   3.703318709171262*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Onsager matrix", "Section",
 CellChangeTimes->{{3.71637587950954*^9, 3.716375883943285*^9}}],

Cell[CellGroupData[{

Cell["Return Odd and Even IdxFull", "Subsection",
 CellChangeTimes->{{3.716375944301375*^9, 3.716375951466794*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Return", " ", "the", " ", "odd", " ", "and", " ", "even", " ", "basis", 
    " ", "based", " ", "upon", " ", "a", " ", "degree"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ReturnOddEven", "[", "degree_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"IdxOdd", ",", "IdxEven", ",", "Idx"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Idx", " ", "=", " ", 
        RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IdxOdd", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IdxEven", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", 
            RowBox[{
            "ii", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{"IdxEven", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"IdxEven", ",", "ii", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ",", 
           RowBox[{"IdxOdd", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"IdxOdd", ",", "ii", ",", 
              RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "Idx"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"IdxEven", ",", "IdxOdd"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Return", " ", "odd", " ", "and", " ", "even", " ", "basis", " ", 
     "indices", " ", "for", " ", "the", " ", "complete", " ", "moment", " ", 
     "approximation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ReturnOddEvenComplete", "[", "M_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"IdxOdd", ",", "IdxEven"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"IdxOdd", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IdxEven", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IdxOdd", " ", "=", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{"IdxOdd", ",", 
             RowBox[{
              RowBox[{"ReturnOddEven", "[", "ii", "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", 
          RowBox[{"IdxEven", " ", "=", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{"IdxEven", ",", 
             RowBox[{
              RowBox[{"ReturnOddEven", "[", "ii", "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "M", ",", "1"}], "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"IdxOdd", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"IdxOdd", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IdxEven", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"IdxEven", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"IdxEven", ",", "IdxOdd"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.716375953352191*^9, 3.716376034238977*^9}, {
  3.7163760683672647`*^9, 3.716376128510169*^9}, {3.71637664277308*^9, 
  3.7163767613799343`*^9}, {3.7163768028885937`*^9, 3.7163768992096233`*^9}, {
  3.71637701537607*^9, 3.7163770197099648`*^9}, {3.7163771445748863`*^9, 
  3.716377156376273*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Return Aoe", "Subsection",
 CellChangeTimes->{{3.7163762403893538`*^9, 3.716376242174458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReturnAoe", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "IdxOdd", ",", "IdxEven", ",", "Aoe", ",", "numOdd", ",", "numEven"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"IdxEven", ",", "IdxOdd"}], "}"}], "=", 
      RowBox[{"ReturnOddEvenComplete", "[", "M", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numOdd", " ", "=", " ", 
      RowBox[{"Length", "[", "IdxOdd", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numEven", " ", "=", " ", 
      RowBox[{"Length", "[", "IdxEven", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Aoe", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"numOdd", ",", "numEven"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Aoe", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "IdxOdd", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "IdxEven", "\[LeftDoubleBracket]", "jj", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "]"}], 
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "IdxOdd", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "IdxEven", "\[LeftDoubleBracket]", "jj", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SqrtBox[
               RowBox[{
                RowBox[{
                 RowBox[{
                 "IdxOdd", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "1"}]], 
              RowBox[{"\[Delta]", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "IdxOdd", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{
                 "IdxEven", "\[LeftDoubleBracket]", "jj", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox[
               RowBox[{
                RowBox[{
                "IdxOdd", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]], 
              RowBox[{"\[Delta]", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "IdxOdd", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "-", "1"}], ",", 
                RowBox[{
                 RowBox[{
                 "IdxEven", "\[LeftDoubleBracket]", "jj", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "numEven"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "numOdd"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Aoe"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.716376243503799*^9, 3.716376271304495*^9}, {
  3.716376976343926*^9, 3.716376977672763*^9}, {3.716377007707491*^9, 
  3.7163773070404577`*^9}, {3.716377820440373*^9, 3.716377836424883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReturnOddEven", "[", "3", "]"}]], "Input",
 CellChangeTimes->{{3.7163760813937483`*^9, 3.7163760851145563`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7163760854526653`*^9, 3.716376131843416*^9, 
  3.716790850509673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KroneckerDelta", "[", 
  RowBox[{"1", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.7163761871730003`*^9, 3.716376201627295*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7163761983268757`*^9, 3.716376201902638*^9}, 
   3.716790850555172*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Return Min", "Subsection",
 CellChangeTimes->{{3.7163787494111433`*^9, 3.716378750973196*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReturnMin", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "IdxOdd", ",", "IdxEven", ",", "Min", ",", "numOdd", ",", "numEven"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"IdxEven", ",", "IdxOdd"}], "}"}], "=", 
      RowBox[{"ReturnOddEvenComplete", "[", "M", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numOdd", " ", "=", " ", 
      RowBox[{"Length", "[", "IdxOdd", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numEven", " ", "=", " ", 
      RowBox[{"Length", "[", "IdxEven", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Min", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"numOdd", ",", "numEven"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "the", " ", "factor", " ", "of", " ", "2", " ", "comes", " ", "from", 
        " ", "the", " ", "left"}], ",", " ", 
       RowBox[{
       "see", " ", "paper", " ", "on", " ", "inflow", " ", "and", " ", 
        "outflow", " ", 
        RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"2", " ", 
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "IdxOdd", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "IdxEven", "\[LeftDoubleBracket]", "jj", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "]"}], 
           RowBox[{"\[Delta]", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "IdxOdd", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "IdxEven", "\[LeftDoubleBracket]", "jj", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], "]"}], 
           RowBox[{"HSpcInt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "IdxOdd", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
              "IdxEven", "\[LeftDoubleBracket]", "jj", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "numEven"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "numOdd"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Min"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7163787529904222`*^9, 3.716378980148285*^9}, {
  3.716379012809185*^9, 3.716379027165905*^9}, {3.7163790575848513`*^9, 
  3.716379086404491*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Return the Onsager Matrix", "Subsection",
 CellChangeTimes->{{3.71637925960465*^9, 3.716379264083246*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReturnOnsagerMatrix", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Aoe", ",", "Min", ",", "numOdd"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Aoe", " ", "=", " ", 
      RowBox[{"ReturnAoe", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Min", " ", "=", 
      RowBox[{"ReturnMin", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numOdd", " ", "=", " ", 
      RowBox[{"Length", "[", "Min", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Min", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", "numOdd"}], ",", 
         RowBox[{"1", ";;", "numOdd"}]}], "\[RightDoubleBracket]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"Aoe", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"1", ";;", "numOdd"}], ",", 
          RowBox[{"1", ";;", "numOdd"}]}], "\[RightDoubleBracket]"}], "]"}]}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.716379419047204*^9, 3.71637950244501*^9}, {
  3.716379686654131*^9, 3.71637971006251*^9}, {3.716380876952567*^9, 
  3.716380919647645*^9}}]
}, Closed]]
}, Closed]]
},
WindowSize->{870, 708},
WindowMargins->{{13, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 364, 7, 93, "Input", "ExpressionUUID" -> \
"b79c051c-2788-4eb4-9e68-4be2711bfe1d"],
Cell[947, 31, 227, 4, 67, "Output", "ExpressionUUID" -> \
"f1d23f9f-830b-4739-9100-c3a253c9f6ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1211, 40, 228, 4, 67, "Input", "ExpressionUUID" -> \
"e075c8d9-1965-4d21-a7af-9da65262129f"],
Cell[1442, 46, 253, 4, 67, "Output", "ExpressionUUID" -> \
"fa74f4f2-40e8-4256-88f0-98d058fae14d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1732, 55, 103, 1, 81, "Section", "ExpressionUUID" -> \
"336ea626-5083-469e-b073-7fd6cfc155e8"],
Cell[1838, 58, 201, 5, 40, "Input", "ExpressionUUID" -> \
"d3380932-9f3d-4aa6-938c-3f61a00ffef4"],
Cell[2042, 65, 528, 12, 133, "Text", "ExpressionUUID" -> \
"a4eb56b9-19d6-467b-86f5-03a089083493"],
Cell[2573, 79, 28302, 727, 4045, "Input", "ExpressionUUID" -> \
"f1155200-b7fd-4445-b0c9-5ac00a2f7277"],
Cell[30878, 808, 5842, 141, 4868, "Input", "ExpressionUUID" -> \
"3f00e438-6998-4986-8e2a-2ad88c064090"],
Cell[36723, 951, 1556, 41, 1272, "Input", "ExpressionUUID" -> \
"eea245d8-482f-45be-8009-a2c5f784182e"],
Cell[CellGroupData[{
Cell[38304, 996, 626, 17, 487, "Input", "ExpressionUUID" -> \
"6e10c523-b20a-411d-82aa-0375a4404915"],
Cell[38933, 1015, 5637, 145, 70, "Output", "ExpressionUUID" -> \
"1693c175-d2df-4336-aaf5-5ff17f9d09e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44607, 1165, 708, 18, 40, "Input", "ExpressionUUID" -> \
"083899bf-6724-4e8d-b5c9-8ea76e3344dc"],
Cell[45318, 1185, 3546, 79, 148, "Output", "ExpressionUUID" -> \
"9aacd9f7-b39f-4111-9de7-2cbed4fe1f1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48901, 1269, 945, 21, 40, "Input", "ExpressionUUID" -> \
"afec7cc1-691e-4cb1-b736-f930ea88a32c"],
Cell[49849, 1292, 2565, 42, 67, "Output", "ExpressionUUID" -> \
"ea391449-082e-47e4-907e-81f6ca58bfe6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52451, 1339, 529, 14, 67, "Input", "ExpressionUUID" -> \
"6ad97654-c4fa-4527-9be6-034b0e540cbb"],
Cell[52983, 1355, 2192, 35, 40, "Output", "ExpressionUUID" -> \
"d84fd1ca-0073-43b1-90aa-0bafaa0e1e5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55212, 1395, 1266, 31, 171, "Input", "ExpressionUUID" -> \
"d6e52790-cf0d-4e69-ab56-039e8daed450"],
Cell[56481, 1428, 2195, 37, 40, "Output", "ExpressionUUID" -> \
"b73d5fbd-74c5-462a-8b79-949cb9100742"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58713, 1470, 1448, 35, 197, "Input", "ExpressionUUID" -> \
"75a72f51-6bbd-4763-bfee-9c6adb97c4c6"],
Cell[60164, 1507, 2317, 39, 40, "Output", "ExpressionUUID" -> \
"9569f68f-d0fb-4fb3-b261-339f8fd9c3e3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[62530, 1552, 104, 1, 62, "Section", "ExpressionUUID" -> \
"6e5a4a77-f05f-4de5-ba8e-7d8f260834b5"],
Cell[62637, 1555, 12122, 278, 1100, "Input", "ExpressionUUID" -> \
"e01a9b14-8fa7-49c0-8a9b-61b02855b0b1"]
}, Closed]],
Cell[CellGroupData[{
Cell[74796, 1838, 98, 1, 62, "Section", "ExpressionUUID" -> \
"a10dc6ae-745b-4f20-b5d1-f6bbd46b6a23"],
Cell[74897, 1841, 3011, 68, 379, "Input", "ExpressionUUID" -> \
"f77d6753-dca7-484e-b31c-e49b8bdce2f0"]
}, Closed]],
Cell[CellGroupData[{
Cell[77945, 1914, 98, 1, 62, "Section", "ExpressionUUID" -> \
"ca95d21e-c760-48b7-af5a-6a234d534796"],
Cell[78046, 1917, 4028, 119, 613, "Input", "ExpressionUUID" -> \
"8541a0c7-d11b-4b59-b962-17bc0fb2e96a"]
}, Closed]],
Cell[CellGroupData[{
Cell[82111, 2041, 99, 1, 62, "Section", "ExpressionUUID" -> \
"3f24f4c7-6fea-4184-8e90-5581dcff66e5"],
Cell[82213, 2044, 2271, 67, 231, "Input", "ExpressionUUID" -> \
"7abbfed4-25a0-42db-ae7e-c3764f481fc5"]
}, Closed]],
Cell[CellGroupData[{
Cell[84521, 2116, 98, 1, 62, "Section", "ExpressionUUID" -> \
"9c8181fc-2464-476a-ab46-1eaa815df922"],
Cell[84622, 2119, 9284, 248, 1366, "Input", "ExpressionUUID" -> \
"c388e1a5-0ce2-43db-be7d-dbeb06650762"]
}, Closed]],
Cell[CellGroupData[{
Cell[93943, 2372, 170, 2, 62, "Section", "ExpressionUUID" -> \
"74eecf50-1bb0-4141-8655-d8e594017a00"],
Cell[94116, 2376, 9919, 226, 2100, "Input", "ExpressionUUID" -> \
"4e3c1f32-3bee-4ad7-89cd-9ae34d166c15"],
Cell[104038, 2604, 336, 8, 60, "Input", "ExpressionUUID" -> \
"da7895a1-5eca-492c-8c0a-d25db6675f1c"],
Cell[CellGroupData[{
Cell[104399, 2616, 111, 1, 83, "Subsection", "ExpressionUUID" -> \
"fa8b9a9a-a77e-4262-93b9-82404ec085ac"],
Cell[104513, 2619, 8386, 200, 1578, "Input", "ExpressionUUID" -> \
"01977b48-dc73-4a4e-813b-e405379f4d33"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[112948, 2825, 174, 2, 62, "Section", "ExpressionUUID" -> \
"4d779032-e79f-4ce9-b7e3-34798216e249"],
Cell[CellGroupData[{
Cell[113147, 2831, 93, 1, 54, "Subsection", "ExpressionUUID" -> \
"028d8931-fe76-4202-9e82-0a17a3016ebe"],
Cell[113243, 2834, 1876, 44, 375, "Input", "ExpressionUUID" -> \
"314b8b96-88d7-46b8-bdf3-23a0abb8aa9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115156, 2883, 109, 1, 54, "Subsection", "ExpressionUUID" -> \
"321b80a6-dc46-427d-b3a0-98f2f40d4541"],
Cell[115268, 2886, 9550, 215, 1471, "Input", "ExpressionUUID" -> \
"6b2bdafe-fd81-4926-91e5-f181c78557dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124867, 3107, 108, 1, 81, "Section", "ExpressionUUID" -> \
"1087f3a4-1bea-4900-9fea-e8d30ac1de88"],
Cell[124978, 3110, 125, 2, 40, "Input", "ExpressionUUID" -> \
"cae9c1b2-0808-424e-bf56-24474f3e9433"],
Cell[125106, 3114, 1226, 28, 112, "Input", "ExpressionUUID" -> \
"fe6dfb38-23f2-49f3-9f76-97381f9d396a"],
Cell[CellGroupData[{
Cell[126357, 3146, 95, 1, 54, "Subsection", "ExpressionUUID" -> \
"7be0359e-17f1-489d-8a92-139d092e614f"],
Cell[126455, 3149, 1525, 37, 249, "Input", "ExpressionUUID" -> \
"5a3fe35f-950c-4dfe-8290-53d2608722f4"],
Cell[CellGroupData[{
Cell[128005, 3190, 970, 25, 72, "Input", "ExpressionUUID" -> \
"a2474d72-e2c9-400c-9fea-bf3fe3657523"],
Cell[128978, 3217, 568, 10, 40, "Output", "ExpressionUUID" -> \
"f85ff9e8-421d-4fd4-8847-f53446576641"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129595, 3233, 105, 1, 54, "Subsection", "ExpressionUUID" -> \
"913c336a-fc27-4d8c-9ab4-a0f11fa2cedb"],
Cell[129703, 3236, 1413, 36, 181, "Input", "ExpressionUUID" -> \
"bc84fb96-aeeb-4cba-ac50-7ff301020faf"],
Cell[131119, 3274, 1508, 42, 181, "Input", "ExpressionUUID" -> \
"cffc93c3-c5c8-4ae4-a4c1-c83cf621e0bb"],
Cell[CellGroupData[{
Cell[132652, 3320, 186, 3, 50, "Input", "ExpressionUUID" -> \
"56cb8d64-b550-4d5c-ab2a-eca88d9e7b3d"],
Cell[132841, 3325, 2766, 57, 406, "Output", "ExpressionUUID" -> \
"10eb66bc-2dd3-40b1-b1a6-26602ae522f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135656, 3388, 114, 1, 67, "Subsection", "ExpressionUUID" -> \
"11a38fd8-a2b2-4259-9dd4-6f0d1a9e628b"],
Cell[135773, 3391, 477, 11, 102, "Input", "ExpressionUUID" -> \
"12dd5ac3-9ff7-4ea8-bee6-5ab985f67710"],
Cell[CellGroupData[{
Cell[136275, 3406, 238, 6, 66, "Input", "ExpressionUUID" -> \
"f9c0bf4f-54b7-44a3-bb16-e108a128c1ae"],
Cell[136516, 3414, 1837, 39, 468, "Output", "ExpressionUUID" -> \
"ca0d1ed8-3ac0-460e-afe0-6f79c228882b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138390, 3458, 287, 7, 66, "Input", "ExpressionUUID" -> \
"a79a9a46-6925-47dd-be86-6b827f9ac2cb"],
Cell[138680, 3467, 1836, 39, 468, "Output", "ExpressionUUID" -> \
"0bca4d5a-7483-45b7-959c-30fd23d748e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140553, 3511, 111, 1, 60, "Input", "ExpressionUUID" -> \
"05ddab9f-9c2b-4075-9e71-a1cc54793935"],
Cell[140667, 3514, 698, 22, 66, "Output", "ExpressionUUID" -> \
"a10c4783-98b6-47e3-9502-4b80eb736b28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141402, 3541, 320, 9, 60, "Input", "ExpressionUUID" -> \
"abdc5633-1050-4ba5-bc49-ff81f7cdec45"],
Cell[141725, 3552, 369, 8, 60, "Output", "ExpressionUUID" -> \
"b08fa926-6e5f-4f57-beb5-b8c43e1845d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142131, 3565, 200, 4, 60, "Input", "ExpressionUUID" -> \
"88a66552-e94a-4a28-867b-1bcbe196ffe5"],
Cell[142334, 3571, 528, 9, 60, "Output", "ExpressionUUID" -> \
"37e08575-81e5-4918-997a-74deee719751"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142899, 3585, 341, 9, 60, "Input", "ExpressionUUID" -> \
"4811a550-a8c5-40e5-99ae-2365a6b4480a"],
Cell[143243, 3596, 300, 7, 60, "Output", "ExpressionUUID" -> \
"5873cce1-01de-4f87-a8e6-00d32f4466c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143580, 3608, 269, 8, 60, "Input", "ExpressionUUID" -> \
"22872248-5f6b-43c9-b638-53da6977f23b"],
Cell[143852, 3618, 176, 5, 60, "Output", "ExpressionUUID" -> \
"9258641e-a268-4267-934a-3c6a7e7bd995"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144065, 3628, 269, 8, 60, "Input", "ExpressionUUID" -> \
"37fabaa3-57cf-408e-bb35-8b25c1290c7e"],
Cell[144337, 3638, 101, 2, 60, "Output", "ExpressionUUID" -> \
"4bd13fe8-85cb-487c-9b2a-490649199cf9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[144487, 3646, 100, 1, 53, "Subsection", "ExpressionUUID" -> \
"2f35e7d8-db43-4830-97b3-dca078ee1df9"],
Cell[CellGroupData[{
Cell[144612, 3651, 951, 24, 116, "Input", "ExpressionUUID" -> \
"699f6ea4-804e-4109-a71c-e64f45bc8c72"],
Cell[145566, 3677, 1065, 30, 83, "Output", "ExpressionUUID" -> \
"267d096e-1b1a-4077-b295-aca06d52ad0e"]
}, Open  ]],
Cell[146646, 3710, 610, 14, 83, "Input", "ExpressionUUID" -> \
"061b1ea1-3d2b-419f-a30a-3b79da3589c9"],
Cell[CellGroupData[{
Cell[147281, 3728, 105, 1, 50, "Input", "ExpressionUUID" -> \
"36ff5a58-9419-445e-9042-db0c60b8d1e4"],
Cell[147389, 3731, 442, 13, 50, "Output", "ExpressionUUID" -> \
"fbc67493-2395-4277-a3e2-8a4e1cdc2cb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147868, 3749, 105, 1, 50, "Input", "ExpressionUUID" -> \
"62ef4b2a-0cb5-44d5-8da3-8f5576957369"],
Cell[147976, 3752, 647, 19, 83, "Output", "ExpressionUUID" -> \
"440b0ae0-439f-4762-a0c7-2b34bce633b0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148672, 3777, 106, 1, 67, "Subsection", "ExpressionUUID" -> \
"26f12067-9fb7-41c3-a5d6-774050eddd99"],
Cell[148781, 3780, 1531, 32, 487, "Input", "ExpressionUUID" -> \
"8ae38dae-a844-4a98-b671-40ddc3a7cbe3"],
Cell[CellGroupData[{
Cell[150337, 3816, 847, 22, 531, "Input", "ExpressionUUID" -> \
"0eb244a8-0a7c-46d3-a0ca-130ea785fcc4"],
Cell[151187, 3840, 1605, 48, 2307, "Output", "ExpressionUUID" -> \
"8404a60a-dc63-4d8e-b049-66c9030efff7"]
}, Open  ]],
Cell[152807, 3891, 92, 1, 291, "Input", "ExpressionUUID" -> \
"f6984d32-5eda-49d2-9f76-9a1a61ce04c2"],
Cell[CellGroupData[{
Cell[152924, 3896, 107, 1, 291, "Input", "ExpressionUUID" -> \
"0b048f2a-d25d-46ea-9757-ca92be67b584"],
Cell[153034, 3899, 527, 9, 291, "Output", "ExpressionUUID" -> \
"cb64fbdc-afe0-4777-a590-c917cc050e25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153598, 3913, 806, 15, 291, "Input", "ExpressionUUID" -> \
"368bbe73-06aa-464b-8322-648b5bd3357e"],
Cell[154407, 3930, 523, 7, 291, "Output", "ExpressionUUID" -> \
"175da3e0-c413-4168-8844-a40827277ce0"]
}, Open  ]],
Cell[154945, 3940, 218, 3, 291, "Input", "ExpressionUUID" -> \
"bc830c6e-320d-43f2-973d-4926ff7ca5ab"],
Cell[CellGroupData[{
Cell[155188, 3947, 797, 21, 291, "Input", "ExpressionUUID" -> \
"887fef4a-8787-4f55-b51e-844ef35b6fb2"],
Cell[155988, 3970, 173, 3, 291, "Output", "ExpressionUUID" -> \
"6fbd966f-0f19-4e0a-ae38-70956c311e91"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[156210, 3979, 109, 1, 53, "Subsection", "ExpressionUUID" -> \
"272cd261-ef6c-4eab-ac5d-974e0835d6de"],
Cell[156322, 3982, 2521, 67, 1075, "Input", "ExpressionUUID" -> \
"9fb3be12-3622-4745-b781-db0949e5afa2"],
Cell[CellGroupData[{
Cell[158868, 4053, 129, 2, 291, "Input", "ExpressionUUID" -> \
"7fce06a6-9871-45f2-9849-f900a4f76f4c"],
Cell[159000, 4057, 683, 19, 571, "Output", "ExpressionUUID" -> \
"dc904ea9-89ab-4cf1-bcd1-21d3457b35b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159720, 4081, 232, 5, 291, "Input", "ExpressionUUID" -> \
"ff2a62b5-2d1c-435f-b695-0ade01eac476"],
Cell[159955, 4088, 126, 3, 291, "Output", "ExpressionUUID" -> \
"5e238542-2a25-4c11-a664-eb1fe1dc59f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160118, 4096, 165, 3, 291, "Input", "ExpressionUUID" -> \
"bcf8ac83-1b58-4af8-9061-561e295f9ffa"],
Cell[160286, 4101, 150, 4, 291, "Output", "ExpressionUUID" -> \
"3f0bb957-5177-4a52-8a76-142c8bdf5a8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160473, 4110, 463, 10, 487, "Input", "ExpressionUUID" -> \
"b8c875c2-55f4-4415-ba52-f9affb8d46c3"],
Cell[160939, 4122, 222, 6, 597, "Output", "ExpressionUUID" -> \
"5f0d135f-07b3-4b8d-b10c-812b783fb370"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161222, 4135, 98, 1, 101, "Section", "ExpressionUUID" -> \
"6aaec851-2cb3-405a-a384-008014a5942e"],
Cell[CellGroupData[{
Cell[161345, 4140, 115, 1, 67, "Subsection", "ExpressionUUID" -> \
"d5d4fab1-b548-41d7-a161-f380cd238c5d"],
Cell[161463, 4143, 4331, 104, 928, "Input", "ExpressionUUID" -> \
"583e4ea4-0561-476e-b057-7d93047e8aa9"]
}, Closed]],
Cell[CellGroupData[{
Cell[165831, 4252, 100, 1, 53, "Subsection", "ExpressionUUID" -> \
"c2b17dfa-d25f-400f-95f8-0146c8539528"],
Cell[165934, 4255, 4525, 109, 1956, "Input", "ExpressionUUID" -> \
"677c9849-902e-4aa0-821a-7ffc82a8007e"],
Cell[CellGroupData[{
Cell[170484, 4368, 136, 2, 145, "Input", "ExpressionUUID" -> \
"b4256d0c-db57-414c-b0ec-346cd98e6b13"],
Cell[170623, 4372, 952, 28, 135, "Output", "ExpressionUUID" -> \
"6c597d52-4ef8-432a-b67d-c71d23964af2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171612, 4405, 158, 3, 145, "Input", "ExpressionUUID" -> \
"acbbf9c6-a370-4c74-b43b-97b9650e9b54"],
Cell[171773, 4410, 122, 2, 135, "Output", "ExpressionUUID" -> \
"ef74e0a3-d422-43e6-b591-62c061b9938b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[171944, 4418, 100, 1, 53, "Subsection", "ExpressionUUID" -> \
"bf533f5c-3745-4fd0-af38-506191360acc"],
Cell[172047, 4421, 3578, 88, 788, "Input", "ExpressionUUID" -> \
"b9ac20b3-263c-4e14-93ab-21f261f8d5e3"]
}, Closed]],
Cell[CellGroupData[{
Cell[175662, 4514, 112, 1, 53, "Subsection", "ExpressionUUID" -> \
"7342e1ef-a69d-4df6-8b1c-eeea09003e6a"],
Cell[175777, 4517, 1276, 30, 278, "Input", "ExpressionUUID" -> \
"29cb0963-b66f-4067-b75a-94596f83f32c"]
}, Closed]]
}, Closed]]
}
]
*)

