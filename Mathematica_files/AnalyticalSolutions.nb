Notebook[{

Cell[CellGroupData[{
Cell["Differential Operators in Cylindrical Coordinates", "Section"],

Cell[TextData[{
 "In tables last index corresponds to inner loop: ",
 StyleBox["Table[Table[a[[i, j]], {j,}], {i,}]", "Input"],
 " "
}], "Text",
 FontFamily->"Adobe Sans MM",
 FontSize->14,
 Background->RGBColor[0, 1, 1]],

Cell["Actual V is covariant (indices are superscripts)", "Text",
 FontFamily->"Adobe Sans MM",
 FontSize->14,
 Background->RGBColor[0, 1, 1]],

Cell[TextData[{
 "Physical coordinates require scaling with ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{"g", "\[LeftDoubleBracket]", 
     RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], TraditionalForm]]],
 StyleBox[" ", "Input"]
}], "Text",
 FontFamily->"Adobe Sans MM",
 FontSize->14,
 Background->RGBColor[0, 1, 1]],

Cell["\<\
Attention with signs of Christoffels when calculating double gradients\
\>", "Text",
 FontFamily->"Adobe Sans MM",
 FontSize->14,
 Background->RGBColor[0, 1, 1]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "spell1"}], "]"}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Remove", "::", "rmnsm"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"There are no symbols matching \
\\\"\[NoBreak]\\!\\(\\\"Global`*\\\"\\)\[NoBreak]\\\". \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Remove/rmnsm\\\", \
ButtonNote -> \\\"Remove::rmnsm\\\"]\\)\"\>"}]], "Message", "MSG"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assumptions, coordinates and parametrization:", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ass", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", ">", "0"}], ",", 
     RowBox[{"0", "<", "\[Theta]", "<", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", "\[CurlyPhi]", "<", 
      RowBox[{"2", "*", "\[Pi]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[CurlyPhi]", ",", "r", ",", "z"}], "}"}], 
      "\[Element]", "Reals"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$Assumptions", "=", "Ass"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"{", 
    RowBox[{"r", ",", "\[Theta]", ",", "z"}], "}"}]}], ";", " ", 
  RowBox[{"n", "=", "3"}], ";", " ", 
  RowBox[{
   SubscriptBox["n", "0"], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "*", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"r", "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "z"}], "}"}]}], 
  ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Coordinate basis (Jacobian), inverse Jacobian, metric, inverse metric, \
Christoffel symbols und volume measure:\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "\[Mu]", "]"}], "]"}]], " ", 
          RowBox[{"P", "[", 
           RowBox[{"[", "\[Nu]", "]"}], "]"}]}], ",", "Ass"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Nu]", ",", 
       SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", "e"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ji", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "J", "]"}], ",", "Ass"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "J", "]"}], ".", "J"}], ",", "Ass"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gi", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "g", "]"}], ",", "Ass"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sdetg", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     SqrtBox[
      RowBox[{"Abs", "[", 
       RowBox[{"Det", "[", "g", "]"}], "]"}]], ",", "Ass"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], "*", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Sigma]", "=", 
               SubscriptBox["n", "0"]}], "n"], 
             RowBox[{
              RowBox[{"gi", "[", 
               RowBox[{"[", 
                RowBox[{"\[Lambda]", ",", "\[Sigma]"}], "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "\[Mu]", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Sigma]", ",", "\[Nu]"}], "]"}], "]"}]}], "+", 
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "\[Nu]", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], "]"}]}], "-", 
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "\[Sigma]", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Mu]", ",", "\[Nu]"}], 
                  "\[RightDoubleBracket]"}]}]}], ")"}]}]}]}], ",", "Ass"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", ",", 
       SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "g"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["gi"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SuperscriptBox["r", "2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\[CapitalGamma]"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "r"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", "r"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "r"], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
    RowBox[{"i", ",", "2", ",", "l"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "r"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "r"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gradient and Laplacian of a scalar function:", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"V", "=", 
   RowBox[{"A", "[", "x1", "]"}]}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"GradV", "[", "V_", "]"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}]], " ", "V"}], ",", "Ass"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";"}], "*)"}]], 
 "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Grad0", "[", "S_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "i", "]"}], "]"}]], " ", "S"}], ",", "Ass"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"gi", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", "Ass"}], 
      "]"}], "]"}]}], ")"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grad0", "[", 
  RowBox[{"S", "[", 
   RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["S", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["S", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}], "r"], ",", 
   RowBox[{
    SuperscriptBox["S", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"r", ",", "\[Theta]", ",", "z"}], "]"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplace0", "[", "S_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"xx", "[", 
            RowBox[{"[", "i", "]"}], "]"}]], " ", "S"}], ",", "Ass"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"temp2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"xx", "[", 
               RowBox[{"[", "k", "]"}], "]"}]], " ", 
             RowBox[{"temp1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "-", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Sigma]", "=", 
               SubscriptBox["n", "0"]}], "n"], 
             RowBox[{
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"[", 
                RowBox[{"\[Sigma]", ",", "i", ",", "k"}], "]"}], "]"}], "*", 
              RowBox[{"temp1", "[", 
               RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}]}], ",", "Ass"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gi", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], 
         RowBox[{"temp2", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gradient, Divergence and Laplacian of a vector field :", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"V", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox[
          RowBox[{"g", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{
        SubscriptBox["A", "i"], "[", "x1", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"GradV", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", 
             RowBox[{"x", "[", 
              RowBox[{"[", "k", "]"}], "]"}]], " ", 
            RowBox[{"V", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"\[Sigma]", "=", 
              SubscriptBox["n", "0"]}], "n"], 
            RowBox[{
             RowBox[{"\[CapitalGamma]", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
             RowBox[{"V", "[", 
              RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}]}], ",", "Ass"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Expand", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"g", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
          SqrtBox[
           RowBox[{"gi", "\[LeftDoubleBracket]", 
            RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]], 
          RowBox[{"GradV", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", "Ass"}], 
    "]"}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Grad1", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], ")"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{
         "V", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"xx", "[", 
               RowBox[{"[", "k", "]"}], "]"}]], " ", 
             RowBox[{"temp", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Sigma]", "=", 
               SubscriptBox["n", "0"]}], "n"], 
             RowBox[{
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}]}], ",", "Ass"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SqrtBox[
             RowBox[{"g", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
            SqrtBox[
             RowBox[{"gi", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]], 
            RowBox[{"temp1", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", "Ass"}], 
      "]"}], "]"}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Div1", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], ")"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{
         "V", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"xx", "[", 
               RowBox[{"[", "k", "]"}], "]"}]], " ", 
             RowBox[{"temp", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Sigma]", "=", 
               SubscriptBox["n", "0"]}], "n"], 
             RowBox[{
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}]}], ",", "Ass"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"temp1", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplace1", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], ")"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{
         "V", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"xx", "[", 
               RowBox[{"[", "k", "]"}], "]"}]], " ", 
             RowBox[{"temp", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"\[Sigma]", "=", 
               SubscriptBox["n", "0"]}], "n"], 
             RowBox[{
              RowBox[{"\[CapitalGamma]", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
              RowBox[{"temp", "[", 
               RowBox[{"[", "\[Sigma]", "]"}], "]"}]}]}]}], ",", "Ass"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"temp2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"xx", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]], " ", 
               RowBox[{"temp1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
                RowBox[{"temp1", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Sigma]", ",", "j"}], "]"}], "]"}]}]}], "-", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Sigma]", ",", "j", ",", "k"}], "]"}], "]"}], "*", 
                RowBox[{"temp1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "\[Sigma]"}], "]"}], "]"}]}]}]}], ",", 
             "Ass"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"g", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"gi", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], 
            RowBox[{"temp2", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "k", ",", "k"}], "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Divergence and Laplace of rank 2 tensor :", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"V", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            SqrtBox[
             RowBox[{
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]], ")"}], 
           RowBox[{"-", "1"}]], 
          RowBox[{
           SubscriptBox["A", 
            RowBox[{"i", ",", "j"}]], "[", "x", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"GradV", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["\[PartialD]", 
               RowBox[{"x", "[", 
                RowBox[{"[", "k", "]"}], "]"}]], " ", 
              RowBox[{"V", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"\[Sigma]", "=", 
                SubscriptBox["n", "0"]}], "n"], 
              RowBox[{
               RowBox[{"\[CapitalGamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
               
               RowBox[{"V", "[", 
                RowBox[{"[", 
                 RowBox[{"\[Sigma]", ",", "j"}], "]"}], "]"}]}]}], "+", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"\[Sigma]", "=", 
                SubscriptBox["n", "0"]}], "n"], 
              RowBox[{
               RowBox[{"\[CapitalGamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "\[Sigma]", ",", "k"}], "]"}], "]"}], "*", 
               
               RowBox[{"V", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "\[Sigma]"}], "]"}], "]"}]}]}]}], ",", 
            "Ass"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Expand", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"g", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
             RowBox[{"g", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], 
             RowBox[{"gi", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}]], 
           RowBox[{"GradV", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DivV", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{"g", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"GradV", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"GradGradV", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["\[PartialD]", 
                 RowBox[{
                 "x", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]],
                 " ", 
                RowBox[{"GradV", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", "k"}], 
                 "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[Sigma]", "=", 
                  SubscriptBox["n", "0"]}], "n"], 
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "\[Sigma]", ",", "l"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"GradV", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Sigma]", ",", "j", ",", "k"}], 
                  "\[RightDoubleBracket]"}]}]}], "+", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[Sigma]", "=", 
                  SubscriptBox["n", "0"]}], "n"], 
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "\[Sigma]", ",", "l"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"GradV", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                  "\[RightDoubleBracket]"}]}]}], "-", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[Sigma]", "=", 
                  SubscriptBox["n", "0"]}], "n"], 
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Sigma]", ",", "k", ",", "l"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"GradV", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j", ",", "\[Sigma]"}], 
                  "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"LaplaceV", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"gi", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], 
             RowBox[{"GradGradV", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k", ",", "k"}], 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Div2", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SqrtBox[
              RowBox[{
               RowBox[{"g", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"g", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]], ")"}], 
            
            RowBox[{"-", "1"}]], 
           RowBox[{"V", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{
                "xx", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]],
                " ", 
               RowBox[{"temp", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"temp", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Sigma]", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "\[Sigma]", ",", "k"}], 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"temp", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Sigma]"}], 
                 "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"g", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"temp1", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "k", ",", "k"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"S", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Div2", "[", "S", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], "r"], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], "r"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "3"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "z"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "1"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], "r"], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], "r"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "3"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "z"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"2", ",", "1"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "z"}], "]"}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "[", 
      RowBox[{"r", ",", "z"}], "]"}], "r"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"3", ",", "3"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "z"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"s", "[", 
       RowBox[{"3", ",", "1"}], "]"}], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"r", ",", "z"}], "]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Grad2", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SqrtBox[
              RowBox[{
               RowBox[{"g", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"g", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]], ")"}], 
            
            RowBox[{"-", "1"}]], 
           RowBox[{"V", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{
                "xx", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]],
                " ", 
               RowBox[{"temp", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"temp", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Sigma]", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "\[Sigma]", ",", "k"}], 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"temp", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Sigma]"}], 
                 "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SqrtBox[
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
             SqrtBox[
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]], 
             SqrtBox[
              RowBox[{"gi", "\[LeftDoubleBracket]", 
               RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]], 
             RowBox[{"temp1", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplace2", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SqrtBox[
              RowBox[{
               RowBox[{"g", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"g", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]], ")"}], 
            
            RowBox[{"-", "1"}]], 
           RowBox[{"V", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{
                "xx", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]],
                " ", 
               RowBox[{"temp", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"temp", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Sigma]", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}]}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"\[Sigma]", "=", 
                 SubscriptBox["n", "0"]}], "n"], 
               RowBox[{
                RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "\[Sigma]", ",", "k"}], 
                 "\[RightDoubleBracket]"}], 
                RowBox[{"temp", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Sigma]"}], 
                 "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"temp2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"temp1", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j", ",", "k"}], 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp1", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", "j", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"j", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp1", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "-", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", "k", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp1", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j", ",", "\[Sigma]"}], 
                   "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"l", ",", 
               SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], " ", 
           SqrtBox[
            RowBox[{"g", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"gi", "\[LeftDoubleBracket]", 
               RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}], 
              RowBox[{"temp2", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "k", ",", "k"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Divergence and Laplace of rank 3 tensor :", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Div3", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               SqrtBox[
                RowBox[{
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}]], 
               ")"}], 
              RowBox[{"-", "1"}]], 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "xx", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"temp", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j", ",", "k"}], 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", "j", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"j", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j", ",", "\[Sigma]"}], 
                   "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"l", ",", 
               SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"g", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
             RowBox[{"g", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]}]], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"temp1", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k", ",", "k"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", "r", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "3", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "3", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "3", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "3", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "1", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "2", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "3", ",", "1"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "3", ",", "2"}], "]"}], "[", "r", "]"}], ",", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "3", ",", "3"}], "]"}], "[", "r", "]"}]}], "}"}]}],
     "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Div3", "[", "S", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "3", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "3", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "3", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "2", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"2", ",", "3", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "1", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", "r", "]"}], "r"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "2", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "3", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", 
         RowBox[{"3", ",", "3", ",", "1"}], "]"}], "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
  RowBox[{"2", 
   FractionBox[
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"1", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}], "r"]}], "+", 
  
  RowBox[{
   SuperscriptBox[
    RowBox[{"s", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Prime]",
    MultilineFunction->None], "[", "r", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "[", "r", "]"}], "r"], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"1", ",", "2", ",", "2"}], "]"}], "[", "r", "]"}]}], "r"], "+", 
  
  RowBox[{
   SuperscriptBox[
    RowBox[{"s", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Prime]",
    MultilineFunction->None], "[", "r", "]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Grad3", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               SqrtBox[
                RowBox[{
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}]], 
               ")"}], 
              RowBox[{"-", "1"}]], 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"temp", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j", ",", "k"}], 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", "j", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"j", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j", ",", "\[Sigma]"}], 
                   "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"l", ",", 
               SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               SqrtBox[
                RowBox[{"g", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], 
               SqrtBox[
                RowBox[{"g", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]], 
               SqrtBox[
                RowBox[{"g", "\[LeftDoubleBracket]", 
                 RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]], 
               SqrtBox[
                RowBox[{"gi", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "l"}], "\[RightDoubleBracket]"}]], 
               RowBox[{"temp1", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplace3", "[", "V_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               SqrtBox[
                RowBox[{
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]}]], 
               ")"}], 
              RowBox[{"-", "1"}]], 
             RowBox[{"V", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"temp1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}]], " ", 
                 RowBox[{"temp", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j", ",", "k"}], 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", "j", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"j", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "\[Sigma]", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[Sigma]", "=", 
                   SubscriptBox["n", "0"]}], "n"], 
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "\[Sigma]", ",", "l"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"temp", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j", ",", "\[Sigma]"}], 
                   "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"l", ",", 
               SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"temp2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Simplify", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[PartialD]", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "m", 
                    "\[RightDoubleBracket]"}]], " ", 
                   RowBox[{"temp1", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Sigma]", "=", 
                    SubscriptBox["n", "0"]}], "n"], 
                   RowBox[{
                    RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "\[Sigma]", ",", "m"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"temp1", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Sigma]", ",", "j", ",", "k", ",", "l"}], 
                    "\[RightDoubleBracket]"}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Sigma]", "=", 
                    SubscriptBox["n", "0"]}], "n"], 
                   RowBox[{
                    RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "\[Sigma]", ",", "m"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"temp1", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "\[Sigma]", ",", "k", ",", "l"}], 
                    "\[RightDoubleBracket]"}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Sigma]", "=", 
                    SubscriptBox["n", "0"]}], "n"], 
                   RowBox[{
                    RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "\[Sigma]", ",", "m"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"temp1", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "\[Sigma]", ",", "l"}], 
                    "\[RightDoubleBracket]"}]}]}], "-", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Sigma]", "=", 
                    SubscriptBox["n", "0"]}], "n"], 
                   RowBox[{
                    RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Sigma]", ",", "l", ",", "m"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"temp1", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "\[Sigma]"}], 
                    "\[RightDoubleBracket]"}]}]}]}], ",", "Ass"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", 
               SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         SubscriptBox["n", "0"], ",", "n"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SqrtBox[
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]], " ", 
             SqrtBox[
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}]], 
             SqrtBox[
              RowBox[{"g", "\[LeftDoubleBracket]", 
               RowBox[{"k", ",", "k"}], "\[RightDoubleBracket]"}]], 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gi", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "l"}], "\[RightDoubleBracket]"}], 
                RowBox[{"temp2", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "l"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}], 
   ")"}]}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["0-1-2-3 system (Type B)", "Subchapter"],

Cell[CellGroupData[{

Cell["first order 0-1-2-3-system with 1-2-3-relaxation", "Section"],

Cell[CellGroupData[{

Cell["Final Result", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coef", "[", 
     RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"expr", ",", "var"}], "]"}], "]"}], "]"}]}], ";", 
   RowBox[{"Clear", "[", 
    RowBox[{
    "A0", ",", "A1", ",", "A2", ",", "\[Tau]", ",", "\[Lambda]1", ",", 
     "\[Lambda]2", ",", "\[Lambda]3", ",", "a0", ",", "b0", ",", "d0", ",", 
     "\[Kappa]0", ",", "\[Gamma]0", ",", "\[Omega]0", ",", "a", ",", "b", ",",
      "d", ",", "\[Gamma]", ",", "\[Kappa]", ",", "\[Omega]", ",", "C0", ",", 
     "C1", ",", "C2", ",", "C3", ",", "C4", ",", "C5", ",", "C6", ",", "C7", 
     ",", "C8", ",", "C9", ",", "C11", ",", "C12", ",", "K1", ",", "K2", ",", 
     "K3", ",", "K4", ",", "K5", ",", "K6", ",", "K7", ",", "K8", ",", "K9", 
     ",", "K10", ",", "K11", ",", "K12"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"d0", "[", "r", "]"}], "+", 
     RowBox[{
      RowBox[{"d", "[", "r", "]"}], 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ur", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"a0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "r", "]"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"b0", "[", "r", "]"}], "-", 
    RowBox[{
     RowBox[{"b", "[", "r", "]"}], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ur", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"u\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]rr", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Gamma]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Gamma]", "[", "r", "]"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Omega]0", "[", "r", "]"}], "-", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "r", "]"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]r\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Kappa]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "r", "]"}], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Sigma]rr", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"\[Sigma]r\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Sigma]r\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Sigma]rr", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
         RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mrrr", "[", 
       RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ",", 
      RowBox[{"mrr\[Theta]", "[", 
       RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ",", 
      RowBox[{"mr\[Theta]\[Theta]", "[", 
       RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ",", 
      RowBox[{"m\[Theta]\[Theta]\[Theta]", "[", 
       RowBox[{"r_", ",", "\[Theta]_"}], "]"}]}], "}"}], "=", " ", 
    RowBox[{"\[Tau]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"\[Gamma]0", "[", "r", "]"}]}], 
         RowBox[{"5", " ", "r"}]], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"\[Omega]0", "[", "r", "]"}]}], 
         RowBox[{"5", " ", "r"}]], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["\[Gamma]0", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}], "5"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"\[Gamma]", "[", "r", "]"}]}], 
            RowBox[{"5", " ", "r"}]], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
            RowBox[{"5", " ", "r"}]], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"\[Omega]", "[", "r", "]"}]}], 
            RowBox[{"5", " ", "r"}]], "-", 
           FractionBox[
            RowBox[{"3", " ", 
             RowBox[{
              SuperscriptBox["\[Gamma]", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}], "5"]}], ")"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"14", " ", 
          RowBox[{"\[Kappa]0", "[", "r", "]"}]}], 
         RowBox[{"15", " ", "r"}]], "-", 
        FractionBox[
         RowBox[{"8", " ", 
          RowBox[{
           SuperscriptBox["\[Kappa]0", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}], "15"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Gamma]", "[", "r", "]"}], 
            RowBox[{"3", " ", "r"}]], "+", 
           FractionBox[
            RowBox[{"14", " ", 
             RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
            RowBox[{"15", " ", "r"}]], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"\[Omega]", "[", "r", "]"}]}], 
            RowBox[{"15", " ", "r"}]], "-", 
           FractionBox[
            RowBox[{"8", " ", 
             RowBox[{
              SuperscriptBox["\[Kappa]", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}], "15"]}], ")"}], 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"8", " ", 
           RowBox[{"\[Gamma]0", "[", "r", "]"}]}], 
          RowBox[{"15", " ", "r"}]]}], "+", 
        FractionBox[
         RowBox[{"8", " ", 
          RowBox[{"\[Omega]0", "[", "r", "]"}]}], 
         RowBox[{"15", " ", "r"}]], "+", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["\[Gamma]0", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}], "15"], "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Omega]0", "\[Prime]",
           MultilineFunction->None], "[", "r", "]"}], "3"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"8", " ", 
              RowBox[{"\[Gamma]", "[", "r", "]"}]}], 
             RowBox[{"15", " ", "r"}]]}], "-", 
           FractionBox[
            RowBox[{"8", " ", 
             RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
            RowBox[{"15", " ", "r"}]], "-", 
           FractionBox[
            RowBox[{"8", " ", 
             RowBox[{"\[Omega]", "[", "r", "]"}]}], 
            RowBox[{"15", " ", "r"}]], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{
              SuperscriptBox["\[Gamma]", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}], "15"], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[Omega]", "\[Prime]",
              MultilineFunction->None], "[", "r", "]"}], "3"]}], ")"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"6", " ", 
           RowBox[{"\[Kappa]0", "[", "r", "]"}]}], 
          RowBox[{"5", " ", "r"}]]}], "+", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["\[Kappa]0", "\[Prime]",
            MultilineFunction->None], "[", "r", "]"}]}], "5"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"6", " ", 
              RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
             RowBox[{"5", " ", "r"}]]}], "-", 
           FractionBox[
            RowBox[{"3", " ", 
             RowBox[{"\[Omega]", "[", "r", "]"}]}], 
            RowBox[{"5", " ", "r"}]], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{
              SuperscriptBox["\[Kappa]", "\[Prime]",
               MultilineFunction->None], "[", "r", "]"}]}], "5"]}], ")"}], 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"A0", "+", 
    RowBox[{"A2", " ", 
     SuperscriptBox["r", "2"]}], "+", 
    RowBox[{"A1", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"5", 
         SuperscriptBox["r", "2"]}], 
        RowBox[{"18", " ", 
         SuperscriptBox["\[Tau]", "2"]}]]}], ")"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", 
   SqrtBox[
    FractionBox["3", "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", 
   SqrtBox[
    FractionBox["5", "6"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   SqrtBox[
    FractionBox["15", "31"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BI", "[", 
    RowBox[{"i_", ",", "x_"}], "]"}], "=", 
   RowBox[{"BesselI", "[", 
    RowBox[{"i", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BK", "[", 
     RowBox[{"i_", ",", "x_"}], "]"}], "=", 
    RowBox[{"BesselK", "[", 
     RowBox[{"i", ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"with\[Tau]", "=", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"r", "/", "\[Tau]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"6", " ", "A0"}], "5"]}], "+", 
        FractionBox[
         RowBox[{"32", 
          SuperscriptBox["\[Tau]", "2"], " ", "A2"}], "5"], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["A0", "4"], "-", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["\[Tau]", "2"], "A2"}], "3"]}], ")"}], " ", 
         SuperscriptBox["r", "2"]}], "-", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Tau]", "2"], "A2"}], "16"], " ", 
         SuperscriptBox["r", "4"]}]}], ")"}]}], "+", "C0", "+", 
     RowBox[{"C3", " ", 
      RowBox[{"Log", "[", "r", "]"}]}], "+", 
     RowBox[{"K3", " ", 
      RowBox[{"BK", "[", 
       RowBox[{"0", ",", 
        RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"K4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"BI", "[", 
         RowBox[{"0", ",", 
          RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}], "-", "1"}], ")"}]}]}], "/.",
     "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Tau]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"19", " ", "A1", " ", 
            SuperscriptBox["r", "2"]}], "27"]}], "+", 
         FractionBox[
          RowBox[{"A1", " ", 
           SuperscriptBox["r", "4"]}], "54"]}], ")"}]}], "+", 
      FractionBox["C1", "r"], "+", 
      RowBox[{"C2", " ", "r"}], "+", 
      RowBox[{"K1", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"1", ",", 
         RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}], "+", 
      RowBox[{"K2", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"1", ",", 
         RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}]}], "/.", 
     "with\[Tau]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"A0", " ", "r"}], "2"], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Tau]", "2"], "A2", " ", 
          SuperscriptBox["r", "3"]}], "4"]}], ")"}]}], "-", 
     FractionBox["C3", "r"]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "A1", " ", "r"}], "3"], "-", 
        FractionBox[
         RowBox[{"2", " ", "A1", " ", 
          SuperscriptBox["r", "3"]}], "27"]}], ")"}]}], "-", "C2", "+", 
     FractionBox["C1", 
      SuperscriptBox["r", "2"]], "+", 
     RowBox[{"K7", " ", 
      FractionBox[
       RowBox[{"BI", "[", 
        RowBox[{"1", ",", 
         RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}], "r"]}], "+", 
     RowBox[{"K8", " ", 
      FractionBox[
       RowBox[{"BK", "[", 
        RowBox[{"1", ",", 
         RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}], "r"]}]}], "/.", 
    "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"K5", " ", 
      RowBox[{"BI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"K6", " ", 
      RowBox[{"BK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}]}], "/.", "with\[Tau]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Tau]", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"A1", " ", "r"}], "3"], "-", 
         FractionBox[
          RowBox[{"A1", " ", 
           SuperscriptBox["r", "3"]}], "54"]}], ")"}]}], "-", "C2", "-", 
      FractionBox["C1", 
       SuperscriptBox["r", "2"]], "+", 
      RowBox[{"K7", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "\[Lambda]1", " ", 
           RowBox[{"BI", "[", 
            RowBox[{"0", ",", 
             RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], "-", 
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], ")"}], "r"]}], "-", 
      RowBox[{"K8", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "\[Lambda]1", " ", 
           RowBox[{"BK", "[", 
            RowBox[{"0", ",", 
             RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], "+", 
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], ")"}], "r"]}]}], "/.",
      "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "K5"}], " ", 
      RowBox[{
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}], "/", "\[Lambda]1"}]}], 
     "+", 
     RowBox[{"K6", " ", 
      RowBox[{
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}], "/", "\[Lambda]1"}]}]}], "/.",
     "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"A1", " ", 
          SuperscriptBox["r", "2"]}], "9"]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"4", " ", "C1"}], 
      SuperscriptBox["r", "3"]], "+", 
     FractionBox[
      RowBox[{"3", " ", "K1", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
      RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "K11", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     RowBox[{"K7", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], 
         RowBox[{"r", " ", "\[Lambda]1"}]], "+", 
        RowBox[{"BI", "[", 
         RowBox[{"3", ",", 
          RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{"3", " ", "K2", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
      RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], "-", 
     FractionBox[
      RowBox[{"2", " ", "K12", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     RowBox[{"K8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"BK", "[", 
            RowBox[{"2", ",", 
             RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], 
          RowBox[{"r", " ", "\[Lambda]1"}]]}], "+", 
        RowBox[{"BK", "[", 
         RowBox[{"3", ",", 
          RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], ")"}]}]}], "/.", 
    "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["A0", "3"]}], "-", 
        FractionBox[
         RowBox[{"8", " ", 
          SuperscriptBox["\[Tau]", "2"], "A2"}], "5"], "-", 
        RowBox[{
         FractionBox[
          RowBox[{"5", " ", 
           SuperscriptBox["\[Tau]", "2"], "A2"}], "6"], " ", 
         SuperscriptBox["r", "2"]}]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{"2", " ", "C3"}], 
      SuperscriptBox["r", "2"]], "+", 
     FractionBox[
      RowBox[{"K9", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"1", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     RowBox[{"K4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}], 
          RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], "-", 
        RowBox[{"BI", "[", 
         RowBox[{"2", ",", 
          RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"K10", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"1", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     RowBox[{"K3", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], "-", 
        RowBox[{"BK", "[", 
         RowBox[{"2", ",", 
          RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], ")"}]}]}], "/.", 
    "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"7", " ", "A1", " ", 
         SuperscriptBox["r", "2"]}], "27"], ")"}]}], "+", 
     FractionBox[
      RowBox[{"4", " ", "C1"}], 
      SuperscriptBox["r", "3"]], "-", 
     FractionBox[
      RowBox[{"2", " ", "K7", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]1"}]], "+", 
     RowBox[{"K1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"2", " ", "K11", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "K8", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]1"}]], "+", 
     RowBox[{"K2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{"2", " ", "K12", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Tau]", "2"], "A2", " ", 
          SuperscriptBox["r", "2"]}], "6"], "-", 
        FractionBox["A0", "3"], "-", 
        FractionBox[
         RowBox[{"8", " ", 
          SuperscriptBox["\[Tau]", "2"], "A2"}], "5"]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"2", " ", "C3"}], 
      SuperscriptBox["r", "2"]], "+", 
     RowBox[{"K4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K9", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"BI", "[", 
         RowBox[{"0", ",", 
          RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}], "-", 
        FractionBox[
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}], 
         RowBox[{"r", " ", "\[Lambda]3"}]]}], ")"}]}], "+", 
     RowBox[{"K3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"BK", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K10", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"BK", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}], 
         RowBox[{"r", " ", "\[Lambda]3"}]]}], ")"}]}]}], "/.", 
    "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"2", " ", "A1", " ", 
         SuperscriptBox["r", "2"]}], "27"], ")"}]}], "+", 
     FractionBox[
      RowBox[{"4", " ", "C1"}], 
      SuperscriptBox["r", "3"]], "-", 
     FractionBox[
      RowBox[{"2", " ", "K7", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]1"}]], "+", 
     RowBox[{"K1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K11", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
         RowBox[{"r", " ", "\[Lambda]3"}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"2", " ", "K8", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]1"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]1"}]], "+", 
     RowBox[{"K2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
         RowBox[{"r", " ", "\[Lambda]3"}]]}], ")"}]}]}], "/.", 
    "with\[Tau]"}]}], ";"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TraceFreeSym2", "[", "mat_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{"mat", "+", 
       RowBox[{"Transpose", "[", "mat", "]"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], 
     RowBox[{"Tr", "[", "mat", "]"}], 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceFreeSym3", "[", "mat_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perm", ",", "sym1", ",", "trace"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perm", "=", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sym1", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"Length", "[", "perm", "]"}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"mat", ",", "idx"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"idx", ",", "perm"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trace", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sym1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "jj", ",", "jj"}], "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Expand", "[", 
      RowBox[{"sym1", "-", 
       RowBox[{
        FractionBox["1", "5"], 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "trace", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"jj", ",", "kk"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
            "trace", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"ii", ",", "kk"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
            "trace", "\[LeftDoubleBracket]", "kk", "\[RightDoubleBracket]"}], 
            
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"ii", ",", "jj"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"kk", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Div1", "[", 
        RowBox[{"u", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "-", 
       RowBox[{"F", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Grad0", "[", 
        RowBox[{"p", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
       RowBox[{"Div2", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"u", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", 
        RowBox[{"TraceFreeSym2", "[", 
         RowBox[{"Grad1", "[", 
          RowBox[{"u", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
       RowBox[{"2", "\[Tau]", " ", 
        RowBox[{"Div3", "[", 
         RowBox[{"TraceFreeSym3", "[", 
          RowBox[{"Grad2", "[", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}], "]"}]}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mrrr", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
          RowBox[{"mrr\[Theta]", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
          RowBox[{"mr\[Theta]\[Theta]", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
          RowBox[{"m\[Theta]\[Theta]\[Theta]", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], "+", 
       RowBox[{"Extract", "[", 
        RowBox[{
         RowBox[{"TraceFreeSym3", "[", 
          RowBox[{"Grad2", "[", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"coef", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"ur", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}], "-", 
     RowBox[{"p", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"coef", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"mrrr", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}], "-", 
     RowBox[{"\[Sigma]rr", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"coef", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"\[Sigma]r\[Theta]", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}], "-", 
     RowBox[{"u\[Theta]", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"coef", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"mr\[Theta]\[Theta]", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}], "-", 
     RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
      RowBox[{"R", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "C0"}], "-", 
    FractionBox["C3", "R"], "-", 
    RowBox[{"K4", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    RowBox[{"K3", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    RowBox[{"C3", " ", 
     RowBox[{"Log", "[", "R", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "C2"}], "+", 
    FractionBox["C1", 
     SuperscriptBox["R", "2"]], "-", 
    FractionBox["C1", "R"], "-", 
    RowBox[{"C2", " ", "R"}], "+", 
    FractionBox[
     RowBox[{"K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "-", 
    RowBox[{"K1", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "-", 
    RowBox[{"K2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}]}], ",", "0"}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", "C3"}], 
      SuperscriptBox["R", "3"]]}], "+", 
    FractionBox[
     RowBox[{"2", " ", "C3"}], 
     SuperscriptBox["R", "2"]], "-", 
    FractionBox[
     RowBox[{"K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"7", " ", "K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"10", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"10", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "+", 
    FractionBox[
     RowBox[{"K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "+", 
    RowBox[{
     FractionBox["3", "10"], " ", "K4", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"7", " ", "K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "-", 
    FractionBox[
     RowBox[{"K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    RowBox[{"K4", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"4", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"10", " ", "R"}]], "+", 
    RowBox[{
     FractionBox["3", "10"], " ", "K4", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"3", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"7", " ", "K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"10", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"10", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "-", 
    FractionBox[
     RowBox[{"K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "-", 
    RowBox[{
     FractionBox["3", "10"], " ", "K3", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"7", " ", "K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "-", 
    FractionBox[
     RowBox[{"K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    RowBox[{"K3", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"4", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", "K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"10", " ", "R"}]], "-", 
    RowBox[{
     FractionBox["3", "10"], " ", "K3", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"3", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"12", " ", "C1"}], 
     SuperscriptBox["R", "4"]], "-", 
    FractionBox[
     RowBox[{"4", " ", "C1"}], 
     SuperscriptBox["R", "3"]], "+", 
    RowBox[{
     FractionBox["3", "10"], " ", "K1", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"3", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"5", " ", "R"}]], "+", 
    RowBox[{"K1", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"21", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"7", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{
      SuperscriptBox["R", "2"], " ", "\[Lambda]1"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]1"}]], "+", 
    FractionBox[
     RowBox[{"27", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"10", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "+", 
    RowBox[{
     FractionBox["3", "10"], " ", "K1", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"18", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    FractionBox[
     RowBox[{"K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "-", 
    FractionBox[
     RowBox[{"9", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", "R"}]], "-", 
    RowBox[{
     FractionBox["3", "10"], " ", "K2", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"3", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"5", " ", "R"}]], "+", 
    RowBox[{"K2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"21", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"7", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{
      SuperscriptBox["R", "2"], " ", "\[Lambda]1"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]1"}]], "-", 
    FractionBox[
     RowBox[{"27", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"10", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "-", 
    RowBox[{
     FractionBox["3", "10"], " ", "K2", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"18", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    FractionBox[
     RowBox[{"K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "-", 
    FractionBox[
     RowBox[{"9", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"5", " ", "R"}]]}], ",", "0"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "K5"}], " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K5", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "\[Lambda]1"], "-", 
    RowBox[{"K6", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"K6", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "\[Lambda]1"]}], ",", 
   "0", ",", 
   RowBox[{
    RowBox[{"-", "C2"}], "+", 
    FractionBox[
     RowBox[{"4", " ", "C1"}], 
     SuperscriptBox["R", "3"]], "-", 
    FractionBox["C1", 
     SuperscriptBox["R", "2"]], "+", 
    RowBox[{"K7", " ", "\[Lambda]1", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "+", 
    FractionBox[
     RowBox[{"2", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]1"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    RowBox[{"K7", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"3", ",", 
       RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "-", 
    RowBox[{"K8", " ", "\[Lambda]1", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "-", 
    FractionBox[
     RowBox[{"2", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]1"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    RowBox[{"K8", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"3", ",", 
       RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}]}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", "C3"}], 
     SuperscriptBox["R", "3"]], "-", 
    FractionBox[
     RowBox[{"2", " ", "C3"}], 
     SuperscriptBox["R", "2"]], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "K4", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"29", " ", "K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"60", " ", "R"}]], "-", 
    RowBox[{"K9", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"23", " ", "K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"30", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"29", " ", "K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"30", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", "K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "-", 
    RowBox[{
     FractionBox["7", "30"], " ", "K4", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"23", " ", "K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "+", 
    FractionBox[
     RowBox[{"K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", "K9", " ", "\[Lambda]3", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"3", " ", "K4", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"4", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"7", " ", "K9", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"30", " ", "R"}]], "-", 
    RowBox[{
     FractionBox["1", "15"], " ", "K4", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"3", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "K3", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"29", " ", "K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"60", " ", "R"}]], "+", 
    RowBox[{"K10", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"23", " ", "K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"0", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"30", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"29", " ", "K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"30", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "+", 
    RowBox[{
     FractionBox["7", "30"], " ", "K3", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"23", " ", "K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "+", 
    FractionBox[
     RowBox[{"K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", "K10", " ", "\[Lambda]3", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"3", " ", "K3", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"4", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"7", " ", "K10", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"30", " ", "R"}]], "+", 
    RowBox[{
     FractionBox["1", "15"], " ", "K3", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"3", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"12", " ", "C1"}], 
      SuperscriptBox["R", "4"]]}], "+", 
    FractionBox[
     RowBox[{"4", " ", "C1"}], 
     SuperscriptBox["R", "3"]], "-", 
    RowBox[{
     FractionBox["3", "20"], " ", "K1", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", "K11", " ", "\[Lambda]3", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"7", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"15", " ", "R"}]], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "K1", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"23", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    RowBox[{"2", " ", "K11", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"23", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{
      SuperscriptBox["R", "2"], " ", "\[Lambda]1"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]1"}]], "-", 
    FractionBox[
     RowBox[{"31", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"10", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "-", 
    RowBox[{
     FractionBox["3", "20"], " ", "K1", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"62", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", "K11", " ", "\[Lambda]3", " ", 
     RowBox[{"BesselI", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K7", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "+", 
    FractionBox[
     RowBox[{"7", " ", "K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"7", " ", "K11", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", "R"}]], "+", 
    RowBox[{
     FractionBox["3", "20"], " ", "K2", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", "K12", " ", "\[Lambda]3", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"7", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"15", " ", "R"}]], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", "K2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"23", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "-", 
    RowBox[{"2", " ", "K12", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"1", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"23", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", "R"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{
      SuperscriptBox["R", "2"], " ", "\[Lambda]1"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", "K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]1"}]], "+", 
    FractionBox[
     RowBox[{"31", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"10", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]2"}]], "-", 
    FractionBox[
     RowBox[{"3", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"2", " ", "R", " ", "\[Lambda]2"}]], "+", 
    RowBox[{
     FractionBox["3", "20"], " ", "K2", " ", "\[Lambda]2", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"62", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", 
      SuperscriptBox["R", "2"], " ", "\[Lambda]3"}]], "-", 
    FractionBox[
     RowBox[{"2", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"2", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"R", " ", "\[Lambda]3"}]], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", "K12", " ", "\[Lambda]3", " ", 
     RowBox[{"BesselK", "[", 
      RowBox[{"2", ",", 
       RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
    FractionBox[
     RowBox[{"K8", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]1"}]}], "]"}]}], "R"], "+", 
    FractionBox[
     RowBox[{"7", " ", "K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]2"}]}], "]"}]}], 
     RowBox[{"20", " ", "R"}]], "+", 
    FractionBox[
     RowBox[{"7", " ", "K12", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"3", ",", 
        RowBox[{"R", " ", "\[Lambda]3"}]}], "]"}]}], 
     RowBox[{"15", " ", "R"}]]}], ",", "0"}], "}"}]], "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions (large radius)", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Chi]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BCrhs", ",", "BC"}], "}"}], "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"CoefficientArrays", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "sn"}], "+", 
        RowBox[{"\[Chi]", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{"\[Theta]", "-", "\[Theta]W"}], ")"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "Rnt"}], "+", 
        RowBox[{"\[Chi]", 
         RowBox[{"(", 
          RowBox[{"st", "+", 
           RowBox[{"2", "mnnt"}], "-", "uW"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "mnnn"}], "+", 
        RowBox[{"\[Chi]", 
         RowBox[{"(", "Rnn", ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "mntt"}], "+", 
        RowBox[{"\[Chi]", 
         RowBox[{"(", "Rtt", ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]", ",", "sn", ",", "st", ",", "Rnn", ",", "Rnt", ",", "Rtt", 
       ",", "mnnn", ",", "mnnt", ",", "mntt", ",", "mttt"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[Theta]W"}], " ", "\[Chi]"}], ",", 
     RowBox[{
      RowBox[{"-", "uW"}], " ", "\[Chi]"}], ",", "0", ",", "0"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Chi]", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
       RowBox[{"2", " ", "\[Chi]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "\[Chi]", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "\[Chi]", ",", "0", 
       ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"u", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"BC1rhs", ",", "BC1"}], "}"}], "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"vars", "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"BC", ".", "vars"}], "+", "BCrhs"}], "\[Equal]", "0"}], 
          ",", 
          RowBox[{"vars", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "5", ",", "7", ",", "9"}], "}"}], 
           "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ",", "vars"}], "]"}], "]"}]}], 
  ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Expand", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BC1", ".", "vars"}], "+", "BC1rhs"}], ")"}], "-", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "10", "]"}], ".", "vars"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"BC", ".", "vars"}], "+", "BCrhs"}], ")"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[Theta]W", " ", "\[Chi]"}], "+", 
    RowBox[{"2", " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "-", 
    RowBox[{"u", "[", "2", "]"}], "+", 
    RowBox[{
     FractionBox["5", "28"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "4", "]"}]}]}], ",", "0", ",", "0", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"11", " ", "uW", " ", "\[Chi]"}], "5"]}], "+", 
    RowBox[{
     FractionBox["11", "5"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "3", "]"}]}], "-", 
    RowBox[{"u", "[", "5", "]"}], "+", 
    RowBox[{
     FractionBox["22", "5"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "8", "]"}]}]}], ",", "0", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"6", " ", "\[Theta]W", " ", "\[Chi]"}], "5"], "-", 
    RowBox[{
     FractionBox["6", "5"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "+", 
    RowBox[{
     FractionBox["93", "70"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "4", "]"}]}], "-", 
    RowBox[{"u", "[", "7", "]"}]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "\[Theta]W", " ", "\[Chi]"}], "5"]}], "+", 
    RowBox[{
     FractionBox["3", "5"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "-", 
    RowBox[{
     FractionBox["111", "280"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "4", "]"}]}], "+", 
    RowBox[{
     FractionBox["15", "28"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "6", "]"}]}], "-", 
    RowBox[{"u", "[", "9", "]"}]}], ",", "0"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Theta]W"}], " ", "\[Chi]"}], "+", 
    RowBox[{"\[Chi]", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "-", 
    FractionBox[
     RowBox[{"u", "[", "2", "]"}], "2"], "+", 
    RowBox[{
     FractionBox["5", "56"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "4", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "uW"}], " ", "\[Chi]"}], "+", 
    RowBox[{"\[Chi]", " ", 
     RowBox[{"u", "[", "3", "]"}]}], "-", 
    FractionBox[
     RowBox[{"5", " ", 
      RowBox[{"u", "[", "5", "]"}]}], "11"], "+", 
    RowBox[{"2", " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "8", "]"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"28", " ", "\[Theta]W", " ", "\[Chi]"}], "31"], "-", 
    RowBox[{
     FractionBox["28", "31"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "+", 
    RowBox[{"\[Chi]", " ", 
     RowBox[{"u", "[", "4", "]"}]}], "-", 
    FractionBox[
     RowBox[{"70", " ", 
      RowBox[{"u", "[", "7", "]"}]}], "93"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"28", " ", "\[Theta]W", " ", "\[Chi]"}], "25"]}], "+", 
    RowBox[{
     FractionBox["28", "25"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "1", "]"}]}], "-", 
    RowBox[{
     FractionBox["37", "50"], " ", "\[Chi]", " ", 
     RowBox[{"u", "[", "4", "]"}]}], "+", 
    RowBox[{"\[Chi]", " ", 
     RowBox[{"u", "[", "6", "]"}]}], "-", 
    FractionBox[
     RowBox[{"28", " ", 
      RowBox[{"u", "[", "9", "]"}]}], "15"]}]}], "}"}]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "-", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ",", 
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "}"}], "&"}], ",", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"ArrayRules", "[", 
      RowBox[{"SparseArray", "[", "BC1", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "-", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     "}"}], "&"}], ",", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"ArrayRules", "[", 
      RowBox[{"SparseArray", "[", "BC1rhs", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"2", " ", "\[Chi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     FractionBox[
      RowBox[{"5", " ", "\[Chi]"}], "28"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}], ",", 
     FractionBox[
      RowBox[{"11", " ", "\[Chi]"}], "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "7"}], "}"}], ",", 
     FractionBox[
      RowBox[{"22", " ", "\[Chi]"}], "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"6", " ", "\[Chi]"}], "5"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "3"}], "}"}], ",", 
     FractionBox[
      RowBox[{"93", " ", "\[Chi]"}], "70"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "7"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "0"}], "}"}], ",", 
     FractionBox[
      RowBox[{"3", " ", "\[Chi]"}], "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "3"}], "}"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"111", " ", "\[Chi]"}], "280"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "5"}], "}"}], ",", 
     FractionBox[
      RowBox[{"15", " ", "\[Chi]"}], "28"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "9"}], "}"}], ",", "1"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Theta]W", " ", "\[Chi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"11", " ", "uW", " ", "\[Chi]"}], "5"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "6", "}"}], ",", 
     FractionBox[
      RowBox[{"6", " ", "\[Theta]W", " ", "\[Chi]"}], "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "8", "}"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "\[Theta]W", " ", "\[Chi]"}], "5"]}]}], "}"}]}], 
  "}"}]], "Output"]
}, Closed]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", 
     RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]0", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uW0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", "=", 
     RowBox[{"1", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C1", "\[Rule]", 
        RowBox[{"C1", "/", "\[Tau]"}]}], ",", 
       RowBox[{"K1", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]2", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K1"}]}], ",", 
       RowBox[{"K2", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]2", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"K3", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"0", ",", 
            RowBox[{"\[Lambda]2", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K3"}]}], ",", 
       RowBox[{"K4", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"0", ",", 
            RowBox[{"\[Lambda]2", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K4"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"K7", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K7"}]}], ",", 
       RowBox[{"K8", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K8"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"K9", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]3", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K9"}]}], ",", 
       RowBox[{"K10", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]3", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K10"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"K11", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"\[Lambda]3", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K11"}]}], ",", 
       RowBox[{"K12", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"\[Lambda]3", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K12"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"C1", "=", 
   RowBox[{"C2", "=", 
    RowBox[{"K1", "=", 
     RowBox[{"K2", "=", 
      RowBox[{"K5", "=", 
       RowBox[{"K6", "=", 
        RowBox[{"K7", "=", 
         RowBox[{"K8", "=", 
          RowBox[{"K11", "=", 
           RowBox[{"K12", "=", "0"}]}]}]}]}]}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"ur", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"u\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"\[Sigma]rr", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"\[Sigma]r\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"mrrr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"mrr\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"mr\[Theta]\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"m\[Theta]\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"nn", "[", "R0", "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nn", "[", "R1", "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]0"}], ",", 
                RowBox[{"uW", "\[Rule]", 
                 RowBox[{"uW0", " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]1"}], ",", 
                RowBox[{"uW", "\[Rule]", "0"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "/.", "scaling"}], ")"}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"C0", ",", "C3", ",", "K3", ",", "K4", ",", "K9", ",", "K10"}], 
      "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C0", "\[Rule]", "0.75817940115657`"}], ",", 
   RowBox[{"C3", "\[Rule]", 
    RowBox[{"-", "0.1680773374037423`"}]}], ",", 
   RowBox[{"K3", "\[Rule]", "0.13618194331758404`"}], ",", 
   RowBox[{"K4", "\[Rule]", 
    RowBox[{"-", "0.4397130699425769`"}]}], ",", 
   RowBox[{"K9", "\[Rule]", "0.03300953404881733`"}], ",", 
   RowBox[{"K10", "\[Rule]", 
    RowBox[{"-", "0.15561422395271596`"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bBC", ",", "ABC"}], "}"}], "=", 
   RowBox[{"FunctionExpand", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"coef", "[", 
              RowBox[{
               RowBox[{"Expand", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"BC", ".", 
                   RowBox[{"U", "[", 
                    RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], 
                 "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]0"}], ",", 
                   RowBox[{"uW", "\[Rule]", 
                    RowBox[{"uW0", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"coef", "[", 
              RowBox[{
               RowBox[{"Expand", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"BC", ".", 
                   RowBox[{"U", "[", 
                    RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], 
                 "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]1"}], ",", 
                   RowBox[{"uW", "\[Rule]", "0"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "/.", "scaling1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "C0", ",", "C3", ",", "K3", ",", "K4", ",", "K9", ",", "K10"}], 
         "}"}]}], "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"scale1", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      SuperscriptBox["\[Tau]", 
       RowBox[{"-", "2"}]], ",", 
      SuperscriptBox["\[Tau]", 
       RowBox[{"-", "2"}]], ",", "1", ",", 
      SuperscriptBox["\[Tau]", 
       RowBox[{"-", "2"}]], ",", 
      SuperscriptBox["\[Tau]", 
       RowBox[{"-", "2"}]]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale2", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"BesselK", "[", 
         RowBox[{"0", ",", 
          FractionBox["\[Lambda]2", 
           RowBox[{"R1", " ", "\[Tau]"}]]}], "]"}], ")"}], 
       RowBox[{"-", "1"}]], ",", 
      RowBox[{
       SuperscriptBox["\[Tau]", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"BesselI", "[", 
          RowBox[{"0", ",", 
           FractionBox["\[Lambda]2", 
            RowBox[{"R0", " ", "\[Tau]"}]]}], "]"}], ")"}], 
        RowBox[{"-", "1"}]]}], ",", 
      RowBox[{
       SuperscriptBox["\[Tau]", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"BesselI", "[", 
          RowBox[{"0", ",", 
           FractionBox["\[Lambda]3", 
            RowBox[{"R0", " ", "\[Tau]"}]]}], "]"}], ")"}], 
        RowBox[{"-", "1"}]]}], ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"BesselK", "[", 
         RowBox[{"0", ",", 
          FractionBox["\[Lambda]3", 
           RowBox[{"R1", " ", "\[Tau]"}]]}], "]"}], ")"}], 
       RowBox[{"-", "1"}]]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"C0", ",", "C3", ",", "K3", ",", "K4", ",", "K9", ",", "K10"}], 
     "}"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"scale2", ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"scale1", ".", "ABC", ".", "scale2"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", "\[Rule]", "100.0"}], "}"}]}], "]"}], ".", 
      "scale1", ".", "bBC"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Tau]", "\[Rule]", "100.0"}], "}"}]}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C0", "\[Rule]", 
    RowBox[{"-", "639998.6239659613`"}]}], ",", 
   RowBox[{"C3", "\[Rule]", 
    RowBox[{"-", "0.0029760604617194986`"}]}], ",", 
   RowBox[{"K3", "\[Rule]", "0.002318341291015713`"}], ",", 
   RowBox[{"K4", "\[Rule]", 
    RowBox[{"-", "640555.7422058582`"}]}], ",", 
   RowBox[{"K9", "\[Rule]", 
    RowBox[{"-", "277.91528928279877`"}]}], ",", 
   RowBox[{"K10", "\[Rule]", 
    RowBox[{"-", "0.0026686897872423287`"}]}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "C0", ",", "C1", ",", "C2", ",", "C3", ",", "K1", ",", "K2", ",", "K3", 
      ",", "K4", ",", "K7", ",", "K8"}], "}"}], "/.", "scaling"}], "/.", 
   "solbc"}], "]"}]], "Input"],

Cell["\<\
List(1.8779973238556051,0.48170199857369206,-0.032245279747091384,0.\
08526741914275243,5.806990250981511e-9,5.91399305082199,
   -1.316040533386685,-1.171551028043168e-8,-2.0241640291810703e-8,1.\
4316433131003932)\
\>", "Output"]
}, Closed]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pC", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ux", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"uy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ur", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"u\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]xx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]xy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]yx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]yy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]rr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"pC", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"ux", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["first order 0-1-2-3-System with 2-3-relaxation", "Section"],

Cell[CellGroupData[{

Cell["Final Result", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{"expr", ",", "var"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceFreeSym2", "[", "mat_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{"mat", "+", 
       RowBox[{"Transpose", "[", "mat", "]"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], 
     RowBox[{"Tr", "[", "mat", "]"}], 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceFreeSym3", "[", "mat_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perm", ",", "sym1", ",", "trace"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perm", "=", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sym1", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"Length", "[", "perm", "]"}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"mat", ",", "idx"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"idx", ",", "perm"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trace", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sym1", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "jj", ",", "jj"}], "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Expand", "[", 
      RowBox[{"sym1", "-", 
       RowBox[{
        FractionBox["1", "5"], 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "trace", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"jj", ",", "kk"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
            "trace", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"ii", ",", "kk"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
            "trace", "\[LeftDoubleBracket]", "kk", "\[RightDoubleBracket]"}], 
            
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"ii", ",", "jj"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"kk", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Tau]", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", 
    "a0", ",", "b0", ",", "d0", ",", "\[Kappa]0", ",", "\[Gamma]0", ",", 
    "\[Omega]0", ",", "a", ",", "b", ",", "d", ",", "\[Gamma]", ",", 
    "\[Kappa]", ",", "\[Omega]", ",", "C0", ",", "C1", ",", "C2", ",", "C3", 
    ",", "C4", ",", "C5", ",", "C6", ",", "C7", ",", "C8", ",", "C9", ",", 
    "C10", ",", "C11", ",", "C12", ",", "K1", ",", "K2", ",", "K3", ",", "K4",
     ",", "K5", ",", "K6", ",", "K7", ",", "K8", ",", "K9", ",", "K10", ",", 
    "K11", ",", "K12"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ur", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"a0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     RowBox[{"a", "[", "r", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u\[Theta]", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"b0", "[", "r", "]"}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"b", "[", "r", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ur", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"u\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"d0", "[", "r", "]"}], "+", 
     RowBox[{
      RowBox[{"d", "[", "r", "]"}], 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]rr", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"\[Gamma]", "[", "r", "]"}]}], "+", 
    RowBox[{"\[Gamma]0", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"\[Omega]", "[", "r", "]"}]}], "+", 
      RowBox[{"\[Omega]0", "[", "r", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]r\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Kappa]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"\[Kappa]", "[", "r", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]zz", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Sigma]rr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
     RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Sigma]rr", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"\[Sigma]r\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Sigma]r\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"\[Sigma]zz", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mrrr", "[", 
      RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ",", 
     RowBox[{"mrr\[Theta]", "[", 
      RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ",", 
     RowBox[{"mr\[Theta]\[Theta]", "[", 
      RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ",", 
     RowBox[{"m\[Theta]\[Theta]\[Theta]", "[", 
      RowBox[{"r_", ",", "\[Theta]_"}], "]"}]}], "}"}], "=", 
   RowBox[{"\[Tau]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"\[Gamma]0", "[", "r", "]"}]}], 
        RowBox[{"5", " ", "r"}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"\[Omega]0", "[", "r", "]"}]}], 
        RowBox[{"5", " ", "r"}]], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"\[Gamma]", "[", "r", "]"}]}], 
           RowBox[{"5", " ", "r"}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
           RowBox[{"5", " ", "r"}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"\[Omega]", "[", "r", "]"}]}], 
           RowBox[{"5", " ", "r"}]], "-", 
          FractionBox[
           RowBox[{"3", " ", 
            RowBox[{
             SuperscriptBox["\[Gamma]", "\[Prime]",
              MultilineFunction->None], "[", "r", "]"}]}], "5"]}], ")"}]}], 
       "-", 
       FractionBox[
        RowBox[{"3", " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]0", "\[Prime]",
           MultilineFunction->None], "[", "r", "]"}]}], "5"]}], ",", 
      RowBox[{
       FractionBox[
        RowBox[{"14", " ", 
         RowBox[{"\[Kappa]0", "[", "r", "]"}]}], 
        RowBox[{"15", " ", "r"}]], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Gamma]", "[", "r", "]"}], 
           RowBox[{"3", " ", "r"}]], "+", 
          FractionBox[
           RowBox[{"14", " ", 
            RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
           RowBox[{"15", " ", "r"}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"\[Omega]", "[", "r", "]"}]}], 
           RowBox[{"15", " ", "r"}]], "-", 
          FractionBox[
           RowBox[{"8", " ", 
            RowBox[{
             SuperscriptBox["\[Kappa]", "\[Prime]",
              MultilineFunction->None], "[", "r", "]"}]}], "15"]}], ")"}]}], 
       "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{
          SuperscriptBox["\[Kappa]0", "\[Prime]",
           MultilineFunction->None], "[", "r", "]"}]}], "15"]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"8", " ", 
          RowBox[{"\[Gamma]0", "[", "r", "]"}]}], 
         RowBox[{"15", " ", "r"}]]}], "-", 
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"\[Omega]0", "[", "r", "]"}]}], 
        RowBox[{"15", " ", "r"}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]0", "\[Prime]",
           MultilineFunction->None], "[", "r", "]"}]}], "15"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"8", " ", 
             RowBox[{"\[Gamma]", "[", "r", "]"}]}], 
            RowBox[{"15", " ", "r"}]]}], "-", 
          FractionBox[
           RowBox[{"8", " ", 
            RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
           RowBox[{"15", " ", "r"}]], "-", 
          FractionBox[
           RowBox[{"8", " ", 
            RowBox[{"\[Omega]", "[", "r", "]"}]}], 
           RowBox[{"15", " ", "r"}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{
             SuperscriptBox["\[Gamma]", "\[Prime]",
              MultilineFunction->None], "[", "r", "]"}]}], "15"], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Omega]", "\[Prime]",
             MultilineFunction->None], "[", "r", "]"}], "3"]}], ")"}]}], "+", 
       
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Omega]0", "\[Prime]",
          MultilineFunction->None], "[", "r", "]"}], "3"]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", 
          RowBox[{"\[Kappa]0", "[", "r", "]"}]}], 
         RowBox[{"5", " ", "r"}]]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"6", " ", 
             RowBox[{"\[Kappa]", "[", "r", "]"}]}], 
            RowBox[{"5", " ", "r"}]]}], "-", 
          FractionBox[
           RowBox[{"3", " ", 
            RowBox[{"\[Omega]", "[", "r", "]"}]}], 
           RowBox[{"5", " ", "r"}]], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{
             SuperscriptBox["\[Kappa]", "\[Prime]",
              MultilineFunction->None], "[", "r", "]"}]}], "5"]}], ")"}]}], 
       "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["\[Kappa]0", "\[Prime]",
           MultilineFunction->None], "[", "r", "]"}]}], "5"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mrzz", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"mrrr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
     RowBox[{"mr\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqns", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{
       RowBox[{"Div1", "[", 
        RowBox[{"u", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"coef", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Grad0", "[", 
         RowBox[{"p", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
        RowBox[{"Div2", "[", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"coef", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"TraceFreeSym2", "[", 
          RowBox[{"Grad1", "[", 
           RowBox[{"u", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "\[Tau]"], 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
        RowBox[{"2", "\[Tau]", " ", 
         RowBox[{"Div3", "[", 
          RowBox[{"TraceFreeSym3", "[", 
           RowBox[{"Grad2", "[", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}], "]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"coef", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", "\[Tau]"], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mrrr", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
           RowBox[{"mrr\[Theta]", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
           RowBox[{"mr\[Theta]\[Theta]", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
           RowBox[{"m\[Theta]\[Theta]\[Theta]", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], "+", 
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"TraceFreeSym3", "[", 
           RowBox[{"Grad2", "[", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"with\[Tau]", "=", 
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"r", "/", "\[Tau]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", 
   SqrtBox[
    FractionBox["5", "6"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", 
   SqrtBox[
    FractionBox["3", "2"]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BI", "[", 
    RowBox[{"i_", ",", "x_"}], "]"}], "=", 
   RowBox[{"BesselI", "[", 
    RowBox[{"i", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BK", "[", 
     RowBox[{"i_", ",", "x_"}], "]"}], "=", 
    RowBox[{"BesselK", "[", 
     RowBox[{"i", ",", "x"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["C1", "r"], "+", 
     RowBox[{"C2", " ", "r"}], "+", 
     RowBox[{"K1", " ", 
      RowBox[{"BI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"K2", " ", 
      RowBox[{"BK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}]}], "/.", "with\[Tau]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d0", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{"C8", "+", 
      RowBox[{"K3", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"0", ",", 
         RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}], "+", 
      RowBox[{"K4", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"0", ",", 
         RowBox[{"\[Lambda]2", " ", "r"}]}], "]"}]}]}], "/.", 
     "with\[Tau]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["C3", "2"], 
     FractionBox["1", "r"]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"C7", " ", "r"}], "+", 
     FractionBox["C4", 
      RowBox[{"2", "r"}]]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"C2", " ", 
       SuperscriptBox["r", "2"]}], "8"], "-", 
     FractionBox["C6", 
      SuperscriptBox["r", "2"]], "+", "C5", "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "C1", " ", 
      RowBox[{"Log", "[", "r", "]"}]}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{"C5", "+", 
      FractionBox["C6", 
       SuperscriptBox["r", "2"]], "+", 
      FractionBox[
       RowBox[{"3", " ", "C2", " ", 
        SuperscriptBox["r", "2"]}], "8"], "+", 
      RowBox[{"C1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "-", 
         FractionBox[
          RowBox[{"Log", "[", "r", "]"}], "2"]}], ")"}]}]}], "/.", 
     "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]0", "[", "r_", "]"}], "=", 
    RowBox[{
     FractionBox["C4", 
      SuperscriptBox["r", "2"]], "/.", "with\[Tau]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]0", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["C3", 
       SuperscriptBox["r", "2"]], "+", 
      FractionBox[
       RowBox[{"K8", " ", 
        RowBox[{"BI", "[", 
         RowBox[{"1", ",", 
          RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "r"], "+", 
      RowBox[{"K4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"BI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}], 
           RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], "-", 
         RowBox[{"BI", "[", 
          RowBox[{"2", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{"K7", " ", 
        RowBox[{"BK", "[", 
         RowBox[{"1", ",", 
          RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "r"], "+", 
      RowBox[{"K3", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}], 
          RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], "-", 
         RowBox[{"BK", "[", 
          RowBox[{"2", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], ")"}]}]}], "/.", 
     "with\[Tau]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["C3", 
      SuperscriptBox["r", "2"]], "+", 
     RowBox[{"K4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Lambda]3"}], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}], "r"]}], ")"}]}], "+", 
     RowBox[{"K3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"BK", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K7", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Lambda]3", " ", 
         RowBox[{"BK", "[", 
          RowBox[{"0", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}], "r"]}], ")"}]}]}], "/.",
     "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"C1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["64", 
          RowBox[{"15", " ", 
           SuperscriptBox["r", "3"]}]]}], "+", 
        FractionBox["1", "r"]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{"4", " ", "C6"}], 
      SuperscriptBox["r", "3"]], "-", 
     FractionBox[
      RowBox[{"C2", " ", "r"}], "2"], "+", 
     RowBox[{"K1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
         RowBox[{"r", " ", "\[Lambda]3"}]]}], ")"}]}], "+", 
     RowBox[{"K2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], ")"}]}], "+", 
     RowBox[{"K5", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
         RowBox[{"r", " ", "\[Lambda]3"}]]}], ")"}]}]}], "/.", 
    "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"64", " ", "C1"}], 
        RowBox[{"15", " ", 
         SuperscriptBox["r", "3"]}]]}], "-", 
      FractionBox[
       RowBox[{"4", " ", "C6"}], 
       SuperscriptBox["r", "3"]], "+", 
      FractionBox[
       RowBox[{"C2", " ", "r"}], "2"], "+", 
      RowBox[{"K1", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"3", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], ")"}]}], "+", 
      FractionBox[
       RowBox[{"2", " ", "K6", " ", 
        RowBox[{"BI", "[", 
         RowBox[{"2", ",", 
          RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
       RowBox[{"r", " ", "\[Lambda]3"}]], "-", 
      FractionBox[
       RowBox[{"3", " ", "K2", " ", 
        RowBox[{"BK", "[", 
         RowBox[{"2", ",", 
          RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
       RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", "K5", " ", 
        RowBox[{"BK", "[", 
         RowBox[{"2", ",", 
          RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
       RowBox[{"r", " ", "\[Lambda]3"}]]}], "/.", "with\[Tau]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"C1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["64", 
          RowBox[{"15", " ", 
           SuperscriptBox["r", "3"]}]]}], "+", 
        FractionBox["1", "r"]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{"4", " ", "C6"}], 
      SuperscriptBox["r", "3"]], "-", 
     FractionBox[
      RowBox[{"C2", " ", "r"}], "2"], "+", 
     FractionBox[
      RowBox[{"2", " ", "K6", " ", 
       RowBox[{"BI", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     RowBox[{"K1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"5", " ", 
           RowBox[{"BI", "[", 
            RowBox[{"2", ",", 
             RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
          RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]]}], "-", 
        RowBox[{"BI", "[", 
         RowBox[{"3", ",", 
          RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{"2", " ", "K5", " ", 
       RowBox[{"BK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"r", " ", "\[Lambda]3"}]}], "]"}]}], 
      RowBox[{"r", " ", "\[Lambda]3"}]], "+", 
     RowBox[{"K2", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"5", " ", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], 
         RowBox[{"2", " ", "r", " ", "\[Lambda]2"}]], "-", 
        RowBox[{"BK", "[", 
         RowBox[{"3", ",", 
          RowBox[{"r", " ", "\[Lambda]2"}]}], "]"}]}], ")"}]}]}], "/.", 
    "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"FunctionExpand", "[", "eqns", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions (small radius)", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]2", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d\[Theta]", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C2", "\[Rule]", 
        RowBox[{"\[Tau]", " ", "C2"}]}], ",", 
       RowBox[{"C6", "\[Rule]", 
        RowBox[{"C6", "/", "\[Tau]"}]}], ",", 
       RowBox[{"K1", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K1"}]}], ",", 
       RowBox[{"K2", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselK", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K2"}]}], ",", 
       RowBox[{"K3", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselK", "[", 
            RowBox[{"0", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K3"}]}], ",", 
       RowBox[{"K4", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselI", "[", 
            RowBox[{"0", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K4"}]}], ",", 
       RowBox[{"K5", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselK", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K5"}]}], ",", 
       RowBox[{"K6", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K6"}]}], ",", 
       RowBox[{"K7", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselK", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K7"}]}], ",", 
       RowBox[{"K8", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BesselI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K8"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"inner", " ", "wall", " ", "R"}], " ", "=", " ", "R0"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", "eps"], 
               RowBox[{"ur", "[", 
                RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"\[Sigma]r\[Theta]", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}], " ", "+", 
              RowBox[{"\[Chi]2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"u\[Theta]", "[", 
                  RowBox[{"R0", ",", "\[Theta]"}], "]"}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"mrr\[Theta]", "[", 
                   RowBox[{"R0", ",", "\[Theta]"}], "]"}]}]}], ")"}]}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"mrrr", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}], "+", 
              RowBox[{"\[Chi]2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["2", "5"]}], "d\[Theta]", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                 RowBox[{
                  FractionBox["7", "5"], 
                  RowBox[{"\[Sigma]rr", "[", 
                   RowBox[{"R0", ",", "\[Theta]"}], "]"}]}]}], ")"}]}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"mr\[Theta]\[Theta]", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}], "+", 
              RowBox[{"\[Chi]2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox["1", "5"], "d\[Theta]", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                 RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
                  RowBox[{"R0", ",", "\[Theta]"}], "]"}], "-", 
                 RowBox[{
                  FractionBox["1", "5"], " ", 
                  RowBox[{"\[Sigma]rr", "[", 
                   RowBox[{"R0", ",", "\[Theta]"}], "]"}]}]}], ")"}]}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"outer", " ", 
             RowBox[{"boundary", "/", "inflow"}], " ", "R"}], " ", "=", " ", 
            "R1"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", "eps"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ur", "[", 
                  RowBox[{"R1", ",", "\[Theta]"}], "]"}], "-", 
                 RowBox[{"v0", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"u\[Theta]", "[", 
               RowBox[{"R1", ",", "\[Theta]"}], "]"}], "+", 
              RowBox[{"v0", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"\[Sigma]rr", "[", 
              RowBox[{"R1", ",", "\[Theta]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
              RowBox[{"R1", ",", "\[Theta]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "/.", 
        "scaling"}], ")"}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "C1", ",", "C2", ",", "C3", ",", "C4", ",", "C5", ",", "C6", ",", "C7", 
       ",", "C8", ",", "K1", ",", "K2", ",", "K3", ",", "K4", ",", "K5", ",", 
       "K6", ",", "K7", ",", "K8"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", 
   "1", "\[RightDoubleBracket]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C1", "\[Rule]", 
    RowBox[{"-", "1.2015803663941995`"}]}], ",", 
   RowBox[{"C2", "\[Rule]", 
    RowBox[{"-", "0.37186922925156585`"}]}], ",", 
   RowBox[{"C3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C5", "\[Rule]", "0.17533845645094645`"}], ",", 
   RowBox[{"C6", "\[Rule]", "0.09182246809600324`"}], ",", 
   RowBox[{"C7", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C8", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K1", "\[Rule]", "0.01878477865308547`"}], ",", 
   RowBox[{"K2", "\[Rule]", "0.11986566347121315`"}], ",", 
   RowBox[{"K3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K5", "\[Rule]", "0.02624042013393698`"}], ",", 
   RowBox[{"K6", "\[Rule]", "0.0047679876250920645`"}], ",", 
   RowBox[{"K7", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K8", "\[Rule]", "0.`"}]}], "}"}]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "[", 
  RowBox[{"r", ",", "\[Theta]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"C8", "+", 
  RowBox[{"K4", " ", 
   RowBox[{"BesselI", "[", 
    RowBox[{"0", ",", 
     RowBox[{"6.0858061945018465`", " ", "r"}]}], "]"}]}], "+", 
  RowBox[{"K3", " ", 
   RowBox[{"BesselK", "[", 
    RowBox[{"0", ",", 
     RowBox[{"6.0858061945018465`", " ", "r"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"0.15`", " ", "C1"}], "r"], "+", 
     RowBox[{"6.666666666666667`", " ", "C2", " ", "r"}], "+", 
     RowBox[{"K1", " ", 
      RowBox[{"BesselI", "[", 
       RowBox[{"1", ",", 
        RowBox[{"6.0858061945018465`", " ", "r"}]}], "]"}]}], "+", 
     RowBox[{"K2", " ", 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", 
        RowBox[{"6.0858061945018465`", " ", "r"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], "Output"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pC", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ux", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"uy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ur", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"u\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]xx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]xy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]yx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]yy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]rr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"pC", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"ux", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"\[Sigma]xy", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions (large radius)", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Tau]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pressure", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"100.`", ",", 
       RowBox[{"-", "0.004086899527429505`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"50.`", ",", 
       RowBox[{"-", "0.008344050869667123`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20.`", ",", 
       RowBox[{"-", "0.021896677301376795`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10.`", ",", 
       RowBox[{"-", "0.046087643115920715`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.`", ",", 
       RowBox[{"-", "0.09630124346005746`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`", ",", 
       RowBox[{"-", "0.2339294172437545`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", 
       RowBox[{"-", "0.3974527307359897`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", 
       RowBox[{"-", "0.568975304838332`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2`", ",", 
       RowBox[{"-", "0.6130850161319591`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1`", ",", 
       RowBox[{"-", "0.45012115926748797`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05`", ",", 
       RowBox[{"-", "0.2647981458504634`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.02`", ",", 
       RowBox[{"-", "0.1126510593168095`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.01`", ",", 
       RowBox[{"-", "0.056928288413405734`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3`", ",", 
       RowBox[{"-", "0.6356377700725309`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.4`", ",", 
       RowBox[{"-", "0.6090043327111337`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7`", ",", 
       RowBox[{"-", "0.4898532726109614`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.8`", ",", 
       RowBox[{"-", "0.45550136224842336`"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P0", "=", 
   RowBox[{"ListPlot", "[", "pressure", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"P0", ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"4", " ", "\[Tau]"}], "+", 
           RowBox[{"15", " ", 
            SuperscriptBox["\[Tau]", "2"]}]}], 
          RowBox[{"1", "+", 
           RowBox[{"28", " ", 
            SuperscriptBox["\[Tau]", "2"]}], "+", 
           RowBox[{"20", " ", 
            SuperscriptBox["\[Tau]", "3"]}]}]]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"5", "\[Tau]"}], 
          RowBox[{"1", "+", 
           RowBox[{"13", 
            SuperscriptBox["\[Tau]", "2"]}]}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Tau]", ",", "0.01", ",", "2"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.01", ",", "2"}], "}"}], ",", "All"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{100., -0.004086899527429505}, {50., -0.008344050869667123}, {
       20., -0.021896677301376795`}, {10., -0.046087643115920715`}, {
       5., -0.09630124346005746}, {2., -0.2339294172437545}, {
       1., -0.3974527307359897}, {0.5, -0.568975304838332}, {
       0.2, -0.6130850161319591}, {0.1, -0.45012115926748797`}, {
       0.05, -0.2647981458504634}, {0.02, -0.1126510593168095}, {
       0.01, -0.056928288413405734`}, {0.3, -0.6356377700725309}, {
       0.4, -0.6090043327111337}, {0.7, -0.4898532726109614}, {
       0.8, -0.45550136224842336`}}]}, {}}, {}}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJwV1Xk4ldsXB3BFkog0IJmHpAHdQjesgxulpCikSQolkjF0RUoy3htRyRVR
JCVTyLDM8znnPRzzeJxjDilKSuf3/v54n/18/viuZz/vWntveXs3C4eVPDw8
U+T3/3Vpu1TJqP890PhTdVxL4yU+XbaNYX8MASZdNm8y5BXqMBKuDi3dB4bu
ZyK/Lx19fLdI9PiHgc7nNTu9ojLxa52kN9U/GiTcsiK+LWXjN81IcVu9R3Da
9R/1U0EF+JkWzqDoJYGKYlBsln0FevDVKITKvAb34PrPCtRm7BM0+ULxfg1z
d/8c1lNvQeP1TZVLza/hXOG+X/setqCkDGF33S8TgmM2J3w4ScUK7b6kU8w3
cNDDc6ahm4Yi1+a3KIW/A9Wrum/OTRPYcSUmbGgpB2JKqV/DOtpw7SdLdz2V
XIiqKanp52UixW3T6YQTuZAVGmMooMnETO8nqiczcsHrUODcQDgTA4KT6utP
5cHzuD+u3dVtR6XEzFXZ7/PBwW9w+97HHehJr7oT4FgIhd0d3tLburF0VrFu
KboQyiOeh1ce6UY+0RBB38JCuDnr0L3vRjfGHzeJ9RAogmt9nRbRRd1YxGhO
c8osghSngfM/jHvwVxuz/sRMMbAkdm6Nte3F+12jwio+pdBQ2Be45mw/0hZN
LFKTSiEi5telG/79KC75Ol6uvhQ0eEd00p70Y8bpa7JSEmWQxzTN82D2Y1PP
rIboxzJoDDNTfXN4AEX6Fy2Xlssh1+ea2r9qg9hyY5XZWFUFSCR/Yx25NIRV
Pv8crOioAH7zeyLSbkNY+Lek/tPJCijbHV/S4T+ELx7sUj8iVglrzq+j8cYM
oV/yqfXZFyvB6tD+dGMcQhXiZbsPTxXMmt9/eHsTC7d2qNPMN1ZBTdChnEFZ
For1FdepqlbBmpMFbmpqLFweoxb2mFfBW3TbEqDPQiZ34an+8ypoGM9xl3Rk
4R114/P8+tXwn2jNLoMcFvrsI6wGT1RDem3lX8YfWehywNa8yKEa6jrO2WpV
s9DG5DrFOaoa7r7PGuxksnD3hXgFWl81ZIH4jMJ3FvZFj47G3aqB0qPDZ2e0
h1Fr5r6bcnEtHKGG+K55M4yRRQHr3tJqYUnamn9n7jAOB3u93cuphU1Z45H7
i4cxWtx+ykikDo5e2C2wuX4Yxyh6TvYOdbBZItWiizWMT2K/nn++vh76A+oF
nm9g48y5yWWVbfWgKb8pNkiSjX+pshLf6daDqJ+4krksG+dKaT1lTvWgLX+z
L0+Njaajr636yuohOWFwz3MKG3/q2B2TdG6Alq32iZJX2WjBaz2dHNgAjNGs
9z2ubMygmkWqxjWA0oadLeEebDxpf6BJu6IBWuWZcUW32JgVsdnYanMjSG43
7jaLYuNKK+GR/h2NQPG7EBX+kI02cnz3HAwawTtlGQrj2LiqYK7Sy6URVEWO
bWH9x8bzAy16sVWNkP5AfdbvLRvzM6r7tnQ1gid3F2d/DhsFPT/eejHdCHqU
mPrJfDZ+WJ1RnCPRBAVNEnTZUjaKaN7dR1xvAhPnBNGeRjZW3N2/S1iqGYxa
hp0yhtmYvDVoSUm9GUzCdMxOjrAxqKCuXteoGbRmxhLnx9hIGbO0d7nWDFfX
l7eJTZN50+uPm0uaISuaj6/hG5ln519m05uBdyA9RfIHmf/7p+ZPdjMwrZ9a
2/0k8+8etKgJtcBIqeFFKpfMr09dEX62BXrzL2urCnAwOXOClnKjBURvf2cr
CXIwyEgjsfheCzzzSTEXF+IgxbtMayKrBWjZvgX9Ihys6Oq8dmi5BR68vT/9
ZTOZd5fZb7eeCivbP9c+lyDzgg78vspU2Ju/+MtwC5nX/ZKcbkaFZ6G3mC7S
HMTnQh38SVTwJJQNjytyMEnHMlUmlwoD4grbc5U4eJvx9IZWHRUiNH7xr1Xh
oD7vtrWOM1Q4O284l6LKQZlE166AlTQ4w72kMLSdg7/35r+M20yD/Jzm2E07
OFjuaECp1adBquqzQMddZH1uqHC/BQ0sjBnSwbvJ+k9oPfOONOjqnjSKUyfr
N53xVvqHBpub1a6/0CTzu3wy7w7SQHXCWt52H5mvK7357CsN3EU+jfyhReYv
8B7MW00H5SWT0lXaZP7hv4PD6nQI+LiH9VCH3J9aZ9aSER10iieOH91P7q9K
2l/Mhg7aP4o2ckmXz2duNAyig88MdpsdIOtHzbFOP6JDUa7hzwnSt1V0st0z
6JDJ55VzW5esb1N7OIWgw2L5EakYPbL+3FrxYg4dLFdemhHVJ+uHWXCIRTpI
lwjGPSA92O8GQaIE8FFrEuyB7EfkYb9LUgQMV6fyU0nLHVDMM1YhYFpM1Fyd
QvZz4ten7ZoEbLVUCw0jbfekQ0VYl4DW6pnKXtI8Ju/tPhsTwOO1T0zFgOz3
QlhC2wkC0q/lhl8hTUm7xPxwloDR9gW9VNIsC711CU4EuO5w0e8gHbxC/FCA
BwHW584nrTDkoML7z3fsAgi4yvPFTZl01fmmEqMHBOT4bq81IG0vnLagEkvA
v8qcbCvSK0sD1AWTCPgeNWBwmfQLZ+ur0xkESEflRjqTNpTUTCXyCPAM7Ey5
SppdL9ifV07AkNuLmIuk7/lwNj9uJMD8oPENC9JKyuXH/ZkEuH1uO6JLuqbt
cfi5QQIanv6pJUv6crB7DWWSgC90E8pPcv98mkd+Ky4QIP8h3Z8gnTaopLOa
hwHEnpGFJNJ/Rf92nxRkQIKMc5Uj6RHdrjfUTQyw8Qz8vI30/amckfdyDDC/
ZfbvMPk/VRIiZB/tYEAcT19OPOm6Qw6nb2ox4OnfYg5/kXb8rh9ra8AANCkq
niL7xf9Kgqp3lAFqjV4YSfrVyS/88tYMePSKHrKN9FjOS/8xFwZoO7AempL9
f2AXmN90kwFT/oLfWsl5URU5PfM2mAHTBR+sT5G+4iJk7/WEAanFquaHyPkS
kBp9Zp3KgJUaziuLyfnLaMT2P98xIC1UZUaR9ISK5+EVNQwI1i7JGCfnN7z9
6F0OjQHqFTKPDEmr3VMpq+9mQMnUhrl4cv6dWd0a0bMMONUXoq1Ono+pZxQJ
KalWSPz6zUd2LwcjTbdY/FZuhYBOpRvH/uDgzh9fI1gardCr+9zEdw8HXazS
uenGrSC8FmtLNTg4LbpubK9HK6yTeugoSJ7n2ZDegmONrdC3NlW+mrwvfGdZ
W7htreCa+Y/yG/I+4Tk9Hpg90AoXAqbmoxU4KLZz4bDofCvQzurIm8pxUKt1
3QBDpg0mfeR6/pEiz5uMIf8przaoCeW0XVzPQeHCDKszskwYmd2Bl5bYGC+X
XbJWjQnue6IiuxbZKBNeIFe6lwlX0qesTL+zUeNc1eRWUyYUlmXwKs+T7w9v
3+0BLyaIJXgkF5L3daK5SPrFJibUVRxusBli445x7+9O3u2QV0dxLa9m46JO
mqddYDuU5dDyV1SxsS6sddYmrB1SXU5uM6pgo/0O9fHD/7WDgFBiSgX5niRc
H+/aUdsOlkYyN18VsFFgwfbj7MYOqJHU4cins3F0BSXgZn4HBLlaFnx/wMYU
KUHe0K+dcOSWwIkVh9m4rVerzz+9B1yqbQx088n3+9q5QK9d/dBd+e1kr9Iw
Mj/kThe9GgRqYUmE71MWjhsTGyfUWCCnpPa7np+FfFI1j32vDcP9wcWbH+4O
oeq+e3e+1LFh2idoyuXHINpn9RLrt47ASJPCgVXcAdwvpLFqr+0oTO3a2HtC
YQAlco8nU/LG4Psev86TlH58RLkud3xhHPx4j/EY+vWhxCab1aYWkxBd5ufx
39tezDXutpzImIKZT5kK/HM9OGFnHRIx/gmUnJwf+Jn2oGplirSE0QzciPpb
zO55N64SnEhIvz8LLzrEnQdWd+OvTrb+zMXP4CP5JivQvwuXzIrZy8JzYHro
zv6Y8U401hH+Gf1uDl4NttwecuzE+IP1B+POfoHR2VSBwaEOdF9hZnR99VeQ
D/mU6H+pAxM0T+Q1vPoKb5lOP19+bceGeyVWTyzn4cu6RyviA9vx4NE0l4n5
eagLCMpmiLfj0SqbfcKxC8B9NxGw9QMTbc54ar7S/wbSn7Lcjx1nYu4VoeSK
gW/g+j5aSHChDUWfrjU8Hvkd0njrFcfj2rBML8zq4u5FaK3k871BacP5f1ul
D1IX4fz+7Iak2VbUWB0skeT3Ay4UO7ZKPGvFkrnsEN8tSzC7RdmFe6wVD3ON
VBoalkBXsSXbkctA+5JUv0nPn3DOuPEMTz4Dm6buQPSGX/BwniW37MZALajT
Sa/4BVcORmx4qcrAOf6wNAP7Zej0nb+ze5xArQDx6nc8v8FSoOHeSCaBQZuF
Nj3M+g17x2VPuTsTKKEU2D1/lAsGTRcUZTUIlI2cXlVpzgW44/xYRp1Alfkz
e6IsuODmwtops5vAvTU6Eco2XLgXulgivZPA45e/6Fpd4oJhu5CzjCqBoWkO
yYV+XKBS+rjKcgR+Uzrq5P+KCw1V08NmogQuR36MNX7NBcbdyzdPiBDIt6Ba
IZbFhVjbGztPrSNQrHaV5JscLqxj71w8K0Tgbgds6i3lQvLPoE3XBQh0fLln
t14bF8J3d12M5yHQVTjFdk0HF/p0JX5oc+no5S0S2t7FBcSu60bLdAw++GnQ
dYAL0i3qUmd+0DFp5OXDpAkuKMY3e0fN0fGl2cZy509cOCYUnZUwS8esguBJ
rVkulJcZKGZM0/FjyAUj+jwXHtsfJqon6Fg5TXV79p0Lwul3+VvH6NhwSjfR
aYkL9IZbfw+N0JFWltnwxzIXDv1Q2jPLpmO7suQCl8sFD1ePbb9ZdPwfIMrr
Yg==
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJwV1Xk8VP0XB3CFFAmVvQcVk5KlslV0lCg9VCpEGwoVj8jeJhSJtJCYbBWF
tCDJeijG2MYsBkk0mGspSyFFmt/9/XFf9/X+43O+r3vvOeeudD13wG2+kJDQ
KHn9/z6zVrmMuHANvnDMdFTu5mDynNO9vtLrkDwdM3de9Tkas6hnvsxEwpnM
9EMJL/IwMFhJofNCNPhsHu7Tq3+FEzTFgOYLcTBkuncE/xbgzw2x8k6mCVA6
wr37U6sExxk3WWamabBcX2PP4tfv8bxIzaoolRxIoPYesjjPwC7xXT/MAnLg
1o2yqt5WBlrKNFTPNOZAerqboplRCyqqMJ29Q3LBLVShz2i2BauMutLsWp8D
k1pfIlLFRCnPSSX1my+h6+PDiIPb2Nh2+l70l5l8uCvqF9ytwkWJbwd9TSkF
8MX+/e7Ef7lodk7WkWpbADu4t0U1grmYG5CkeSi7ANS57c40Jhcvh6fV1dkV
Qsdp+aSlV9tQPSVX9NXrN1BW/Hj0SVs7+rW8D7vsXgzjUy7R5107sXxsNW0m
rhgazYZtl0V1ooj0dfHg4mKY8DifGfO8ExP374o/v/AdZGfJxc2f7MR3rMZM
j9x3INPuukYs4hP+4bTW2Y6WwM/SaZMjyV0Y2UFIUgLLwYKXrdrytBsZv3Yd
eJJWDiUyrjo7aN0or5iTqFZXDtSKZYYx/G7MdvRUVVaoAFXdEUr66h5s6BzT
ky6tAPM9eZ6M1B6U+vzr4MxcJTi8GKBqWHzBJh9Rm4H3VRAf8cJ+bCUP3wfe
tqhqqwLvA6dv1OvwsPiS4rbk4Sq4njvbdXsrDx/f0Nb9d2k1iEXMifEO8TAk
w07mlUs1yD52WZkYyUMKM4sbKPQebmq4dNkSPAzTtTy+YNsHoP7m77Z+0IuB
Bkz7HtsP8HYf27/0US96bXXa987tA1T0SvfK5vXi4V3eZmdvfQBrUceXCVW9
qHMicRWj6wNMB3TZFQ72YlccQdy/WAMqNzeFhxr0oeFo5DmNklqwGlUdf1Hd
h7HvLi95waiF8Ha+/a2GPuwN93+h318LIx9sUg9z+jBO3vWruRQNCHe7ZYX9
fThgZurh6kaDeUF380MW9GNS/MTxdJk6WKSS5X7csh9Hjw3PUdbUwbl50zki
e/txpyYv5aVJHQwuyhA8sOvH7+WMzgqPOqg5Lbkh8lQ/7iFy7Lsq6uCM7WhH
eFg/zho771U8SwfXmDH6knf9eEDYYSQjlA4JVr9u367sx+xmm1jN+3TIq5nN
/VvTj4dctzYYVdHBIuu+TjarH/Ni5Czt5eqhgFKbvW64H493N5nGv6+HZc+D
jgrk+fgm+0OXUkc9bB4tmfP+h4/ifqUXH4/UQ5TTvq2MVXx8K5Zdkq/QAGNS
tM9HtPkotSHCgOndAIGbvgmKtvOxKmKztqRyIwRdP1wQ5MHHjBVXZ9R1G0Ei
rkE33ZOPV4todSbmjXAi9U5EyTk+mg0cdPXybARarsM4LYjM7/F+0FjWCEc8
Ql9YRpGWeTLv5tEm2J86ojj4hKyXO8R45NMEx0LUi3Y+I+uZ66WUXGuC+Bta
2vdzyXoBFYZDeU3gvcZtUiafzHe0e+6ea4LpkR+PL1XwEdMXty1Iawae9shV
9VY+phkffKJS0Ay51/Z709r4eIWV7GNIa4b81BdGxz7ycZvwGgn30WYwdehN
OdPNx0r37Wa12xjgJ84/JRgg84Ioyc8HGCDOWkhYDZP5JEbnpDsDcvy2YPQ3
Mt9wJED9NgO2N0oUD42Tee3A3IgeBszNH3Bf/5vM08qDHk4w4ESp+cHVs2T+
hLBFoVgLPPJSkpGeI/N37/T06raAP03OtFGIwMrJ3OU7rrYAvh36WS9GYNqt
7zzHhBYwFReR9l1E4BWK8Svf7BZYWLXOd4kEgdsO11o9YrYAI13Ecv0SAns+
n4Or0kxwD17KnFpG4NVYq5CTykxojJRz/k+WQLWtqwstKUxIKTOV6pQj0Dmp
jSJpwgSU27MsXpFAoV2vncctmSDdqh3bo0RgxlQ0lWPLhPHyDV4rVxDIO2C6
hOrBBF4gN/u6CoHh8+R3Xz7PhOV3CM1sVQJXvR4Pc77MhLrtM/ZVagS6SmZO
UeKZsFNplzB7FYHzyy/riqcxYU7ENbNxNYGPzzqcGclmwpIfOzaXqRPYVyf+
ubCSCbYtByIuUQi8Ftgv96CeCSdU2E571xCorlG5/0IrE4KXvzsrp0ngqXDf
GrNhJgSOxQVFryVQZMO/f1dPMUHX1DRRfx2BmT3qxmJCLNg31qTXRppv0vG8
WZYF/EpYMadFYOTXfP5rNRZUL7KOC19PIIUao5qgxYIh4djKv6Rpu90cgwxZ
8PCVW4WvNoHu09vinbaTeef1Dz+RXvBUodnUmgXRxWqnTXQIfHrox4KVDiw4
l+yjn0DaUrjJTMSVBTHaRtJ9pAfysy4MeLHgUPslibW6BN5wDn3TEMSCpI1G
hu6kNaUcR1+Es+CblFUGlTS9YqPm3VssCPMNd6SRPu212NU/iQU+NzJ8h0gv
VCYeOjwhzy+w+SWsR2B2PXK3vGTB1eCVc7KkdwcnS6mUsCA5NuO2Kukhip/V
vBoW1NaboBrpm1zriH4GC1Q32T1UJL3uGqWi7iP5fBMGm8RJN2wUms7tZ0Hd
CYXEH+R5Z3kf9eLGWPB2YhWHTVr8TuFZ3xkWLHA48zuXdO62W5mHRNkwcfSb
/EXSe0bcu42k2fB4AdXUnPTXh2YKysps8LhuEyJMOnaP0oG/GmzwMW35WEa+
n/W/J2J4emzoorf+50W66Vlzbc1WNmjOCu2UJe1l/0zwzJINPf19Z9+S73+x
aNjmGFs2cNpnxveRzit08vM+yoYgz9f9PPL7jUgvGdA/zwZl6517x8jvHYcD
agqX2UCxpX45S1rHu9ppNooNKuevKPaQ/eHd6M+oTmXD/aBlxflkPy25sHdh
VjYbqCueGUmTfqmpueNGIRvMvOISPcj+G7v+qWhvPRuuvbKlzCP7M3iMpyTg
sMEuQPKXJdm/Qo6Doa+62TBvMFQlUoPApeunrKQn2aCdFJIyTva/IXtJN0uF
A6u0UiqCyHnBrbLm4Ws5YLnFJTGanKfdWcrZG/U5YN0tonmfnDenYM3z8VYc
KO0ufZpMzuMVlR0L7Pw5oCU+d9JRgUCxG7s9RUM5ML14t/0WeQLvfN/LLIrm
APeSm4ssOe+Pa45Q5dI50HaybbyE3A+0swE6HfUcqPbXM64k94dkcbb9EdVW
CDrmtr9CmMBEtVdlEutaISPKV9NiPoEqN4vUyvVbwTFxrKmO3Fd6x94Pr9jT
CoOc31kV5D47JNx1pdu/FWxH+eg1zceUfVLPXBpa4bfsvlTeEB+1BgOmPQK4
oC5lbeDZyMdfxpl+zqFcuLNcxi+ino+0aPbY4WguJLrMbk6q46Orlu6gVSoX
Oiq/hRZ/4CPVe7BDq5YLO0fyC5rL+Lhwyql0bHkbPK+0rj3+nI/EPLPLQW/a
wKjhkuKOG3x8pCwuHDXRDlr8Mz9dtpD/F4Y32/5vO/ictpN4YETu5zDOI8qi
Djj5tp1Zr0/WH0gxo6l0QMW0f6SmLh/vFepeEd3TAXXO13Y1ruZj+L92vyMy
OiBhosHx+WI+nrqYMXbV5iN0/HnpNdfVj2s+GXZdeNYJNZ3SAWIh/TjgeSzU
X/szfHcof2Dypg9b3xaMvHvaA80G5seejvbioCVz+dA6HkhIxV88ptSLIso1
D4I9eyG2zNXkuBMPNQ2uhf2g9cGXOaOiwPgv6Jr3iSmzgg//LWrbeK+oBzcv
1hPVdyLgcY6sJMOnGxUK9meYFQ5Al8to7FeNz5hg5q22f2oQCt5EK18U6UIF
2cNiew4MQzp1Uf5odycWWH48OJT9FXqO/WloZn3EIWeH6zGD3yBBY9WaVKID
Nasf/aNgPgqTg/IXX023o6j4EPVZ5Bg4HSY+J1Da8U9737ZRl3FY0Wtzr8Ct
DWdsSvrmJL9DyCaVPzMZXLQ0lpyNe/kdSm543bScbMVEizqL+0d/QA/DR0N0
Zyv6zrMx9xabAO+UgHk6jzhI3WBbSH86AW7GRa2FMhykXyuzTzo4CZSwnG/3
r7DRwjrTa2hyEp5w+44/+sNC6/eHDSTjp2CQsJjKimDh4SN+G55u+wmr5atc
JcRYWHB6cUZV90/QO3HNMjWJidLJEjv2x05D7pHfCQwKEytMo+1ddH4Bdd1A
yemIFpy8w/7HovkXGJxad8GAxkA9sXCFtJDfULrlVKLPfAaWfX91PVhpBr6o
yvksPNSMVgJzCp0+A5FVisdC05vQtexJyLDfLGxoPNq882cjNnwNg7hlfyD0
iZiUyolGNASa8bOqP+CvXSCq8L4Bvy+IztzuOgdWi6bG7hg0oOFl+Q8vhf6C
edGTDM38erwqt1j2bt5foCZVq61dU48K6qEfJ60FsDs5w8bjOR1VY0dEq/cJ
oFVv0sIqh46UySMbbx0QwMOMvclaz+ioX2Mco3FYAItuVu7//piO+0/9MLE/
KYCoh4pCYVQ6RmW6ZRSHCED7jbVNfjQdf6pbe1x4KoAWywdidqfpOBdbGm+Z
Q55X+t1ghzsdRaY0q5bmCaDPL6Fc9xQdl9aKKj7PF8CVt0fZEs501HHDhk/l
Atj5Jf0fugMd3bM26phyyHprd6jZ7qLjf5KPnBa1CYDIUqo3t6Cjf4BUFLdD
AMs8CbqhOR3DLb71/NctAOZF4eZ/gI5p/Ky7aUMC4Lcv4I8Z0jHLZnnl2W8C
0Li93pyvT8e8ovBhwzEBNNxNne7cSMfS6yfMWyYFkDYtebJOh47VI83nHk4L
4FRun2LlejrS7UxSPGYEULArn1K0jo6Milz6pjkBvBBzjc7TpCNXQ3FKIBDA
rCZveyaFjv8Dtn/7JQ==
      "]]}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0.01, 2}, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", ",", "\[Chi]3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BCrhs", ",", "BC"}], "}"}], "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"CoefficientArrays", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"un", "-", "vnW"}], ")"}]}], "+", 
        RowBox[{"\[Chi]1", " ", 
         RowBox[{"(", 
          RowBox[{"pp", "-", "\[Theta]W"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "\[Chi]2"]}], "\[Sigma]nt"}], "+", 
        RowBox[{"(", 
         RowBox[{"ut", "+", 
          RowBox[{
           FractionBox["2", "1"], "mnnt"}], "-", "vtW"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "mnnn"}], "+", 
        RowBox[{"\[Chi]3", 
         RowBox[{"(", "\[Sigma]nn", ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "mntt"}], "+", 
        RowBox[{"\[Chi]4", 
         RowBox[{"(", "\[Sigma]tt", ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pp", ",", "un", ",", "ut", ",", "\[Sigma]nn", ",", "\[Sigma]nt", ",", 
       "\[Sigma]tt", ",", "mnnn", ",", "mnnt", ",", "mntt", ",", "mttt"}], 
      "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vnW", "-", 
      RowBox[{"\[Theta]W", " ", "\[Chi]1"}]}], ",", 
     RowBox[{"-", "vtW"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]1", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", 
       RowBox[{"-", 
        FractionBox["1", "\[Chi]2"]}], ",", "0", ",", "0", ",", "2", ",", "0",
        ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "\[Chi]3", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "\[Chi]4", ",", "0", 
       ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]eps", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", "0.00001"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C2", "\[Rule]", 
        RowBox[{"\[Tau]", " ", "C2"}]}], ",", 
       RowBox[{"C6", "\[Rule]", 
        RowBox[{"C6", "/", "\[Tau]"}]}], ",", 
       RowBox[{"K1", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K1"}]}], ",", 
       RowBox[{"K2", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BK", "[", 
            RowBox[{"0", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K2"}]}], ",", 
       RowBox[{"K3", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BK", "[", 
            RowBox[{"0", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K3"}]}], ",", 
       RowBox[{"K4", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BI", "[", 
            RowBox[{"0", ",", 
             RowBox[{"\[Lambda]2", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K4"}]}], ",", 
       RowBox[{"K5", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BK", "[", 
            RowBox[{"3", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K5"}]}], ",", 
       RowBox[{"K6", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BI", "[", 
            RowBox[{"3", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K6"}]}], ",", 
       RowBox[{"K7", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BK", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R0", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K7"}]}], ",", 
       RowBox[{"K8", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"BI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]3", " ", 
              FractionBox["R1", "\[Tau]"]}]}], "]"}], ")"}], 
          RowBox[{"-", "1"}]], "K8"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"ur", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"u\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"\[Sigma]rr", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"\[Sigma]r\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"mrrr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"mrr\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"mr\[Theta]\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"m\[Theta]\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"nn", "[", "R0", "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nn", "[", "R1", "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                RowBox[{"vtW", "\[Rule]", "0"}], ",", 
                RowBox[{"\[Chi]1", "\[Rule]", "eps"}], ",", 
                RowBox[{"\[Chi]2", "\[Rule]", 
                 RowBox[{"1", "/", "eps"}]}], ",", 
                RowBox[{"\[Chi]3", "\[Rule]", "\[Chi]"}], ",", 
                RowBox[{"\[Chi]4", "\[Rule]", "\[Chi]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", 
                 RowBox[{
                  TagBox[
                   RowBox[{"-", 
                    FractionBox[
                    RowBox[{"5", "\[Tau]"}], 
                    RowBox[{"1", "+", 
                    RowBox[{"13", 
                    SuperscriptBox["\[Tau]", "2"]}]}]]}],
                   CheckAbort[#, 
                    Defer[#]]& ], 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
                RowBox[{"vnW", "\[Rule]", 
                 RowBox[{"v0", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
                RowBox[{"vtW", "\[Rule]", 
                 RowBox[{
                  RowBox[{"-", "v0"}], " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                RowBox[{"\[Chi]1", "\[Rule]", 
                 RowBox[{"1", "/", "eps"}]}], ",", 
                RowBox[{"\[Chi]2", "\[Rule]", 
                 RowBox[{"1", "/", "eps"}]}], ",", 
                RowBox[{"\[Chi]3", "\[Rule]", "\[Chi]eps"}], ",", 
                RowBox[{"\[Chi]4", "\[Rule]", "\[Chi]eps"}]}], "}"}]}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "/.", "scaling"}], ")"}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "C1", ",", "C2", ",", "C3", ",", "C4", ",", "C5", ",", "C6", ",", "C7", 
       ",", "C8", ",", "K1", ",", "K2", ",", "K3", ",", "K4", ",", "K5", ",", 
       "K6", ",", "K7", ",", "K8"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", 
   "1", "\[RightDoubleBracket]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C1", "\[Rule]", 
    RowBox[{"-", "3.0991564381030514`"}]}], ",", 
   RowBox[{"C2", "\[Rule]", 
    RowBox[{"-", "0.1483104865047869`"}]}], ",", 
   RowBox[{"C3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C5", "\[Rule]", 
    RowBox[{"-", "2.9412095090071317`"}]}], ",", 
   RowBox[{"C6", "\[Rule]", 
    RowBox[{"-", "1.2340334381934923`"}]}], ",", 
   RowBox[{"C7", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C8", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K1", "\[Rule]", "0.009100811996617221`"}], ",", 
   RowBox[{"K2", "\[Rule]", "0.015083517645190428`"}], ",", 
   RowBox[{"K3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K5", "\[Rule]", 
    RowBox[{"-", "0.0006864150743995427`"}]}], ",", 
   RowBox[{"K6", "\[Rule]", "0.0018238905175749585`"}], ",", 
   RowBox[{"K7", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K8", "\[Rule]", "0.`"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "C1", ",", "C2", ",", "C3", ",", "C4", ",", "C5", ",", "C6", ",", "C7", 
      ",", "C8", ",", "K1", ",", "K2", ",", "K3", ",", "K4"}], "}"}], "/.", 
    "scaling"}], "/.", "solbc"}], "]"}]], "Input"],

Cell["\<\
List(-3.7493457286826626,-0.0001748532577469614,0.,0.,-8.121139559813377,-\
2207.9530113872297,0.,0.,-2.660553333968104e-83,4.9870629820977434e17,0.,0.)\
\>", "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pC", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ux", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ",", 
      RowBox[{"uy", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ur", "[", 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}]], ",", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
         RowBox[{"u\[Theta]", "[", 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}]], ",", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]xx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]xy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]yx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]yy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]rr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"pC", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"ux", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ux", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"uy", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["0-1-2 system (Type A)", "Subchapter"],

Cell[CellGroupData[{

Cell["first order 0-1-2-System with 2-relaxation", "Section"],

Cell[CellGroupData[{

Cell["Final Result", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coef", "[", 
   RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Normal", "[", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"expr", ",", "var"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coef", "[", 
   RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"expr", ",", "var"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p0", ">", "0"}], ",", 
     RowBox[{"RT0", ">", "0"}], ",", 
     RowBox[{"u0", ">", "0"}], ",", 
     RowBox[{"r", ">", "0"}], ",", 
     RowBox[{"\[Xi]", ">", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Cot", "[", "\[Theta]", "]"}], ">", "0"}], ",", 
     RowBox[{"Kn", ">", "0"}], ",", 
     RowBox[{"a", ">", "0"}], ",", 
     RowBox[{"b", ">", "0"}]}], "}"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Chi]", ",", "\[Alpha]", ",", "eps", ",", "\[Epsilon]", ",", "\[Tau]", 
    ",", "a0", ",", "b0", ",", "c0", ",", "d0", ",", "\[Alpha]0", ",", 
    "\[Kappa]0", ",", "\[Gamma]0", ",", "\[Omega]0", ",", "a", ",", "b", ",", 
    "c", ",", "d", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", 
    "\[Kappa]", ",", "\[Omega]", ",", "C0", ",", "C1", ",", "C2", ",", "C3", 
    ",", "C4", ",", "C5", ",", "C6", ",", "C7", ",", "C8", ",", "C9", ",", 
    "C10", ",", "C11", ",", "C12", ",", "K1", ",", "K2", ",", "K3", ",", "K4",
     ",", "K5", ",", "K6", ",", "K7", ",", "K8", ",", "K9", ",", "K10", ",", 
    "K11", ",", "K12"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ur", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"a0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     RowBox[{"a", "[", "r", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u\[Theta]", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"b0", "[", "r", "]"}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"b", "[", "r", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ur", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"u\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"d0", "[", "r", "]"}], "+", 
     RowBox[{
      RowBox[{"d", "[", "r", "]"}], 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]rr", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"\[Gamma]", "[", "r", "]"}]}], "+", 
    RowBox[{"\[Gamma]0", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"\[Omega]", "[", "r", "]"}]}], "+", 
    RowBox[{"\[Omega]0", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]r\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Kappa]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"\[Kappa]", "[", "r", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]zz", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Sigma]rr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
     RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]rr", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"\[Sigma]r\[Theta]", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]r\[Theta]", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"\[Sigma]zz", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"with\[Tau]", "=", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"r", "/", "\[Tau]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{"2", 
     FractionBox["C1", "r"]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b0", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["C2", 
        RowBox[{"2", " ", "r"}]], "+", 
       RowBox[{"r", " ", "C4"}]}], ")"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d0", "[", "r_", "]"}], "=", 
   RowBox[{"C3", "/.", "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]0", "[", "r_", "]"}], "=", 
   RowBox[{
    FractionBox["C2", 
     SuperscriptBox["r", "2"]], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]0", "[", "r_", "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", "C1"}], 
     SuperscriptBox["r", "2"]], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]0", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "C1"}], 
       SuperscriptBox["r", "2"]]}], "/.", "with\[Tau]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["C5", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"]}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox["r", "2"], " ", "C6"}], "+", "C7", "+", 
       RowBox[{"C8", " ", 
        RowBox[{"Log", "[", "r", "]"}]}]}], ")"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "C7"}], "-", "C8", "-", 
       FractionBox["C5", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "C6", " ", 
         SuperscriptBox["r", "2"]}], "2"], "-", 
       RowBox[{"C8", " ", 
        RowBox[{"Log", "[", "r", "]"}]}]}], ")"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "C8"}], "r"]}], "+", 
     RowBox[{"4", " ", "C6", " ", "r"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "C5"}], 
       SuperscriptBox["r", "3"]]}], "+", 
     RowBox[{"2", " ", "C6", " ", "r"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "C5"}], 
       SuperscriptBox["r", "3"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", "C8"}], "r"], "-", 
     RowBox[{"2", " ", "C6", " ", "r"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "r_", "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "C5"}], 
      SuperscriptBox["r", "3"]], "+", 
     FractionBox[
      RowBox[{"2", " ", "C8"}], "r"], "+", 
     RowBox[{"2", " ", "C6", " ", "r"}]}], "/.", "with\[Tau]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FunctionExpand", "[", 
  RowBox[{"coef", "[", 
   RowBox[{
    RowBox[{"Div1", "[", 
     RowBox[{"u", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FunctionExpand", "[", 
  RowBox[{"coef", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Grad0", "[", 
      RowBox[{"p", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
     RowBox[{"Div2", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{"FunctionExpand", "[", 
   RowBox[{"coef", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Grad1", "[", 
          RowBox[{"u", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Grad1", "[", 
           RowBox[{"u", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{
       FractionBox["1", "\[Tau]"], 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"coef", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"ur", "[", 
      RowBox[{"R0", ",", "\[Theta]"}], "]"}], "-", 
     RowBox[{"p", "[", 
      RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"coef", "[", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"\[Sigma]r\[Theta]", "[", 
      RowBox[{"R0", ",", "\[Theta]"}], "]"}], "-", 
     RowBox[{"u\[Theta]", "[", 
      RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "C3"}], "+", 
    RowBox[{"4.`", " ", "C1", " ", "\[Tau]"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "C7"}], "+", 
    FractionBox[
     RowBox[{"0.25`", " ", "C6"}], 
     SuperscriptBox["\[Tau]", "2"]], "-", 
    FractionBox[
     RowBox[{"2.`", " ", "C6"}], "\[Tau]"], "+", 
    RowBox[{"4.`", " ", "C8", " ", "\[Tau]"}], "-", 
    RowBox[{"4.`", " ", "C5", " ", 
     SuperscriptBox["\[Tau]", "2"]}], "+", 
    RowBox[{"2", " ", "C8", " ", 
     RowBox[{"Log", "[", 
      FractionBox["0.5`", "\[Tau]"], "]"}]}]}], ",", "0"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"1.`", " ", "C4"}], "\[Tau]"]}], "-", 
    RowBox[{"2.`", " ", "C2", " ", "\[Tau]"}], "+", 
    RowBox[{"4.`", " ", "C2", " ", 
     SuperscriptBox["\[Tau]", "2"]}]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"2", " ", "C7"}], "+", 
    RowBox[{"2", " ", "C8"}], "+", 
    FractionBox[
     RowBox[{"0.75`", " ", "C6"}], 
     SuperscriptBox["\[Tau]", "2"]], "+", 
    FractionBox[
     RowBox[{"1.`", " ", "C6"}], "\[Tau]"], "+", 
    RowBox[{"4.`", " ", "C5", " ", 
     SuperscriptBox["\[Tau]", "2"]}], "-", 
    RowBox[{"16.`", " ", "C5", " ", 
     SuperscriptBox["\[Tau]", "3"]}], "+", 
    RowBox[{"2", " ", "C8", " ", 
     RowBox[{"Log", "[", 
      FractionBox["0.5`", "\[Tau]"], "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]2", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"inner", " ", "wall", " ", "R"}], " ", "=", " ", "R0"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", "eps"], 
               RowBox[{"ur", "[", 
                RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", 
              RowBox[{"p", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"\[Sigma]r\[Theta]", "[", 
               RowBox[{"R0", ",", "\[Theta]"}], "]"}], " ", "+", 
              RowBox[{"\[Chi]2", 
               RowBox[{"(", 
                RowBox[{"u\[Theta]", "[", 
                 RowBox[{"R0", ",", "\[Theta]"}], "]"}], ")"}]}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"outer", " ", 
             RowBox[{"boundary", "/", "inflow"}], " ", "R"}], " ", "=", " ", 
            "R1"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", "eps"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ur", "[", 
                  RowBox[{"R1", ",", "\[Theta]"}], "]"}], "-", 
                 RowBox[{"v0", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"eps", " ", 
               RowBox[{"\[Sigma]r\[Theta]", "[", 
                RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u\[Theta]", "[", 
                 RowBox[{"R1", ",", "\[Theta]"}], "]"}], "-", 
                RowBox[{"v0", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "/.", 
        "scaling"}], ")"}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "C1", ",", "C2", ",", "C3", ",", "C4", ",", "C5", ",", "C6", ",", "C7", 
       ",", "C8"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C1", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C2", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C5", "\[Rule]", 
    RowBox[{"-", "0.000035986266305954594`"}]}], ",", 
   RowBox[{"C6", "\[Rule]", 
    RowBox[{"-", "188.2734932775042`"}]}], ",", 
   RowBox[{"C7", "\[Rule]", "3.490821351043474`"}], ",", 
   RowBox[{"C8", "\[Rule]", "0.8928710366139468`"}]}], "}"}]], "Output"]
}, Closed]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pC", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ux", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"uy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ur", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"u\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]xx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]xy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]yx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"\[Sigma]yy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]rr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Sigma]r\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"\[Sigma]\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"pC", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"ux", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"\[Sigma]xy", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions (large)", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", ",", "\[Chi]3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BCrhs", ",", "BC"}], "}"}], "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"CoefficientArrays", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"sn", "-", "vnW"}], ")"}]}], "+", 
        RowBox[{"\[Chi]1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Theta]W"}], ")"}], "+", "Rnn"}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "Rnt"}], "+", 
        RowBox[{"\[Chi]2", 
         RowBox[{"(", 
          RowBox[{"st", "-", "vtW"}], ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]", ",", "sn", ",", "st", ",", "Rnn", ",", "Rnt", ",", "Rtt"}], 
      "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vnW", "-", 
      RowBox[{"\[Theta]W", " ", "\[Chi]1"}]}], ",", 
     RowBox[{
      RowBox[{"-", "vtW"}], " ", "\[Chi]2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]1", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "\[Chi]1", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Chi]2", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vnW", "-", 
       RowBox[{"\[Theta]W", " ", "\[Chi]1"}]}], ",", 
      RowBox[{
       RowBox[{"-", "vtW"}], " ", "\[Chi]2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Chi]1", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "\[Chi]1", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Chi]2", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Chi]1", "\[Rule]", "\[Epsilon]"}], ",", 
    RowBox[{"\[Chi]2", "\[Rule]", 
     RowBox[{"1", "/", "\[Epsilon]"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vnW", ",", 
     RowBox[{"-", 
      FractionBox["vtW", "\[Epsilon]"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "\[Epsilon]", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       FractionBox["1", "\[Epsilon]"], ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", 
     RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C1", "\[Rule]", 
        RowBox[{"C1", "/", "eps"}]}], ",", 
       RowBox[{"C2", "\[Rule]", 
        RowBox[{"C2", "/", "eps"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"sr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"s\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"Rrr", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"Rr\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"R\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nn", "[", "R0", "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nn", "[", "R1", "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
           "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "eps", ",", "1", 
            ",", "1", ",", "1", ",", "1", ",", "1", ",", "eps"}], "}"}], 
          "]"}], ".", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coef", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"BC", ".", 
                 RowBox[{"U", "[", 
                  RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                 RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                 RowBox[{"vtW", "\[Rule]", "0"}], ",", 
                 RowBox[{"\[Chi]1", "\[Rule]", "eps"}], ",", 
                 RowBox[{"\[Chi]2", "\[Rule]", 
                  RowBox[{"1", "/", "eps"}]}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coef", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"BC", ".", 
                 RowBox[{"U", "[", 
                  RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                 RowBox[{"vnW", "\[Rule]", 
                  RowBox[{"v0", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
                 RowBox[{"vtW", "\[Rule]", 
                  RowBox[{
                   RowBox[{"-", "v0"}], " ", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                 RowBox[{"\[Chi]1", "\[Rule]", "eps"}], ",", 
                 RowBox[{"\[Chi]2", "\[Rule]", 
                  RowBox[{"1", "/", "eps"}]}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "/.", "scaling"}], ")"}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "C1", ",", "C2", ",", "C3", ",", "C4", ",", "C5", ",", "C6", ",", "C7", 
       ",", "C8"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"RowReduce", "::", "luc"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Result for \[NoBreak]\\!\\(RowReduce\\)\[NoBreak] of badly \
conditioned matrix \[NoBreak]\\!\\({\\(\\({0.`, 0.`, 0.`, 0.`, 0.`, 0.00001`, \
0.`, 400007.99999999994`, 0.`}\\)\\), \\(\\({0.`, 0.`, 0.`, 0.`, 100000.`, \
0.`, 2.00004`*^10, 0.`, 0.`}\\)\\), \\(\\({\\(\\(-1.3863743611198907`\\)\\), \
2.`, 0.25001`, \\(\\(-4.00016`\\)\\), 0.`, 0.`, 0.`, 0.`, 0.`}\\)\\), \\(\\({\
\\(\\(-0.6137056388801094`\\)\\), \\(\\(\[LeftSkeleton] 7 \[RightSkeleton]\\)\
\\), 0.`}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\), \
\\(\\({0.`, 0.`, 0.`, 0.`, 400000.`, 0.`, 4.999975`*^9, 0.`, 0.`}\\)\\), \
\\(\\({\\(\\(-1.3863143611198905`\\)\\), \\(\\(-2.`\\)\\), \\(\\(-3.99996`\\)\
\\), 0.2499975`, 0.`, 0.`, 0.`, 0.`, 1.`}\\)\\), \
\\(\\({\\(\\(-3.3862943611198912`\\)\\), \\(\\(-2.`\\)\\), \
\\(\\(-12.00004`\\)\\), \\(\\(-0.2499975`\\)\\), 0.`, 0.`, 0.`, 0.`, \
1.`}\\)\\)}\\)\[NoBreak] may contain significant numerical errors. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/luc\\\", \
ButtonNote -> \\\"RowReduce::luc\\\"]\\)\"\>"}]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C1", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C2", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C5", "\[Rule]", 
    RowBox[{"-", "0.23343538802154615`"}]}], ",", 
   RowBox[{"C6", "\[Rule]", 
    RowBox[{"-", "0.23342916324385726`"}]}], ",", 
   RowBox[{"C7", "\[Rule]", "0.24999732534919544`"}], ",", 
   RowBox[{"C8", "\[Rule]", "0.9920941745006198`"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]C", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"theta", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sx", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"sy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sr", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"s\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rxx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Rxy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ryx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Ryy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rrr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"R\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"\[Theta]C", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"sx", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Rxy", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["first order 0-1-2-system with 1-2-relaxation", "Section"],

Cell[CellGroupData[{

Cell["Final Result", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coef", "[", 
   RowBox[{"expr_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Normal", "[", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"expr", ",", "var"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "A0", ",", "A1", ",", "A2", ",", "\[Tau]", ",", "\[Lambda]1", ",", "a0", 
    ",", "b0", ",", "d0", ",", "\[Kappa]0", ",", "\[Gamma]0", ",", 
    "\[Omega]0", ",", "a", ",", "b", ",", "d", ",", "\[Gamma]", ",", 
    "\[Kappa]", ",", "\[Omega]", ",", "C1", ",", "C2", ",", "C3", ",", "C4", 
    ",", "K1", ",", "K2", ",", "K3", ",", "K4"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sr", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"a0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"a", "[", "r", "]"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"s\[Theta]", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"b0", "[", "r", "]"}], "+", 
     RowBox[{
      RowBox[{"b", "[", "r", "]"}], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"s\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"d0", "[", "r", "]"}], "+", 
     RowBox[{
      RowBox[{"d", "[", "r", "]"}], 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rrr", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"\[Gamma]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Gamma]", "[", "r", "]"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R\[Theta]\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Omega]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "r", "]"}], 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rr\[Theta]", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Kappa]0", "[", "r", "]"}], "+", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", "r", "]"}], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rzz", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Rrr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "-", 
     RowBox[{"R\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rrr", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"Rr\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rr\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"R\[Theta]\[Theta]", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"Rzz", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"A0", "+", 
    RowBox[{"A2", " ", 
     SuperscriptBox["r", "2"]}], "+", 
    RowBox[{"A1", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]1", "=", 
     SqrtBox["2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BI", "[", 
      RowBox[{"i_", ",", "x_"}], "]"}], "=", 
     RowBox[{"BesselI", "[", 
      RowBox[{"i", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BK", "[", 
      RowBox[{"i_", ",", "x_"}], "]"}], "=", 
     RowBox[{"BesselK", "[", 
      RowBox[{"i", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"with\[Tau]", "=", 
     RowBox[{"{", 
      RowBox[{"r", "\[Rule]", 
       RowBox[{"r", "/", "\[Tau]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Tau]", 
        FractionBox[
         RowBox[{"2", " ", "A1", " ", "r"}], "3"]}], "-", "C2", "+", 
       FractionBox["C1", 
        SuperscriptBox["r", "2"]], "-", 
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", "K2", " ", 
         RowBox[{"BI", "[", 
          RowBox[{"1", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"], "+", 
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", "K1", " ", 
         RowBox[{"BK", "[", 
          RowBox[{"1", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"]}], "/.", 
      "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Tau]"}], 
        FractionBox[
         RowBox[{"A1", " ", "r"}], "3"]}], "+", "C2", "+", 
       FractionBox["C1", 
        SuperscriptBox["r", "2"]], "+", 
       RowBox[{"K2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"BI", "[", 
           RowBox[{"0", ",", 
            RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}], "+", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"K1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"BK", "[", 
           RowBox[{"0", ",", 
            RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}], "+", 
          RowBox[{"BK", "[", 
           RowBox[{"2", ",", 
            RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], ")"}]}]}], "/.", 
      "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "3"]}], "\[Tau]", " ", "A1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          SuperscriptBox["r", "2"]}], ")"}]}], "+", 
       FractionBox["C1", "r"], "+", 
       RowBox[{"C2", " ", "r"}]}], "/.", "with\[Tau]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Tau]"}], 
        FractionBox["A1", "3"]}], "+", 
       FractionBox[
        RowBox[{"2", " ", "C1"}], 
        SuperscriptBox["r", "3"]], "+", 
       FractionBox[
        RowBox[{"2", " ", "K2", " ", 
         RowBox[{"BI", "[", 
          RowBox[{"2", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"], "+", 
       FractionBox[
        RowBox[{"2", " ", "K1", " ", 
         RowBox[{"BK", "[", 
          RowBox[{"2", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"]}], "/.", 
      "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "C1"}], 
         SuperscriptBox["r", "3"]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", "K2", " ", 
         RowBox[{"BI", "[", 
          RowBox[{"2", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"], "-", 
       FractionBox[
        RowBox[{"2", " ", "K1", " ", 
         RowBox[{"BK", "[", 
          RowBox[{"2", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"]}], "/.", 
      "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Kappa]", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Tau]", 
        FractionBox["A1", "3"]}], "+", 
       FractionBox[
        RowBox[{"2", " ", "C1"}], 
        SuperscriptBox["r", "3"]], "+", 
       RowBox[{"K2", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"BI", "[", 
             RowBox[{"0", ",", 
              RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"], "-", 
          RowBox[{
           SqrtBox["2"], " ", 
           RowBox[{"BI", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            SqrtBox["2"], " ", 
            RowBox[{"BI", "[", 
             RowBox[{"1", ",", 
              RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], 
           SuperscriptBox["r", "2"]]}], ")"}]}], "+", 
       RowBox[{"K1", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"BK", "[", 
             RowBox[{"0", ",", 
              RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "r"], "+", 
          RowBox[{
           SqrtBox["2"], " ", 
           RowBox[{"BK", "[", 
            RowBox[{"1", ",", 
             RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "+", 
          FractionBox[
           RowBox[{"2", " ", 
            SqrtBox["2"], " ", 
            RowBox[{"BK", "[", 
             RowBox[{"1", ",", 
              RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], 
           SuperscriptBox["r", "2"]]}], ")"}]}]}], "/.", "with\[Tau]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d0", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Tau]"}], 
        FractionBox[
         RowBox[{"A0", " ", 
          SuperscriptBox["r", "2"]}], "4"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Tau]", "3"], 
        FractionBox[
         RowBox[{"2", " ", "A2", " ", 
          SuperscriptBox["r", "2"]}], "3"]}], "-", 
       RowBox[{
        SuperscriptBox["\[Tau]", "3"], 
        FractionBox[
         RowBox[{"A2", " ", 
          SuperscriptBox["r", "4"]}], "16"]}], "+", "C3", "+", 
       RowBox[{"C4", " ", 
        RowBox[{"Log", "[", "r", "]"}]}]}], "/.", "with\[Tau]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a0", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Tau]", 
        FractionBox[
         RowBox[{"A0", " ", "r"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Tau]", "3"], 
        FractionBox[
         RowBox[{"A2", " ", 
          SuperscriptBox["r", "3"]}], "4"]}], "-", 
       FractionBox["C4", "r"]}], "/.", "with\[Tau]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b0", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"K3", " ", 
        RowBox[{"BK", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], "+", 
       RowBox[{"K4", " ", 
        RowBox[{"BI", "[", 
         RowBox[{"1", ",", 
          RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}]}], "/.", 
      "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]0", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Tau]"}], 
        FractionBox["A0", "6"]}], "-", 
       RowBox[{
        SuperscriptBox["\[Tau]", "3"], 
        FractionBox[
         RowBox[{"5", " ", "A2", " ", 
          SuperscriptBox["r", "2"]}], "12"]}], "-", 
       FractionBox["C4", 
        SuperscriptBox["r", "2"]]}], "/.", "with\[Tau]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Kappa]0", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"K4", " ", 
          RowBox[{"BI", "[", 
           RowBox[{"2", ",", 
            RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], 
         SqrtBox["2"]]}], "+", 
       FractionBox[
        RowBox[{"K3", " ", 
         RowBox[{"BK", "[", 
          RowBox[{"2", ",", 
           RowBox[{"\[Lambda]1", " ", "r"}]}], "]"}]}], 
        SqrtBox["2"]]}], "/.", "with\[Tau]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]0", "[", "r_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Tau]"}], 
        FractionBox["A0", "6"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Tau]", "3"], 
        FractionBox[
         RowBox[{"A2", " ", 
          SuperscriptBox["r", "2"]}], "12"]}], "+", 
       FractionBox["C4", 
        SuperscriptBox["r", "2"]]}], "/.", "with\[Tau]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceFreeSym2", "[", "mat_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"mat", "+", 
        RowBox[{"Transpose", "[", "mat", "]"}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "3"], 
      RowBox[{"Tr", "[", "mat", "]"}], 
      RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FunctionExpand", "[", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Div1", "[", 
        RowBox[{"s", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "-", 
       RowBox[{"F", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Grad0", "[", 
        RowBox[{"theta", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
       RowBox[{"Div2", "[", 
        RowBox[{"R", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"s", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"coef", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"TraceFreeSym2", "[", 
        RowBox[{"Grad1", "[", 
         RowBox[{"s", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}], "+", 
       RowBox[{
        FractionBox["1", "\[Tau]"], 
        RowBox[{"R", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FunctionExpand", "[", 
  RowBox[{"coef", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Grad0", "[", 
      RowBox[{"theta", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "-", 
     RowBox[{
      FractionBox["1", "2"], "\[Tau]", " ", 
      RowBox[{"Laplace1", "[", 
       RowBox[{"s", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "6"], "\[Tau]", " ", 
      RowBox[{"Grad0", "[", 
       RowBox[{"Div1", "[", 
        RowBox[{"s", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "\[Tau]"], 
      RowBox[{"s", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "10.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]0", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uW0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"scaling", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nn", "[", "R0", "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nn", "[", "R1", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"inner", " ", "wall", " ", "R"}], " ", "=", " ", "R0"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", "R0", "]"}], 
               RowBox[{"sr", "[", 
                RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "-", 
              RowBox[{"\[Chi]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"theta", "[", 
                    RowBox[{"R0", ",", "\[Theta]"}], "]"}], "-", 
                   "\[Theta]0"}], ")"}], "+", 
                 RowBox[{"Rrr", "[", 
                  RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], ")"}]}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", "R0", "]"}], 
               RowBox[{"Rr\[Theta]", "[", 
                RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], " ", "-", 
              RowBox[{"\[Chi]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s\[Theta]", "[", 
                  RowBox[{"R0", ",", "\[Theta]"}], "]"}], "-", 
                 RowBox[{"uW0", " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"outer", " ", "boundary", " ", "R"}], " ", "=", " ", 
            "R1"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", "R1", "]"}], 
               RowBox[{"sr", "[", 
                RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "-", 
              RowBox[{"\[Chi]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"theta", "[", 
                    RowBox[{"R1", ",", "\[Theta]"}], "]"}], "-", 
                   "\[Theta]1"}], ")"}], "+", 
                 RowBox[{"Rrr", "[", 
                  RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], ")"}]}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", "R1", "]"}], 
               RowBox[{"Rr\[Theta]", "[", 
                RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], " ", "-", 
              RowBox[{"\[Chi]", 
               RowBox[{"(", 
                RowBox[{"s\[Theta]", "[", 
                 RowBox[{"R1", ",", "\[Theta]"}], "]"}], ")"}]}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "/.", 
        "scaling"}], ")"}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "K1", ",", "K2", ",", "K3", ",", "K4", ",", "C1", ",", "C2", ",", "C3", 
       ",", "C4"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"K1", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K2", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C1", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C2", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C3", "\[Rule]", "0.9625031559956678`"}], ",", 
   RowBox[{"C4", "\[Rule]", 
    RowBox[{"-", "0.00040623828646352994`"}]}]}], "}"}]], "Output"]
}, Closed]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]C", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"theta", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sx", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"sy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sr", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"s\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rxx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Rxy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ryx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Ryy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rrr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"R\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"\[Theta]C", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"sx", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Rxy", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions (large radius)", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Chi]", ",", "\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", ",", "\[Chi]3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BCrhs", ",", "BC"}], "}"}], "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"CoefficientArrays", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"sn", "-", "vnW"}], ")"}]}], "+", 
        RowBox[{"\[Chi]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Theta]W"}], ")"}], "+", "Rnn"}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "Rnt"}], "+", 
        RowBox[{"\[Chi]", " ", "st"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]", ",", "sn", ",", "st", ",", "Rnn", ",", "Rnt", ",", "Rtt"}], 
      "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vnW", "-", 
      RowBox[{"\[Theta]W", " ", "\[Chi]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "\[Chi]", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Chi]", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Zeta]", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]0", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]1", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uW0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", "=", 
     RowBox[{"-", "0.1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C1", "\[Rule]", "C1"}], ",", 
       RowBox[{"C2", "\[Rule]", "C2"}], ",", 
       RowBox[{"K1", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{"K1", "/", 
          RowBox[{"(", "\[Tau]", ")"}]}]}]}], ",", 
       RowBox[{"K2", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{"K2", "/", 
          RowBox[{"(", "\[Tau]", ")"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"K3", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K3"}]}], ",", 
       RowBox[{"K4", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K4"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"sr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"s\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"Rrr", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"Rr\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"R\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nn", "[", "R0", "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nn", "[", "R1", "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]0"}], ",", 
                RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                RowBox[{"vtW", "\[Rule]", "0"}], ",", 
                RowBox[{"\[Chi]1", "\[Rule]", "eps"}], ",", 
                RowBox[{"\[Chi]2", "\[Rule]", 
                 RowBox[{"1", "/", "eps"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]1"}], ",", 
                RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                RowBox[{"vtW", "\[Rule]", "0"}], ",", 
                RowBox[{"\[Chi]1", "\[Rule]", "eps"}], ",", 
                RowBox[{"\[Chi]2", "\[Rule]", 
                 RowBox[{"1", "/", "eps"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "/.", "scaling"}], ")"}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "C1", ",", "C2", ",", "C3", ",", "C4", ",", "K1", ",", "K2", ",", "K3", 
       ",", "K4"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C1", "\[Rule]", 
    RowBox[{"-", "0.9351837633174386`"}]}], ",", 
   RowBox[{"C2", "\[Rule]", "0.07180825974284018`"}], ",", 
   RowBox[{"C3", "\[Rule]", "3.79149457833139`"}], ",", 
   RowBox[{"C4", "\[Rule]", 
    RowBox[{"-", "1.3083111049166367`"}]}], ",", 
   RowBox[{"K1", "\[Rule]", 
    RowBox[{"-", "0.00015049666674108245`"}]}], ",", 
   RowBox[{"K2", "\[Rule]", "9.007490134902125`*^-6"}], ",", 
   RowBox[{"K3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K4", "\[Rule]", "0.`"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "C1", ",", "C2", ",", "C3", ",", "C4", ",", "K1", ",", "K2", ",", "K3", 
      ",", "K4"}], "}"}], "/.", "scaling"}], "/.", "solbc"}], "]"}]], "Input"],

Cell["\<\
List(-0.9351837633174386,0.07180825974284018,3.79149457833139,-1.\
3083111049166367,-3.577337931978802,
   6.33324623915661e-16,0.,0.)\
\>", "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]C", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"theta", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sx", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"sy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sr", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"s\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rxx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Rxy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ryx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Ryy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rrr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"R\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"\[Theta]C", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"],

Cell[BoxData[" "], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"sx", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Rxy", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["With Boundary Conditions (large, angular)", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Chi]1", ",", "\[Chi]2", ",", "\[Chi]3", ",", "\[Chi]3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BCrhs", ",", "BC"}], "}"}], "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"CoefficientArrays", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"sn", "-", "vnW"}], ")"}]}], "+", 
        RowBox[{"\[Chi]1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]", "-", "\[Theta]W"}], ")"}], "+", "Rnn"}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "Rnt"}], "+", 
        RowBox[{"\[Chi]2", 
         RowBox[{"(", 
          RowBox[{"st", "-", "vtW"}], ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]", ",", "sn", ",", "st", ",", "Rnn", ",", "Rnt", ",", "Rtt"}], 
      "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vnW", "-", 
      RowBox[{"\[Theta]W", " ", "\[Chi]1"}]}], ",", 
     RowBox[{
      RowBox[{"-", "vtW"}], " ", "\[Chi]2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]1", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "\[Chi]1", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Chi]2", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"BCrhs", ",", "BC"}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"vnW", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
    RowBox[{"\[Chi]1", "\[Rule]", "\[Chi]"}], ",", 
    RowBox[{"\[Chi]2", "\[Rule]", "\[Chi]"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "vtW"}], " ", "\[Chi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "\[Chi]", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "\[Chi]", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", 
     RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=."}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Chi]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C1", "\[Rule]", "C1"}], ",", 
       RowBox[{"C2", "\[Rule]", "C2"}], ",", 
       RowBox[{"K1", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{"K1", "/", 
          RowBox[{"(", "\[Tau]", ")"}]}]}]}], ",", 
       RowBox[{"K2", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], 
         RowBox[{"K2", "/", 
          RowBox[{"(", "\[Tau]", ")"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"K3", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BK", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R0", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K3"}]}], ",", 
       RowBox[{"K4", "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"BI", "[", 
           RowBox[{"1", ",", 
            RowBox[{"\[Lambda]1", " ", 
             FractionBox["R1", "\[Tau]"]}]}], "]"}], 
          RowBox[{"-", "1"}]], "K4"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scaling1", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"sr", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"s\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{"Rrr", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"nn", "[", "r", "]"}], 
      RowBox[{"Rr\[Theta]", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}], ",", 
     RowBox[{"R\[Theta]\[Theta]", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nn", "[", "R0", "]"}], "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nn", "[", "R1", "]"}], "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"solbc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                RowBox[{"vtW", "\[Rule]", 
                 RowBox[{
                  RowBox[{"-", "v0"}], " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                RowBox[{"\[Chi]1", "\[Rule]", "\[Chi]"}], ",", 
                RowBox[{"\[Chi]2", "\[Rule]", "\[Chi]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BC", ".", 
                RowBox[{"U", "[", 
                 RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                RowBox[{"vtW", "\[Rule]", "0"}], ",", 
                RowBox[{"\[Chi]1", "\[Rule]", "\[Chi]"}], ",", 
                RowBox[{"\[Chi]2", "\[Rule]", "\[Chi]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "/.", "scaling"}], ")"}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "C1", ",", "C2", ",", "C3", ",", "C4", ",", "K1", ",", "K2", ",", "K3", 
       ",", "K4"}], "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"C1", "\[Rule]", "0.802317082510476`"}], ",", 
   RowBox[{"C2", "\[Rule]", 
    RowBox[{"-", "0.0018243621490365378`"}]}], ",", 
   RowBox[{"C3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"C4", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K1", "\[Rule]", 
    RowBox[{"-", "0.025715520724387365`"}]}], ",", 
   RowBox[{"K2", "\[Rule]", "5.828997268003255`*^-7"}], ",", 
   RowBox[{"K3", "\[Rule]", "0.`"}], ",", 
   RowBox[{"K4", "\[Rule]", "0.`"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C3", "=", 
   RowBox[{"C4", "=", 
    RowBox[{"K3", "=", 
     RowBox[{"K4", "=", "0"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bBC", ",", "ABC"}], "}"}], "=", 
   RowBox[{"FunctionExpand", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"coef", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"BC", ".", 
                  RowBox[{"U", "[", 
                   RowBox[{"R0", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                  RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                  RowBox[{"vtW", "\[Rule]", 
                   RowBox[{
                    RowBox[{"-", "v0"}], " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                  RowBox[{"\[Chi]1", "\[Rule]", "\[Chi]"}], ",", 
                  RowBox[{"\[Chi]2", "\[Rule]", "\[Chi]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"coef", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"BC", ".", 
                  RowBox[{"U", "[", 
                   RowBox[{"R1", ",", "\[Theta]"}], "]"}]}], "+", "BCrhs"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Theta]W", "\[Rule]", "0"}], ",", 
                  RowBox[{"vnW", "\[Rule]", "0"}], ",", 
                  RowBox[{"vtW", "\[Rule]", "0"}], ",", 
                  RowBox[{"\[Chi]1", "\[Rule]", "\[Chi]"}], ",", 
                  RowBox[{"\[Chi]2", "\[Rule]", "\[Chi]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"C1", ",", "C2", ",", "K1", ",", "K2"}], "}"}]}], "]"}], 
      "]"}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale1", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["\[Tau]", "0"], ",", 
      SuperscriptBox["\[Tau]", 
       RowBox[{"-", "1"}]], ",", "1", ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale2", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["\[Tau]", 
       RowBox[{"-", "3"}]], ",", 
      SuperscriptBox["\[Tau]", "0"], ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Tau]", "2"], 
         RowBox[{"BesselK", "[", 
          RowBox[{"0", ",", 
           FractionBox["\[Lambda]1", 
            RowBox[{"R1", " ", "\[Tau]"}]]}], "]"}]}], ")"}], 
       RowBox[{"-", "1"}]], ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"BesselI", "[", 
         RowBox[{"0", ",", 
          FractionBox["\[Lambda]1", 
           RowBox[{"R0", " ", "\[Tau]"}]]}], "]"}], ")"}], 
       RowBox[{"-", "1"}]]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{"scale1", ".", "ABC", ".", "scale2"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Tau]", "\[Rule]", "0.01"}], "}"}]}], "]"}], "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"basis", "[", "\[CurlyPhi]_", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]C", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"theta", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], ",", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "/.", "scaling"}], "/.", 
     "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sx", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", 
     RowBox[{"sy", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sr", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
        RowBox[{"s\[Theta]", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ".", 
      RowBox[{"basis", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "/.", "scaling"}], "/.", 
    "solbc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rxx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Rxy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ryx", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", 
       RowBox[{"Ryy", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}]}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rrr", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rr\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}], ",", 
            RowBox[{"R\[Theta]\[Theta]", "[", 
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}]], ",", 
              RowBox[{"ArcTan", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"basis", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ")"}]}], "/.", "scaling"}],
     "/.", "solbc"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"\[Theta]C", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"sx", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2.1"}], ",", "2.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Rxy", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<SouthwestColors\>\"", "]"}], "[", "z", 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"R0", "<", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "<", "R1"}]}], "]"}]}]}], 
  "]"}]], "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2113, 1219},
WindowMargins->{{104, Automatic}, {Automatic, 47}},
Visible->True,
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 23, \
2015)",
StyleDefinitions->"Default.nb"
]

