(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    207735,       5122]
NotebookOptionsPosition[    204422,       5007]
NotebookOutlinePosition[    204781,       5023]
CellTagsIndexPosition[    204738,       5020]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["A Must Run", "Section",
 CellChangeTimes->{{3.717228780296014*^9, 3.717228782724167*^9}}],

Cell[BoxData[
 RowBox[{"Off", "[", 
  StyleBox[
   RowBox[{"Solve", "::", "svars"}], "MessageName"], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"colorlist", "=", 
  RowBox[{"{", 
   RowBox[{"Black", ",", "Blue", ",", "Red", ",", 
    RowBox[{"Darker", "[", "Green", "]"}], ",", 
    RowBox[{"Darker", "[", "Yellow", "]"}], ",", "Orange", ",", 
    RowBox[{"Lighter", "[", "Green", "]"}], ",", 
    RowBox[{"Lighter", "[", "Brown", "]"}], ",", "Purple", ",", "Cyan"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.697795650946891*^9, 3.6977956613764*^9}, {
  3.6978016324049883`*^9, 3.697801632700445*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {GrayLevel[0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->GrayLevel[0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "GrayLevel[0]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["GrayLevelColorValueSelector"], {
           0, {Left, Bottom}}, {Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    GrayLevel[0],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0., 0., 0.6666666666666666],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[0, 0, 1]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 0, 1]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0, 0, 1],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0., 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[1, 0, 0]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0, 0],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0, 
          Rational[2, 3], 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0., 0.4444444444444444, 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[0, 2/3, 0]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 
           Rational[2, 3], 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0, 
     Rational[2, 3], 0],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[
          Rational[2, 3], 
          Rational[2, 3], 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0.4444444444444444, 0.4444444444444444, 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[2/3, 2/3, 0]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
           Rational[2, 3], 
           Rational[2, 3], 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[
     Rational[2, 3], 
     Rational[2, 3], 0],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[1, 0.5, 0]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[1, 0.5, 0],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[
          Rational[1, 3], 1, 
          Rational[1, 3]], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[
        0.2222222222222222, 0.6666666666666666, 0.2222222222222222],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[1/3, 1, 1/3]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
           Rational[1, 3], 1, 
           Rational[1, 3]]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[
     Rational[1, 3], 1, 
     Rational[1, 3]],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.7333333333333333, 0.6, 0.4666666666666667], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0.4888888888888889, 0.4, 0.3111111111111111],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[0.7333333333333333, 0.6, 0.4666666666666667]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.7333333333333333, 0.6, 0.4666666666666667]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.7333333333333333, 0.6, 0.4666666666666667],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.5, 0, 0.5], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0.33333333333333337`, 0., 0.33333333333333337`],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[0.5, 0, 0.5]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0.5, 0, 0.5]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.5, 0, 0.5],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0, 1, 1], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       Frame->True,
       FrameStyle->RGBColor[0., 0.6666666666666666, 0.6666666666666666],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 
          1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
           Magnification])}],
       PlotRangePadding->None],
      "RGBColor[0, 1, 1]"],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 1]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0, 1, 1],
    Editable->False,
    Selectable->False]}], "}"}]], "Output",
 CellChangeTimes->{3.697801633080882*^9, 3.7106639632926598`*^9, 
  3.710756667892189*^9, 3.7171591121095333`*^9, 3.717228772761167*^9, 
  3.717229020999215*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NtensorsFullTheories", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"6", ",", "9", ",", "12", ",", "16", ",", "20"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamesFullTheries", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<G20\>\"", ",", "\"\<G35\>\"", ",", "\"\<G56\>\"", ",", 
      "\"\<G84\>\"", ",", "\"\<G120\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NtensorsOrderedTheories", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"8", ",", "11", ",", "15", ",", "19", ",", "24"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NamesOrderedTheories", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<G26\>\"", ",", "\"\<G45\>\"", ",", "\"\<G71\>\"", ",", 
     "\"\<G105\>\"", ",", "\"\<G148\>\""}], "}"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix Generation", "Title",
 CellChangeTimes->{{3.681699355858017*^9, 3.681699357725204*^9}, {
  3.687549916945778*^9, 3.687549920075283*^9}}],

Cell[CellGroupData[{

Cell["Tensor Definitions", "Section",
 CellChangeTimes->{{3.569139429210832*^9, 3.569139448895958*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.679824089018515*^9}],

Cell["\<\
Mathematica build-in function like \[OpenCurlyQuote]Symmetrize[]\
\[CloseCurlyQuote] and \[OpenCurlyQuote]TensorContract[]\[CloseCurlyQuote] \
seem 
to work really slow or fail due to memory requirements on fully symmetric \
tensors 
with degree >10.
We define our own functions below based on a simply array data structure for \
fully symmetric tensors.\
\>", "Text",
 CellChangeTimes->{{3.5691393015045276`*^9, 3.5691394253246098`*^9}, {
  3.569230437595318*^9, 3.569230461117482*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "n", ",", "degree", ",", "idx", ",", "idx1", ",", "A", ",", "b", ",", "id3",
    ",", "IDX"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "TensorDegree", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Every", " ", "symmetric", " ", "tensor", " ", "can", " ", "be", " ", 
     "identified", " ", "with", " ", "the", " ", "help", " ", "of", " ", "a", 
     " ", "2", "D", " ", "array", " ", "say", " ", 
     RowBox[{
      RowBox[{"a", "[", "N", "]"}], "[", "3", "]"}], " ", "where", " ", "N", 
     " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "indepedent", " ", "variables", " ", "it", " ", 
     RowBox[{"has", ".", " ", "So"}], " ", "every", " ", "row", " ", "ie", 
     " ", 
     RowBox[{"a", "[", "i", "]"}], " ", "store", " ", "the", " ", "number", 
     " ", "of", " ", "entries", " ", "for", " ", "x", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}]}], ",", 
    RowBox[{"for", " ", "y", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}], " ", "and", " ", "for", 
     " ", "z", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "3", "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", "ii"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "the", " ", "same", " ", "thing", " ", "as", " ", "IDXFull", 
    " ", "but", " ", "for", " ", "trace", " ", "free", " ", "tensors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXtrfFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"ii", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IDX", "[", "degree", "]"}], "=", 
      RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDXtrf", "[", "degree", "]"}], "=", 
      RowBox[{"IDXtrfFull", "[", "degree", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "0", ",", "40"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"given", " ", "an", " ", "array", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "counts", " ", "the", " ", 
     "number", " ", "of", " ", "1", "s"}], ",", " ", 
    RowBox[{"2", "s", " ", "and", " ", "3", "s"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX1", "[", "list_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Input", " ", "cartesean", " ", "indices"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "3"}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "Total", " ", "of", " ", "the", " ", "list", " ", "is", " ", 
     "the", " ", "tensorial", " ", "degree", " ", "we", " ", "are", " ", 
     "interested", " ", 
     RowBox[{"in", ".", " ", "So"}], " ", "list", " ", "should", " ", "be", 
     " ", "a", " ", "3", "X1", " ", "array", " ", "and", " ", "the", " ", 
     "following", " ", "function", " ", "will", " ", "give", " ", "us", " ", 
     "the", " ", "n", " ", "corresponding", " ", "to", " ", "which", " ", 
     RowBox[{"a", "[", "n", "]"}]}], " ", "=", " ", 
    RowBox[{"list", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX2", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDX", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX3", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDXtrfFull", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "tensor", " ", "degree", " ", "of", " ", "a", 
    " ", "symmetric", " ", 
    RowBox[{"tensor", ".", "\[IndentingNewLine]", 
     RowBox[{"CAUTION", ":", " ", 
      RowBox[{
      "the", " ", "formulae", " ", "is", " ", "not", " ", "valid", " ", "for",
        " ", "trace", " ", "free", " ", 
       RowBox[{"tensors", "."}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorDegree", "[", "A_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         RowBox[{"Length", "[", "A", "]"}]}]}]]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"id3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaValues", "[", "list_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"b", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"c", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OddQ", "[", "a", "]"}], "||", 
         RowBox[{"OddQ", "[", "b", "]"}], "||", 
         RowBox[{"OddQ", "[", "c", "]"}]}], ",", "0", ",", 
        FractionBox[
         RowBox[{"Multinomial", "[", 
          RowBox[{
           FractionBox["a", "2"], ",", 
           FractionBox["b", "2"], ",", 
           FractionBox["c", "2"]}], "]"}], 
         RowBox[{"Multinomial", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "applied", " ", "deltavalues", " ", "to", " ", "all", " ", "the", " ", 
    "components", " ", "of", " ", "an", " ", "even", " ", "degree", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor2", "[", 
     RowBox[{"degree_", "?", "EvenQ"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"DeltaValues", ",", 
      RowBox[{"IDX", "[", "degree", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"What", " ", "does", " ", "this", " ", 
    RowBox[{"do", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTrace2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX2", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IDX", "[", 
                   RowBox[{"degree", "-", "2"}], "]"}], 
                  "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTraces", "[", 
     RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", "=", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"SymTrace2", "[", "res", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Assumes", " ", "3", " ", 
     RowBox[{"dimensions", ".", " ", "And"}], " ", "so"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contraction", " ", "of", " ", "a", " ", "symmetric", " ", "tensor", " ", 
    "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymDot2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Lets", " ", "take", " ", "a", " ", "particular", " ", "term", " ",
             "say", " ", "Ai1i2"}], ".."}], 
          RowBox[{"xbx", ".", " ", "In"}], " ", "the", " ", "result", " ", 
          "only", " ", "those", " ", "components", " ", "will", " ", "appear",
           " ", "in", " ", "which", " ", "x", " ", "atleast", " ", "appears", 
          " ", "once", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "why", " ", "the", " ", "addition",
           " ", "of", " ", 
          RowBox[{"id3", "[", 
           RowBox[{"[", "iis", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"toIDX2", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IDX", "[", 
                    RowBox[{"degree", "-", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                  "+", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "]"}], 
                "\[RightDoubleBracket]"}], 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "full", " ", "contraction", " ", "of", " ", "two", " ", "symmetric", " ", 
     "tensors", " ", "A"}], ",", " ", 
    RowBox[{"B", " ", "with", " ", "same", " ", "degree"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymFullDot", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TensorDegree", "[", "B", "]"}], "\[NotEqual]", "degree"}], 
         ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"idx", "=", 
           RowBox[{
            RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", "jj",
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "+=", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
              "]"}], 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{
            "B", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProduct2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"degree", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"degree", "+", "1"}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "1"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "b", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProductDelta2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"degree", "+", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"degree", "+", "1"}], ")"}]}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "2"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[GreaterEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}], 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "converts", " ", "a", " ", "symmetric", " ", "tensor", " ", "into", " ", 
    "a", " ", "trace", " ", "free", " ", "tensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "returns", " ", "the", " ", "tracefree", " ", "part", " ", "of", " ", "a",
      " ", "symmetric", " ", "tensor"}], ",", " ", 
    RowBox[{"but", " ", "with", " ", "all", " ", "components"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymTracefree", "[", "A_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
       RowBox[{"degree", "=", 
        RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", "res", 
       ",", "trace", ",", "res1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"trace", "=", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"trace", "=", 
           RowBox[{"SymTrace2", "[", "trace", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"res1", "=", 
            RowBox[{"SymProductDelta2", "[", "res1", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ll", ",", "1", ",", "kk"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "kk"], 
               RowBox[{"degree", "!"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"degree", "-", 
                  RowBox[{"2", "kk"}]}], ")"}], "!"}], 
               SuperscriptBox["2", "kk"], 
               RowBox[{"kk", "!"}]}]], 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"jj", "=", 
                RowBox[{"degree", "-", "kk"}]}], 
               RowBox[{"degree", "-", "1"}]], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", "jj"}], "+", "1"}]]}]}], ")"}], "res1"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"degree", "/", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5977647060562134`*^9, 3.5977647268750763`*^9}, {
   3.597764982828605*^9, 3.5977649884363317`*^9}, {3.676179501293851*^9, 
   3.6761796856337767`*^9}, {3.676179724780055*^9, 3.6761797401819553`*^9}, {
   3.6761800693011913`*^9, 3.67618009071702*^9}, {3.67618055987227*^9, 
   3.676180688136693*^9}, {3.676180727497422*^9, 3.676180773976479*^9}, {
   3.676181010436315*^9, 3.676181034457363*^9}, {3.676182895833144*^9, 
   3.676182910871441*^9}, {3.676183029280117*^9, 3.676183040299528*^9}, {
   3.676183109751354*^9, 3.676183133647092*^9}, {3.676184105172339*^9, 
   3.676184107563058*^9}, {3.676184447780569*^9, 3.676184559506366*^9}, 
   3.676184625341688*^9, {3.6761850010521708`*^9, 3.676185035780895*^9}, {
   3.6763163148181763`*^9, 3.676316347073567*^9}, {3.676316864163743*^9, 
   3.676316876694518*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trfEvaluate", "[", 
     RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "m", ",", 
        RowBox[{"dim", "=", "3"}], ",", 
        RowBox[{"degree", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", 
          "2"}]}], ",", "length", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "list"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"c", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"toIDX3", "[", "list", "]"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Binomial", "[", 
               RowBox[{"m", ",", "i"}], "]"}], 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX3", "[", 
                RowBox[{"list", "+", 
                 RowBox[{"2", "i", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "i"}], ")"}], " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"2", "m", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "say", " ", "we", " ", "have", " ", "a", " ", "trace", " ", "free", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "whose", " ", "independent", " ", "components", " ", "are", " ", "given",
       " ", "then", " ", "the", " ", "following", " ", "function", " ", 
      "will", " ", "introduce", " ", "those", " ", "components", " ", "in", 
      " ", "the", " ", "list", " ", "which", " ", "have", " ", "been", " ", 
      "negelected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
      "free", " ", "nature", " ", "of", " ", "the", " ", 
      RowBox[{"tensor", ".", " ", "For"}], " ", 
      RowBox[{"eg", ".", " ", "it"}], " ", "will", " ", "introduce"}], " ", 
     "-", "Rxx", "-", 
     RowBox[{
     "Ryy", " ", "for", " ", "a", " ", "second", " ", "order", " ", 
      "tensor"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trf2sym", "[", "A_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"trfEvaluate", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
        "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", "2"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Pick", " ", "the", " ", "2", "D", " ", "variables", " ", "from", " ", "a",
     " ", "list", " ", "containing", " ", "all", " ", "the", " ", 
    RowBox[{"indices", ".", "The"}], " ", "list", " ", "will", " ", "be", " ",
     "obtained", " ", "from", " ", "the", " ", "IDXtrf", " ", 
    RowBox[{"routine", ".", " ", "freeindex"}], " ", "is", " ", "the", " ", 
    "total", " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in",
     " ", "the", " ", "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pick2D", "[", "freeindex_", "]"}], ":=", 
   RowBox[{"Pick", "[", 
    RowBox[{
     RowBox[{"IDXtrf", "[", "freeindex", "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "freeindex"}], "}"}]}], "]"}]}], "]"}],
       "]"}], ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592214156581615*^9, 3.5922142269069633`*^9}, {
  3.592214273648*^9, 3.592214321643592*^9}, {3.592214562691799*^9, 
  3.5922146307578783`*^9}, {3.5922150087114487`*^9, 3.5922151927530117`*^9}, {
  3.592215226866392*^9, 3.592215227208199*^9}, {3.5922152622517147`*^9, 
  3.592215315308941*^9}, {3.592215349687686*^9, 3.592215358801886*^9}, {
  3.59221558179191*^9, 3.592215608488448*^9}, {3.592215669267857*^9, 
  3.592215699095985*^9}, {3.676315905534268*^9, 3.676315915972599*^9}, {
  3.6763161617740183`*^9, 3.676316190517806*^9}, {3.67631623272976*^9, 
  3.676316302687489*^9}, {3.683806014488147*^9, 3.683806106724654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTensorForm", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
               RowBox[{
               "A", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               "}"}], "&"}], ",", 
            RowBox[{
             RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", 
             "ii", "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "length"}], "}"}]}], "]"}], "//", 
        "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.59211253078022*^9, 3.592112545437512*^9}, {
   3.5921125805422792`*^9, 3.5921127616337748`*^9}, {3.592112796427103*^9, 
   3.5921128146670732`*^9}, 3.597764731152925*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymProductDelta2", "[", 
  RowBox[{"SymProductDelta2", "[", 
   RowBox[{"SymProductDelta2", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
        "]"}], "&"}], ",", 
      RowBox[{"IDX", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516209179254*^9, 3.591516237845764*^9}, {
  3.591516279723213*^9, 3.591516319002157*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441912649*^9, 3.676179291151037*^9, 3.6762888609657383`*^9, 
   3.6763161356528177`*^9, 3.6779058949079237`*^9, 3.678529868398068*^9, 
   3.679117967252459*^9, 3.679318837538498*^9, {3.6793190558293753`*^9, 
   3.679319058380992*^9}, 3.679575273024575*^9, 3.679577657421208*^9, 
   3.679658895156467*^9, 3.6797228224020033`*^9, 3.6797482729168377`*^9, 
   3.6797526651898537`*^9, 3.679823747940913*^9, 3.679824094340494*^9, 
   3.679916332279891*^9, 3.67999882302528*^9, 3.6803172844933577`*^9, 
   3.6809502873032503`*^9, 3.681138707433749*^9, 3.6812109489012957`*^9, 
   3.68145797428557*^9, 3.6816993958050756`*^9, 3.6820486434762287`*^9, 
   3.682050102103993*^9, {3.682076336638524*^9, 3.682076355905759*^9}, 
   3.68208228870901*^9, 3.68224490278273*^9, 3.682512107741544*^9, 
   3.68370299060351*^9, 3.683804366294202*^9, 3.684500244083356*^9, 
   3.684575174210775*^9, 3.6845752161625957`*^9, 3.684660181849285*^9, 
   3.68467126128831*^9, 3.68481365641619*^9, 3.6851056524874783`*^9, 
   3.685123331713553*^9, 3.685262662109161*^9, 3.685424638158787*^9, 
   3.685966017058461*^9, 3.686220731045607*^9, 3.687236612952524*^9, 
   3.687495338270397*^9, 3.6875504623069773`*^9, 3.687550586152584*^9, 
   3.687578759645015*^9, 3.6875831518868856`*^9, 3.687683442589807*^9, 
   3.68821555737145*^9, 3.697795464720536*^9, 3.710663965912551*^9, {
   3.7107561136882973`*^9, 3.7107561358180847`*^9}, 3.710756676723071*^9, 
   3.717159132979187*^9, 3.717228788375513*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "2", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591517786313066*^9, 3.5915178359472446`*^9}, {
  3.591517885949567*^9, 3.591517930610208*^9}, {3.5977650183992825`*^9, 
  3.597765018845586*^9}, {3.676316092317675*^9, 3.6763161065616913`*^9}, {
  3.676316140175808*^9, 3.676316140772443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441957636*^9, 3.6761792911794147`*^9, 3.676288861012822*^9, {
   3.676316093569808*^9, 3.676316107287977*^9}, {3.676316137581958*^9, 
   3.6763161413544827`*^9}, 3.677905894933*^9, 3.678529868437419*^9, 
   3.679117967277781*^9, 3.6793188375764503`*^9, {3.6793190558584337`*^9, 
   3.679319058418271*^9}, 3.679575273045879*^9, 3.6795776574426947`*^9, 
   3.679658895200933*^9, 3.679722822451293*^9, 3.679748272951642*^9, 
   3.6797526652462883`*^9, 3.679823747962522*^9, 3.6798240943917*^9, 
   3.679916332302744*^9, 3.679998823059197*^9, 3.680317284526877*^9, 
   3.680950287334775*^9, 3.681138707474543*^9, 3.681210948938271*^9, 
   3.681457974307749*^9, 3.681699395843232*^9, 3.682048643515264*^9, 
   3.682050102123021*^9, {3.682076336676392*^9, 3.682076355939827*^9}, 
   3.682082288745886*^9, 3.682244902819724*^9, 3.682512107762454*^9, 
   3.683702990650755*^9, 3.6838043663292027`*^9, 3.684500244127709*^9, 
   3.6845751742446737`*^9, 3.6845752161992826`*^9, 3.6846601818893833`*^9, 
   3.684671261318471*^9, 3.6848136564349537`*^9, 3.685105652526771*^9, 
   3.6851233317512207`*^9, 3.6852626621474*^9, 3.6854246381976*^9, 
   3.685966017098112*^9, 3.686220731084846*^9, 3.6872366130034647`*^9, 
   3.687495338306348*^9, 3.687550462357708*^9, 3.687550586182782*^9, 
   3.687578759680378*^9, 3.687583151923934*^9, 3.687683442625328*^9, 
   3.688215557407043*^9, 3.697795464758089*^9, 3.710663965956173*^9, {
   3.710756113727948*^9, 3.710756135861652*^9}, 3.710756676758993*^9, 
   3.717159133016121*^9, 3.717228788413114*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", 
          RowBox[{"2.", "#2"}], "-", 
          RowBox[{"3", "#3"}]}], "&"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "4", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516796847253*^9, 3.591516813094841*^9}, {
   3.5915174393368073`*^9, 3.5915174614075623`*^9}, {3.59151750012652*^9, 
   3.59151776014233*^9}, {3.591517814794807*^9, 3.5915178185262527`*^9}, {
   3.591517860691409*^9, 3.5915178802347727`*^9}, 3.591518123963479*^9, {
   3.5915182744621964`*^9, 3.591518302569395*^9}, {3.591526482595047*^9, 
   3.5915265043240232`*^9}, {3.591611217481101*^9, 3.591611231450076*^9}, {
   3.597765011088415*^9, 3.5977650116257725`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1428571428571423`"}], ",", "1.1428571428571432`", ",", 
   "2.571428571428571`", ",", "3.428571428571429`", ",", 
   "1.4285714285714286`", ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", "3.1428571428571432`", ",", 
   "2.857142857142857`", ",", 
   RowBox[{"-", "4.285714285714286`"}], ",", 
   RowBox[{"-", "5.428571428571429`"}], ",", 
   RowBox[{"-", "2.2857142857142847`"}], ",", "4.285714285714286`", ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "5.714285714285714`"}], ",", "3.428571428571427`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.675954442007567*^9, 3.67617929122402*^9, 3.676288861058632*^9, 
   3.677905894982387*^9, 3.678529868487091*^9, 3.679117967319182*^9, 
   3.6793188376105824`*^9, {3.679319055894771*^9, 3.679319058450843*^9}, 
   3.679575273094136*^9, 3.6795776574842777`*^9, 3.6796588952380247`*^9, 
   3.6797228224790287`*^9, 3.6797482729844093`*^9, 3.679752665267261*^9, 
   3.679823747991828*^9, 3.679824094441633*^9, 3.679916332335182*^9, 
   3.679998823098927*^9, 3.6803172845586*^9, 3.6809502873740597`*^9, 
   3.6811387075067053`*^9, 3.681210948971066*^9, 3.6814579743442507`*^9, 
   3.681699395875101*^9, 3.6820486435478983`*^9, 3.682050102157604*^9, {
   3.682076336706912*^9, 3.6820763559592457`*^9}, 3.682082288778234*^9, 
   3.6822449028531103`*^9, 3.682512107799152*^9, 3.683702990693994*^9, 
   3.683804366361187*^9, 3.6845002441605253`*^9, 3.6845751742821827`*^9, 
   3.684575216232545*^9, 3.684660181922132*^9, 3.684671261353323*^9, 
   3.684813656465918*^9, 3.685105652558341*^9, 3.6851233317891407`*^9, 
   3.685262662181744*^9, 3.685424638219063*^9, 3.685966017129785*^9, 
   3.6862207311299343`*^9, 3.687236613054021*^9, 3.687495338334983*^9, 
   3.68755046240657*^9, 3.687550586216948*^9, 3.6875787597118883`*^9, 
   3.687583151954731*^9, 3.6876834426579847`*^9, 3.688215557442892*^9, 
   3.697795464794897*^9, 3.710663965988412*^9, {3.710756113765514*^9, 
   3.7107561358948927`*^9}, 3.710756676791733*^9, 3.717159133050603*^9, 
   3.717228788441598*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymFullDot", "[", 
   RowBox[{
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], "}"}], 
      "]"}], "]"}], ",", 
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], "}"}], 
      "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Rxx", " ", "Sxx"}], "+", 
  RowBox[{"Ryy", " ", "Sxx"}], "+", 
  RowBox[{"2", " ", "Rxy", " ", "Sxy"}], "+", 
  RowBox[{"Rxx", " ", "Syy"}], "+", 
  RowBox[{"2", " ", "Ryy", " ", "Syy"}]}]], "Output",
 CellChangeTimes->{
  3.675954442064178*^9, 3.676179291269311*^9, 3.676288861096998*^9, 
   3.6779058950315104`*^9, 3.6785298685371113`*^9, 3.679117967356577*^9, 
   3.6793188376487103`*^9, {3.679319055928149*^9, 3.6793190584906387`*^9}, 
   3.679575273127549*^9, 3.679577657522038*^9, 3.679658895273378*^9, 
   3.6797228225005693`*^9, 3.6797482730345907`*^9, 3.67975266531371*^9, 
   3.679823748014205*^9, 3.6798240944848623`*^9, 3.679916332363706*^9, 
   3.6799988231490192`*^9, 3.6803172845798607`*^9, 3.680950287417145*^9, 
   3.681138707540022*^9, 3.68121094899828*^9, 3.681457974376297*^9, 
   3.6816993958984547`*^9, 3.682048643582439*^9, 3.68205010219067*^9, {
   3.682076336726356*^9, 3.682076355994687*^9}, 3.682082288811843*^9, 
   3.682244902885347*^9, 3.682512107830677*^9, 3.683702990731329*^9, 
   3.6838043663945713`*^9, 3.684500244192729*^9, 3.6845751743152113`*^9, 
   3.684575216264653*^9, 3.684660181955201*^9, 3.684671261373692*^9, 
   3.684813656498608*^9, 3.6851056525783567`*^9, 3.685123331821924*^9, 
   3.685262662214212*^9, 3.6854246382596397`*^9, 3.685966017149164*^9, 
   3.6862207311629133`*^9, 3.687236613103174*^9, 3.6874953383576593`*^9, 
   3.687550462437729*^9, 3.687550586237665*^9, 3.687578759731698*^9, 
   3.687583151973214*^9, 3.687683442686513*^9, 3.688215557475955*^9, 
   3.6977954648279552`*^9, 3.710663966008905*^9, {3.710756113798646*^9, 
   3.710756135927362*^9}, 3.7107566768248453`*^9, 3.717159133082704*^9, 
   3.7172287884749928`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], 
               "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], 
               "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sxx", ",", "Sxy", ",", "Syy"}], "}"}]}], "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6759544421144657`*^9, 3.676179291324445*^9, 3.676288861145307*^9, 
   3.6779058950810213`*^9, 3.678529868586431*^9, 3.679117967407839*^9, 
   3.679318837688384*^9, {3.67931905596832*^9, 3.679319058536566*^9}, 
   3.679575273161376*^9, 3.679577657555993*^9, 3.679658895317548*^9, 
   3.6797228225355597`*^9, 3.6797482730705357`*^9, 3.67975266534791*^9, 
   3.679823748046441*^9, 3.679824094521659*^9, 3.679916332386283*^9, 
   3.6799988232008038`*^9, 3.680317284627035*^9, 3.680950287450737*^9, 
   3.68113870757331*^9, 3.681210949019701*^9, 3.681457974397373*^9, 
   3.68169939592647*^9, 3.682048643616544*^9, 3.682050102224084*^9, {
   3.682076336757115*^9, 3.68207635602658*^9}, 3.682082288844701*^9, 
   3.682244902922915*^9, 3.6825121078512993`*^9, 3.68370299076066*^9, 
   3.6838043664285183`*^9, 3.6845002442129803`*^9, 3.684575174348187*^9, 
   3.6845752162828074`*^9, 3.684660181989087*^9, 3.684671261401486*^9, 
   3.6848136565327787`*^9, 3.685105652608335*^9, 3.685123331854587*^9, 
   3.685262662247349*^9, 3.68542463829657*^9, 3.685966017179893*^9, 
   3.6862207311960363`*^9, 3.687236613153617*^9, 3.687495338388363*^9, 
   3.687550462459461*^9, 3.687550586272641*^9, 3.687578759762412*^9, 
   3.687583152000236*^9, 3.687683442705769*^9, 3.688215557507641*^9, 
   3.697795464863399*^9, 3.710663966055792*^9, {3.710756113832677*^9, 
   3.710756135956469*^9}, 3.7107566768611803`*^9, 3.717159133127955*^9, 
   3.717228788508253*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "mxxx", ",", "mxxy", ",", "0", ",", "mxyy", ",", "0", ",", 
                "myyy", ",", "0"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "nxxx", ",", "nxxy", ",", "0", ",", "nxyy", ",", "0", ",", 
                "nyyy", ",", "0"}], "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy"}], "}"}]}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"nxxx", ",", "nxxy", ",", "nxyy", ",", "nyyy"}], "}"}]}], "]"}],
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}, {3.656607710425463*^9, 
  3.656607745128602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6759544421633577`*^9, 3.676179291374331*^9, 3.6762888611958103`*^9, 
   3.6779058951312113`*^9, 3.6785298686374598`*^9, 3.679117967455283*^9, 
   3.679318837730372*^9, {3.679319056013073*^9, 3.679319058585289*^9}, 
   3.679575273192576*^9, 3.6795776576017933`*^9, 3.679658895350123*^9, 
   3.679722822571162*^9, 3.679748273114377*^9, 3.679752665385249*^9, 
   3.679823748080174*^9, 3.6798240945561943`*^9, 3.679916332430656*^9, 
   3.67999882324424*^9, 3.6803172846583776`*^9, 3.68095028749041*^9, 
   3.6811387076070023`*^9, 3.681210949052898*^9, 3.6814579744431267`*^9, 
   3.681699395959167*^9, 3.682048643648769*^9, 3.682050102259828*^9, {
   3.682076336777141*^9, 3.68207635604613*^9}, 3.682082288878572*^9, 
   3.68224490295254*^9, 3.682512107880975*^9, 3.683702990795364*^9, 
   3.683804366461938*^9, 3.6845002442432127`*^9, 3.6845751743766327`*^9, 
   3.684575216310408*^9, 3.684660182022472*^9, 3.684671261435358*^9, 
   3.6848136565705357`*^9, 3.6851056526274567`*^9, 3.6851233318830767`*^9, 
   3.685262662282794*^9, 3.6854246383314543`*^9, 3.6859660172008753`*^9, 
   3.686220731229653*^9, 3.687236613204381*^9, 3.687495338407893*^9, 
   3.687550462494329*^9, 3.687550586317775*^9, 3.687578759780919*^9, 
   3.687583152033791*^9, 3.6876834427416973`*^9, 3.68821555752713*^9, 
   3.697795464905953*^9, 3.710663966087839*^9, {3.7107561138646173`*^9, 
   3.710756135975974*^9}, 3.710756676892455*^9, 3.717159133167177*^9, 
   3.71722878853086*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Definitions", "Section",
 CellChangeTimes->{{3.679646970945805*^9, 3.6796469737833633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ref", " ", "to", " ", "manuels", " ", "paper", " ", "on", " ", "fluxes", 
    " ", "for", " ", "large", " ", "moment", " ", "system", " ", "for", " ", 
    "a", " ", "detailed", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "tensorial", " ", "degree", " ", "including", " ", 
    "traces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"iFullDegree", "[", "i_", "]"}], "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"4", "i"}], "-", "3"}]], "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "traces", " ", 
     RowBox[{"C", "^", "2"}], " ", "has", " ", "one", " ", "trace"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTraces", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"iFullDegree", "[", "i", "]"}]}]}], ")"}], "2"], "]"}], 
      "-", "i"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "tensorial", " ", "degree"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTensorDegree", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"iFullDegree", "[", "i", "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"iTraces", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ii", "[", 
      RowBox[{"s_", ",", "A_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"A", "+", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{"A", "+", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"s", "+", "1"}], ")"}]}], "-", 
         RowBox[{"Floor", "[", 
          FractionBox[
           RowBox[{"A", "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}]}], ")"}]}], "-",
       "s"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "i", " ", "is", " ", "as", " ", "defined", " ", "in", " ", "the", " ", 
     "reference"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables2D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iTensorDegree", "[", "i", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfFullTensors3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"iFullDegree", "[", "ntensors", "]"}]}], ",", "frac"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"m", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "3"}], ")"}]}], "6."], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", 
               RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}], "2"], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varName", "[", 
     RowBox[{"s_", ",", "ix_", ",", "iy_", ",", "iz_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\[Rho]\>\"", ",", 
      RowBox[{"ToString", "[", "s", "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<x\>\"", ",", "ix"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<y\>\"", ",", "iy"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<z\>\"", ",", "iz"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "not", " ", "the", " ", "norm", " ", "of", " ", 
      "\[Psi]"}], ",", " ", 
     RowBox[{"rather", " ", 
      RowBox[{"it", "'"}], "s", " ", "the", " ", "norm", " ", "of", " ", 
      "the", " ", "laguerre", " ", "polynomials"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm\[Psi]", "[", 
      RowBox[{"a_", ",", "deg_"}], "]"}], "=", 
     FractionBox[
      RowBox[{
       RowBox[{"deg", "!"}], 
       RowBox[{"a", "!"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"deg", "+", "a", "+", 
         RowBox[{"3", "/", "2"}]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"deg", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "given", " ", "a", " ", "tensor", " ", "W", " ", "extract", " ", "all", 
     " ", "the", " ", "independed", " ", "components", " ", "in", " ", "2", 
     "D", " ", "in", " ", "case", " ", "of", " ", "trace", " ", "free", " ", 
     "situation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfComponents2D", "[", "W_", "]"}], ":=", 
    RowBox[{"Extract", "[", 
     RowBox[{"W", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"IDX", "[", 
             RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}], ",", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"IDXtrf", "[", 
           RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"TensorDegree", "[", "W", "]"}]}], "}"}]}], "]"}]}], 
            "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfVar2D", "[", 
     RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"name", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"deg", "+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"From2Dto3D", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "list", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Given", " ", "the", " ", "components", " ", "of", " ", "a", " ", 
        "tensor", " ", "represented", " ", "by", " ", "B"}], ",", " ", 
       RowBox[{
        RowBox[{
        "then", " ", "tmp", " ", "collects", " ", "the", " ", "terms", " ", 
         "corresponding", " ", 
         RowBox[{"to", " ", "\\", "partial_x"}], " ", 
         RowBox[{"in", " ", "\\", "partial_"}]}], "<", 
        RowBox[{"x_", 
         RowBox[{"{", "in", "}"}], " ", "w_", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i1", ".."}], "in"}], ">"}], "}"}], "\[IndentingNewLine]",
          "the", " ", "second", " ", "one", " ", "does", " ", "the", " ", 
         "same", " ", "job", " ", "but", " ", "for", " ", "a", " ", "tensor", 
         " ", 
         RowBox[{"product", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymDot2", "[", 
              RowBox[{
               RowBox[{"trf2sym", "[", 
                RowBox[{"From2Dto3D", "[", 
                 RowBox[{"trfVar2D", "[", 
                  RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficient", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", 
         "tensor", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymTracefree", "[", 
              RowBox[{"SymProduct2", "[", 
               RowBox[{
                RowBox[{"trf2sym", "[", 
                 RowBox[{"From2Dto3D", "[", 
                  RowBox[{"trfVar2D", "[", 
                   RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficients", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "15"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "following", " ", "is", " ", "the", " ", "main", " ", 
     "moment", " ", "equation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"recursion1", "[", 
     RowBox[{"a_", ",", "deg_", ",", "flag_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "deg"}], "+", "2"}], 
         RowBox[{
          RowBox[{"2", "deg"}], "+", "3"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"deg", "+", "a", "+", 
            FractionBox["3", "2"]}]], 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar2D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", "a", ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
         RowBox[{
          SqrtBox["a"], " ", 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar2D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", 
                RowBox[{"a", "-", "1"}], ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
        ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"deg", ">", "0"}], ",", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", "deg"}], 
           RowBox[{
            RowBox[{"2", "deg"}], "+", "1"}]]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SqrtBox[
             RowBox[{"(", 
              RowBox[{"deg", "+", "a", "+", 
               FractionBox["1", "2"]}], ")"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
           RowBox[{
            SqrtBox[
             RowBox[{"a", "+", "1"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"a", "+", "1"}], ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
          ")"}]}], ",", "0"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox[
      RowBox[{
       RowBox[{"Give", " ", "two", " ", "Laguerre", " ", "polynomials", " ", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["L", 
           RowBox[{"(", "n", ")"}]], ")"}], 
         RowBox[{"a", " "}]], "and", " ", 
        SubscriptBox[
         RowBox[{"(", 
          SuperscriptBox["L", 
           RowBox[{"(", "m", ")"}]], ")"}], 
         RowBox[{"b", " "}]], "then", " ", "the", " ", "following", " ", 
        "routine", " ", "computes", " ", 
        RowBox[{
         SubscriptBox[
          SuperscriptBox["\[Integral]", "\[Infinity]"], "0"], 
         RowBox[{
          SubscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["L", 
              RowBox[{"(", "n", ")"}]], 
             RowBox[{"(", 
              FractionBox[
               SuperscriptBox["x", "2"], "2"], ")"}]}], ")"}], 
           RowBox[{"a", " "}]], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["L", 
             RowBox[{"(", "m", ")"}]], 
            RowBox[{"(", 
             FractionBox[
              SuperscriptBox["x", "2"], "2"], ")"}]}], ")"}]}]}]}], ")"}], 
      RowBox[{"b", " "}]], 
     SuperscriptBox["x", "2"], 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"-", 
        SuperscriptBox["x", "2"]}], "2"]], 
     RowBox[{"dx", ".", " ", "Uses"}], " ", "the", " ", "Laguerre", " ", 
     "polynomials", " ", "used", " ", "in", " ", "file", " ", 
     RowBox[{"CompleteGenericMatrices1D", ".", "nb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mixed", "[", 
      RowBox[{"a_", ",", "n_", ",", "b_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Expand", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"n", "-", 
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"], "+", "a", "-", "c1", "-", "1"}], 
           ",", 
           RowBox[{"a", "-", "c1"}]}], "]"}], 
         FractionBox[
          RowBox[{"a", "!"}], 
          RowBox[{"c1", "!"}]], 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"m", "-", 
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"], "+", "b", "-", "c1", "-", "1"}], 
           ",", 
           RowBox[{"b", "-", "c1"}]}], "]"}], 
         FractionBox[
          RowBox[{"b", "!"}], 
          RowBox[{"c1", "!"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c1", "!"}], 
           SqrtBox["2"], 
           RowBox[{"Gamma", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"n", "+", "m"}], "2"], "+", "c1", "+", 
             RowBox[{"3", "/", "2"}]}], "]"}], 
           SuperscriptBox["2", 
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"]]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"c1", ",", "0", ",", 
          RowBox[{"Min", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "ratio", " ", "between", " ", "the", " ", "new", " ", "and", " ", "old", 
     " ", "laguerre", " ", "polynomials"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"factorLaguerre", "[", 
      RowBox[{"a_", ",", "n_"}], "]"}], ":=", 
     SqrtBox[
      FractionBox[
       RowBox[{"Gamma", "[", 
        RowBox[{"n", "+", 
         FractionBox["3", "2"]}], "]"}], 
       RowBox[{
        RowBox[{"n", "!"}], 
        RowBox[{"a", "!"}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"n", "+", "a", "+", 
          FractionBox["3", "2"]}], "]"}]}]]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "Laguerre", 
     " ", "polynomials", " ", "used", " ", "in", " ", "the", " ", "Boundary", 
     " ", "Value", " ", "problem", " ", "paper"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mixed2", "[", 
      RowBox[{"a_", ",", "n_", ",", "b_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"mixed", "[", 
        RowBox[{"a", ",", "n", ",", "b", ",", "m"}], "]"}], 
       RowBox[{"factorLaguerre", "[", 
        RowBox[{"a", ",", "n"}], "]"}], 
       RowBox[{"factorLaguerre", "[", 
        RowBox[{"b", ",", "m"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "The", " ", "following", " ", "function", " ", "integrates", " ", 
        "expressions", " ", "of", " ", "the", " ", "kind", " ", 
        RowBox[{"\[Integral]", 
         RowBox[{
          SuperscriptBox["\[Nu]x", "m"], 
          SuperscriptBox["\[Nu]y", "p"], 
          SuperscriptBox["\[Nu]z", "n"], "d\[Nu]", " ", "but", " ", "the", 
          " ", "integration", " ", "is", " ", "such", " ", "that", " ", 
          "only", " ", "\[Nu]x"}]}]}], " ", ">", 
       RowBox[{
       "0.", " ", "Making", " ", "the", " ", "transformation", " ", "to", " ",
         "spherical", " ", "coordinates", " ", 
        RowBox[{"i", ".", "e", ".", " ", "\[Nu]x"}]}]}], " ", "=", " ", 
      RowBox[{"Sin", " ", "\[Nu]", " ", "Cos", " ", "\[Theta]"}]}], ",", " ", 
     
     RowBox[{"\[Nu]y", " ", "=", " ", 
      RowBox[{
       RowBox[{
       "Sin", " ", "\[Nu]", " ", "Sin", " ", "\[Theta]", " ", "and", " ", 
        "\[Nu]z"}], " ", "=", " ", 
       RowBox[{"Cos", " ", "\[Nu]", " ", "we", " ", "have", " ", 
        RowBox[{
         SubscriptBox[
          SuperscriptBox["\[Integral]", 
           RowBox[{
            RowBox[{"+", "\[Pi]"}], "/", "2"}]], 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}]], 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Integral]", "0"], "\[Pi]"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Sin\[Nu]", 
              RowBox[{"mm", "+", "nn", "+", "1"}]], 
             SuperscriptBox["Cos\[Nu]", "pp"], 
             SuperscriptBox["Sin\[Theta]", "nn"], 
             SuperscriptBox["Cos\[Theta]", "mm"]}], ")"}], 
           "d\[Nu]d\[Theta]"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNz1", "[", "ex_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2", ",", "pos3", ",", 
        RowBox[{"mm", "=", "0"}], ",", 
        RowBox[{"nn", "=", "0"}], ",", 
        RowBox[{"pp", "=", "0"}], ",", "res", ",", 
        RowBox[{"res1", "=", 
         RowBox[{"\[Nu]x", " ", "\[Nu]y", " ", "\[Nu]z", " ", "ex"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos1", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]x", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos2", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]y", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos3", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]z", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], ">", "0"}], ",", 
         RowBox[{"mm", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], ">", "0"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos2", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], ">", "0"}], ",", 
         RowBox[{"pp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos3", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{"res1", ",", 
           RowBox[{"Join", "[", 
            RowBox[{"pos1", ",", "pos2", ",", "pos3"}], "]"}]}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OddQ", "[", "nn", "]"}], "||", 
            RowBox[{"OddQ", "[", "pp", "]"}]}], ",", "0", ",", 
           RowBox[{"2", "\[Pi]", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nn", "-", "1"}], ")"}], "!!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"mm", "-", "1"}], ")"}], "!!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pp", "-", "1"}], ")"}], "!!"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nn", "+", "mm", "+", "pp", "+", "1"}], ")"}], 
              "!!"}]]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]x"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]y"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]z"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "applies", " ", "integrate", " ", "halfnxnynz1", " ", "to", " ", "a", " ",
      "long", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNz", "[", "ex_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "ex", "]"}], "===", " ", "Plus"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"IntegrateHalfNxNyNz1", "[", 
           RowBox[{
           "ex", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"IntegrateHalfNxNyNz1", "[", "ex", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "input", " ", "of", " ", "the", " ", "following", " ", 
      "function", " ", 
      RowBox[{"i", ".", "e"}], " ", "idx1", " ", "and", " ", "idx2", " ", 
      "are", " ", "arrays", " ", "such", " ", "that", " ", 
      RowBox[{"idx1", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#xcomponents", ",", "#ycomponents", ",", "#zcomponents"}], 
         "}"}], ".", " ", "The"}], " ", "following", " ", "function", " ", 
       "computes", " ", "the", " ", "half", " ", "integrals", " ", "of", " ", 
       "the", " ", "form", " ", 
       RowBox[{"\[Integral]", " ", 
        RowBox[{
        "\[Psi]", " ", "fdc", " ", "where", " ", "\[Psi]", " ", "is", " ", 
         "the", " ", "basis", " ", "function", " ", "and", " ", "the", " ", 
         "integral", " ", "is", " ", "only", " ", "over", " ", "the", " ", 
         "half", " ", 
         RowBox[{"space", ".", " ", "The"}], " ", "\[Psi]", " ", "is", " ", 
         "represented", " ", "by", " ", "one", " ", "of", " ", "the", " ", 
         "input", " ", "parameters", " ", "and", " ", "the", " ", "basis", 
         " ", "functions", " ", "in", " ", "f", " ", "are", " ", 
         "represented", " ", "by", " ", "one", " ", "of", " ", "the", " ", 
         "input", " ", 
         RowBox[{
         "parameters", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "idx1"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
       "index", " ", "for", " ", "the", " ", "testfunction", 
        "\[IndentingNewLine]", "\t   ", "ix2"}], " ", "=", " ", 
       RowBox[{
       "index", " ", "for", " ", "the", " ", "basis", " ", "of", " ", "the", 
        " ", "distribution", " ", "function"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfIntegrate", "[", 
     RowBox[{"idx1_", ",", "idx2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Int1", ",", "Int2", ",", 
        RowBox[{"deg1", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx1", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", 
        RowBox[{"deg2", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx2", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "f0"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "following", " ", "term", " ", "develops", " ", "terms", 
        " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         SubscriptBox["\[Nu]", 
          RowBox[{"<", 
           RowBox[{
            SuperscriptBox["x", "m"], 
            SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "The"}], " ", 
        "algorithm", " ", "is", " ", "as", " ", "follows", 
        "\[IndentingNewLine]", "1.", " ", "Extract", " ", "the", " ", "total",
         " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in", 
        " ", "the", " ", "tensor", "\[IndentingNewLine]", "2.", " ", 
        "Develop", " ", "the", " ", "full", " ", "sym", " ", "trace", " ", 
        "free", " ", "tensor", " ", 
        RowBox[{"i", ".", "e"}], " ", "develop", " ", "all", " ", "the", " ", 
        "components", " ", "of", " ", 
        SubscriptBox["\[Nu]", 
         RowBox[{"<", 
          RowBox[{
           SubscriptBox["i", 
            RowBox[{"1", "..."}]], 
           SubscriptBox["i", "n"]}], ">"}]], "\[IndentingNewLine]", "3.", " ",
         "Extract", " ", "the", " ", "component", " ", "corresponding", " ", 
        "to", " ", "idx1"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Int1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"SymTracefree", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Nu]x", "#1"], 
                  SuperscriptBox["\[Nu]y", "#2"], 
                  SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
              "&"}], ",", 
             RowBox[{"IDX", "[", "deg1", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"toIDX2", "[", 
           RowBox[{"idx1", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
            "\[RightDoubleBracket]"}], "]"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "Let", " ", "us", " ", "consider", " ", "the", " ", "part", " ",
                "of", " ", "the", " ", "distribution", " ", "function", " ", 
               "which", " ", "comes", " ", "from", " ", 
               RowBox[{"Rij", ".", " ", "This"}], " ", "part", " ", "will", 
               " ", "be", " ", "of", " ", "the", " ", "form", " ", "Rxx"}], 
              "..."}], "+", "Rzz"}], "..."}], ".", " ", "But"}], " ", "Rzz"}],
          " ", "=", " ", 
         RowBox[{
          RowBox[{"-", "Rxx"}], "-", 
          RowBox[{
          "Ryy", " ", "and", " ", "therefore", " ", "Int2", " ", "is", " ", 
           "not", " ", "simply", " ", "the", " ", "tensorised", " ", 
           SubscriptBox["\[Nu]", 
            RowBox[{"<", 
             RowBox[{
              SuperscriptBox["x", "m"], 
              SuperscriptBox["y", "n"]}], ">"}]]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Int2", "=", 
        RowBox[{"SymFullDot", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Nu]x", "#1"], 
                 SuperscriptBox["\[Nu]y", "#2"], 
                 SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
             "&"}], ",", 
            RowBox[{"IDX", "[", "deg2", "]"}]}], "]"}], ",", 
          RowBox[{"trf2sym", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "\[Equal]", 
                    RowBox[{"idx2", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], ",", "1", ",", "0"}], "]"}], 
                 "&"}], ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"IDXtrf", "[", "deg2", "]"}]}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"f0", "=", " ", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", " ", "\[Pi]"}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"mixed2", "[", 
          RowBox[{
           RowBox[{
           "idx1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg1", ",", 
           RowBox[{
           "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg2"}], "]"}], "f0", " ", 
         RowBox[{"IntegrateHalfNxNyNz", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Int1", " ", "Int2"}], "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.679121885999333*^9, 
   3.679121891174914*^9}, {3.679122262361793*^9, 3.679122267112525*^9}, {
   3.679133059362032*^9, 3.679133059631439*^9}, {3.679133589038743*^9, 
   3.67913360936185*^9}, {3.679133640904398*^9, 3.6791336831388493`*^9}, {
   3.6791337141082077`*^9, 3.679133874437611*^9}, {3.679135482134459*^9, 
   3.679135484173957*^9}, {3.6792156676707373`*^9, 3.679215704456918*^9}, {
   3.6792240744446783`*^9, 3.67922407965063*^9}, {3.679224862877001*^9, 
   3.679224873400732*^9}, {3.679225442671756*^9, 3.679225466025872*^9}, {
   3.679226905039249*^9, 3.679226910362652*^9}, {3.6792317958716917`*^9, 
   3.679231814488446*^9}, {3.679234365577106*^9, 3.67923455103795*^9}, {
   3.679234637556697*^9, 3.679234658998818*^9}, {3.67923481326576*^9, 
   3.6792349261248913`*^9}, {3.67930698033679*^9, 3.679307111509572*^9}, 
   3.6793079545705748`*^9, {3.679307990942153*^9, 3.6793080003912067`*^9}, {
   3.6793080728155317`*^9, 3.67930812133251*^9}, {3.679308193672022*^9, 
   3.6793081992657127`*^9}, {3.679308266611847*^9, 3.6793082780834208`*^9}, {
   3.67930833570712*^9, 3.679308473366946*^9}, {3.679308542688333*^9, 
   3.679308586584567*^9}, 3.67931011500143*^9, {3.679316283604321*^9, 
   3.6793164193343067`*^9}, {3.679316950785508*^9, 3.679317078760085*^9}, {
   3.679317115961516*^9, 3.679317148087328*^9}, {3.679317186721846*^9, 
   3.679317202807983*^9}, {3.679317250901362*^9, 3.679317253339156*^9}, {
   3.679577712229986*^9, 3.679577715509426*^9}, {3.679577809486747*^9, 
   3.679577809636169*^9}, {3.6795856251725492`*^9, 3.679585640933337*^9}, {
   3.679637631192264*^9, 3.679637681544441*^9}, {3.679637722657783*^9, 
   3.679637838534441*^9}, {3.6796380620381813`*^9, 3.679638062453928*^9}, {
   3.6796381418023863`*^9, 3.67963814848005*^9}, {3.6796382255962143`*^9, 
   3.679638259265773*^9}, {3.6796382978240213`*^9, 3.679638422576579*^9}, {
   3.679645489712325*^9, 3.679645490928825*^9}, {3.679645528417181*^9, 
   3.679645538219562*^9}, {3.6796456043820677`*^9, 3.679645689824514*^9}, {
   3.679645765050008*^9, 3.67964580304412*^9}, {3.679645835164995*^9, 
   3.679645838423962*^9}, {3.679645957213408*^9, 3.679645981843093*^9}, {
   3.6796460142235928`*^9, 3.679646072405961*^9}, {3.679646113923502*^9, 
   3.679646146851458*^9}, {3.679646953690811*^9, 3.679646955349524*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrices generation", "Section",
 CellChangeTimes->{{3.679646943039679*^9, 3.6796469466063766`*^9}}],

Cell[CellGroupData[{

Cell["System Matrices", "Subsection",
 CellChangeTimes->{{3.679741272317607*^9, 3.679741275532207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetMatrices2D", "[", "Ntensors_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "varIdx", ",", "varIdxComplete", ",", "theory", ",", "normMatrix", ",", 
       "varNames", ",", "var", ",", "Ax", ",", "Ay", ",", 
       "\[IndentingNewLine]", "var1D", ",", "BCvar", ",", "varOdd", ",", 
       "varIdxCompleteEven", ",", "varEven", ",", "BCraw", ",", 
       RowBox[{"\[Rho]index", "=", "1"}], ",", 
       RowBox[{"vindex", "=", "2"}], ",", "\[Rho]Weqn", ",", "BCnum", ",", 
       "BCrhs", ",", "Praw", ",", "BCraw2", ",", "varIdxCompleteOdd", ",", 
       "IntGasEven", ",", "IntGasOdd", ",", "varIdxWall", ",", "IntWall", ",",
        "B", ",", "eqnVelocity"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "compute", " ", "the", " ", "tensor", " ", "degree", " ", "and", " ", 
        "the", " ", "number", " ", "of", " ", "traces", " ", "for", " ", 
        "every", " ", "tensor", " ", "in", " ", "the", " ", 
        RowBox[{"system", ".", "\[IndentingNewLine]", "In"}], " ", "all", " ",
         "the", " ", "coming", " ", "computations"}], ",", " ", 
       RowBox[{
       "iTraces", " ", "will", " ", "be", " ", "represented", " ", "by", " ", 
        
        RowBox[{"a", ".", "sa"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varIdx", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"iTraces", "[", "i", "]"}], ",", 
           RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "same", " ", "as", " ", "IDXtrf", " ", "but", " ", "instead", " ", 
        "stores", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
        "number", " ", "of", " ", "traces", " ", "in", " ", "the", " ", 
        "first", " ", "argument", " ", "of", " ", "every", " ", "list"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxComplete", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                  RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"IDXtrf", "[", 
                RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
               ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"variables", " ", "for", " ", "the", " ", 
        RowBox[{"wall", ".", " ", "Density"}], " ", "and", " ", 
        "Temperature"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxWall", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "computes", " ", "the", " ", "number", " ", "of", " ", "traces", " ", 
        "for", " ", "a", " ", "given", " ", 
        RowBox[{"iTensorDegree", ".", " ", "The"}], " ", "final", " ", 
        "result", " ", "gives", " ", "us", " ", "the", " ", "tuple", " ", 
        "discussed", " ", "in", " ", "the", " ", "paper", " ", "on", " ", 
        "the", " ", "convergence", " ", "of", " ", "the", " ", "boundary", 
        " ", "value", " ", 
        RowBox[{"problem", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"theory", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"varIdx", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "k"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"iFullDegree", "[", "Ntensors", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<number of different tensor degrees: \>\"", ",", "theory"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<corresponding variables (traces,indices): \>\"", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", 
                  RowBox[{
                   RowBox[{
                   "theory", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "theory", "]"}]}], "}"}]}], "]"}], ",",
             "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 1D: \>\"", ",", "Ntensors"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 2D: \>\"", ",", 
          RowBox[{"NumberOfVariables2D", "[", "Ntensors", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 3D: \>\"", ",", 
          RowBox[{"NumberOfVariables3D", "[", "Ntensors", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of full Tensors 3D: \>\"", ",", 
          RowBox[{"NumberOfFullTensors3D", "[", "Ntensors", "]"}]}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"normMatrix", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "deg"}], "}"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{
                  RowBox[{"Norm\[Psi]", "[", 
                   RowBox[{"a", ",", "deg"}], "]"}], ",", 
                  RowBox[{"deg", "+", "1"}]}], "]"}]}], "]"}], "@@", "#"}], 
             "&"}], ",", "varIdx"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "So", " ", "the", " ", "stress", " ", "tensor", " ", "will", " ", "be",
         " ", "different", " ", "from", " ", "the", " ", "usual", " ", 
        "stress", " ", "tensor", " ", "defined", " ", 
        RowBox[{"normally", ".", "\[IndentingNewLine]", "All"}], " ", "the", 
        " ", "variable", " ", "names", " ", "are", " ", "for", " ", "the", 
        " ", "2", "D", " ", 
        RowBox[{"case", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varNames", "=", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"varName", "@@", "#"}], "&"}], ",", "varIdxComplete"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<\[Rho]0\>\"", "\[Rule]", "\"\<\[Rho]\>\""}], ",", 
            RowBox[{"\"\<\[Rho]0x\>\"", "\[Rule]", "\"\<vx\>\""}], ",", 
            RowBox[{"\"\<\[Rho]0y\>\"", "\[Rule]", "\"\<vy\>\""}], ",", 
            RowBox[{"\"\<\[Rho]1\>\"", "\[Rule]", "\"\<\[Theta]\>\""}], ",", 
            RowBox[{"\"\<\[Rho]0xx\>\"", "\[Rule]", "\"\<\[Sigma]xx\>\""}], 
            ",", 
            RowBox[{"\"\<\[Rho]0xy\>\"", "\[Rule]", "\"\<\[Sigma]xy\>\""}], 
            ",", 
            RowBox[{"\"\<\[Rho]0yy\>\"", "\[Rule]", "\"\<\[Sigma]yy\>\""}], 
            ",", 
            RowBox[{"\"\<\[Rho]1x\>\"", "\[Rule]", "\"\<qx\>\""}], ",", 
            RowBox[{"\"\<\[Rho]1y\>\"", "\[Rule]", "\"\<qy\>\""}]}], "}"}]}], 
         "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "/", "2"}], "\[Theta]"}]}], ",", 
          RowBox[{"qx", "\[Rule]", 
           RowBox[{"-", "qx"}]}], ",", 
          RowBox[{"qy", "\[Rule]", 
           RowBox[{"-", "qy"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "the", " ", "result", " ", "from", " ", "var", " ", "consists", " ", 
         "of", " ", "the", " ", "form", " ", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"n", ",", "a", ",", "deg"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"where", " ", "a"}], " ", "=", " ", "#traces"}], ",", " ", 
        RowBox[{"deg", " ", "=", " ", 
         RowBox[{
          RowBox[{
          "#free", " ", "tensors", " ", "and", " ", "n", " ", "is", " ", 
           "the", " ", "name", " ", "for", " ", "eg", " ", "vx"}], " ", "=", 
          " ", 
          RowBox[{
           RowBox[{"1", " ", "and", " ", "vy"}], " ", "=", " ", 
           RowBox[{
           "2", " ", "or", " ", "\[Theta]", " ", "is", " ", "simply", " ", 
            "1"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"var", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "deg"}], "}"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"deg", ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", "deg"}], "]"}], "&"}]}], "]"}]}],
             "]"}], ",", "item"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ax", "=", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "deg"}], "}"}], ",", 
                 RowBox[{"recursion1", "[", 
                  RowBox[{"a", ",", "deg", ",", "1"}], "]"}]}], "]"}], ",", 
               "item"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ay", "=", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "deg"}], "}"}], ",", 
                 RowBox[{"recursion1", "[", 
                  RowBox[{"a", ",", "deg", ",", "2"}], "]"}]}], "]"}], ",", 
               "item"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"reduction", " ", "for", " ", "1", "d"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"var1D", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ")"}]}], 
                 ",", "1", ",", "0"}], "]"}], "&"}], ",", "varIdxComplete"}], 
             "]"}], ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"varIdxComplete", "=", 
         RowBox[{
         "varIdxComplete", "\[LeftDoubleBracket]", "var1D", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"varNames", "=", 
         RowBox[{
         "varNames", "\[LeftDoubleBracket]", "var1D", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ax", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"Ax", "\[LeftDoubleBracket]", 
           RowBox[{"var1D", ",", "var1D"}], "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normMatrix", "=", 
         RowBox[{"normMatrix", "\[LeftDoubleBracket]", 
          RowBox[{"var1D", ",", "var1D"}], "\[RightDoubleBracket]"}]}], ";"}],
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "As", " ", "the", " ", "literature", " ", "says", " ", "the", " ", 
        "boundary", " ", "conditions", " ", "will", " ", "only", " ", "be", 
        " ", "computed", " ", "with", " ", "basis", " ", "functions", " ", 
        "which", " ", "have", " ", "odd", " ", "powers", " ", "of", " ", "Cx", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "considering", " ", "the", " ", "normal", " ", "to", " ", "point", 
           " ", "in", " ", "the", " ", "x", " ", "direction"}], ")"}], ".", 
         " ", "BCVar"}], " ", "is", " ", "a", " ", "mapping", " ", "which", 
        " ", "collects", " ", "odd", " ", "basis", " ", "functions"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BCvar", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OddQ", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ",", "1", ",", "0"}], "]"}], "&"}], ",", 
         "varIdxComplete"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"the", " ", "position", " ", "of", " ", "odd", " ", 
        RowBox[{"variables", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varOdd", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"BCvar", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Picks", " ", "out", " ", "the", " ", "even", " ", 
        RowBox[{"components", ".", " ", "The"}], " ", "fourth", " ", 
        "component", " ", "is", " ", "anyhow", " ", "always", " ", 
        RowBox[{"zero", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxCompleteEven", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"varIdxComplete", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"EvenQ", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], "&&", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
             "\[Equal]", "0"}]}], ")"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Picks", " ", "out", " ", "the", " ", "odd", " ", "variables"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varIdxCompleteOdd", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"varIdxComplete", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OddQ", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], "&&", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
             "\[Equal]", "0"}]}], ")"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Every", " ", "element", " ", "is", " ", "same", " ", "as", " ", 
         "that", " ", "to", " ", 
         RowBox[{"varIdxCompleteEven", ".", " ", "The"}], " ", "following", 
         " ", "manupilation", " ", "just", " ", "separates", " ", "out", " ", 
         "the", " ", "elements", " ", "depending", " ", "upon", " ", "the", 
         " ", "number", " ", "of", " ", "y"}], "-", "indices"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"varEven", "[", 
          RowBox[{"jj", ",", "0"}], "]"}], "=", 
         RowBox[{"Select", "[", 
          RowBox[{"varIdxCompleteEven", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              "\[Equal]", "jj"}], ")"}], "&"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "0", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"varIdxCompleteEven", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "In", " ", "the", " ", "following", " ", "function", " ", "we", " ", 
          "compute", " ", 
          RowBox[{"\[Integral]", " ", 
           RowBox[{"\[Psi]", " ", 
            SuperscriptBox["f", "even"], "dc", " ", "where", " ", "\[Psi]", 
            " ", "is", " ", "such", " ", "that", " ", "the", " ", "powers", 
            " ", "of", " ", "Cx", " ", "appearing", " ", "in", " ", "\[Psi]", 
            " ", "are", " ", 
            RowBox[{"odd", ".", " ", "The"}], " ", "first", " ", "argument", 
            " ", "of", " ", "jj", " ", "has", " ", "been", " ", "optimised", 
            " ", "using", " ", "some", " ", "currently", " ", "unkown", " ", 
            RowBox[{"formula", ".", " ", "The"}], " ", "result", " ", "from", 
            " ", "this", " ", "manipulation", " ", "remains", " ", "the", " ",
             "same", " ", "even", " ", "if", " ", 
            RowBox[{"{", 
             RowBox[{"jj", ",", 
              RowBox[{"idx", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
              RowBox[{"-", "2"}]}], "}"}], " ", "is", " ", "substituted", " ",
             "by", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"jj", ",", "0", ",", 
               RowBox[{"Max", "[", 
                RowBox[{"varIdxCompleteEven", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], 
                "]"}]}], "}"}], ".", "\[IndentingNewLine]", "Let"}], " ", 
            "the", " ", "basis", " ", "function", " ", "of", " ", "f", " ", 
            "be", " ", "\[Phi]", " ", "and", " ", "the", " ", "test", " ", 
            "function", " ", "be", " ", 
            RowBox[{"\[Psi]", ".", " ", "m"}]}]}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{
          "powers", " ", "of", " ", "Cy", " ", "in", " ", "\[Psi]", " ", 
           "and", " ", "n"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"powers", " ", "of", " ", "Cy", " ", "in", " ", 
            RowBox[{"\[Phi]", ".", " ", "\[IndentingNewLine]", " ", "Then"}], 
            " ", "the", " ", "following", " ", "unexplained", " ", 
            "observation", " ", "holds", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "1.", " ", 
            RowBox[{"\[Integral]", 
             RowBox[{"\[Psi]", " ", "f"}]}]}], " ", "=", " ", 
           RowBox[{
            RowBox[{"0", " ", "if", " ", "n"}], " ", ">", " ", 
            RowBox[{
             RowBox[{"m", " ", "or", " ", "n"}], "+", "m"}], " ", 
            "\[NotEqual]", " ", 
            RowBox[{
             RowBox[{"Even", ".", "\[IndentingNewLine]", "2."}], " ", "In", 
             " ", "the", " ", "equation", " ", "for", " ", 
             "\[Rho]W"}]}]}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "odd", " ", "part", " ", "of", " ", "f", " ", "only", 
          " ", "contributed", " ", "vx"}], " ", "=", " ", 
         RowBox[{"0", " ", "and", " ", "thus", " ", "has", " ", "been", " ", 
          RowBox[{
          "neglected", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", " ",
            "Based"}], " ", "on", " ", "this", " ", "observation"}]}], ",", 
        " ", 
        RowBox[{
        "the", " ", "following", " ", "routine", " ", "has", " ", "been", " ", 
         RowBox[{"simplified", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"IntGasEven", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", 
            RowBox[{
            "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Total", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"HalfIntegrate", "[", 
                 RowBox[{"idx", ",", "#"}], "]"}], 
                RowBox[{"Apply", "[", 
                 RowBox[{"w", ",", "#"}], "]"}]}], "&"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"idx2", ",", 
                RowBox[{"{", 
                 RowBox[{"idx2", ",", "varIdxCompleteEven"}], "}"}]}], 
               "]"}]}], "]"}], "]"}], "\[IndentingNewLine]", ",", "0"}], 
          "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IntGasOdd", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", 
            RowBox[{
            "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Total", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"HalfIntegrate", "[", 
                 RowBox[{"idx", ",", "#"}], "]"}], 
                RowBox[{"Apply", "[", 
                 RowBox[{"w", ",", "#"}], "]"}]}], "&"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"idx2", ",", 
                RowBox[{"{", 
                 RowBox[{"idx2", ",", "varIdxCompleteOdd"}], "}"}]}], "]"}]}],
              "]"}], "]"}], "\[IndentingNewLine]", ",", "0"}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IntWall", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", 
            RowBox[{
            "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Total", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"HalfIntegrate", "[", 
                 RowBox[{"idx", ",", "#"}], "]"}], 
                RowBox[{"Apply", "[", 
                 RowBox[{
                  SubscriptBox["w", "wall"], ",", "#"}], "]"}]}], "&"}], ",", 
              
              RowBox[{"Table", "[", 
               RowBox[{"idx2", ",", 
                RowBox[{"{", 
                 RowBox[{"idx2", ",", "varIdxWall"}], "}"}]}], "]"}]}], "]"}],
             "]"}], "\[IndentingNewLine]", ",", "0"}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "when", " ", "wall", " ", "normal", " ", "points", " ", "into", " ", 
        "the", " ", "gas"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"IntGasOdd", "+", "IntGasEven", "-", "IntWall"}], "]"}], 
         ",", "Ax", ",", "Ay", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"w", ",", "#"}], "]"}], "&"}], ",", "varIdxComplete"}], 
          "]"}], ",", "varOdd"}], "}"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "when", " ", "the", " ", "wall", " ", "normal", " ", "points", " ", 
        "out", " ", "of", " ", "the", " ", 
        RowBox[{"gas", ".", " ", "We"}], " ", "assume", " ", "specular", " ", 
        "walls"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", "IntGasOdd", "]"}], "\[LeftDoubleBracket]", 
         "varOdd", "\[RightDoubleBracket]"}], ",", "Ax", ",", "Ay", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"w", ",", "#"}], "]"}], "&"}], ",", "varIdxComplete"}], 
         "]"}], ",", "varOdd"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.679647031917143*^9, 3.679647099911919*^9}, {
   3.679647215405871*^9, 3.67964728826398*^9}, {3.6796484868649893`*^9, 
   3.679648488782342*^9}, {3.6796485244476013`*^9, 3.679648525695869*^9}, {
   3.679648742279809*^9, 3.679648753999201*^9}, {3.679649364927759*^9, 
   3.679649374503847*^9}, {3.679649553342266*^9, 3.679649559116745*^9}, {
   3.679649623489869*^9, 3.6796496981446133`*^9}, {3.6796506594678926`*^9, 
   3.679650677994932*^9}, {3.679650850019477*^9, 3.6796508501766357`*^9}, {
   3.6796512773207073`*^9, 3.679651309105542*^9}, {3.67965930190547*^9, 
   3.679659632195958*^9}, {3.679659704687038*^9, 3.6796597053883142`*^9}, {
   3.679659768552642*^9, 3.679659775808573*^9}, {3.679660123500009*^9, 
   3.6796602527414722`*^9}, {3.679660462917212*^9, 3.6796605811999187`*^9}, {
   3.679660614979422*^9, 3.679660617882406*^9}, {3.6796606871495523`*^9, 
   3.679660705067223*^9}, {3.6796614116396027`*^9, 3.6796614135224943`*^9}, {
   3.679661497750643*^9, 3.679661543977549*^9}, 3.679661641355783*^9, 
   3.6796618491080236`*^9, {3.679661970884364*^9, 3.6796620080156193`*^9}, {
   3.6796620497447033`*^9, 3.6796621062577963`*^9}, {3.679662150539589*^9, 
   3.679662366018393*^9}, {3.6796628306656303`*^9, 3.6796628489529676`*^9}, {
   3.6796628864871283`*^9, 3.679662889388175*^9}, {3.679662922081427*^9, 
   3.679662927207323*^9}, 3.67966300388706*^9, {3.6796630411492643`*^9, 
   3.679663175531505*^9}, {3.679663207465036*^9, 3.679663269879057*^9}, 
   3.6796633110827436`*^9, {3.679663349467235*^9, 3.679663468406846*^9}, {
   3.6796634992825203`*^9, 3.679663538495411*^9}, {3.679663586855328*^9, 
   3.6796635882569*^9}, {3.679722450330904*^9, 3.679722548974909*^9}, {
   3.679722581041194*^9, 3.679722727763695*^9}, {3.679722760837673*^9, 
   3.679722775734234*^9}, {3.6797240814788237`*^9, 3.679724114527561*^9}, {
   3.6797241679925337`*^9, 3.6797242389002028`*^9}, {3.6797243783707447`*^9, 
   3.679724473700451*^9}, {3.6797245160083323`*^9, 3.679724516734179*^9}, {
   3.679724803003631*^9, 3.679724977591249*^9}, {3.679725017315276*^9, 
   3.679725105084105*^9}, {3.679725185424803*^9, 3.679725373094212*^9}, {
   3.679725463114794*^9, 3.679725501313965*^9}, {3.679725576743939*^9, 
   3.67972567967268*^9}, {3.679725750428523*^9, 3.679725788036639*^9}, {
   3.679725834327087*^9, 3.679726201118889*^9}, {3.679726346100215*^9, 
   3.679726357432131*^9}, {3.679726410106641*^9, 3.679726601275735*^9}, {
   3.679726668616539*^9, 3.6797267665475597`*^9}, {3.6797267989515533`*^9, 
   3.679726818665327*^9}, {3.679727033633028*^9, 3.679727041249545*^9}, {
   3.679727400536808*^9, 3.679727563121554*^9}, {3.679728626457303*^9, 
   3.679728672305711*^9}, {3.679728898829811*^9, 3.679728913669427*^9}, {
   3.679734045130917*^9, 3.67973408405052*^9}, {3.679734273226388*^9, 
   3.67973430322889*^9}, {3.679734435313775*^9, 3.6797345922328243`*^9}, {
   3.679734737770137*^9, 3.679734834790203*^9}, {3.679734873487105*^9, 
   3.679734902803897*^9}, {3.6797362596256523`*^9, 3.679736267148348*^9}, {
   3.679736331834815*^9, 3.679736333923428*^9}, {3.679736619804406*^9, 
   3.679737051100614*^9}, {3.6797380919047318`*^9, 3.67973825996982*^9}, {
   3.679738307515477*^9, 3.679738362515954*^9}, {3.6797384077455387`*^9, 
   3.679738466367291*^9}, {3.679738522307621*^9, 3.6797385252578278`*^9}, {
   3.6797386022815123`*^9, 3.679738625892692*^9}, {3.679738708770852*^9, 
   3.679738763873699*^9}, {3.679738804565854*^9, 3.6797388316598377`*^9}, {
   3.6797388624211807`*^9, 3.679738865790346*^9}, {3.67973890511226*^9, 
   3.679738960222994*^9}, {3.679738996529152*^9, 3.679739064946948*^9}, {
   3.679739102457986*^9, 3.6797391732013702`*^9}, {3.679739353391523*^9, 
   3.6797394039037037`*^9}, {3.679739454280705*^9, 3.6797394702912903`*^9}, {
   3.679739501452456*^9, 3.679739501804695*^9}, {3.6797395629368153`*^9, 
   3.679739593131974*^9}, 3.679739823865004*^9, {3.679739858130385*^9, 
   3.679739899019606*^9}, {3.679739935508493*^9, 3.679739937043545*^9}, {
   3.679739983964518*^9, 3.679739984370578*^9}, {3.679740060382936*^9, 
   3.679740132752553*^9}, {3.679740193467099*^9, 3.6797401944604*^9}, {
   3.679740229644825*^9, 3.679740242656685*^9}, {3.679740436064118*^9, 
   3.679740476028513*^9}, {3.679740560566556*^9, 3.6797405928939323`*^9}, {
   3.679740685779406*^9, 3.6797406966742573`*^9}, 3.679741288740939*^9, 
   3.679741824659174*^9, {3.679747738434867*^9, 3.6797477388975153`*^9}, {
   3.682076268008319*^9, 3.682076300623631*^9}, {3.721294031013533*^9, 
   3.7212940400050497`*^9}, {3.721294860980659*^9, 3.721294864628463*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Permutation matrix", "Subsection",
 CellChangeTimes->{{3.680327984984622*^9, 3.680327987665279*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "transformation", " ", "matrix", " ", "from", 
     " ", "var2", " ", "to", " ", "var1", " ", 
     RowBox[{"i", ".", "e", ".", " ", "var1"}]}], "=", 
    RowBox[{"Perm", " ", "v2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PermuteVar", "[", 
    RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "nEqn", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nEqn", " ", "=", " ", 
       RowBox[{"Length", "[", "var1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"nEqn", ",", "nEqn"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pos", " ", "=", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"var2", ",", 
             RowBox[{"var1", "[", 
              RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "pos"}], "\[RightDoubleBracket]"}], "=", 
          "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", "nEqn"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.68032799203395*^9, 3.680328159490745*^9}, {
  3.680328224863463*^9, 3.680328228463756*^9}, {3.680328262829427*^9, 
  3.6803282757897787`*^9}, {3.6803283197812233`*^9, 3.680328410397325*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Final Matrices", "Subsection",
 CellChangeTimes->{{3.6872365005032997`*^9, 3.687236504262679*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FinalMatrices", "[", "Ntensors_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Shalf", ",", "ShalfInv", ",", "S", ",", "BC", 
       ",", "result", ",", "var", ",", "varOdd", ",", "g", ",", "B", ",", 
       "nEqn", ",", "varEven", ",", "varRearranged", ",", "PermuteMatrix", 
       ",", "EntropyMat", ",", "Boe", ",", "OnsagerMat", ",", "Soe", ",", 
       "PermuteMatInv", ",", "BCMat", ",", "filenameAx", ",", "filenameAy", 
       ",", "filenameB", ",", "filenameOddID", ",", "percision", ",", 
       RowBox[{"$MaxExtraPrecision", "=", "150"}], ",", "Bmbc"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"GetMatrices2D", "[", "Ntensors", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BC", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"2", 
         RowBox[{
         "result", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ax", " ", "=", " ", 
       RowBox[{
       "result", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Ay", " ", "=", " ", 
       RowBox[{
       "result", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"var", " ", "=", " ", 
       RowBox[{
       "result", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"varOdd", " ", "=", " ", 
       RowBox[{
       "result", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Ax", ",", "Ay", ",", "BC", ",", "var", ",", "varOdd"}], 
       "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.687236529426733*^9, 3.6872367209466763`*^9}, {
   3.687236772976245*^9, 3.6872368312665443`*^9}, {3.687236915945259*^9, 
   3.687236997170021*^9}, {3.68723703160742*^9, 3.687237031738987*^9}, {
   3.687237073295095*^9, 3.687237102206689*^9}, {3.687237434836173*^9, 
   3.6872374353931427`*^9}, {3.687237478997837*^9, 3.687237655870494*^9}, {
   3.687495323471754*^9, 3.6874953239294987`*^9}, {3.687495471423119*^9, 
   3.687495578242072*^9}, {3.6874956478086367`*^9, 3.687495651745409*^9}, {
   3.6874956819666357`*^9, 3.687495793206705*^9}, {3.687495869502749*^9, 
   3.687496040167461*^9}, {3.687496075733777*^9, 3.687496179012404*^9}, {
   3.687496213684024*^9, 3.68749621377957*^9}, {3.68749625881328*^9, 
   3.687496320765864*^9}, {3.687496391843639*^9, 3.687496650076902*^9}, {
   3.687496724032881*^9, 3.68749676123724*^9}, {3.687496792168445*^9, 
   3.6874967938241243`*^9}, {3.687496988647143*^9, 3.6874970169250813`*^9}, {
   3.687497058576022*^9, 3.687497160023081*^9}, {3.6874972111252823`*^9, 
   3.687497266748619*^9}, 3.6874975835870953`*^9, {3.687497838693184*^9, 
   3.687498126216382*^9}, {3.687498268987771*^9, 3.687498345414588*^9}, 
   3.687498388369108*^9, {3.6874984380606613`*^9, 3.687498439795816*^9}, {
   3.687498503525031*^9, 3.687498510747129*^9}, {3.6874985742600937`*^9, 
   3.6874986228636312`*^9}, {3.6874990711011744`*^9, 3.68749911818661*^9}, {
   3.6874991502405043`*^9, 3.6874991558763523`*^9}, {3.687499258361182*^9, 
   3.6874992844209557`*^9}, {3.687501439158989*^9, 3.687501442812451*^9}, {
   3.68750147327164*^9, 3.687501543982765*^9}, {3.687501709749907*^9, 
   3.687501856067081*^9}, {3.687501893080254*^9, 3.687501933623994*^9}, 
   3.687502616365622*^9, {3.6875027465584908`*^9, 3.6875027748365297`*^9}, {
   3.6875084628999968`*^9, 3.687508514347818*^9}, {3.687508966693145*^9, 
   3.6875089820127172`*^9}, 3.687512107514319*^9, 3.687512155263958*^9, {
   3.687512388901594*^9, 3.687512389356392*^9}, {3.6875124972379303`*^9, 
   3.6875125189905233`*^9}, {3.687512579353801*^9, 3.68751260691541*^9}, 
   3.687512653679002*^9, {3.687512750928063*^9, 3.687512752787796*^9}, {
   3.687512932616138*^9, 3.68751293478235*^9}, {3.687513251349489*^9, 
   3.6875132871984453`*^9}, {3.68751334357588*^9, 3.6875134236152983`*^9}, {
   3.687514070405156*^9, 3.687514070687427*^9}, {3.687519557818061*^9, 
   3.6875195589949102`*^9}, {3.687550476405017*^9, 3.687550498729718*^9}, {
   3.697796933490458*^9, 3.697796968579096*^9}, {3.7212946603103533`*^9, 
   3.721294679626719*^9}, {3.721294923537238*^9, 3.7212949584767103`*^9}, {
   3.721295000529364*^9, 3.72129500432642*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Develop Boundary Conditions", "Section",
 CellChangeTimes->{{3.685270169379651*^9, 3.685270178385528*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "the", " ", "ID", " ", "of", " ", "the", " ", "variables", 
    " ", "to", " ", "variables", " ", "to", " ", "which", " ", "the", " ", 
    "coupling", " ", "exists"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ReturnCoupling", "[", "var_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xid", ",", "yid", ",", "numVar", ",", "result", ",", "PosFirstTerm", 
       ",", "PosSecondTerm", ",", "VarType", ",", "i", ",", "j"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVar", " ", "=", " ", 
       RowBox[{"Length", "[", "var", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "first", " ", "column", " ", "for", " ", "the", " ", "variable", " ", 
        "itself", " ", "and", " ", "all", " ", "the", " ", "other", " ", 
        "columns", " ", "for", " ", "the", " ", "coupling"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"numVar", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "The", " ", "type", " ", "of", " ", "variable", " ", "scalar"}], ",", 
        " ", 
        RowBox[{"vector", " ", "or", " ", "higher", " ", "order"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"VarType", " ", "=", 
       RowBox[{"Flatten", "[", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"numVar", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "store", " ", "the", " ", "index", " ", "corresponding", " ", "to", 
        " ", "x", " ", "and", " ", "y"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xid", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "numVar"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yid", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "numVar"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "xid", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
           "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "yid", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
           "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", "numVar"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "perform", " ", "the", " ", "computation", " ", "only", " ", "for", 
        " ", "Odd", " ", "Variables"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", 
            RowBox[{
            "xid", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "]"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "If", " ", "Normal", " ", "variable", " ", "or", " ", 
             "tangential"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "xid", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "\[Equal]", 
                RowBox[{"Total", "[", 
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}]}], " ", "||", " ", 
               RowBox[{
                RowBox[{
                "xid", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "\[Equal]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{
                   "var", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}], "-", "1"}], ")"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                "result", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "xid", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "\[Equal]", 
                  RowBox[{"Total", "[", 
                   RowBox[{
                   "var", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "VarType", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "=", "0"}], ",", 
                 RowBox[{
                  RowBox[{
                  "VarType", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "=", "1"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                "VarType", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], " ", "=", " ", "2"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "The", " ", "i", " ", "and", " ", "j", " ", "index", " ", 
                 "in", " ", "the", " ", "formulae", " ", "for", " ", "tt"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"i", " ", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "xid", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}], "-", "2"}], ")"}]}], 
                   ">", "0"}], ",", "1", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"j", " ", "=", " ", "2"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "first", " ", "term", " ", "in", " ", "expression", " ", 
                 "for", " ", "tt"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"PosFirstTerm", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"var", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}], ",", "0", ",", "0"}], 
                    "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"PosSecondTerm", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"var", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}], "-", "1"}], ",", "1", 
                    ",", "0"}], "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]",
                  "1", "\[RightDoubleBracket]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
               "PosSecondTerm", " ", "=", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "result", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"PosFirstTerm", ">", "0"}], ",", "PosFirstTerm", 
                    ",", "0"}], "]"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"PosSecondTerm", ">", "0"}], ",", "PosSecondTerm",
                     ",", "0"}], "]"}]}], "}"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", " ", "even", " ", "variable"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
             "result", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "VarType", "\[LeftDoubleBracket]", "ii", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "xid", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"result", ",", "VarType"}], "}"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685270181388358*^9, 3.685270229839326*^9}, {
   3.685270415345604*^9, 3.685270473256706*^9}, {3.6852715586952343`*^9, 
   3.685271630759714*^9}, {3.685272211625369*^9, 3.68527231703229*^9}, {
   3.685276728091689*^9, 3.6852769123367987`*^9}, 3.685276998146081*^9, {
   3.685277031948019*^9, 3.6852773320567102`*^9}, {3.685277382593685*^9, 
   3.685277479557622*^9}, 3.685277514858116*^9, {3.685277552728964*^9, 
   3.685277565428816*^9}, {3.685277657496917*^9, 3.6852778318685837`*^9}, {
   3.685277870587059*^9, 3.685277989984865*^9}, {3.6852781103080883`*^9, 
   3.68527812552273*^9}, {3.685278252895565*^9, 3.685278267611782*^9}, 
   3.685278333139594*^9, {3.685278379073863*^9, 3.6852783897079573`*^9}, {
   3.685278424443645*^9, 3.685278452851285*^9}, {3.685278556380454*^9, 
   3.6852785794914303`*^9}, {3.685278614926363*^9, 3.685278770428101*^9}, 
   3.685278975440968*^9, {3.685279063040265*^9, 3.6852790877294893`*^9}, {
   3.6852798301447973`*^9, 3.6852798959429827`*^9}, {3.685280138320369*^9, 
   3.6852801694514914`*^9}, {3.685280679755225*^9, 3.685280739552126*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Core Routines", "Title",
 CellChangeTimes->{{3.687548466564065*^9, 3.68754847088585*^9}}],

Cell[CellGroupData[{

Cell["Return the Coutte flow variables", "Section",
 CellChangeTimes->{{3.687513521198139*^9, 3.68751352291641*^9}, {
  3.6875485082995157`*^9, 3.68754852289324*^9}, {3.7212950659195004`*^9, 
  3.7212950731662292`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReturnCoutteVar", "[", "var_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "assumption", " ", "is", " ", "that", " ", "none", " ", 
        "of", " ", "the", " ", "variables", " ", "contain", " ", "the", " ", 
        "z"}], "-", 
       RowBox[{
        RowBox[{"index", ".", " ", "Therefore"}], " ", "we", " ", "only", " ",
         "check", " ", "for", " ", "the", " ", "y", " ", 
        RowBox[{"index", ".", " ", "If"}], " ", "the", " ", "y", " ", "index",
         " ", "is", " ", "zero", " ", "then", " ", "the", " ", "variable", 
        " ", "is", " ", "involved", " ", "in", " ", "heat", " ", 
        "conduction"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"result", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"result", ",", 
              RowBox[{"{", 
               RowBox[{
               "var", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}],
                "}"}]}], "]"}]}], ";", 
           RowBox[{"pos", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"pos", ",", 
              RowBox[{"{", 
               RowBox[{"{", "ii", "}"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", 
         RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "we", " ", "also", " ", "return", " ", "the", " ", "total", " ", 
       "number", " ", "of", " ", "variables", " ", "involved", " ", "in", " ",
        "the", " ", "heat", " ", 
       RowBox[{"conduction", ".", " ", "The"}], " ", "final", " ", "result", 
       " ", "includes", " ", "at", " ", "first", " ", "the", " ", "variables",
        " ", "involved", " ", "in", " ", "heat", " ", "conduction", " ", 
       "and", " ", "then", " ", "the", " ", "variables", " ", "which", " ", 
       "were", " ", "left", " ", 
       RowBox[{"out", "."}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"result", ",", 
         RowBox[{"Delete", "[", 
          RowBox[{"var", ",", "pos"}], "]"}]}], "]"}], ",", 
       RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.687513572049939*^9, 3.6875136697794647`*^9}, {
   3.687513732674876*^9, 3.687513780875609*^9}, {3.687513872334138*^9, 
   3.687513926965645*^9}, {3.687513957729773*^9, 3.687513958262898*^9}, 
   3.687514210214773*^9, {3.687514324727006*^9, 3.687514356798633*^9}, {
   3.687514549914095*^9, 3.687514594532855*^9}, {3.6875146506454487`*^9, 
   3.687514714684532*^9}, {3.687514878011159*^9, 3.687514916123034*^9}, {
   3.687514976371559*^9, 3.68751501402098*^9}, {3.687515056389267*^9, 
   3.6875150565259867`*^9}, {3.6875151415938377`*^9, 3.687515160783886*^9}, {
   3.687519778596327*^9, 3.687519778915113*^9}, {3.687548663346612*^9, 
   3.687548686552763*^9}, {3.69779648636655*^9, 3.697796598595253*^9}, {
   3.7171593260169373`*^9, 3.717159346575513*^9}, {3.7172288663468103`*^9, 
   3.71722887764522*^9}, {3.721295081183709*^9, 3.721295116733203*^9}, {
   3.72129516323507*^9, 3.7212951653472843`*^9}, 3.7212952125890017`*^9, 
   3.721296846843377*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Return the Matrix for Coutte Flow", "Section",
 CellChangeTimes->{{3.68754857059042*^9, 3.687548578289731*^9}, {
  3.721295888137887*^9, 3.721295891560895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixCoutte", "[", 
   RowBox[{"Mat_", ",", "var_", ",", "varCoutte_", ",", "numHeat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Permute", ",", "PermuteInv", ",", "MatHeat"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Permute", "=", 
      RowBox[{"PermuteVar", "[", 
       RowBox[{"var", ",", "varCoutte"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PermuteInv", "=", 
      RowBox[{"PermuteVar", "[", 
       RowBox[{"varCoutte", ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"MatHeat", "=", 
      RowBox[{"PermuteInv", ".", "Mat", ".", "Permute"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "we", " ", "first", " ", "extract", " ", "the", " ", "matrix", " ", 
       "which", " ", "plays", " ", "a", " ", "role", " ", "in", " ", "heat", 
       " ", "conduction"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"MatHeat", "=", 
      RowBox[{"MatHeat", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", "numHeat"}], ",", 
        RowBox[{"1", ";;", "numHeat"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "MatHeat"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.687548583767686*^9, 3.687548644942121*^9}, {
   3.687548697951344*^9, 3.687548704730782*^9}, {3.687549319213936*^9, 
   3.6875493877374783`*^9}, {3.687549491348543*^9, 3.68754952119003*^9}, {
   3.6875495599273643`*^9, 3.6875496205583763`*^9}, {3.710756186924448*^9, 
   3.710756197783594*^9}, {3.721295328908156*^9, 3.721295338217435*^9}, 
   3.72129543982164*^9, {3.721295583384108*^9, 3.721295602884663*^9}, {
   3.7212958969221563`*^9, 3.721295898982671*^9}, {3.721297383026119*^9, 
   3.721297384353571*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving Routine(Core)", "Section",
 CellChangeTimes->{{3.68755011626121*^9, 3.687550118582527*^9}, {
  3.68758276030796*^9, 3.687582761718665*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "res", ",", "nn", ",", "var", ",", "eqn", ",", "b0", ",", "A0", ",", "P0", 
   ",", "a", ",", "n", ",", "w", ",", "ww", ",", "unknowns", ",", 
   "\[Lambda]0", ",", "\[Lambda]", ",", "\[Lambda]Plus", ",", "vv", ",", "v", 
   ",", "Ansatz", ",", "Coefs", ",", "v0", ",", "v1", ",", "v2", ",", "v3", 
   ",", "v4", ",", "C0", ",", "k", ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetSolutionHeat", "[", "Ntensors_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", "nn", ",", "var", ",", "varC", ",", "eqn", ",", "b0", ",", 
       "a", ",", "n", ",", "w", ",", "dw", ",", "\[Lambda]0", ",", 
       "\[Lambda]", ",", "\[Lambda]Plus", ",", "v", ",", "vv", ",", "Ansatz", 
       ",", "Coefs", ",", "C0", ",", "Signum", ",", "SymmetryConditions", ",",
        "k", ",", "x", ",", "jj", ",", "ii", ",", "Kn", ",", "\[Alpha]", ",", 
       "numEqn"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Delete", " ", "is", " ", "for", " ", "removing", " ", "the", " ", 
         "density", " ", "and", " ", "the", " ", 
         RowBox[{"velocity", ".", " ", "The"}], " ", "reason", " ", "for", 
         " ", "removing", " ", "the", " ", "first", " ", "equation", " ", 
         "is", " ", 
         RowBox[{"obvious", ".", " ", 
          RowBox[{"aIdx", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "+", 
        RowBox[{
        "1", " ", "removes", " ", "the", " ", "energy", " ", "balance", " ", 
         "because", " ", "it", " ", "contains", " ", "the", " ", "denstiy", 
         " ", "and", " ", "the", " ", "stress", " ", 
         RowBox[{"tensor", ".", " ", "Since"}], " ", "we", " ", "are", " ", 
         "not", " ", "interested", " ", "in", " ", "density"}]}], ",", " ", 
       RowBox[{"we", " ", "let", " ", "it", " ", 
        RowBox[{"go", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SystemData", "=", 
       RowBox[{"FinalMatrices", "[", "Ntensors", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"MatrixCoutte", "[", 
        RowBox[{
         RowBox[{
         "SystemData", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{
         "SystemData", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{
          RowBox[{"ReturnCoutteVar", "[", 
           RowBox[{
           "SystemData", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"ReturnCoutteVar", "[", 
           RowBox[{
           "SystemData", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"numEqn", "=", 
       RowBox[{"Length", "[", "A0", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P0", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
           RowBox[{"-", "1"}]}], "}"}], ",", "numEqn"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"only", " ", "the", " ", "moment", " ", 
        RowBox[{"balance", ".", " ", "All"}], " ", "the", " ", "other", " ", 
        "equations", " ", "have", " ", "been", " ", "ignored"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P0", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generalized", " ", "eigen", " ", "vector", " ", "and", " ", "eigen", 
        " ", "value", " ", "of", " ", "P0", " ", "with", " ", "respect", " ", 
        "to", " ", "A0"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]0", ",", "vv"}], "}"}], "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{"{", 
          RowBox[{"P0", ",", 
           RowBox[{"1.0", "A0"}]}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "remove", " ", "the", " ", "zero", " ", "and", " ", "the", " ", 
         "infinite", " ", "eigen", " ", "values"}], ",", " ", 
        RowBox[{
        "why", " ", "do", " ", "the", " ", "infinite", " ", "eigen", " ", 
         "values", " ", 
         RowBox[{"appear", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"\[Lambda]0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "<", 
            RowBox[{"Abs", "[", "#", "]"}], "<", "\[Infinity]"}], ")"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"vv", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"\[Lambda]0", ",", "item"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"item", ",", 
               RowBox[{"Select", "[", 
                RowBox[{"\[Lambda]0", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"0", "<", 
                    RowBox[{"Abs", "[", "#", "]"}], "<", "\[Infinity]"}], 
                   ")"}], "&"}]}], "]"}]}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"assumes", " ", "symmetric", " ", "spectrum"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{
              RowBox[{
              "\[Lambda]", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}], ",", "0"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Rationalize", "[", 
              RowBox[{
               RowBox[{
               "\[Lambda]", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Lambda]", "]"}], ",", "2"}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]Plus", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"\[Lambda]", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", ">", "0"}], ")"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"a", " ", "polynomial", " ", "ansatz"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ansatz", "[", "x_", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coef", "[", 
             RowBox[{"jj", ",", "ii"}], "]"}], 
            SuperscriptBox["x", "jj"]}], ",", 
           RowBox[{"{", 
            RowBox[{"jj", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "numEqn"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Coefs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"coef", "[", 
             RowBox[{"jj", ",", "ii"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "numEqn"}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "vector", " ", "for", " ", "the", " ", "forcing", " ", "term"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"B0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "numEqn"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "ansatz", " ", "for", " ", "the", " ", "particular", " ", "solution", 
        " ", "of", " ", "the", " ", 
        RowBox[{"equations", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ansatz", "[", "x_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Ansatz", "[", "x", "]"}], "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"CoefficientList", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A0", ".", 
                   RowBox[{
                    RowBox[{"Ansatz", "'"}], "[", "x", "]"}]}], "-", 
                  RowBox[{
                   FractionBox["1", "Kn"], 
                   RowBox[{"P0", ".", 
                    RowBox[{"Ansatz", "[", "x", "]"}]}]}], "+", 
                  RowBox[{"\[Alpha]", " ", "B0", " ", 
                   SuperscriptBox["x", "2"]}]}], ",", "x"}], "]"}], "]"}], 
              "\[Equal]", "0"}], "]"}], ",", "Coefs"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{"_", ",", "_"}], "]"}], "\[Rule]", "0"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Signum", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Lambda]", "]"}], ",", "2"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "store", " ", "the", " ", "sign", " ", "of", " ", "the", " ", "first",
          " ", "non"}], "-", 
        RowBox[{
        "zero", " ", "entry", " ", "in", " ", "the", " ", "eigenvectors"}]}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"jj", "=", "1"}], ";", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "\[LeftDoubleBracket]", 
             RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}], "\[Equal]",
             "0"}], ",", 
           RowBox[{"jj", "++"}]}], "]"}], ";", 
         RowBox[{
          RowBox[{"Signum", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ii", "+", "1"}], ")"}], "/", "2"}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"-", 
           RowBox[{"Sign", "[", 
            FractionBox[
             RowBox[{"v", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"ii", "+", "1"}], ",", "jj"}], 
              "\[RightDoubleBracket]"}], 
             RowBox[{"v", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "jj"}], "\[RightDoubleBracket]"}]], 
            "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Lambda]", "]"}], ",", "2"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SymmetryConditions", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", "[", "ii", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Signum", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ii", "+", "1"}], ")"}], "/", "2"}], 
             "\[RightDoubleBracket]"}]}], 
           RowBox[{"k", "[", 
            RowBox[{"ii", "+", "1"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Lambda]", "]"}], ",", "2"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "The", " ", "final", " ", "result", " ", "is", " ", "the", " ", 
         "particular", " ", "solution"}], " ", "+", " ", 
        RowBox[{
        "the", " ", "solution", " ", "to", " ", "the", " ", "homogeneous", 
         " ", 
         RowBox[{"problem", ".", " ", "The"}], " ", "particular", " ", 
         "solution", " ", "is", " ", "the", " ", "Ansatz", " ", "and", " ", 
         "the", " ", "homogeneous", " ", "solution", " ", "is", " ", "the", 
         " ", 
         RowBox[{"part", ":", " ", 
          RowBox[{
           RowBox[{"C0", " ", "B0"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"k", "[", "ii", "]"}], " ", 
             RowBox[{
             "v", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
               "\[Lambda]", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], 
               FractionBox["x", "Kn"]}], "]"}]}]}]}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"ExpToTrig", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"C0", " ", "B0"}], "+", 
             RowBox[{"Ansatz", "[", "x", "]"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"k", "[", "ii", "]"}], " ", 
                RowBox[{
                "v", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
                
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{
                  "\[Lambda]", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], 
                  FractionBox["x", "Kn"]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", "1", ",", 
                 RowBox[{"Length", "[", "\[Lambda]", "]"}]}], "}"}]}], 
              "]"}]}], "/.", "SymmetryConditions"}], "/.", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "[", "ii", "]"}], "\[Rule]", 
              RowBox[{"k", "[", 
               RowBox[{"ii", "/", "2"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", 
               RowBox[{"Length", "[", "\[Lambda]", "]"}]}], "}"}]}], "]"}]}], 
          "]"}], "]"}], "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"k", "[", "ii", "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"k", "[", "ii", "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
               "\[Lambda]Plus", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}]}], 
              FractionBox[
               RowBox[{"1", "/", "2"}], "Kn"]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Lambda]Plus", "]"}]}], "}"}]}], 
         "]"}]}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6875501517079906`*^9, 3.687550225804554*^9}, {
   3.68755025837084*^9, 3.687550314764522*^9}, {3.687550363938319*^9, 
   3.68755039251931*^9}, {3.687550539540681*^9, 3.6875505769439163`*^9}, {
   3.6875506311516523`*^9, 3.687550644734264*^9}, 3.6875506843684*^9, {
   3.687550723055977*^9, 3.687550797107792*^9}, {3.687578802745755*^9, 
   3.687578817218597*^9}, {3.687578856829712*^9, 3.6875788594454193`*^9}, {
   3.687579056954892*^9, 3.687579057903698*^9}, {3.687579544392321*^9, 
   3.687579555942479*^9}, {3.6875795909661827`*^9, 3.687579628199963*^9}, {
   3.687579675686151*^9, 3.68757967765368*^9}, {3.687579710179405*^9, 
   3.687579715563381*^9}, {3.6875798127903957`*^9, 3.6875798180480328`*^9}, 
   3.6875798842696657`*^9, {3.687584201308683*^9, 3.6875842018677893`*^9}, {
   3.697799080494442*^9, 3.6977990863567667`*^9}, {3.721295783510275*^9, 
   3.721295783777996*^9}, {3.7212958486438103`*^9, 3.721295965116856*^9}, {
   3.721296017267177*^9, 3.7212960390038958`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721296045186232*^9, 3.721296046630679*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "x_", "]"}], "=", 
     RowBox[{"GetSolutionHeat", "[", "6", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Chop", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"A0", ".", 
        RowBox[{
         RowBox[{"u", "'"}], "[", "x", "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "Kn"], 
        RowBox[{"P0", ".", 
         RowBox[{"u", "[", "x", "]"}]}]}], "+", 
       RowBox[{"\[Alpha]", " ", "B0", " ", 
        SuperscriptBox["x", "2"]}]}], "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6875791202954493`*^9, 3.6875791250557623`*^9}, {
   3.6875797761540213`*^9, 3.687579780707192*^9}, {3.687579832466173*^9, 
   3.687579832542182*^9}, {3.710664415624954*^9, 3.7106644161236353`*^9}, {
   3.710756250287065*^9, 3.710756251872911*^9}, 3.721295837847416*^9}],

Cell[BoxData[
 TemplateBox[{
  "Solve","svars",
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"",2,
   297,74,19672805925774066930,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.717228940893477*^9, {3.721295838180277*^9, 3.721295862567971*^9}, 
   3.721295979357357*^9, 3.7212960806324663`*^9, 3.721296869897045*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6875791256308002`*^9, 3.68757974920776*^9, 3.6875797819764967`*^9, {
   3.6875798282292833`*^9, 3.687579833777669*^9}, 3.687579892800169*^9, 
   3.687581061545751*^9, 3.687583169069117*^9, {3.687683450427717*^9, 
   3.6876834709353447`*^9}, 3.68821558084007*^9, 3.6977955782058268`*^9, 
   3.697798981173626*^9, 3.697799186518031*^9, 3.710663990136232*^9, 
   3.710664419063612*^9, {3.7107562429782333`*^9, 3.7107562531193037`*^9}, 
   3.710756681848691*^9, 3.717228940920248*^9, {3.721295841146822*^9, 
   3.721295862768643*^9}, 3.721295979557509*^9, 3.721296080650673*^9, 
   3.7212968699082613`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", "x", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7212983532573833`*^9, 3.721298353944413*^9}, {
  3.7212984453551617`*^9, 3.721298463745572*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"Expand", "[", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"A0", ".", 
      RowBox[{
       RowBox[{"u", "'"}], "[", "x", "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "Kn"], 
      RowBox[{"P0", ".", 
       RowBox[{"u", "[", "x", "]"}]}]}], "+", 
     RowBox[{"\[Alpha]", " ", "B0", " ", 
      SuperscriptBox["x", "2"]}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.721298469272559*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary Conditions", "Section",
 CellChangeTimes->{{3.6875798560118103`*^9, 3.687579858694078*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetBoundaryCoutte", "[", 
   RowBox[{"B_", ",", "var_", ",", "varOdd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", "PermuteMat", ",", "varHeat", ",", "Bheat", ",", 
      "PermuteMatOdd", ",", "varHeatOdd", ",", "numVarHeat", ",", 
      "numVarHeatOdd", ",", "Brhs"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"varHeatOdd", ",", "numVarHeatOdd"}], "}"}], "=", 
      RowBox[{"ReturnCoutteVar", "[", 
       RowBox[{
       "var", "\[LeftDoubleBracket]", "varOdd", "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "varHeatOdd", "\[LeftDoubleBracket]", "numVarHeatOdd", 
      "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.6875801484016857`*^9, 3.687580231152809*^9}, {
   3.687580264502211*^9, 3.687580303449786*^9}, {3.687580393581833*^9, 
   3.687580407005487*^9}, {3.687580520495472*^9, 3.6875805514134903`*^9}, {
   3.687580608513585*^9, 3.687580778749277*^9}, {3.6875808938681173`*^9, 
   3.687580897555625*^9}, {3.687580949099105*^9, 3.687580949756734*^9}, {
   3.687581001575534*^9, 3.6875810107398243`*^9}, {3.6875811824652977`*^9, 
   3.6875813551364202`*^9}, {3.68758139658675*^9, 3.687581399634294*^9}, {
   3.687581489601774*^9, 3.687581491083344*^9}, {3.687581526066002*^9, 
   3.6875815279637547`*^9}, {3.687581561618733*^9, 3.6875815692319098`*^9}, {
   3.687581604360519*^9, 3.6875816344929943`*^9}, {3.687582385817588*^9, 
   3.687582439300256*^9}, {3.687582503158347*^9, 3.687582515154552*^9}, {
   3.687582549064995*^9, 3.687582578297481*^9}, {3.68758260845077*^9, 
   3.6875826422674837`*^9}, {3.687690664068966*^9, 3.687690672036848*^9}, 
   3.687690733096346*^9, 3.6977964276640463`*^9, {3.697796812812521*^9, 
   3.697796886453343*^9}, {3.7212961075732527`*^9, 3.721296108207761*^9}, {
   3.7212964079322433`*^9, 3.721296434340377*^9}, {3.7212967058124027`*^9, 
   3.721296720191683*^9}, {3.7212967790200367`*^9, 3.7212967804607277`*^9}, {
   3.721297536182542*^9, 3.7212975441419907`*^9}, {3.721297867332258*^9, 
   3.721297882018569*^9}, {3.721298094572048*^9, 3.7212980958299513`*^9}, {
   3.721298160004867*^9, 3.721298163251164*^9}, {3.721298212544609*^9, 
   3.721298233936985*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving Procedure", "Section",
 CellChangeTimes->{{3.6875826596299963`*^9, 3.687582664108437*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"flag", " ", "\[Equal]", " ", 
    RowBox[{"0", " ", "for", " ", "OBC", " ", "and", " ", "flag"}], " ", 
    "\[Equal]", " ", 
    RowBox[{"1", " ", "for", " ", "MBC"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GetHeatConduction", "[", 
    RowBox[{
    "kn_", ",", "\[Theta]w_", ",", "alpha_", ",", "Ntensors_", ",", "flag_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "varHeat", ",", "numVarHeat", ",", "U", ",", "BC", ",", "BCrhs", ",", 
       "BCmatrix", ",", "bcSol"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"U", "=", 
       RowBox[{"GetSolutionHeat", "[", "Ntensors", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "we", " ", "first", " ", "collect", " ", "all", " ", "the", " ", 
        "variables"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "value", " ", "of", " ", "SystemData", " ", "is", " ", 
        "prescribed", " ", "inside", " ", "the", " ", "GetSolutionHeat"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"varHeat", ",", "numVarHeat"}], "}"}], "=", 
       RowBox[{"ReturnCoutteVar", "[", 
        RowBox[{
        "SystemData", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "we", " ", "now", " ", "remove", " ", "density", " ", "and", " ", 
        "velocity", " ", "from", " ", "the", " ", "set", " ", "of", " ", 
        "variables"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"varHeat", "=", 
       RowBox[{"varHeat", "\[LeftDoubleBracket]", 
        RowBox[{"3", ";;", "numVarHeat"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BC", "=", 
       RowBox[{"GetBoundaryCoutte", "[", 
        RowBox[{
         RowBox[{
         "SystemData", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{
         "SystemData", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{
         "SystemData", "\[LeftDoubleBracket]", "6", 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"BCrhs", ",", "BCmatrix"}], "}"}], "=", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"BC", "/.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "varHeat", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "\[Rule]", 
                RowBox[{
                "U", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{"x", "\[Rule]", 
                 RowBox[{"1", "/", "2"}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", 
                RowBox[{"Length", "[", "varHeat", "]"}]}], "}"}]}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Chi]1", "\[Rule]", "1"}], ",", 
             RowBox[{"Kn", "\[Rule]", "kn"}]}], "}"}]}], ")"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "C0", "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"k", "[", "ii", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "BC", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bcSol", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "C0", "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"k", "[", "ii", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "BC", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], "]"}], "\[Rule]", 
         RowBox[{"Chop", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Inverse", "[", "BCmatrix", "]"}], ".", "BCrhs"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           RowBox[{"2", "/", "3"}]]}], ",", 
         SqrtBox["2"], ",", 
         RowBox[{"-", 
          SqrtBox[
           RowBox[{"5", "/", "2"}]]}]}], "}"}], 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"U", "/.", "bcSol"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Kn", "\[Rule]", "kn"}], ",", 
            RowBox[{"\[Theta]W", "\[Rule]", "\[Theta]w"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
        "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.687582673806695*^9, 3.687582689715313*^9}, {
   3.6875827255361567`*^9, 3.687582742330155*^9}, {3.687582776306507*^9, 
   3.687582942913451*^9}, {3.687582989250399*^9, 3.687582993304393*^9}, {
   3.68758305014231*^9, 3.687583052608492*^9}, {3.687583097037759*^9, 
   3.6875830973589077`*^9}, 3.687583204673522*^9, 3.687583531613757*^9, {
   3.6875842101671247`*^9, 3.687584210596736*^9}, {3.687699082318595*^9, 
   3.687699094433639*^9}, {3.687699255040174*^9, 3.68769926094275*^9}, {
   3.697796176765758*^9, 3.697796195349493*^9}, {3.697797199134199*^9, 
   3.697797291092177*^9}, {3.6977990239036922`*^9, 3.697799047250894*^9}, {
   3.697799129151774*^9, 3.697799141837957*^9}, {3.697799178297876*^9, 
   3.697799213741324*^9}, {3.6977995684986477`*^9, 3.6977995711477127`*^9}, {
   3.721298254506501*^9, 3.7212982862993937`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{62, Automatic}, {35, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 95, 1, 64, "Section"],
Cell[678, 25, 117, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[820, 32, 613, 14, 75, "Input"],
Cell[1436, 48, 15484, 433, 32, "Output"]
}, Open  ]],
Cell[16935, 484, 866, 24, 117, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[17838, 513, 149, 2, 66, "Title"],
Cell[CellGroupData[{
Cell[18012, 519, 103, 1, 64, "Section"],
Cell[18118, 522, 141, 3, 32, "Input"],
Cell[18262, 527, 528, 12, 87, "Text"],
Cell[18793, 541, 28245, 726, 3076, "Input"],
Cell[47041, 1269, 5782, 139, 524, "Input"],
Cell[52826, 1410, 1495, 39, 138, "Input"],
Cell[CellGroupData[{
Cell[54346, 1453, 566, 15, 54, "Input"],
Cell[54915, 1470, 5172, 138, 214, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60124, 1613, 648, 16, 32, "Input"],
Cell[60775, 1631, 3068, 72, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63880, 1708, 884, 19, 32, "Input"],
Cell[64767, 1729, 2096, 35, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66900, 1769, 472, 13, 54, "Input"],
Cell[67375, 1784, 1731, 28, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69143, 1817, 1206, 29, 138, "Input"],
Cell[70352, 1848, 1728, 30, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72117, 1883, 1391, 34, 138, "Input"],
Cell[73511, 1919, 1850, 32, 32, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[75410, 1957, 104, 1, 50, "Section"],
Cell[75517, 1960, 41250, 1035, 3613, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[116804, 3000, 106, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[116935, 3005, 103, 1, 44, "Subsection"],
Cell[117041, 3008, 32415, 701, 2939, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[149493, 3714, 106, 1, 36, "Subsection"],
Cell[149602, 3717, 1910, 46, 264, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[151549, 3768, 104, 1, 36, "Subsection"],
Cell[151656, 3771, 4632, 81, 369, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[156337, 3858, 112, 1, 64, "Section"],
Cell[156452, 3861, 11963, 270, 1041, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[168464, 4137, 95, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[168584, 4142, 219, 3, 64, "Section"],
Cell[168806, 4147, 4035, 86, 348, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[172878, 4238, 166, 2, 50, "Section"],
Cell[173047, 4242, 1916, 39, 264, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[175000, 4286, 153, 2, 50, "Section"],
Cell[175156, 4290, 413, 7, 54, "Input"],
Cell[175572, 4299, 16613, 400, 1616, "Input"],
Cell[192188, 4701, 92, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[192305, 4706, 958, 24, 112, "Input"],
Cell[193266, 4732, 370, 8, 24, "Message"],
Cell[193639, 4742, 720, 12, 32, "Output"]
}, Open  ]],
Cell[194374, 4757, 294, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[194693, 4768, 416, 13, 49, "Input"],
Cell[195112, 4783, 135, 3, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[195296, 4792, 106, 1, 64, "Section"],
Cell[195405, 4795, 2434, 44, 201, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[197876, 4844, 104, 1, 50, "Section"],
Cell[197983, 4847, 6411, 156, 599, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

