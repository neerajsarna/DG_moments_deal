(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15014,        408]
NotebookOptionsPosition[     13769,        359]
NotebookOutlinePosition[     14288,        381]
CellTagsIndexPosition[     14201,        376]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.681131130964129*^9, 3.681131145028804*^9}}],

Cell[CellGroupData[{

Cell["Read matrix", "Section",
 CellChangeTimes->{{3.681131155353066*^9, 3.681131157410226*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReadMatrixSparse", "[", 
    RowBox[{"directoryname_", ",", "filename_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nnz", ",", "result", ",", "sparseformat"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sparseformat", " ", "=", " ", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"directoryname", ",", "\"\</\>\"", ",", "filename"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"converting", " ", "to", " ", "mathematica", " ", "format"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sparseformat", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{"sparseformat", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sparseformat", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        RowBox[{"sparseformat", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "+", "1"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"sparseformat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sparseformat", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
          "\[Rule]", 
          RowBox[{"sparseformat", "\[LeftDoubleBracket]", 
           RowBox[{"ii", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", 
           RowBox[{"Length", "[", "sparseformat", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"SparseArray", "[", "sparseformat", "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReadMatrixFull", "[", 
   RowBox[{"directoryname_", ",", "filename_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"directoryname", ",", "\"\</\>\"", ",", "filename"}], "]"}], 
        ",", "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.681131159402052*^9, 3.6811311813325357`*^9}, {
  3.681131256721466*^9, 3.6811312962349052`*^9}, {3.68113137849492*^9, 
  3.681131399707399*^9}, {3.681131503149167*^9, 3.681131566788328*^9}, {
  3.681131612860922*^9, 3.681131620332862*^9}, {3.6811316542765903`*^9, 
  3.681131671655809*^9}, {3.681131904323003*^9, 3.681131949316951*^9}, {
  3.681131982563807*^9, 3.681132030290449*^9}, {3.6820544621358423`*^9, 
  3.682054463308844*^9}, {3.682227960144142*^9, 3.682227977953829*^9}, {
  3.682228228960951*^9, 3.68222823665523*^9}, {3.682228326760805*^9, 
  3.682228353073103*^9}, {3.682228486868541*^9, 3.682228487788932*^9}, {
  3.682230131589316*^9, 3.6822301566350937`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadVector", "[", "filename_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nnz", ",", "result", ",", "sparseformat"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Import", "[", 
      RowBox[{"filename", ",", "\"\<Table\>\""}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6820685319603024`*^9, 3.682068532982291*^9}, {
  3.6820686319756403`*^9, 3.682068641582653*^9}, {3.682068747332656*^9, 
  3.682068750337764*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparisions", "Section",
 CellChangeTimes->{{3.6985897003014708`*^9, 3.698589701724546*^9}}],

Cell[CellGroupData[{

Cell["Poisson Heat Conduction", "Subsection",
 CellChangeTimes->{{3.6822282560989857`*^9, 3.6822282577410727`*^9}, {
  3.698419503479911*^9, 3.6984195136965437`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "directoryname", "=", 
   "\"\</Users/neerajsarna/sciebo/DG_moments_deal/Tests/build/printed_\
matrices\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<cell_matrix_internal0\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG20", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<cell_matrix_internal1\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG26", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<cell_matrix_internal2\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG35", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<cell_matrix_internal3\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG45", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "matrices", " ", "from", " ", "code", " ", "which", " ", "is", " ", "not", 
    " ", "m", " ", "adapted"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "filename", " ", "=", " ", "\"\<cell_matrix_original_-0.375_6\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG20Original", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "filename", " ", "=", " ", "\"\<cell_matrix_original_-0.125_8\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG26Original", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<cell_matrix_original_0.125_9\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG35Original", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "filename", " ", "=", " ", "\"\<cell_matrix_original_0.375_11\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatG45Original", " ", "=", " ", 
    RowBox[{"ReadMatrixFull", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682228274296187*^9, 3.682228319370467*^9}, {
  3.682228361863179*^9, 3.682228373782333*^9}, {3.682228405491519*^9, 
  3.682228408848145*^9}, {3.682228482334509*^9, 3.6822285797084503`*^9}, {
  3.682228622215624*^9, 3.682228627656262*^9}, {3.6822301619658117`*^9, 
  3.6822301709016943`*^9}, {3.6984195206978292`*^9, 3.698419560945312*^9}, {
  3.6984195918127947`*^9, 3.6984195983144197`*^9}, {3.698419863502678*^9, 
  3.698419864751287*^9}, {3.698589736484482*^9, 3.698589826377071*^9}, {
  3.6985898605753593`*^9, 3.698589897631505*^9}, {3.698592263104501*^9, 
  3.698592362714562*^9}, {3.698592395508258*^9, 3.69859241794062*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"(", 
   RowBox[{"MatG45", "-", "MatG45Original"}], ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.698419571380603*^9, 3.698419643603539*^9}, {
  3.698589909496924*^9, 3.6985899443285027`*^9}, {3.698592382928132*^9, 
  3.6985924336524563`*^9}}],

Cell[BoxData[
 GraphicsBox[
  RasterBox[SparseArray[
   Automatic, {22, 22}, 1., {
    1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}, {}}, {}}], {{0, 0}, {22, 22}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{21.5, 
       FormBox["1", TraditionalForm]}, {17.5, 
       FormBox["5", TraditionalForm]}, {12.5, 
       FormBox["10", TraditionalForm]}, {7.5, 
       FormBox["15", TraditionalForm]}, {0.5, 
       FormBox["22", TraditionalForm]}}, {{21.5, 
       FormBox["1", TraditionalForm]}, {17.5, 
       FormBox["5", TraditionalForm]}, {12.5, 
       FormBox["10", TraditionalForm]}, {7.5, 
       FormBox["15", TraditionalForm]}, {0.5, 
       FormBox["22", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {14.5, 
       FormBox["15", TraditionalForm]}, {21.5, 
       FormBox["22", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {14.5, 
       FormBox["15", TraditionalForm]}, {21.5, 
       FormBox["22", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.6984195820003843`*^9, 3.6984196440877132`*^9}, 
   3.698419869717854*^9, 3.69841998425849*^9, 3.698420265468726*^9, 
   3.698420569806849*^9, {3.698589919697513*^9, 3.698589944959711*^9}, 
   3.698592367126066*^9, {3.698592398927598*^9, 3.698592433993697*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Manuel and Meshworker assembly comparision", "Subsection",
 CellChangeTimes->{{3.699008244161455*^9, 3.699008250705886*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "directoryname", "=", 
   "\"\</Users/neerajsarna/sciebo/DG_moments_deal/Tests/build/printed_\
matrices\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<global_matrix_meshworker\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatMeshworker", " ", "=", " ", 
    RowBox[{"ReadMatrixSparse", "[", 
     RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", "\"\<global_matrix_manuel\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatManuel", " ", "=", " ", 
   RowBox[{"ReadMatrixSparse", "[", 
    RowBox[{"directoryname", ",", "filename"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6990082656650352`*^9, 3.6990083376429367`*^9}, {
  3.6990087392398233`*^9, 3.69900882305573*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"MatMeshworker", "-", "MatManuel"}], "]"}]], "Input",
 CellChangeTimes->{{3.699008291662341*^9, 3.699008308018073*^9}, {
  3.69900910307631*^9, 3.699009149492161*^9}, {3.699009225528528*^9, 
  3.6990092265584173`*^9}, {3.6990104397793007`*^9, 3.699010442195324*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.699008297406464*^9, 3.699008308382646*^9}, 
   3.699008342018478*^9, {3.699009100488159*^9, 3.699009150896798*^9}, 
   3.69900922730919*^9, 3.6990104600210648`*^9, 3.699010863442532*^9, 
   3.699011222280192*^9, 3.699011347910797*^9, 3.699011605137846*^9, 
   3.6990117694177513`*^9, 3.699011916237603*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.699009127065897*^9, 3.699009129161264*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\\!\\(\\*RowBox[{\\\"MatrixPlot\\\", \\\"[\\\", \
StyleBox[\\\"m\\\", \\\"TI\\\"], \\\"]\\\"}]\\) generates a plot that gives a \
visual representation of the values of elements in a matrix.\"\>", "MSG"], 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/MatrixPlot"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.6990091296288137`*^9},
 CellTags->"Info603699012729-9779227"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{56, Automatic}, {Automatic, 18}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info603699012729-9779227"->{
  Cell[13217, 342, 512, 12, 43, "Print",
   CellTags->"Info603699012729-9779227"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info603699012729-9779227", 14094, 370}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 189, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[772, 28, 96, 1, 64, "Section"],
Cell[871, 31, 3693, 81, 390, "Input"],
Cell[4567, 114, 572, 14, 75, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[5176, 133, 99, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[5300, 138, 166, 2, 44, "Subsection"],
Cell[5469, 142, 3705, 93, 600, "Input"],
Cell[CellGroupData[{
Cell[9199, 239, 296, 6, 32, "Input"],
Cell[9498, 247, 1763, 38, 378, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[11310, 291, 130, 1, 36, "Subsection"],
Cell[11443, 294, 915, 23, 159, "Input"],
Cell[CellGroupData[{
Cell[12383, 321, 313, 5, 32, "Input"],
Cell[12699, 328, 359, 5, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13095, 338, 119, 2, 32, "Input"],
Cell[13217, 342, 512, 12, 43, "Print",
 CellTags->"Info603699012729-9779227"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

