(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    257265,       6829]
NotebookOptionsPosition[    252654,       6673]
NotebookOutlinePosition[    253013,       6689]
CellTagsIndexPosition[    252970,       6686]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tensor Definitions", "Section",
 CellChangeTimes->{{3.569139429210832*^9, 3.569139448895958*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.679824085289926*^9}],

Cell["\<\
Mathematica build-in function like \[OpenCurlyQuote]Symmetrize[]\
\[CloseCurlyQuote] and \[OpenCurlyQuote]TensorContract[]\[CloseCurlyQuote] \
seem 
to work really slow or fail due to memory requirements on fully symmetric \
tensors 
with degree >10.
We define our own functions below based on a simply array data structure for \
fully symmetric tensors.\
\>", "Text",
 CellChangeTimes->{{3.5691393015045276`*^9, 3.5691394253246098`*^9}, {
  3.569230437595318*^9, 3.569230461117482*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "n", ",", "degree", ",", "idx", ",", "idx1", ",", "A", ",", "b", ",", "id3",
    ",", "IDX"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "TensorDegree", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Every", " ", "symmetric", " ", "tensor", " ", "can", " ", "be", " ", 
     "identified", " ", "with", " ", "the", " ", "help", " ", "of", " ", "a", 
     " ", "2", "D", " ", "array", " ", "say", " ", 
     RowBox[{
      RowBox[{"a", "[", "N", "]"}], "[", "3", "]"}], " ", "where", " ", "N", 
     " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "indepedent", " ", "variables", " ", "it", " ", 
     RowBox[{"has", ".", " ", "So"}], " ", "every", " ", "row", " ", "ie", 
     " ", 
     RowBox[{"a", "[", "i", "]"}], " ", "store", " ", "the", " ", "number", 
     " ", "of", " ", "entries", " ", "for", " ", "x", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}]}], ",", 
    RowBox[{"for", " ", "y", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}], " ", "and", " ", "for", 
     " ", "z", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "3", "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", "ii"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "the", " ", "same", " ", "thing", " ", "as", " ", "IDXFull", 
    " ", "but", " ", "for", " ", "trace", " ", "free", " ", "tensors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXtrfFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"ii", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IDX", "[", "degree", "]"}], "=", 
      RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDXtrf", "[", "degree", "]"}], "=", 
      RowBox[{"IDXtrfFull", "[", "degree", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "0", ",", "40"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"given", " ", "an", " ", "array", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "counts", " ", "the", " ", 
     "number", " ", "of", " ", "1", "s"}], ",", " ", 
    RowBox[{"2", "s", " ", "and", " ", "3", "s"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX1", "[", "list_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Input", " ", "cartesean", " ", "indices"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "3"}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "Total", " ", "of", " ", "the", " ", "list", " ", "is", " ", 
     "the", " ", "tensorial", " ", "degree", " ", "we", " ", "are", " ", 
     "interested", " ", 
     RowBox[{"in", ".", " ", "So"}], " ", "list", " ", "should", " ", "be", 
     " ", "a", " ", "3", "X1", " ", "array", " ", "and", " ", "the", " ", 
     "following", " ", "function", " ", "will", " ", "give", " ", "us", " ", 
     "the", " ", "n", " ", "corresponding", " ", "to", " ", "which", " ", 
     RowBox[{"a", "[", "n", "]"}]}], " ", "=", " ", 
    RowBox[{"list", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX2", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDX", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX3", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDXtrfFull", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "tensor", " ", "degree", " ", "of", " ", "a", 
    " ", "symmetric", " ", 
    RowBox[{"tensor", ".", "\[IndentingNewLine]", 
     RowBox[{"CAUTION", ":", " ", 
      RowBox[{
      "the", " ", "formulae", " ", "is", " ", "not", " ", "valid", " ", "for",
        " ", "trace", " ", "free", " ", 
       RowBox[{"tensors", "."}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorDegree", "[", "A_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         RowBox[{"Length", "[", "A", "]"}]}]}]]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"id3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaValues", "[", "list_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"b", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"c", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OddQ", "[", "a", "]"}], "||", 
         RowBox[{"OddQ", "[", "b", "]"}], "||", 
         RowBox[{"OddQ", "[", "c", "]"}]}], ",", "0", ",", 
        FractionBox[
         RowBox[{"Multinomial", "[", 
          RowBox[{
           FractionBox["a", "2"], ",", 
           FractionBox["b", "2"], ",", 
           FractionBox["c", "2"]}], "]"}], 
         RowBox[{"Multinomial", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "applied", " ", "deltavalues", " ", "to", " ", "all", " ", "the", " ", 
    "components", " ", "of", " ", "an", " ", "even", " ", "degree", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor2", "[", 
     RowBox[{"degree_", "?", "EvenQ"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"DeltaValues", ",", 
      RowBox[{"IDX", "[", "degree", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"What", " ", "does", " ", "this", " ", 
    RowBox[{"do", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTrace2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX2", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IDX", "[", 
                   RowBox[{"degree", "-", "2"}], "]"}], 
                  "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTraces", "[", 
     RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", "=", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"SymTrace2", "[", "res", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Assumes", " ", "3", " ", 
     RowBox[{"dimensions", ".", " ", "And"}], " ", "so"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contraction", " ", "of", " ", "a", " ", "symmetric", " ", "tensor", " ", 
    "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymDot2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Lets", " ", "take", " ", "a", " ", "particular", " ", "term", " ",
             "say", " ", "Ai1i2"}], ".."}], 
          RowBox[{"xbx", ".", " ", "In"}], " ", "the", " ", "result", " ", 
          "only", " ", "those", " ", "components", " ", "will", " ", "appear",
           " ", "in", " ", "which", " ", "x", " ", "atleast", " ", "appears", 
          " ", "once", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "why", " ", "the", " ", "addition",
           " ", "of", " ", 
          RowBox[{"id3", "[", 
           RowBox[{"[", "iis", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"toIDX2", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IDX", "[", 
                    RowBox[{"degree", "-", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                  "+", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "]"}], 
                "\[RightDoubleBracket]"}], 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "full", " ", "contraction", " ", "of", " ", "two", " ", "symmetric", " ", 
     "tensors", " ", "A"}], ",", " ", 
    RowBox[{"B", " ", "with", " ", "same", " ", "degree"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymFullDot", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TensorDegree", "[", "B", "]"}], "\[NotEqual]", "degree"}], 
         ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"idx", "=", 
           RowBox[{
            RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", "jj",
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "+=", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
              "]"}], 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{
            "B", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProduct2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"degree", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"degree", "+", "1"}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "1"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "b", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProductDelta2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"degree", "+", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"degree", "+", "1"}], ")"}]}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "2"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[GreaterEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}], 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "converts", " ", "a", " ", "symmetric", " ", "tensor", " ", "into", " ", 
    "a", " ", "trace", " ", "free", " ", "tensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "returns", " ", "the", " ", "tracefree", " ", "part", " ", "of", " ", "a",
      " ", "symmetric", " ", "tensor"}], ",", " ", 
    RowBox[{"but", " ", "with", " ", "all", " ", "components"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymTracefree", "[", "A_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
       RowBox[{"degree", "=", 
        RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", "res", 
       ",", "trace", ",", "res1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"trace", "=", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"trace", "=", 
           RowBox[{"SymTrace2", "[", "trace", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"res1", "=", 
            RowBox[{"SymProductDelta2", "[", "res1", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ll", ",", "1", ",", "kk"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "kk"], 
               RowBox[{"degree", "!"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"degree", "-", 
                  RowBox[{"2", "kk"}]}], ")"}], "!"}], 
               SuperscriptBox["2", "kk"], 
               RowBox[{"kk", "!"}]}]], 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"jj", "=", 
                RowBox[{"degree", "-", "kk"}]}], 
               RowBox[{"degree", "-", "1"}]], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", "jj"}], "+", "1"}]]}]}], ")"}], "res1"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"degree", "/", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5977647060562134`*^9, 3.5977647268750763`*^9}, {
   3.597764982828605*^9, 3.5977649884363317`*^9}, {3.676179501293851*^9, 
   3.6761796856337767`*^9}, {3.676179724780055*^9, 3.6761797401819553`*^9}, {
   3.6761800693011913`*^9, 3.67618009071702*^9}, {3.67618055987227*^9, 
   3.676180688136693*^9}, {3.676180727497422*^9, 3.676180773976479*^9}, {
   3.676181010436315*^9, 3.676181034457363*^9}, {3.676182895833144*^9, 
   3.676182910871441*^9}, {3.676183029280117*^9, 3.676183040299528*^9}, {
   3.676183109751354*^9, 3.676183133647092*^9}, {3.676184105172339*^9, 
   3.676184107563058*^9}, {3.676184447780569*^9, 3.676184559506366*^9}, 
   3.676184625341688*^9, {3.6761850010521708`*^9, 3.676185035780895*^9}, {
   3.6763163148181763`*^9, 3.676316347073567*^9}, {3.676316864163743*^9, 
   3.676316876694518*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trfEvaluate", "[", 
     RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "m", ",", 
        RowBox[{"dim", "=", "3"}], ",", 
        RowBox[{"degree", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", 
          "2"}]}], ",", "length", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "list"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"c", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"toIDX3", "[", "list", "]"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Binomial", "[", 
               RowBox[{"m", ",", "i"}], "]"}], 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX3", "[", 
                RowBox[{"list", "+", 
                 RowBox[{"2", "i", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "i"}], ")"}], " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"2", "m", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "say", " ", "we", " ", "have", " ", "a", " ", "trace", " ", "free", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "whose", " ", "independent", " ", "components", " ", "are", " ", "given",
       " ", "then", " ", "the", " ", "following", " ", "function", " ", 
      "will", " ", "introduce", " ", "those", " ", "components", " ", "in", 
      " ", "the", " ", "list", " ", "which", " ", "have", " ", "been", " ", 
      "negelected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
      "free", " ", "nature", " ", "of", " ", "the", " ", 
      RowBox[{"tensor", ".", " ", "For"}], " ", 
      RowBox[{"eg", ".", " ", "it"}], " ", "will", " ", "introduce"}], " ", 
     "-", "Rxx", "-", 
     RowBox[{
     "Ryy", " ", "for", " ", "a", " ", "second", " ", "order", " ", 
      "tensor"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trf2sym", "[", "A_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"trfEvaluate", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
       "#"}], "]"}], "&"}], ",", 
    RowBox[{"IDX", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", "2"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.592214156581615*^9, 3.5922142269069633`*^9}, {
  3.592214273648*^9, 3.592214321643592*^9}, {3.592214562691799*^9, 
  3.5922146307578783`*^9}, {3.5922150087114487`*^9, 3.5922151927530117`*^9}, {
  3.592215226866392*^9, 3.592215227208199*^9}, {3.5922152622517147`*^9, 
  3.592215315308941*^9}, {3.592215349687686*^9, 3.592215358801886*^9}, {
  3.59221558179191*^9, 3.592215608488448*^9}, {3.592215669267857*^9, 
  3.592215699095985*^9}, {3.676315905534268*^9, 3.676315915972599*^9}, {
  3.6763161617740183`*^9, 3.676316190517806*^9}, {3.67631623272976*^9, 
  3.676316302687489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTensorForm", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
               RowBox[{
               "A", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               "}"}], "&"}], ",", 
            RowBox[{
             RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", 
             "ii", "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "length"}], "}"}]}], "]"}], "//", 
        "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.59211253078022*^9, 3.592112545437512*^9}, {
   3.5921125805422792`*^9, 3.5921127616337748`*^9}, {3.592112796427103*^9, 
   3.5921128146670732`*^9}, 3.597764731152925*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymProductDelta2", "[", 
  RowBox[{"SymProductDelta2", "[", 
   RowBox[{"SymProductDelta2", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
        "]"}], "&"}], ",", 
      RowBox[{"IDX", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516209179254*^9, 3.591516237845764*^9}, {
  3.591516279723213*^9, 3.591516319002157*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675954441912649*^9, 3.676179291151037*^9, 
  3.6762888609657383`*^9, 3.6763161356528177`*^9, 3.6779058949079237`*^9, 
  3.678529868398068*^9, 3.6789569966828136`*^9, 3.679817284096423*^9, 
  3.679824018877027*^9, 3.6798241121962147`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "2", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591517786313066*^9, 3.5915178359472446`*^9}, {
  3.591517885949567*^9, 3.591517930610208*^9}, {3.5977650183992825`*^9, 
  3.597765018845586*^9}, {3.676316092317675*^9, 3.6763161065616913`*^9}, {
  3.676316140175808*^9, 3.676316140772443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441957636*^9, 3.6761792911794147`*^9, 3.676288861012822*^9, {
   3.676316093569808*^9, 3.676316107287977*^9}, {3.676316137581958*^9, 
   3.6763161413544827`*^9}, 3.677905894933*^9, 3.678529868437419*^9, 
   3.67895699670127*^9, 3.679817284141407*^9, 3.679824018900482*^9, 
   3.679824112240232*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", 
          RowBox[{"2.", "#2"}], "-", 
          RowBox[{"3", "#3"}]}], "&"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "4", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516796847253*^9, 3.591516813094841*^9}, {
   3.5915174393368073`*^9, 3.5915174614075623`*^9}, {3.59151750012652*^9, 
   3.59151776014233*^9}, {3.591517814794807*^9, 3.5915178185262527`*^9}, {
   3.591517860691409*^9, 3.5915178802347727`*^9}, 3.591518123963479*^9, {
   3.5915182744621964`*^9, 3.591518302569395*^9}, {3.591526482595047*^9, 
   3.5915265043240232`*^9}, {3.591611217481101*^9, 3.591611231450076*^9}, {
   3.597765011088415*^9, 3.5977650116257725`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1428571428571423`"}], ",", "1.1428571428571432`", ",", 
   "2.571428571428571`", ",", "3.428571428571429`", ",", 
   "1.4285714285714286`", ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", "3.1428571428571432`", ",", 
   "2.857142857142857`", ",", 
   RowBox[{"-", "4.285714285714286`"}], ",", 
   RowBox[{"-", "5.428571428571429`"}], ",", 
   RowBox[{"-", "2.2857142857142847`"}], ",", "4.285714285714286`", ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "5.714285714285714`"}], ",", "3.428571428571427`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675954442007567*^9, 3.67617929122402*^9, 
  3.676288861058632*^9, 3.677905894982387*^9, 3.678529868487091*^9, 
  3.6789569967340937`*^9, 3.679817284174168*^9, 3.679824018948873*^9, 
  3.679824112272427*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymFullDot", "[", 
   RowBox[{
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], "}"}], 
      "]"}], "]"}], ",", 
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], "}"}], 
      "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Rxx", " ", "Sxx"}], "+", 
  RowBox[{"Ryy", " ", "Sxx"}], "+", 
  RowBox[{"2", " ", "Rxy", " ", "Sxy"}], "+", 
  RowBox[{"Rxx", " ", "Syy"}], "+", 
  RowBox[{"2", " ", "Ryy", " ", "Syy"}]}]], "Output",
 CellChangeTimes->{3.675954442064178*^9, 3.676179291269311*^9, 
  3.676288861096998*^9, 3.6779058950315104`*^9, 3.6785298685371113`*^9, 
  3.678956996767218*^9, 3.679817284207345*^9, 3.679824018993655*^9, 
  3.679824112315743*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], 
               "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], 
               "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sxx", ",", "Sxy", ",", "Syy"}], "}"}]}], "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759544421144657`*^9, 3.676179291324445*^9, 
  3.676288861145307*^9, 3.6779058950810213`*^9, 3.678529868586431*^9, 
  3.6789569967998867`*^9, 3.679817284241613*^9, 3.6798240190319567`*^9, 
  3.679824112356357*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "mxxx", ",", "mxxy", ",", "0", ",", "mxyy", ",", "0", ",", 
                "myyy", ",", "0"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "nxxx", ",", "nxxy", ",", "0", ",", "nxyy", ",", "0", ",", 
                "nyyy", ",", "0"}], "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy"}], "}"}]}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"nxxx", ",", "nxxy", ",", "nxyy", ",", "nyyy"}], "}"}]}], "]"}],
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}, {3.656607710425463*^9, 
  3.656607745128602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759544421633577`*^9, 3.676179291374331*^9, 
  3.6762888611958103`*^9, 3.6779058951312113`*^9, 3.6785298686374598`*^9, 
  3.678956996833495*^9, 3.679817284276608*^9, 3.679824019081929*^9, 
  3.6798241123905783`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equations Definitions", "Section"],

Cell[CellGroupData[{

Cell["Basic Definitions", "Subsection",
 CellChangeTimes->{{3.679224206952962*^9, 3.67922420968581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ref", " ", "to", " ", "manuels", " ", "paper", " ", "on", " ", "fluxes", 
    " ", "for", " ", "large", " ", "moment", " ", "system", " ", "for", " ", 
    "a", " ", "detailed", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "tensorial", " ", "degree", " ", "including", " ", 
    "traces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"iFullDegree", "[", "i_", "]"}], "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"4", "i"}], "-", "3"}]], "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "traces", " ", 
     RowBox[{"C", "^", "2"}], " ", "has", " ", "one", " ", "trace"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTraces", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"iFullDegree", "[", "i", "]"}]}]}], ")"}], "2"], "]"}], 
      "-", "i"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "tensorial", " ", "degree"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTensorDegree", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"iFullDegree", "[", "i", "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"iTraces", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ii", "[", 
      RowBox[{"s_", ",", "A_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"A", "+", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{"A", "+", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"s", "+", "1"}], ")"}]}], "-", 
         RowBox[{"Floor", "[", 
          FractionBox[
           RowBox[{"A", "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}]}], ")"}]}], "-",
       "s"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "i", " ", "is", " ", "as", " ", "defined", " ", "in", " ", "the", " ", 
     "reference"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables2D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iTensorDegree", "[", "i", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfFullTensors3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"iFullDegree", "[", "ntensors", "]"}]}], ",", "frac"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"m", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "3"}], ")"}]}], "6."], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", 
               RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}], "2"], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varName", "[", 
     RowBox[{"s_", ",", "ix_", ",", "iy_", ",", "iz_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\[Rho]\>\"", ",", 
      RowBox[{"ToString", "[", "s", "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<x\>\"", ",", "ix"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<y\>\"", ",", "iy"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<z\>\"", ",", "iz"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "not", " ", "the", " ", "norm", " ", "of", " ", 
      "\[Psi]"}], ",", " ", 
     RowBox[{"rather", " ", 
      RowBox[{"it", "'"}], "s", " ", "the", " ", "norm", " ", "of", " ", 
      "the", " ", "laguerre", " ", "polynomials"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm\[Psi]", "[", 
      RowBox[{"a_", ",", "deg_"}], "]"}], "=", 
     FractionBox[
      RowBox[{
       RowBox[{"deg", "!"}], 
       RowBox[{"a", "!"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"deg", "+", "a", "+", 
         RowBox[{"3", "/", "2"}]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"deg", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "given", " ", "a", " ", "tensor", " ", "W", " ", "extract", " ", "all", 
     " ", "the", " ", "independed", " ", "components", " ", "in", " ", "2", 
     "D", " ", "in", " ", "case", " ", "of", " ", "trace", " ", "free", " ", 
     "situation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfComponents2D", "[", "W_", "]"}], ":=", 
    RowBox[{"Extract", "[", 
     RowBox[{"W", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"IDX", "[", 
             RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}], ",", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"IDXtrf", "[", 
           RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"TensorDegree", "[", "W", "]"}]}], "}"}]}], "]"}]}], 
            "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfVar2D", "[", 
     RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"name", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"deg", "+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"From2Dto3D", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "list", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Given", " ", "the", " ", "components", " ", "of", " ", "a", " ", 
        "tensor", " ", "represented", " ", "by", " ", "B"}], ",", " ", 
       RowBox[{
        RowBox[{
        "then", " ", "tmp", " ", "collects", " ", "the", " ", "terms", " ", 
         "corresponding", " ", 
         RowBox[{"to", " ", "\\", "partial_x"}], " ", 
         RowBox[{"in", " ", "\\", "partial_"}]}], "<", 
        RowBox[{"x_", 
         RowBox[{"{", "in", "}"}], " ", "w_", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i1", ".."}], "in"}], ">"}], "}"}], "\[IndentingNewLine]",
          "the", " ", "second", " ", "one", " ", "does", " ", "the", " ", 
         "same", " ", "job", " ", "but", " ", "for", " ", "a", " ", "tensor", 
         " ", 
         RowBox[{"product", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymDot2", "[", 
              RowBox[{
               RowBox[{"trf2sym", "[", 
                RowBox[{"From2Dto3D", "[", 
                 RowBox[{"trfVar2D", "[", 
                  RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficient", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", 
         "tensor", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymTracefree", "[", 
              RowBox[{"SymProduct2", "[", 
               RowBox[{
                RowBox[{"trf2sym", "[", 
                 RowBox[{"From2Dto3D", "[", 
                  RowBox[{"trfVar2D", "[", 
                   RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficients", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "15"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "moment", " ", "equation", " ", "as", " ", "given", " ", "in", " ", "the",
      " ", "boundary", " ", "value", " ", "problem", " ", "paper", " ", 
     "from", " ", 
     RowBox[{"Manuel", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"recursion1", "[", 
     RowBox[{"a_", ",", "deg_", ",", "flag_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "deg"}], "+", "2"}], 
         RowBox[{
          RowBox[{"2", "deg"}], "+", "3"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"deg", "+", "a", "+", 
            FractionBox["3", "2"]}]], 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar2D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", "a", ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
         RowBox[{
          SqrtBox["a"], " ", 
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
           RowBox[{"trfVar2D", "[", 
            RowBox[{
             RowBox[{"deg", "+", "1"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"#", ",", 
                RowBox[{"a", "-", "1"}], ",", 
                RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
        ")"}]}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"deg", ">", "0"}], ",", 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", "deg"}], 
           RowBox[{
            RowBox[{"2", "deg"}], "+", "1"}]]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SqrtBox[
             RowBox[{"(", 
              RowBox[{"deg", "+", "a", "+", 
               FractionBox["1", "2"]}], ")"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
           RowBox[{
            SqrtBox[
             RowBox[{"a", "+", "1"}]], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"a", "+", "1"}], ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}]}], 
          ")"}]}], ",", "0"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetMatrices1D", "[", "Ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "varIdx", ",", "varIdxComplete", ",", "theory", ",", "normMatrix", 
         ",", "varNames", ",", "var", ",", "Ax", ",", "Ay", ",", 
         "\[IndentingNewLine]", "var1D", ",", "BCvar", ",", "varOdd", ",", 
         "varIdxCompleteEven", ",", "varEven", ",", "BCraw", ",", 
         RowBox[{"\[Rho]index", "=", "1"}], ",", 
         RowBox[{"vindex", "=", "2"}], ",", "\[Rho]Weqn", ",", "BCnum", ",", 
         "BCrhs", ",", "P", ",", "NumVar"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "compute", " ", "the", " ", "tensor", " ", "degree", " ", "and", " ",
           "the", " ", "number", " ", "of", " ", "traces", " ", "for", " ", 
          "every", " ", "tensor", " ", "in", " ", "the", " ", 
          RowBox[{"system", ".", "\[IndentingNewLine]", "In"}], " ", "all", 
          " ", "the", " ", "coming", " ", "computations"}], ",", " ", 
         RowBox[{
         "iTraces", " ", "will", " ", "be", " ", "represented", " ", "by", 
          " ", 
          RowBox[{"a", ".", "sa"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"varIdx", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"iTraces", "[", "i", "]"}], ",", 
             RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "same", " ", "as", " ", "IDXtrf", " ", "but", " ", "instead", " ", 
          "stores", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
          "number", " ", "of", " ", "traces", " ", "in", " ", "the", " ", 
          "first", " ", "argument", " ", "of", " ", "every", " ", "list"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"varIdxComplete", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}],
                   ",", "#"}], "]"}], "&"}], ",", 
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"IDXtrf", "[", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
                 ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
         "computes", " ", "the", " ", "number", " ", "of", " ", "traces", " ",
           "for", " ", "a", " ", "given", " ", 
          RowBox[{"iTensorDegree", ".", " ", "The"}], " ", "final", " ", 
          "result", " ", "gives", " ", "us", " ", "the", " ", "tuple", " ", 
          "discussed", " ", "in", " ", "the", " ", "paper", " ", "on", " ", 
          "the", " ", "convergence", " ", "of", " ", "the", " ", "boundary", 
          " ", "value", " ", 
          RowBox[{"problem", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"theory", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"varIdx", ",", 
             RowBox[{"{", 
              RowBox[{"_", ",", "k"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"iFullDegree", "[", "Ntensors", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<number of different tensor degrees: \>\"", ",", "theory"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<corresponding variables (traces,indices): \>\"", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", 
                  RowBox[{
                   RowBox[{
                   "theory", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", 
                RowBox[{"Length", "[", "theory", "]"}]}], "}"}]}], "]"}], ",",
             "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 1D: \>\"", ",", "Ntensors"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 2D: \>\"", ",", 
          RowBox[{"NumberOfVariables2D", "[", "Ntensors", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of Variables 3D: \>\"", ",", 
          RowBox[{"NumberOfVariables3D", "[", "Ntensors", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Number of full Tensors 3D: \>\"", ",", 
          RowBox[{"NumberOfFullTensors3D", "[", "Ntensors", "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"normMatrix", "=", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "deg"}], "}"}], ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{
                    RowBox[{"Norm\[Psi]", "[", 
                    RowBox[{"a", ",", "deg"}], "]"}], ",", 
                    RowBox[{"deg", "+", "1"}]}], "]"}]}], "]"}], "@@", "#"}], 
               "&"}], ",", "varIdx"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "the", " ", "result", " ", "from", " ", "var", " ", "consists", " ",
            "of", " ", "the", " ", "form", " ", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"n", ",", "a", ",", "deg"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"where", " ", "a"}], " ", "=", " ", "#traces"}], ",", " ", 
          
          RowBox[{"deg", " ", "=", " ", 
           RowBox[{
            RowBox[{
            "#free", " ", "indices", " ", "and", " ", "n", " ", "is", " ", 
             "the", " ", "name", " ", "for", " ", "eg", " ", "vx"}], " ", "=",
             " ", 
            RowBox[{
             RowBox[{"1", " ", "and", " ", "vy"}], " ", "=", " ", 
             RowBox[{
             "2", " ", "or", " ", "\[Theta]", " ", "is", " ", "simply", " ", 
              "1"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"var", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "deg"}], "}"}], ",", 
               RowBox[{"trfVar2D", "[", 
                RowBox[{"deg", ",", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", 
                   RowBox[{"#", ",", "a", ",", "deg"}], "]"}], "&"}]}], 
                "]"}]}], "]"}], ",", "item"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NumVar", " ", "=", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"Flatten", "[", "var", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Ax", "=", 
         RowBox[{
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", ",", "deg"}], "}"}], ",", 
                   RowBox[{"recursion1", "[", 
                    RowBox[{"a", ",", "deg", ",", "1"}], "]"}]}], "]"}], ",", 
                 "item"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ay", "=", 
         RowBox[{
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", ",", "deg"}], "}"}], ",", 
                   RowBox[{"recursion1", "[", 
                    RowBox[{"a", ",", "deg", ",", "2"}], "]"}]}], "]"}], ",", 
                 "item"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "production", " ", "term"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"P", " ", "=", " ", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "NumVar"}], "}"}]}], "]"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", "0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", "0"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Ax", ",", "Ay", ",", "var", ",", "P"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.6789571122427063`*^9, 
   3.678957168470767*^9}, {3.678957258151763*^9, 3.67895728691035*^9}, {
   3.6789574805203876`*^9, 3.6789574813607388`*^9}, 3.678957647285915*^9, {
   3.678957709797439*^9, 3.678957720845735*^9}, {3.678957938446752*^9, 
   3.678958016986763*^9}, {3.678958060884356*^9, 3.67895808288346*^9}, {
   3.678958258367999*^9, 3.6789582586646748`*^9}, {3.678959201968364*^9, 
   3.678959203973609*^9}, {3.678959253091893*^9, 3.6789593377942467`*^9}, {
   3.678959710864044*^9, 3.678959744805642*^9}, {3.6789597880911617`*^9, 
   3.678959848591672*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Ax", ",", "Ay", ",", "var", ",", "P"}], "}"}], "=", 
   RowBox[{"GetMatrices1D", "[", "8", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", " ", "=", " ", 
    RowBox[{"Flatten", "[", "var", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "Ax", ")"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "need", " ", "to", " ", "remove", " ", "the", " ", "rows", " ", "in", " ", 
    "the", " ", "end", " ", "so", " ", "that", " ", "we", " ", "can", " ", 
    "insert", " ", "the", " ", "R13", " ", "closure"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ax", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"Ax", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "ii", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "10", ",", "17"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ay", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"Ay", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", "ii", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "10", ",", "17"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678957291033966*^9, 3.678957293271102*^9}, 
   3.678957575551816*^9, {3.67895811955786*^9, 3.678958129772015*^9}, {
   3.678958269413616*^9, 3.678958269707749*^9}, {3.678958434459474*^9, 
   3.6789584388254128`*^9}, {3.678959378689608*^9, 3.6789593790635233`*^9}, {
   3.678995419567569*^9, 3.678995438316271*^9}, {3.678995469976138*^9, 
   3.678995473523082*^9}, {3.678995524314109*^9, 3.678995547466898*^9}, {
   3.678995588371447*^9, 3.678995592190835*^9}, {3.679032723408598*^9, 
   3.679032759232046*^9}, {3.679032934009947*^9, 3.679032935856627*^9}, {
   3.679136594348855*^9, 3.679136614005979*^9}, {3.6792236644541388`*^9, 
   3.6792236678183813`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of different tensor degrees: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2", ",", "1", ",", "0"}], "}"}]}],
  SequenceForm["number of different tensor degrees: ", {3, 2, 2, 1, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225252943`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"corresponding variables (traces,indices): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}],
  SequenceForm[
  "corresponding variables (traces,indices): ", {{0, 0}, {1, 0}, {2, 0}, {0, 
   1}, {1, 1}, {0, 2}, {1, 2}, {0, 3}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.679824122534727*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 1D: \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Number of Variables 1D: ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225514193`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 2D: \"\>", "\[InvisibleSpace]", "17"}],
  SequenceForm["Number of Variables 2D: ", 17],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.6798241225587683`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 3D: \"\>", "\[InvisibleSpace]", "26"}],
  SequenceForm["Number of Variables 3D: ", 26],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.679824122566218*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of full Tensors 3D: \"\>", "\[InvisibleSpace]", 
   "3.4000000000000004`"}],
  SequenceForm["Number of full Tensors 3D: ", 3.4000000000000004`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6789575763746843`*^9, {3.678958112510795*^9, 3.678958130160503*^9}, 
   3.678958270078285*^9, 3.678958445085536*^9, 3.678959379976667*^9, 
   3.678959751361084*^9, 3.678959798769631*^9, 3.67895989653836*^9, {
   3.678995540432328*^9, 3.678995547951743*^9}, 3.678995593501545*^9, 
   3.679032726871355*^9, 3.679032759802978*^9, {3.6790329368502417`*^9, 
   3.679032950725803*^9}, 3.679136614672982*^9, 3.6792234682856407`*^9, 
   3.6792236683225727`*^9, {3.679817289851452*^9, 3.6798172990192003`*^9}, 
   3.679819032472438*^9, 3.679824021536605*^9, 3.679824122574935*^9}]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"1", "0", "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], 
      SqrtBox["2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", 
      SqrtBox["2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "3"]]}], "0", "0", "0", "0", "0", 
      SqrtBox[
       FractionBox["5", "3"]], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox["2"]}], "3"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["4", 
        RowBox[{"3", " ", 
         SqrtBox["5"]}]]}], "0", 
      SqrtBox["3"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["5"]]}], "0", 
      SqrtBox["3"], "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox["2"], "3"]}], "0", "0", "0", "0", "0", 
      FractionBox["2", 
       RowBox[{"3", " ", 
        SqrtBox["5"]}]], "0", "0", "0", 
      SqrtBox["3"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SqrtBox[
       FractionBox["5", "3"]], 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["5"]]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["3"]]}], 
      SqrtBox[
       FractionBox["14", "5"]], "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["5"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SqrtBox[
       FractionBox["14", "5"]], "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", 
        SqrtBox["3"]}], "5"], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", 
         SqrtBox[
          FractionBox["6", "7"]]}], "5"]}], "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["8", 
       RowBox[{"5", " ", 
        SqrtBox["3"]}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"8", " ", 
         SqrtBox[
          FractionBox["2", "21"]]}], "5"]}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]]}], "0", 
      FractionBox["1", 
       SqrtBox["3"]], "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         FractionBox["2", "21"]]}], "5"], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["2", "21"]]}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SqrtBox["3"]}], "5"]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         FractionBox["6", "7"]]}], "5"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["2", 
        SqrtBox["3"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox[
         FractionBox["14", "5"]]}], "3"], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "7"]]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      SqrtBox[
       FractionBox["7", "10"]], "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "7"]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         FractionBox["14", "5"]], "3"]}], "0", "0", "0", 
      RowBox[{"-", 
       SqrtBox[
        FractionBox["6", "7"]]}], "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {17, 17}, 0, {
     1, {{0, 1, 4, 5, 7, 10, 13, 16, 20, 22, 24, 26, 30, 32, 33, 35, 37, 
       39}, {{2}, {5}, {1}, {4}, {6}, {2}, {8}, {10}, {2}, {8}, {11}, {3}, {
       9}, {2}, {8}, {12}, {5}, {15}, {4}, {14}, {6}, {16}, {5}, {15}, {6}, {
       16}, {15}, {5}, {7}, {17}, {6}, {16}, {8}, {10}, {8}, {11}, {9}, {8}, {
       12}}}, {1, 2^Rational[1, 2], 1, -Rational[2, 3]^Rational[1, 2], 2^
       Rational[1, 2], -Rational[2, 3]^Rational[1, 2], Rational[5, 3]^
       Rational[1, 2], 3^Rational[1, 2], Rational[2, 3] 2^Rational[1, 2], 
       Rational[-4, 3] 5^Rational[-1, 2], 3^Rational[1, 2], 2^
       Rational[-1, 2], -5^Rational[-1, 2], Rational[-1, 3] 2^Rational[1, 2], 
       Rational[2, 3] 5^Rational[-1, 2], 3^Rational[1, 2], (-2) 
       5^Rational[-1, 2], Rational[14, 5]^Rational[1, 2], Rational[5, 3]^
       Rational[1, 2], (-2) 3^Rational[-1, 2], (-2) 5^Rational[-1, 2], 
       Rational[14, 5]^Rational[1, 2], Rational[3, 5] 3^Rational[1, 2], 
       Rational[-3, 5] Rational[6, 7]^Rational[1, 2], Rational[8, 5] 
       3^Rational[-1, 2], Rational[-8, 5] Rational[2, 21]^Rational[1, 2], 
       Rational[2, 5] Rational[2, 21]^Rational[1, 2], Rational[-2, 5] 
       3^Rational[-1, 2], 3^Rational[-1, 2], -Rational[2, 21]^Rational[1, 2], 
       Rational[-2, 5] 3^Rational[1, 2], Rational[2, 5] 
       Rational[6, 7]^Rational[1, 2], (-2) 3^Rational[-1, 2], -
       Rational[6, 7]^Rational[1, 2], Rational[2, 3] 
       Rational[14, 5]^Rational[1, 2], -Rational[6, 7]^Rational[1, 2], 
       Rational[7, 10]^Rational[1, 2], Rational[-1, 3] 
       Rational[14, 5]^Rational[1, 2], -
       Rational[6, 7]^Rational[1, 2]}}]]]]], "Output",
 CellChangeTimes->{
  3.6792236683737383`*^9, {3.6798172899109583`*^9, 3.6798172990727243`*^9}, 
   3.679819032531104*^9, 3.679824021597459*^9, 3.679824122584605*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["var"], "Input",
 CellChangeTimes->{{3.678958272038644*^9, 3.6789582789665537`*^9}, 
   3.678958352695456*^9, {3.678958393239523*^9, 3.678958395646706*^9}, {
   3.678958442740348*^9, 3.678958442933165*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"3", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"3", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"4", ",", "0", ",", "3"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"2", ",", "1", ",", "2"}], "]"}], ",", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.678958279380022*^9, 3.678958396082905*^9, {3.678958443369494*^9, 
   3.6789584472826433`*^9}, 3.6792234683764277`*^9, {3.679817289957815*^9, 
   3.679817299106327*^9}, 3.6798190325719233`*^9, 3.67982402164268*^9, 
   3.679824122620924*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["variable transformation", "Subsection",
 CellChangeTimes->{{3.6789581840153227`*^9, 3.678958187756557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "map", " ", "from", " ", "\[Psi]", " ", "to", " ", "conventional", " ", 
    "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"transfMoments", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "\[Rho]"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", "vx"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", "vy"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["3", "2"]]}], " ", "\[Theta]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "2"}], "]"}], "->", 
        FractionBox["\[Sigma]xx", 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "2"}], "]"}], "->", 
        FractionBox["\[Sigma]xy", 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "0", ",", "2"}], "]"}], "->", 
        FractionBox["\[Sigma]yy", 
         SqrtBox["2"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["2", "5"]]}], "qx"}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["2", "5"]]}], "qy"}]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["mxxx", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["mxxy", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["mxyy", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"4", ",", "0", ",", "3"}], "]"}], "->", 
        FractionBox["myyy", 
         SqrtBox["6"]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "2", ",", "0"}], "]"}], "->", 
        FractionBox["\[CapitalDelta]", 
         RowBox[{"2", " ", 
          SqrtBox["30"]}]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "->", 
        FractionBox[
         RowBox[{"-", "Rxx"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}], "->", 
        FractionBox[
         RowBox[{"-", "Rxy"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "1", ",", "2"}], "]"}], "->", 
        FractionBox[
         RowBox[{"-", "Ryy"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConversionMatrix", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "2"]]}], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", "1", ",", "1", ",", "1", ",", "1", 
        ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConversionMatrix2", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["3", "2"]]}], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        FractionBox["1", 
         SqrtBox["2"]], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "5"]]}], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         SqrtBox["6"]], ",", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["30"]}]], ",", 
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]], ",", 
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]], ",", 
        FractionBox[
         RowBox[{"-", "1"}], 
         RowBox[{"2", 
          SqrtBox["7"]}]]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"map", " ", "from", " ", "w", " ", "to", " ", "\[Psi]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"transfMoments2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"1", ",", "2", ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "0", ",", "2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "3"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"4", ",", "0", ",", "3"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"3", ",", "1", ",", "2"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varConventional", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\[Rho]", ",", "vx", ",", "vy", ",", " ", "\[Theta]", ",", "\[Sigma]xx",
        ",", "\[Sigma]xy", ",", "\[Sigma]yy", ",", "qx", ",", "qy", ",", 
       "mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy", ",", "\[CapitalDelta]", 
       ",", "Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varLocal", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\[Rho]", ",", "vn", ",", "vt", ",", " ", "\[Theta]", ",", "\[Sigma]nn",
        ",", "\[Sigma]nt", ",", "\[Sigma]tt", ",", "qn", ",", "qt", ",", 
       "mnnn", ",", "mnnt", ",", "mntt", ",", "mttt", ",", "\[CapitalDelta]", 
       ",", "Rnn", ",", "Rnt", ",", "Rtt"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Conversion", " ", "from", " ", "Global", " ", "to", " ", "local", " ", 
     "variables"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varGlobalLocal", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vx", "\[Rule]", "vt"}], ",", 
       RowBox[{"vy", "\[Rule]", "vn"}], ",", " ", 
       RowBox[{"\[Sigma]xx", "\[Rule]", "\[Sigma]tt"}], ",", 
       RowBox[{"\[Sigma]xy", "\[Rule]", "\[Sigma]nt"}], ",", 
       RowBox[{"\[Sigma]yy", "\[Rule]", "\[Sigma]nn"}], ",", 
       RowBox[{"qx", "\[Rule]", "qt"}], ",", 
       RowBox[{"qy", "\[Rule]", "qn"}], ",", 
       RowBox[{"mxxx", "\[Rule]", "mttt"}], ",", 
       RowBox[{"mxxy", "\[Rule]", "mttn"}], ",", 
       RowBox[{"mxyy", "\[Rule]", "mtnn"}], ",", 
       RowBox[{"myyy", "\[Rule]", "mnnn"}], ",", 
       RowBox[{"Rxx", "\[Rule]", "Rtt"}], ",", 
       RowBox[{"Rxy", "\[Rule]", "Rtn"}], ",", 
       RowBox[{"Ryy", "\[Rule]", "Rnn"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678958354291965*^9, 3.6789585180047913`*^9}, {
  3.6789585788239517`*^9, 3.67895863147085*^9}, {3.67895868219844*^9, 
  3.6789587407131033`*^9}, {3.678958821637702*^9, 3.678958834413289*^9}, {
  3.678958867759439*^9, 3.678958900712845*^9}, {3.678958949516328*^9, 
  3.678958950284752*^9}, {3.678958996761046*^9, 3.678959134643436*^9}, {
  3.678961242948419*^9, 3.6789612446999207`*^9}, {3.678963444023161*^9, 
  3.6789635343713512`*^9}, {3.6789635876002283`*^9, 3.678963710689351*^9}, {
  3.678967624607039*^9, 3.678967700603652*^9}, {3.678967779211268*^9, 
  3.6789678801914883`*^9}, {3.679817793309338*^9, 3.679817862622698*^9}, {
  3.679817979299653*^9, 3.679818050828229*^9}, {3.6798187643327312`*^9, 
  3.679818791640038*^9}, {3.679829074506608*^9, 3.679829079849581*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["conversion to conventional variables", "Subsection",
 CellChangeTimes->{{3.6789586432158422`*^9, 3.678958647389152*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AxConventional", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ax", ".", "var"}], ")"}], "/.", "transfMoments"}], ",", 
      "varConventional"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AyConventional", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ay", ".", "var"}], ")"}], "/.", "transfMoments"}], ",", 
      "varConventional"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PConventional", " ", "=", " ", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"P", ".", "var"}], ")"}], "/.", "transfMoments"}], ",", 
      "varConventional"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PConventional", " ", "=", " ", 
    RowBox[{"PConventional", "/", "Kn"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "AyConventional", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.678958656662806*^9, 3.67895867103199*^9}, {
  3.678959161877551*^9, 3.678959171789771*^9}, {3.678959386210034*^9, 
  3.678959444509392*^9}, {3.678959481399109*^9, 3.67895960305048*^9}, {
  3.678959641877749*^9, 3.678959678552741*^9}, {3.67895975505232*^9, 
  3.678959756399041*^9}, {3.678959906052855*^9, 3.678959967763588*^9}, {
  3.6789615600694923`*^9, 3.678961608975268*^9}, {3.678961734511387*^9, 
  3.678961749412485*^9}, {3.678961831583569*^9, 3.678961831935166*^9}, {
  3.678962147704145*^9, 3.678962218397575*^9}, {3.678962265414879*^9, 
  3.678962267721305*^9}, {3.679817530484885*^9, 3.6798175306165323`*^9}, {
  3.6798175611562033`*^9, 3.679817561924119*^9}, {3.679818059685359*^9, 
  3.679818078393009*^9}, {3.6798190663827887`*^9, 3.679819077010035*^9}}],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{{3.679819066834867*^9, 3.679819077331353*^9}, 
   3.679819136305929*^9, 3.679819190132214*^9, 3.679824021693763*^9, 
   3.67982412268178*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["regularized closure", "Subsection",
 CellChangeTimes->{{3.6789928993043003`*^9, 3.678992903090581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Contribution", " ", "from", " ", "mijk", " ", "into", " ", "the", " ", 
    "Ax"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EqnmijkX", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"2", ",", "1"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"2", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "\[Sigma]xx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "\[Sigma]xy"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "3", "]"}], "\[Rule]", "\[Sigma]yy"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "mijk", " ", "into", " ", "the", " ", "Ay", 
     " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqnmijkY", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"2", ",", "2"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"2", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "\[Sigma]xx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "\[Sigma]xy"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "3", "]"}], "\[Rule]", "\[Sigma]yy"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"insert", " ", "new", " ", "rows"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AxConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AxConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnmijkX", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AyConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AyConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnmijkY", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "EqnmijkX", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "\[CapitalDelta]", " ", "into", " ", "the", 
     " ", "Ax"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqn\[CapitalDelta]X", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "\[CapitalDelta]", " ", "into", " ", "the", 
     " ", "Ay", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqn\[CapitalDelta]Y", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"insert", " ", "new", " ", "rows"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AxConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AxConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"Eqn\[CapitalDelta]X", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AyConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AyConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"Eqn\[CapitalDelta]Y", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "Eqn\[CapitalDelta]X", "]"}]}], "}"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "Rij", " ", "into", " ", "the", " ", "Ax"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqnRijX", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["28", "5"]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Contri", " ", "from", " ", "\[CapitalDelta]", " ", "into", " ", "the", 
     " ", "Ay", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqnRijY", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"-", "28"}], "5"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ".", 
          RowBox[{"trfVar2D", "[", 
           RowBox[{"1", ",", "B"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"B", "[", "1", "]"}], "\[Rule]", "qx"}], ",", 
         RowBox[{
          RowBox[{"B", "[", "2", "]"}], "\[Rule]", "qy"}]}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"insert", " ", "new", " ", "rows"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AxConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AxConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnRijX", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AyConventional", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"AyConventional", ",", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"EqnRijY", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "varConventional"}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"Length", "[", "EqnRijX", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.678992938968079*^9, 3.678993025406086*^9}, {
  3.6789930601406937`*^9, 3.678993119752409*^9}, {3.678993586817073*^9, 
  3.678993719832505*^9}, {3.678993783230296*^9, 3.67899378932616*^9}, {
  3.6789939129243526`*^9, 3.678993929361561*^9}, {3.678993961982028*^9, 
  3.678994137522501*^9}, {3.678994168158155*^9, 3.6789941854626427`*^9}, {
  3.6798184026908627`*^9, 3.679818426703833*^9}, {3.67981847523556*^9, 
  3.679818477930049*^9}, {3.679818580599434*^9, 3.679818632567211*^9}, {
  3.679818684763143*^9, 3.67981869241901*^9}, {3.679819084561821*^9, 
  3.6798191128879213`*^9}, {3.679828580897443*^9, 3.679828581374837*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AxR13", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "ConversionMatrix", "]"}], ".", 
    "AxConventional"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AyR13", "=", 
    RowBox[{
     RowBox[{"Inverse", "[", "ConversionMatrix", "]"}], ".", 
     "AyConventional"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dx", " ", 
    RowBox[{"AxR13", ".", "varConventional"}]}], "+", 
   RowBox[{"dy", " ", 
    RowBox[{"AyR13", ".", "varConventional"}]}], "+", 
   FractionBox[
    RowBox[{"P", ".", "varConventional"}], "Kn"]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6789937390505533`*^9, 3.67899374216776*^9}, {
   3.679223496965559*^9, 3.679223514305544*^9}, 3.679223689731427*^9, {
   3.6798176532872953`*^9, 3.679817672695807*^9}, {3.6798182479622517`*^9, 
   3.67981826917864*^9}, {3.679818975717106*^9, 3.6798189990019073`*^9}, 
   3.679819055822591*^9, {3.679819119950396*^9, 3.6798192324133577`*^9}, {
   3.6798192659276333`*^9, 3.679819327757249*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"dx", " ", "vx"}], "+", 
        RowBox[{"dy", " ", "vy"}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]xx"}], ")"}]}], 
        "+", 
        RowBox[{"dy", " ", "\[Sigma]xy"}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", "\[Sigma]xy"}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]yy"}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "qx"}], "3"], "+", 
           FractionBox[
            RowBox[{"2", " ", "vx"}], "3"]}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "qy"}], "3"], "+", 
           FractionBox[
            RowBox[{"2", " ", "vy"}], "3"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"mxxx", "+", 
           FractionBox[
            RowBox[{"8", " ", "qx"}], "15"], "+", 
           FractionBox[
            RowBox[{"4", " ", "vx"}], "3"]}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"mxxy", "-", 
           FractionBox[
            RowBox[{"4", " ", "qy"}], "15"], "-", 
           FractionBox[
            RowBox[{"2", " ", "vy"}], "3"]}], ")"}]}], "+", 
        FractionBox["\[Sigma]xx", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"mxyy", "+", 
           FractionBox[
            RowBox[{"2", " ", "qx"}], "5"], "+", "vx"}], ")"}]}], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"mxxy", "+", 
           FractionBox[
            RowBox[{"2", " ", "qy"}], "5"], "+", "vy"}], ")"}]}], "+", 
        FractionBox["\[Sigma]xy", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{"mxyy", "-", 
           FractionBox[
            RowBox[{"4", " ", "qx"}], "15"], "-", 
           FractionBox[
            RowBox[{"2", " ", "vx"}], "3"]}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{"myyy", "+", 
           FractionBox[
            RowBox[{"8", " ", "qy"}], "15"], "+", 
           FractionBox[
            RowBox[{"4", " ", "vy"}], "3"]}], ")"}]}], "+", 
        FractionBox["\[Sigma]yy", "Kn"]}]},
      {
       RowBox[{
        FractionBox["qx", "Kn"], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Rxx", "2"], "+", 
           FractionBox["\[CapitalDelta]", "6"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]xx"}], 
          ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}], ")"}]}]}]},
      {
       RowBox[{
        FractionBox["qy", "Kn"], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["Ryy", "2"], "+", 
           FractionBox["\[CapitalDelta]", "6"], "+", 
           FractionBox[
            RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]yy"}], 
          ")"}]}]}]},
      {
       RowBox[{
        FractionBox["mxxx", "Kn"], "-", 
        FractionBox[
         RowBox[{"9", " ", "dx", " ", "\[Sigma]xx"}], "5"], "+", 
        FractionBox[
         RowBox[{"6", " ", "dy", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{
        FractionBox["mxxy", "Kn"], "-", 
        FractionBox[
         RowBox[{"8", " ", "dx", " ", "\[Sigma]xy"}], "5"], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Sigma]xx"}], "+", 
           FractionBox[
            RowBox[{"2", " ", "\[Sigma]yy"}], "5"]}], ")"}]}]}]},
      {
       RowBox[{
        FractionBox["mxyy", "Kn"], "-", 
        FractionBox[
         RowBox[{"8", " ", "dy", " ", "\[Sigma]xy"}], "5"], "+", 
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "\[Sigma]xx"}], "5"], "-", "\[Sigma]yy"}], 
          ")"}]}]}]},
      {
       RowBox[{
        FractionBox["myyy", "Kn"], "+", 
        FractionBox[
         RowBox[{"6", " ", "dx", " ", "\[Sigma]xy"}], "5"], "-", 
        FractionBox[
         RowBox[{"9", " ", "dy", " ", "\[Sigma]yy"}], "5"]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", "dx", " ", "qx"}], "-", 
        RowBox[{"8", " ", "dy", " ", "qy"}], "+", 
        FractionBox["\[CapitalDelta]", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"56", " ", "dx", " ", "qx"}], "15"]}], "+", 
        FractionBox[
         RowBox[{"28", " ", "dy", " ", "qy"}], "15"], "+", 
        FractionBox["Rxx", "Kn"]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"14", " ", "dy", " ", "qx"}], "5"]}], "-", 
        FractionBox[
         RowBox[{"14", " ", "dx", " ", "qy"}], "5"], "+", 
        FractionBox["Rxy", "Kn"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"28", " ", "dx", " ", "qx"}], "15"], "-", 
        FractionBox[
         RowBox[{"56", " ", "dy", " ", "qy"}], "15"], "+", 
        FractionBox["Ryy", "Kn"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.679819215407778*^9, {3.6798192775166073`*^9, 3.6798193284727*^9}, 
   3.679824021760694*^9, 3.679824122777813*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "AyConventional", "]"}]], "Input",
 CellChangeTimes->{{3.67981901766683*^9, 3.679819022781282*^9}}],

Cell[BoxData["17"], "Output",
 CellChangeTimes->{3.679819023167349*^9, 3.679819059309663*^9, 
  3.679824021781609*^9, 3.6798241228157578`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary Condition evaluation", "Section",
 CellChangeTimes->{{3.678962278116391*^9, 3.678962286119834*^9}}],

Cell[CellGroupData[{

Cell["Distribution Function", "Subsection",
 CellChangeTimes->{{3.56114859231459*^9, 3.561148613171827*^9}, {
  3.5622179435996304`*^9, 3.5622179479520383`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "C", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "C", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"a_", ",", "n_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"a", "!"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "a"}], ")"}], "!"}]}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "p"], 
        RowBox[{
         RowBox[{"p", "!"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "-", "p"}], ")"}], "!"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "+", "n"}], ")"}], "!"}]}]], 
       SuperscriptBox["x", "p"]}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", "0", ",", "a"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceFreeNormalVariables", "[", 
     RowBox[{"A_", ",", "ix_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "ix", "]"}]}], ",", 
        RowBox[{"n1", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"ix", ",", "1"}], "]"}]}], ",", 
        RowBox[{"n2", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"ix", ",", "2"}], "]"}]}], ",", 
        RowBox[{"n3", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"ix", ",", "3"}], "]"}]}], ",", "idx", ",", "res"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"OddQ", "[", "n1", "]"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"OddQ", "[", "n3", "]"}], ")"}]}], ",", 
         RowBox[{"res", "=", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", 
              FractionBox["1", "2"]}], ")"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n3", "+", "n1"}], ")"}], "/", "2"}]], 
           RowBox[{"A", "[", "idx", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OddQ", "[", "n1", "]"}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{"OddQ", "[", "n3", "]"}], ")"}]}], ",", 
           RowBox[{"res", "=", "0"}], ",", 
           RowBox[{"res", "=", "ix"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceFreeNormalVariables1", "[", 
     RowBox[{"A_", ",", "ix_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "ix", "]"}]}], ",", 
        RowBox[{"n1", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"ix", ",", "1"}], "]"}]}], ",", 
        RowBox[{"n2", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"ix", ",", "2"}], "]"}]}], ",", 
        RowBox[{"n3", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"ix", ",", "3"}], "]"}]}], ",", "idx", ",", "res"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"OddQ", "[", "n1", "]"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"OddQ", "[", "n3", "]"}], ")"}]}], ",", 
         RowBox[{"res", "=", "0"}], ",", 
         RowBox[{"res", "=", "ix"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceFreeCoord", "[", "idx_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nx", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"idx", ",", "1"}], "]"}]}], ",", 
        RowBox[{"ny", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"idx", ",", "2"}], "]"}]}], ",", 
        RowBox[{"nz", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"idx", ",", "3"}], "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "idx", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Expand", "[", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "n"], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "-", "1"}], ")"}], "!!"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["Cx", "2"], "+", 
            SuperscriptBox["Cy", "2"], "+", 
            SuperscriptBox["Cz", "2"]}]], ")"}], 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}]], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              FractionBox["1", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["Cx", "2"], "+", 
                 SuperscriptBox["Cy", "2"], "+", 
                 SuperscriptBox["Cz", "2"]}]]], ",", 
              RowBox[{"{", 
               RowBox[{"Cx", ",", "nx"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Cy", ",", "ny"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Cz", ",", "nz"}], "}"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "following", " ", "function", " ", "returns", " ", "the", " ", 
    "basis", " ", "function", " ", "in", " ", "the", " ", "distribution", " ",
     "function", " ", "corresponding", " ", "to", " ", "those", " ", 
    "variables", " ", "which", " ", "we", " ", "need", " ", "for", " ", "the",
     " ", "heat", " ", "conduction", " ", "problem", " ", 
    RowBox[{"i", ".", "e", ".", " ", "those"}], " ", "variables", " ", 
    "which", " ", "have", " ", "all", " ", "the", " ", "indices", " ", "as", 
    " ", 
    RowBox[{"y", "."}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiTerm", "[", 
    RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Expand", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}], "!!"}], 
         RowBox[{"2", 
          RowBox[{"n", "!"}]}]], 
        SqrtBox["\[Pi]"]}]], 
      RowBox[{"S", "[", 
       RowBox[{"s", ",", 
        RowBox[{"n", "+", 
         RowBox[{"1", "/", "2"}]}], ",", 
        FractionBox[
         RowBox[{
          SuperscriptBox["Cx", "2"], "+", 
          SuperscriptBox["Cy", "2"], "+", 
          SuperscriptBox["Cz", "2"]}], "2"]}], "]"}], 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox["2"], ")"}], "n"]], 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TraceFreeNormalVariables", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"w", "[", 
                RowBox[{"s", ",", 
                 RowBox[{"Length", "[", "#", "]"}]}], "]"}], "&"}], ",", 
              "#"}], "]"}], 
            RowBox[{"TraceFreeCoord", "[", "#", "]"}]}], ")"}], "&"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "n"}], "]"}]}], 
        "]"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.558945372786235*^9, 3.558945373491125*^9}, {
   3.558946088929596*^9, 3.558946149934105*^9}, {3.558946181049096*^9, 
   3.558946300316731*^9}, {3.5589463398436604`*^9, 3.558946423327518*^9}, {
   3.5589470089248447`*^9, 3.558947048474738*^9}, {3.5589470819639397`*^9, 
   3.558947335353084*^9}, {3.558947385967211*^9, 3.558947403895132*^9}, 
   3.558947453776681*^9, {3.558947560300825*^9, 3.558947564431205*^9}, {
   3.558947617305551*^9, 3.558947630726513*^9}, {3.5589476970185432`*^9, 
   3.558947741572076*^9}, {3.558953089697953*^9, 3.5589531418577147`*^9}, {
   3.5589531740908337`*^9, 3.558953195106165*^9}, {3.558953238906097*^9, 
   3.558953239167796*^9}, {3.558953279884398*^9, 3.558953288424244*^9}, {
   3.558953451282818*^9, 3.558953451544392*^9}, 3.558953571393613*^9, 
   3.558953618865898*^9, {3.558953696996275*^9, 3.5589537012981977`*^9}, {
   3.5590529228578076`*^9, 3.559052928177417*^9}, {3.5590529873171206`*^9, 
   3.559053003525549*^9}, 3.559053369580192*^9, {3.559054478977141*^9, 
   3.5590544937503667`*^9}, {3.5590546006573544`*^9, 3.559054624228996*^9}, {
   3.559054661825062*^9, 3.559054663151064*^9}, {3.56032437217837*^9, 
   3.560324437526885*^9}, {3.5603446255018644`*^9, 3.5603446442626963`*^9}, {
   3.5603523892448397`*^9, 3.5603525328742924`*^9}, {3.5603526001728106`*^9, 
   3.560352676269744*^9}, {3.5641276696792493`*^9, 3.5641277096777196`*^9}, {
   3.564127763981415*^9, 3.5641277654634175`*^9}, {3.5641279249268975`*^9, 
   3.564127927251302*^9}, {3.564127961914562*^9, 3.5641279621329627`*^9}, {
   3.564128157585706*^9, 3.5641281594265094`*^9}, {3.5641281930757685`*^9, 
   3.564128195088172*^9}, {3.564128309451973*^9, 3.5641283119635773`*^9}, {
   3.5641284168893614`*^9, 3.5641284213041697`*^9}, {3.564128620266919*^9, 
   3.5641286506713724`*^9}, {3.5641287547391553`*^9, 
   3.5641288172484646`*^9}, {3.5641311102184925`*^9, 
   3.5641311108892937`*^9}, {3.5641314148714275`*^9, 3.564131419972636*^9}, {
   3.564132174670762*^9, 3.5641321902083893`*^9}, {3.678388330991723*^9, 
   3.6783883784954977`*^9}, 3.678389165662547*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"aIdx", ",", "nn", ",", "n", ",", "phi"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tfcMax", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tracefreecoord1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"nx", "+", "ny", "+", "nz"}], ")"}]], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"nx", "+", "ny", "+", "nz"}], ")"}]}], "-", "1"}], 
               ")"}], "!!"}]], 
            SuperscriptBox[
             RowBox[{"(", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["Cx", "2"], "+", 
                SuperscriptBox["Cy", "2"], "+", 
                SuperscriptBox["Cz", "2"]}]], ")"}], 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{"nx", "+", "ny", "+", "nz"}], ")"}]}], "+", "1"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  FractionBox["1", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Cx", "2"], "+", 
                    SuperscriptBox["Cy", "2"], "+", 
                    SuperscriptBox["Cz", "2"]}]]], ",", 
                  RowBox[{"{", 
                   RowBox[{"Cx", ",", "nx"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Cy", ",", "ny"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Cz", ",", "nz"}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"nx", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"nz", ",", "ny"}], "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"tfcMax", "-", "nz", "-", "ny"}], ")"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ny", ",", "nz", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"tfcMax", "-", "nz"}], ")"}], "/", "2"}]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"nz", ",", "0", ",", 
        RowBox[{"tfcMax", "/", "3"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceFreeCoord1", "[", "idx_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", 
        RowBox[{"n1", "=", 
         RowBox[{
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
          "1"}]}], ",", 
        RowBox[{"n2", "=", 
         RowBox[{
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", 
          "1"}]}], ",", 
        RowBox[{"n3", "=", 
         RowBox[{
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
          "1"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
          
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", 
          
          RowBox[{
          "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "n1", "\[GreaterEqual]", "n2", "\[GreaterEqual]", " ", "n3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"tracefreecoord1", "\[LeftDoubleBracket]", 
            RowBox[{"n3", ",", 
             RowBox[{"n2", "-", "n3", "+", "1"}], ",", 
             RowBox[{"n1", "-", "n2", "+", "1"}]}], "\[RightDoubleBracket]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cx", "\[Rule]", "C1"}], ",", 
             RowBox[{"Cy", "\[Rule]", "C2"}], ",", 
             RowBox[{"Cz", "\[Rule]", "C3"}]}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "n2", "\[GreaterEqual]", "n1", "\[GreaterEqual]", " ", "n3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"tracefreecoord1", "\[LeftDoubleBracket]", 
            RowBox[{"n3", ",", 
             RowBox[{"n1", "-", "n3", "+", "1"}], ",", 
             RowBox[{"n2", "-", "n1", "+", "1"}]}], "\[RightDoubleBracket]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cx", "\[Rule]", "C2"}], ",", 
             RowBox[{"Cy", "\[Rule]", "C1"}], ",", 
             RowBox[{"Cz", "\[Rule]", "C3"}]}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "n3", "\[GreaterEqual]", "n2", "\[GreaterEqual]", " ", "n1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"tracefreecoord1", "\[LeftDoubleBracket]", 
            RowBox[{"n1", ",", 
             RowBox[{"n2", "-", "n1", "+", "1"}], ",", 
             RowBox[{"n3", "-", "n2", "+", "1"}]}], "\[RightDoubleBracket]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cx", "\[Rule]", "C3"}], ",", 
             RowBox[{"Cy", "\[Rule]", "C2"}], ",", 
             RowBox[{"Cz", "\[Rule]", "C1"}]}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "n1", "\[GreaterEqual]", "n3", "\[GreaterEqual]", " ", "n2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"tracefreecoord1", "\[LeftDoubleBracket]", 
            RowBox[{"n2", ",", 
             RowBox[{"n3", "-", "n2", "+", "1"}], ",", 
             RowBox[{"n1", "-", "n3", "+", "1"}]}], "\[RightDoubleBracket]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cx", "\[Rule]", "C1"}], ",", 
             RowBox[{"Cy", "\[Rule]", "C3"}], ",", 
             RowBox[{"Cz", "\[Rule]", "C2"}]}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "n2", "\[GreaterEqual]", "n3", "\[GreaterEqual]", " ", "n1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"tracefreecoord1", "\[LeftDoubleBracket]", 
            RowBox[{"n1", ",", 
             RowBox[{"n3", "-", "n1", "+", "1"}], ",", 
             RowBox[{"n2", "-", "n3", "+", "1"}]}], "\[RightDoubleBracket]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cx", "\[Rule]", "C2"}], ",", 
             RowBox[{"Cy", "\[Rule]", "C3"}], ",", 
             RowBox[{"Cz", "\[Rule]", "C1"}]}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "n3", "\[GreaterEqual]", "n1", "\[GreaterEqual]", " ", "n2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"tracefreecoord1", "\[LeftDoubleBracket]", 
            RowBox[{"n2", ",", 
             RowBox[{"n1", "-", "n2", "+", "1"}], ",", 
             RowBox[{"n3", "-", "n1", "+", "1"}]}], "\[RightDoubleBracket]"}],
            "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cx", "\[Rule]", "C3"}], ",", 
             RowBox[{"Cy", "\[Rule]", "C1"}], ",", 
             RowBox[{"Cz", "\[Rule]", "C2"}]}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"C1", "\[Rule]", "Cx"}], ",", 
          RowBox[{"C2", "\[Rule]", "Cy"}], ",", 
          RowBox[{"C3", "\[Rule]", "Cz"}]}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"a_", ",", "n_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"a", "!"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "a"}], ")"}], "!"}]}]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "p"], 
        RowBox[{
         RowBox[{"p", "!"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "-", "p"}], ")"}], "!"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "+", "n"}], ")"}], "!"}]}]], 
       SuperscriptBox["x", "p"]}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", "0", ",", "a"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "following", " ", "function", " ", "develops", " ", "phi", " ",
     "and", " ", "does", " ", "nothing", " ", 
    RowBox[{"more", ".", " ", "Why"}], " ", "different", " ", "from", " ", 
    "phiTerm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bcBuild1", "[", "theory_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tmp1", ",", "aIdx", ",", "nn", ",", "idx0", ",", "digits", ",", 
       "part"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aIdx", "=", "theory"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nn", "=", 
       RowBox[{"Length", "[", "aIdx", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"phi", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"phi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"aa", ",", "0", ",", 
             RowBox[{
              RowBox[{"aIdx", "\[LeftDoubleBracket]", 
               RowBox[{"n", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", 
           RowBox[{"nn", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tmp1", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Multinomial", "[", 
                RowBox[{
                 RowBox[{"n", "-", 
                  RowBox[{"2", "k"}]}], ",", 
                 RowBox[{
                  RowBox[{"2", "k"}], "-", 
                  RowBox[{"2", "j"}]}], ",", 
                 RowBox[{"2", "j"}]}], "]"}], 
               RowBox[{"TraceFreeCoord1", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "j"}], ",", 
                  RowBox[{"n", "-", 
                   RowBox[{"2", "k"}]}], ",", 
                  RowBox[{
                   RowBox[{"2", "k"}], "-", 
                   RowBox[{"2", "j"}]}]}], "}"}], "]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", 
                  FractionBox["1", "2"]}], ")"}], "k"], " ", 
               RowBox[{"w", "[", 
                RowBox[{"ss", ",", "n"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", "k"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"phi", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", 
               RowBox[{"aa", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  SqrtBox["2"], ")"}], "n"]], 
               SqrtBox[
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}], "!!"}], 
                  RowBox[{"2", 
                   RowBox[{"n", "!"}]}]], 
                 SqrtBox["\[Pi]"]}]], 
               RowBox[{"S", "[", 
                RowBox[{"aa", ",", 
                 RowBox[{"n", "+", 
                  RowBox[{"1", "/", "2"}]}], ",", 
                 FractionBox["CC", "2"]}], "]"}], "tmp1"}], "/.", 
              RowBox[{"{", 
               RowBox[{"ss", "\[Rule]", "aa"}], "}"}]}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"aa", ",", "0", ",", 
             RowBox[{
              RowBox[{"aIdx", "\[LeftDoubleBracket]", 
               RowBox[{"n", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", 
          RowBox[{"nn", "-", "1"}]}], "}"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "same", " ", "thing", " ", "as", " ", "phiTerm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CurlyPhi]0", "[", 
   RowBox[{"a_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"phi", "\[LeftDoubleBracket]", 
   RowBox[{
    RowBox[{"n", "+", "1"}], ",", 
    RowBox[{"a", "+", "1"}]}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5622091920640073`*^9, 3.5622092078468523`*^9}, {
   3.5622092450119095`*^9, 3.5622092908973165`*^9}, {3.5622094037286615`*^9, 
   3.5622094732442465`*^9}, {3.5622095410702286`*^9, 3.562209547084573*^9}, {
   3.5622096561231337`*^9, 3.562209656809535*^9}, {3.5622097666691713`*^9, 
   3.562209801929935*^9}, {3.5622099083427653`*^9, 3.562209908865795*^9}, {
   3.562210220459511*^9, 3.5622102690857563`*^9}, {3.562210450957785*^9, 
   3.562210451488186*^9}, {3.562211665880743*^9, 3.5622116664617767`*^9}, {
   3.5622140904087653`*^9, 3.5622141418485765`*^9}, {3.562214231130499*^9, 
   3.562214231617527*^9}, {3.5622142699227533`*^9, 3.5622142751370163`*^9}, {
   3.5622143380521593`*^9, 3.56221434471054*^9}, {3.5622143857529635`*^9, 
   3.562214386205364*^9}, {3.5622144607712297`*^9, 3.562214467311495*^9}, {
   3.5622145145209117`*^9, 3.562214545711626*^9}, {3.562214667991761*^9, 
   3.5622146960821967`*^9}, {3.5622147698837457`*^9, 
   3.5622147728321505`*^9}, {3.5622148531865096`*^9, 
   3.5622148534517097`*^9}, {3.5622151226059704`*^9, 3.562215157158887*^9}, {
   3.5622152711369314`*^9, 3.562215280338293*^9}, {3.5622157271153345`*^9, 
   3.5622158003458395`*^9}, {3.5622158762958145`*^9, 
   3.5622159077576137`*^9}, {3.5622161095202217`*^9, 3.562216109960247*^9}, {
   3.5622163145284214`*^9, 3.5622163149564457`*^9}, {3.5622163644293756`*^9, 
   3.5622163987690506`*^9}, {3.5622165245158377`*^9, 
   3.5622165555623555`*^9}, {3.562216625052616*^9, 3.5622167069729767`*^9}, {
   3.5622167660480466`*^9, 3.562216778943784*^9}, {3.5622172868153653`*^9, 
   3.562217305154414*^9}, {3.5622173779682784`*^9, 3.562217378435305*^9}, {
   3.5622174722416935`*^9, 3.5622174742528086`*^9}, {3.5622175607915106`*^9, 
   3.562217696061705*^9}, {3.5622178697404447`*^9, 3.562217869896454*^9}, {
   3.5622180233310704`*^9, 3.5622180318438234`*^9}, {3.5622184798109426`*^9, 
   3.562218482633104*^9}, {3.562218522839584*^9, 3.562218525959589*^9}, {
   3.562218591847727*^9, 3.5622185930277944`*^9}, {3.5622187001827135`*^9, 
   3.562218746008563*^9}, {3.5622188396982946`*^9, 3.5622188404313364`*^9}, 
   3.5622279354281993`*^9, {3.562232383840641*^9, 3.5622324193856745`*^9}, {
   3.562232458943937*^9, 3.562232461425079*^9}, {3.5622325421646967`*^9, 
   3.5622325613417935`*^9}, 3.562235856948292*^9, {3.5641271640511613`*^9, 
   3.5641271710711737`*^9}, {3.5641285420327816`*^9, 3.564128542921983*^9}, {
   3.564131018942732*^9, 3.5641310517807894`*^9}, {3.5641313615349336`*^9, 
   3.5641313921733875`*^9}, {3.5641315403268476`*^9, 3.564131560372883*^9}, {
   3.5641326926384716`*^9, 3.564132724883728*^9}, {3.5641327663798013`*^9, 
   3.5641328038510666`*^9}, {3.5641330631703224`*^9, 
   3.5641330820307555`*^9}, {3.564133135211249*^9, 3.5641331373484526`*^9}, {
   3.564133225597808*^9, 3.5641332260346084`*^9}, {3.5641332916951237`*^9, 
   3.564133294206728*^9}, {3.56413334075721*^9, 3.564133341350011*^9}, {
   3.5641336341001253`*^9, 3.564133721195078*^9}, {3.678389735864891*^9, 
   3.678389743373304*^9}, {3.678389777956118*^9, 3.678389798546288*^9}}],

Cell[BoxData[
 RowBox[{"bcBuild1", "[", 
  RowBox[{"MakeComplete", "[", "10", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.564133104666395*^9, 3.5641331109844065`*^9}, {
  3.564133447274197*^9, 3.5641334564158134`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CurlyPhi]0", "[", 
     RowBox[{"1", ",", "5"}], "]"}], "-", 
    RowBox[{"phiTerm", "[", 
     RowBox[{"1", ",", "5"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"CC", "->", 
     RowBox[{
      SuperscriptBox["Cx", "2"], "+", 
      SuperscriptBox["Cy", "2"], "+", 
      SuperscriptBox["Cz", "2"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5641331135272107`*^9, 3.5641331240104294`*^9}, {
  3.564133398368111*^9, 3.564133441361787*^9}, {3.5641334942146797`*^9, 
  3.5641335480971737`*^9}, {3.564133732926299*^9, 3.564133734751502*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"0", ",", "0"}], "]"}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", 
          SqrtBox["\[Pi]"]], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}]}], 
          RowBox[{"3", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"3", " ", "\[Pi]"}], "2"]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"1", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SqrtBox["\[Pi]"]], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}]}], 
          RowBox[{"3", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"15", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"15", " ", "\[Pi]"}], "2"]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"2", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["3", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"3", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"3", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"15", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"315", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        RowBox[{"35", " ", "\[Pi]"}]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"3", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["9", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"12", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"9", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"30", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"315", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "4"], 
          RowBox[{"11340", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"35", " ", "\[Pi]"}], "2"]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"4", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["45", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"60", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"36", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"90", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"630", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "4"], 
          RowBox[{"11340", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "5"], 
          RowBox[{"623700", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        RowBox[{"77", " ", "\[Pi]"}]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"5", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["45", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"360", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"180", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"360", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"1890", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "4"], 
          RowBox[{"22680", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "5"], 
          RowBox[{"623700", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "6"], 
          RowBox[{"48648600", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        RowBox[{"3003", " ", "\[Pi]"}]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"6", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["945", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2520", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"1080", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"1800", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"7560", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "4"], 
          RowBox[{"68040", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "5"], 
          RowBox[{"1247400", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "6"], 
          RowBox[{"48648600", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "7"], 
          RowBox[{"5108103000", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"715", " ", "\[Pi]"}], "2"]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"7", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["945", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"20160", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"7560", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"10800", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"37800", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "4"], 
          RowBox[{"272160", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "5"], 
          RowBox[{"3742200", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "6"], 
          RowBox[{"97297200", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "7"], 
          RowBox[{"5108103000", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "8"], 
          RowBox[{"694702008000", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"12155", " ", "\[Pi]"}], "2"]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"8", ",", "0"}], "]"}]}], ",", 
      RowBox[{
       FractionBox["2835", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"181440", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Cx", "2"], "+", 
           SuperscriptBox["Cy", "2"], "+", 
           SuperscriptBox["Cz", "2"]}], 
          RowBox[{"60480", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "2"], 
          RowBox[{"75600", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "3"], 
          RowBox[{"226800", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "4"], 
          RowBox[{"1360800", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "5"], 
          RowBox[{"14968800", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "6"], 
          RowBox[{"291891600", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "7"], 
          RowBox[{"10216206000", " ", 
           SqrtBox["\[Pi]"]}]], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "8"], 
          RowBox[{"694702008000", " ", 
           SqrtBox["\[Pi]"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}], ")"}], "9"], 
          RowBox[{"118794043368000", " ", 
           SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
       SqrtBox[
        RowBox[{"230945", " ", "\[Pi]"}]], " ", 
       RowBox[{"w", "[", 
        RowBox[{"9", ",", "0"}], "]"}]}]}], "}"}], "}"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"6", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["65", "3"]], " ", 
   SuperscriptBox["Cx", "4"], " ", "Cy", " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["5", "39"]], " ", 
   SuperscriptBox["Cx", "6"], " ", "Cy", " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SqrtBox[
    FractionBox["65", "3"]], " ", 
   SuperscriptBox["Cx", "2"], " ", 
   SuperscriptBox["Cy", "3"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["15", "13"]], " ", 
   SuperscriptBox["Cx", "4"], " ", 
   SuperscriptBox["Cy", "3"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SqrtBox[
    FractionBox["13", "15"]], " ", 
   SuperscriptBox["Cy", "5"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Cx", "2"], " ", 
    SuperscriptBox["Cy", "5"], " ", 
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "5"}], "]"}]}], 
   SqrtBox["195"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Cy", "7"], " ", 
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "5"}], "]"}]}], 
   RowBox[{"4", " ", 
    SqrtBox["195"]}]], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SqrtBox["195"], " ", 
   SuperscriptBox["Cx", "2"], " ", "Cy", " ", 
   SuperscriptBox["Cz", "2"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["7", "16"], " ", 
   SqrtBox[
    FractionBox["5", "39"]], " ", 
   SuperscriptBox["Cx", "4"], " ", "Cy", " ", 
   SuperscriptBox["Cz", "2"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SqrtBox[
    FractionBox["65", "3"]], " ", 
   SuperscriptBox["Cy", "3"], " ", 
   SuperscriptBox["Cz", "2"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SqrtBox[
    FractionBox["5", "39"]], " ", 
   SuperscriptBox["Cx", "2"], " ", 
   SuperscriptBox["Cy", "3"], " ", 
   SuperscriptBox["Cz", "2"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Cy", "5"], " ", 
    SuperscriptBox["Cz", "2"], " ", 
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "5"}], "]"}]}], 
   SqrtBox["195"]], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["65", "3"]], " ", "Cy", " ", 
   SuperscriptBox["Cz", "4"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["7", "16"], " ", 
   SqrtBox[
    FractionBox["5", "39"]], " ", 
   SuperscriptBox["Cx", "2"], " ", "Cy", " ", 
   SuperscriptBox["Cz", "4"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["15", "13"]], " ", 
   SuperscriptBox["Cy", "3"], " ", 
   SuperscriptBox["Cz", "4"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   SqrtBox[
    FractionBox["5", "39"]], " ", "Cy", " ", 
   SuperscriptBox["Cz", "6"], " ", 
   RowBox[{"w", "[", 
    RowBox[{"1", ",", "5"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.564133116366416*^9, 3.5641331494384737`*^9}, 
   3.5641332369234276`*^9, 3.564133309869156*^9, 3.564133366263255*^9, {
   3.5641334003493147`*^9, 3.564133425075358*^9}, 3.564133464964628*^9, {
   3.564133502669894*^9, 3.564133548549575*^9}, {3.564133729712693*^9, 
   3.5641337354379034`*^9}, 3.564158596994423*^9, 3.5683865425528064`*^9, 
   3.572517217960639*^9, 3.572778977394332*^9, 3.5731499812856674`*^9, 
   3.5736375676175795`*^9, 3.678387983457712*^9, 3.678539301916441*^9, 
   3.678694148903492*^9, 3.678698103877355*^9, 3.678963330314705*^9, 
   3.6792234719083233`*^9, 3.679824024506714*^9, 3.679824129615857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CurlyPhi]0", "[", 
  RowBox[{"2", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.5641336192488995`*^9, 3.5641336197481003`*^9}, {
  3.5641337542515364`*^9, 3.564133755125138*^9}, {3.564133791832002*^9, 
  3.5641337999752164`*^9}, {3.56838654698406*^9, 3.5683865509962893`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "[", 
      RowBox[{"0", ",", "0"}], "]"}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["2", 
         SqrtBox["\[Pi]"]], "-", 
        FractionBox[
         RowBox[{"2", " ", "CC"}], 
         RowBox[{"3", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "2"]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"1", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["\[Pi]"]], "-", 
        FractionBox[
         RowBox[{"2", " ", "CC"}], 
         RowBox[{"3", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"15", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"15", " ", "\[Pi]"}], "2"]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"2", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["3", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"3", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"3", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"15", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"315", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"35", " ", "\[Pi]"}]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"3", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["9", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"12", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"9", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"30", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"315", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "4"], 
         RowBox[{"11340", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"35", " ", "\[Pi]"}], "2"]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"4", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["45", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"60", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"36", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"90", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"630", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "4"], 
         RowBox[{"11340", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "5"], 
         RowBox[{"623700", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"77", " ", "\[Pi]"}]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"5", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["45", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"360", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"180", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"360", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"1890", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "4"], 
         RowBox[{"22680", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "5"], 
         RowBox[{"623700", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "6"], 
         RowBox[{"48648600", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"3003", " ", "\[Pi]"}]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"6", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["945", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2520", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"1080", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"1800", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"7560", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "4"], 
         RowBox[{"68040", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "5"], 
         RowBox[{"1247400", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "6"], 
         RowBox[{"48648600", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "7"], 
         RowBox[{"5108103000", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"715", " ", "\[Pi]"}], "2"]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"7", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["945", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"20160", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"7560", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"10800", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"37800", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "4"], 
         RowBox[{"272160", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "5"], 
         RowBox[{"3742200", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "6"], 
         RowBox[{"97297200", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "7"], 
         RowBox[{"5108103000", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "8"], 
         RowBox[{"694702008000", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"12155", " ", "\[Pi]"}], "2"]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"8", ",", "0"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["2835", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"181440", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox["CC", 
         RowBox[{"60480", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "2"], 
         RowBox[{"75600", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "3"], 
         RowBox[{"226800", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "4"], 
         RowBox[{"1360800", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "5"], 
         RowBox[{"14968800", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "6"], 
         RowBox[{"291891600", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "7"], 
         RowBox[{"10216206000", " ", 
          SqrtBox["\[Pi]"]}]], "+", 
        FractionBox[
         SuperscriptBox["CC", "8"], 
         RowBox[{"694702008000", " ", 
          SqrtBox["\[Pi]"]}]], "-", 
        FractionBox[
         SuperscriptBox["CC", "9"], 
         RowBox[{"118794043368000", " ", 
          SqrtBox["\[Pi]"]}]]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"230945", " ", "\[Pi]"}]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"9", ",", "0"}], "]"}]}]}], "}"}], "}"}], 
  "\[LeftDoubleBracket]", 
  RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{
  3.564133620340901*^9, {3.564133736935506*^9, 3.564133755546338*^9}, {
   3.564133793251605*^9, 3.564133800240417*^9}, 3.5641585983204255`*^9, {
   3.5683865437318735`*^9, 3.5683865517593327`*^9}, 3.5725172394262767`*^9, 
   3.5727789774303336`*^9, 3.5731499813324676`*^9, 3.5736375679451804`*^9, 
   3.6783879835099087`*^9, 3.678539301937665*^9, 3.678694148935934*^9, 
   3.678698103902815*^9, 3.678963330335709*^9, 3.679223471981166*^9, 
   3.67982402454874*^9, 3.6798241296514997`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Boundary Conditions", "Subsection",
 CellChangeTimes->{{3.56114859231459*^9, 3.561148613171827*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "w", ",", "phi", ",", "bc", ",", "pos", ",", "pos1", ",", "pos2", ",", 
    "mm", ",", "\[Alpha]", ",", "nn", ",", "res", ",", "res1", ",", "ex", ",",
     "a", ",", "b", ",", "ex0"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"psi", "[", 
    RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "n"}], "+", "1"}], ")"}], "!!"}], 
        RowBox[{"2", 
         RowBox[{"n", "!"}]}]], 
       SqrtBox["\[Pi]"]}]], 
     RowBox[{"S", "[", 
      RowBox[{"s", ",", 
       RowBox[{"n", "+", 
        RowBox[{"1", "/", "2"}]}], ",", 
       FractionBox["CC", "2"]}], "]"}], 
     FractionBox[
      RowBox[{"TraceFreeCoord", "[", 
       RowBox[{"Table", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        SqrtBox["2"], ")"}], "n"]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"psi1", "[", 
     RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Expand", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}], "!!"}], 
         RowBox[{"2", 
          RowBox[{"n", "!"}]}]], 
        SqrtBox["\[Pi]"]}]], 
      RowBox[{"S1", "[", 
       RowBox[{"s", ",", 
        RowBox[{"n", "+", 
         RowBox[{"1", "/", "2"}]}], ",", 
        FractionBox["CC", "2"]}], "]"}], 
      FractionBox[
       RowBox[{"TraceFreeCoord1", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "n", ",", "0"}], "}"}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox["2"], ")"}], "n"]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Integrates", " ", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox["\[Integral]", "\[Pi]"], "0"], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], "nn"], 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], "mm"], "d\[Alpha]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateCosSin", "[", 
    RowBox[{"\[Alpha]_", ",", "ex_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pos1", ",", "pos2", ",", 
       RowBox[{"mm", "=", "0"}], ",", 
       RowBox[{"nn", "=", "0"}], ",", "res", ",", 
       RowBox[{"res1", "=", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", "ex"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pos1", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"res1", ",", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Alpha]", "]"}], "_"]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos2", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"res1", ",", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Alpha]", "]"}], "_"]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos1", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mm", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos2", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos2", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"res1", ",", 
          RowBox[{"Join", "[", 
           RowBox[{"pos1", ",", "pos2"}], "]"}]}], "]"}], 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "nn"]}], ")"}], "  ", 
          RowBox[{"Gamma", "[", 
           FractionBox[
            RowBox[{"1", "+", "mm"}], "2"], "]"}], 
          RowBox[{"Gamma", "[", 
           FractionBox[
            RowBox[{"1", "+", "nn"}], "2"], "]"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"Gamma", "[", 
           RowBox[{"1", "+", 
            FractionBox["mm", "2"], "+", 
            FractionBox["nn", "2"]}], "]"}]}]]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "The", " ", "division", " ", "is", " ", "to", " ", "make", " ", 
         "sure", " ", "that", " ", "ex", " ", "is", " ", "not", " ", "of", 
         " ", "the", " ", "form", " ", "ex"}], " ", "=", " ", 
        RowBox[{"C", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Alpha]", "]"}], 
          RowBox[{"-", "1"}]], " ", "or", " ", "C", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
           RowBox[{"-", "1"}]], ".", " ", "In"}], " ", "such", " ", "a", " ", 
         "case", " ", "we", " ", "do", " ", "not", " ", "perform", " ", "the",
          " ", "integration", " ", "and", " ", "simply", " ", "return", " ", 
         "the", " ", 
         RowBox[{"input", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos1", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"res", "/", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos2", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"res", "/", 
           RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "the", " ", "expressions", " ", "this", " ", "integrates"}], 
    ",", " ", 
    RowBox[{
    "see", " ", "the", " ", "bottom", " ", "section", " ", "on", " ", 
     "integration"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateLaguerre", "[", 
    RowBox[{"a_", ",", "ex_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pos", ",", 
       RowBox[{"nn", "=", "0"}], ",", 
       RowBox[{"res", "=", "ex"}], ",", "ex0", ",", "res1", ",", "p", ",", 
       "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ex0", "=", 
       RowBox[{
        RowBox[{"b", " ", "ex"}], "/.", 
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", 
          SuperscriptBox["b", "2"]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"Position", "[", 
            RowBox[{"ex0", ",", "b"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res1", "=", 
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"ex0", ",", "pos"}], "]"}], 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", 
            RowBox[{"Extract", "[", 
             RowBox[{"ex0", ",", "pos"}], "]"}]}], "]"}], ",", 
          RowBox[{"Assumptions", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", "b", "]"}], ">", "0"}], ",", 
             RowBox[{"b", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"res1", ",", 
         SuperscriptBox["b", "_"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"res1", ",", 
                RowBox[{
                "pos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
              "2", "\[RightDoubleBracket]"}], "-", "1"}], ")"}], "/", "2"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Delete", "[", 
             RowBox[{"res1", ",", "pos"}], "]"}], 
            RowBox[{"nn", "!"}]}], "/.", 
           RowBox[{"b", "\[Rule]", 
            SuperscriptBox["a", 
             RowBox[{"1", "/", "2"}]]}]}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "following", " ", "function", " ", "integrates", " ", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      SuperscriptBox["x", "n"], 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"-", 
         SuperscriptBox["x", "2"]}], "2"], "]"}], "dx"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateGauss", "[", 
    RowBox[{"a_", ",", "ex_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"a", " ", "ex"}], ",", 
          SuperscriptBox["a", "_"]}], "]"}]}], ",", 
       RowBox[{"nn", "=", "0"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         SqrtBox[
          RowBox[{"2", "\[Pi]"}]], "ex"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{
                RowBox[{"a", " ", "ex"}], ",", 
                RowBox[{
                "pos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
              "2", "\[RightDoubleBracket]"}], "-", "1"}], ")"}], "/", "2"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "nn", "]"}], ",", 
           RowBox[{"res", "=", 
            RowBox[{
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"a", " ", "ex"}], ",", "pos"}], "]"}], 
             SqrtBox[
              RowBox[{"2", "\[Pi]"}]], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "nn"}], "-", "1"}], ")"}], "!!"}]}]}], " ", ",", 
           
           RowBox[{"res", "=", "0"}]}], "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "following", " ", "function", " ", "integrates", " ", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox["\[Integral]", "\[Infinity]"], "0"], 
     RowBox[{
      SuperscriptBox["x", "n"], 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"-", 
         SuperscriptBox["x", "2"]}], "2"], "]"}], "dx"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateHalfGauss", "[", 
    RowBox[{"a_", ",", "ex_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"a", " ", "ex"}], ",", 
          SuperscriptBox["a", "_"]}], "]"}]}], ",", 
       RowBox[{"nn", "=", "0"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         SqrtBox[
          RowBox[{"\[Pi]", "/", "2"}]], "ex"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pos", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{
              RowBox[{"a", " ", "ex"}], ",", 
              RowBox[{
              "pos", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
              "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "-", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"a", " ", "ex"}], ",", "pos"}], "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             SqrtBox["2"], ")"}], 
            RowBox[{"nn", "+", "1"}]], 
           RowBox[{
            RowBox[{"Gamma", "[", 
             FractionBox[
              RowBox[{"nn", "+", "1"}], "2"], "]"}], "/", "2"}]}]}], " ", 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "res"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "following", " ", "function", " ", "computes", " ", "the", " ",
     "moment", " ", "of", " ", "the", " ", "fw", " ", "and", " ", "fgas", " ",
     "again", " ", "the", " ", "basis", " ", "function", " ", "identified", 
    " ", "with", " ", 
    RowBox[{"(", 
     RowBox[{"s", ",", "n"}], ")"}], " ", "for", " ", "a", " ", "given", " ", 
    
    RowBox[{"theory", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bc", "[", 
    RowBox[{"s_", ",", "n_", ",", "theory_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"IntWall", ",", "IntGas", ",", "res", ",", 
       RowBox[{"nn", "=", 
        RowBox[{"Length", "[", "theory", "]"}]}], ",", "b", ",", "m", ",", 
       "dummy"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "0", ",", 
             RowBox[{
              RowBox[{"theory", "\[LeftDoubleBracket]", 
               RowBox[{"m", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"nn", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "psi", " ", "is", " ", "the", " ", "function", " ", "we", " ", "are", 
        " ", "testing", " ", "the", " ", "equation", " ", "with", " ", "and", 
        " ", "\[CurlyPhi]0", " ", "is", " ", "the", " ", "basis", " ", 
        "function", " ", "for", " ", "the", " ", "phase", " ", 
        RowBox[{"density", "."}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<bc: (\>\"", "<>", 
        RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\<, \>\"", "<>", 
        RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<)\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"IntGas", "=", 
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"dummy", "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"CC", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "dC"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    SqrtBox[
                    RowBox[{"2", "\[Pi]"}]], ")"}], "2"]], " ", 
                    RowBox[{"psi1", "[", 
                    RowBox[{"s", ",", "n"}], "]"}], 
                    RowBox[{"\[CurlyPhi]0", "[", 
                    RowBox[{"b", ",", "m"}], "]"}]}]}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"CC", "\[Rule]", 
                    SuperscriptBox["C", "2"]}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cx", "\[Rule]", 
                    RowBox[{"C", " ", 
                    RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                   RowBox[{"Cy", "\[Rule]", 
                    RowBox[{"C", " ", 
                    RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
                   RowBox[{"Cz", "\[Rule]", 
                    RowBox[{"C", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "}"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"C", "\[Rule]", 
                   SqrtBox[
                    RowBox[{"2", "x"}]]}], ",", 
                  RowBox[{"dC", "\[Rule]", 
                   RowBox[{
                    FractionBox["1", 
                    SqrtBox[
                    RowBox[{"2", "x"}]]], "dx"}]}]}], "}"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{"S1", "\[Rule]", "S"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"IntGas", "=", 
             RowBox[{"Expand", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"IntegrateLaguerre", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{
                    "IntGas", "\[LeftDoubleBracket]", "kk", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"kk", ",", "1", ",", 
                    RowBox[{"Length", "[", "IntGas", "]"}]}], "}"}]}], 
                 "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"IntGas", "=", 
             RowBox[{"Expand", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"IntegrateCosSin", "[", 
                   RowBox[{"\[Theta]", ",", 
                    RowBox[{
                    "IntGas", "\[LeftDoubleBracket]", "kk", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"kk", ",", "1", ",", 
                    RowBox[{"Length", "[", "IntGas", "]"}]}], "}"}]}], 
                 "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"IntGas", "=", 
             RowBox[{"Expand", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"IntegrateCosSin", "[", 
                   RowBox[{"\[CurlyPhi]", ",", 
                    RowBox[{
                    "IntGas", "\[LeftDoubleBracket]", "kk", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"kk", ",", "1", ",", 
                    RowBox[{"Length", "[", "IntGas", "]"}]}], "}"}]}], 
                 "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"res", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", 
               RowBox[{"b", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"IntGas", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dx", "\[Rule]", "1"}], ",", 
                RowBox[{"dummy", "\[Rule]", "0"}]}], "}"}]}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "0", ",", 
             RowBox[{
              RowBox[{"theory", "\[LeftDoubleBracket]", 
               RowBox[{"m", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "0", ",", 
          RowBox[{"nn", "-", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IntGas", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"Plus", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"res", ",", "1"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "since", " ", "wall", " ", "velocity", " ", "is", " ", "zero", " ", 
        "we", " ", "only", " ", "have", " ", 
        FractionBox[
         RowBox[{"\[Rho]W", "+", 
          RowBox[{
           FractionBox["\[Theta]W", "2"], 
           RowBox[{"(", 
            RowBox[{"CC", "-", "3"}], ")"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           SqrtBox[
            RowBox[{"2", "\[Pi]"}]], ")"}], "2"]]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IntWall", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dummy", "+", 
           RowBox[{
            RowBox[{"psi1", "[", 
             RowBox[{"s", ",", "n"}], "]"}], 
            FractionBox[
             RowBox[{"\[Rho]W", "+", 
              RowBox[{
               FractionBox["\[Theta]W", "2"], 
               RowBox[{"(", 
                RowBox[{"CC", "-", "3"}], ")"}]}]}], 
             SuperscriptBox[
              RowBox[{"(", 
               SqrtBox[
                RowBox[{"2", "\[Pi]"}]], ")"}], "2"]]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"CC", "\[Rule]", 
            RowBox[{
             SuperscriptBox["Cx", "2"], "+", 
             SuperscriptBox["Cy", "2"], "+", 
             SuperscriptBox["Cz", "2"]}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"S1", "\[Rule]", "S"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IntWall", "=", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"IntegrateHalfGauss", "[", 
              RowBox[{"Cy", ",", 
               RowBox[{"IntegrateGauss", "[", 
                RowBox[{"Cz", ",", 
                 RowBox[{"IntegrateGauss", "[", 
                  RowBox[{"Cx", ",", 
                   RowBox[{
                   "IntWall", "\[LeftDoubleBracket]", "kk", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"kk", ",", "1", ",", 
               RowBox[{"Length", "[", "IntWall", "]"}]}], "}"}]}], "]"}]}], 
          "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"dummy", "\[Rule]", "0"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "remove", " ", "all", " ", "the", " ", "even", " ", "and", " ", "odd", 
        " ", 
        RowBox[{"correspondingly", "."}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["1", "\[Chi]1"], 
        RowBox[{"(", 
         RowBox[{"IntGas", "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"_", ",", "i"}], "]"}], "\[Rule]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "nn", ",", "2"}], "}"}]}], "]"}]}], 
         ")"}]}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntWall", "-", "IntGas"}], ")"}], "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"_", ",", "i"}], "]"}], "\[Rule]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nn", ",", "2"}], "}"}]}], "]"}]}], 
        ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.522136125915647*^9, 3.522136128177651*^9}, {
   3.5221366671273975`*^9, 3.5221367303543086`*^9}, {3.522136772505583*^9, 
   3.5221368129408536`*^9}, {3.522136855996929*^9, 3.522136877946168*^9}, {
   3.5279267049040594`*^9, 3.52792670509126*^9}, {3.535904872991056*^9, 
   3.5359048743170586`*^9}, {3.535905232150487*^9, 3.5359052326028876`*^9}, {
   3.535905890347843*^9, 3.5359058910498443`*^9}, 3.535906254202882*^9, {
   3.5359066057963*^9, 3.535906608682305*^9}, {3.535906721844904*^9, 
   3.535906727414113*^9}, {3.5360790915546856`*^9, 3.536079102786705*^9}, 
   3.5371186419506845`*^9, 3.537118818246594*^9, {3.5371202600187263`*^9, 
   3.537120274604752*^9}, 3.5371623416345267`*^9, {3.559013016590843*^9, 
   3.5590131033695583`*^9}, {3.559013167719194*^9, 3.5590131695151377`*^9}, 
   3.559013215991082*^9, {3.559013259860063*^9, 3.559013260115897*^9}, {
   3.559013306527426*^9, 3.559013366053358*^9}, {3.559013813567947*^9, 
   3.5590138311220083`*^9}, {3.5590138817515383`*^9, 3.559013903075638*^9}, {
   3.559013943386979*^9, 3.5590139995848207`*^9}, {3.559014038625557*^9, 
   3.5590140875689898`*^9}, {3.5590144977898493`*^9, 
   3.5590145004356403`*^9}, {3.559014532983191*^9, 3.5590145647906513`*^9}, {
   3.559014672094407*^9, 3.559014680226512*^9}, {3.559017397527574*^9, 
   3.559017404416193*^9}, {3.5590584347476883`*^9, 3.5590584415961*^9}, {
   3.5590584868049793`*^9, 3.5590585712947273`*^9}, {3.560422173792428*^9, 
   3.560422206880086*^9}, {3.560513564445539*^9, 3.560513567203951*^9}, {
   3.560680316615147*^9, 3.5606803173990393`*^9}, {3.560682059250248*^9, 
   3.560682065321464*^9}, {3.5611482348867626`*^9, 3.5611482557595987`*^9}, {
   3.5611804139986086`*^9, 3.5611804410178556`*^9}, {3.561183579476393*^9, 
   3.5611835861220045`*^9}, {3.561184166365024*^9, 3.561184177784244*^9}, {
   3.562049995972879*^9, 3.562050014569406*^9}, {3.5620502154330463`*^9, 
   3.562050217775414*^9}, {3.562050282304618*^9, 3.56205033313969*^9}, {
   3.562050482441646*^9, 3.5620505096512938`*^9}, {3.562050632025197*^9, 
   3.562050645605816*^9}, {3.562050767372925*^9, 3.5620507849908953`*^9}, {
   3.562050940330319*^9, 3.562050943056592*^9}, {3.562061357765729*^9, 
   3.5620613621705017`*^9}, {3.5622177745379033`*^9, 
   3.5622177768300343`*^9}, {3.562218992858142*^9, 3.5622189930241513`*^9}, {
   3.562219062783286*^9, 3.5622190792774873`*^9}, 3.5622279907234554`*^9, {
   3.562233972856528*^9, 3.5622339924496484`*^9}, {3.5622540605734115`*^9, 
   3.5622540741941905`*^9}, {3.562254362292669*^9, 3.562254460594291*^9}, {
   3.562254918258468*^9, 3.562254918532484*^9}, {3.562255912123314*^9, 
   3.5622559871566057`*^9}, {3.5622675962411413`*^9, 3.562267599326318*^9}, {
   3.562303294870167*^9, 3.5623033010597258`*^9}, {3.5635502700266953`*^9, 
   3.563550272993865*^9}, {3.563550319090502*^9, 3.5635503290900736`*^9}, {
   3.5635506220288286`*^9, 3.5635506430430307`*^9}, {3.563608143760601*^9, 
   3.5636081567313423`*^9}, 3.563608451056177*^9, {3.563608561011466*^9, 
   3.56360856632377*^9}, {3.5636086535007563`*^9, 3.563608660628164*^9}, {
   3.5641584509157667`*^9, 3.5641584900250354`*^9}, {3.5641588294036317`*^9, 
   3.564158832008836*^9}, {3.5641588664692965`*^9, 3.56415887960452*^9}, {
   3.564159061360439*^9, 3.56415906229644*^9}, {3.5641592856888328`*^9, 
   3.5641592890740385`*^9}, {3.5641603300204334`*^9, 3.564160347634182*^9}, {
   3.5641622070132027`*^9, 3.564162207502028*^9}, {3.678392005721882*^9, 
   3.678392037874076*^9}, {3.678392306990068*^9, 3.678392310777031*^9}, {
   3.678392454594054*^9, 3.678392525328938*^9}, {3.678393587211595*^9, 
   3.678393591739223*^9}, {3.678393631618043*^9, 3.678393645975238*^9}, {
   3.678393676679666*^9, 3.678393677225136*^9}, {3.6784314434990187`*^9, 
   3.678431536328682*^9}, {3.67843158814361*^9, 3.678431596277966*^9}, {
   3.678431637999795*^9, 3.678431682426057*^9}, {3.678431757247725*^9, 
   3.6784318017053957`*^9}, {3.6784319091421957`*^9, 3.678431953190564*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["R13 Boundary Conditions", "Subsection",
 CellChangeTimes->{{3.678963733758984*^9, 3.678963738325531*^9}, {
  3.678966730504191*^9, 3.678966734257338*^9}, {3.678994352432108*^9, 
  3.67899435695588*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"normal", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bcBuild1", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "}"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqn", "=", 
     RowBox[{
      RowBox[{"bc", "[", 
       RowBox[{"0", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "\[Rule]", "0"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]Wsol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"eqn", "\[Equal]", "0"}], ",", "\[Rho]W"}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\[Chi]1", " ", "=", " ", 
     FractionBox["2", 
      RowBox[{"2", "-", "\[Chi]"}]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bc1", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"5", "/", "2"}]], 
          RowBox[{"bc", "[", 
           RowBox[{"1", ",", "1", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "}"}]}], "]"}]}], "/.",
          "\[Rho]Wsol"}], "/.", "transfMoments2"}], "/.", "transfMoments"}], 
      "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"bc2", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"2", 
          SqrtBox[
           RowBox[{"3", "/", "2"}]], 
          RowBox[{"bc", "[", 
           RowBox[{"0", ",", "3", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "}"}]}], "]"}]}], "/.",
          "\[Rho]Wsol"}], "/.", "transfMoments2"}], "/.", "transfMoments"}], 
      "]"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"bc1Local", " ", "=", " ", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{"bc1", "/.", "varGlobalLocal"}], ",", "varLocal"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"bc2Local", " ", "=", " ", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{"bc2", "/.", "varGlobalLocal"}], ",", "varLocal"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.678963760240951*^9, 3.678963806036078*^9}, {
  3.6789667768634043`*^9, 3.6789667837819767`*^9}, {3.678966832378827*^9, 
  3.678966833177177*^9}, {3.678967727189939*^9, 3.6789677684009333`*^9}, {
  3.678967891165854*^9, 3.67896789165585*^9}, {3.6789679358493958`*^9, 
  3.6789679480363817`*^9}, {3.67896800651656*^9, 3.6789680127226267`*^9}, {
  3.678968134710946*^9, 3.678968136434082*^9}, {3.67897023542036*^9, 
  3.678970236631343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"5", " ", "Ryy"}], "28"]}], "-", 
  FractionBox["\[CapitalDelta]", "15"], "-", 
  RowBox[{"2", " ", "\[Theta]"}], "+", 
  RowBox[{"2", " ", "\[Theta]W"}], "-", 
  FractionBox["\[Sigma]yy", "2"], "-", 
  FractionBox[
   RowBox[{
    SqrtBox[
     FractionBox["\[Pi]", "2"]], " ", "qy"}], "\[Chi]1"]}]], "Output",
 CellChangeTimes->{
  3.678968137025979*^9, 3.6789702372341127`*^9, 3.678970589203196*^9, 
   3.678974326713447*^9, {3.678974468020219*^9, 3.6789744791519737`*^9}, 
   3.6789956463957863`*^9, 3.679223472337393*^9, 3.6798240248882008`*^9, 
   3.679824129978506*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["Ryy", "14"], "-", 
  FractionBox["\[CapitalDelta]", "75"], "-", 
  FractionBox[
   RowBox[{"2", " ", "\[Theta]"}], "5"], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Theta]W"}], "5"], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[Sigma]yy"}], "5"], "+", 
  FractionBox[
   RowBox[{"myyy", " ", 
    SqrtBox[
     FractionBox["\[Pi]", "2"]]}], "\[Chi]1"]}]], "Output",
 CellChangeTimes->{
  3.678968137025979*^9, 3.6789702372341127`*^9, 3.678970589203196*^9, 
   3.678974326713447*^9, {3.678974468020219*^9, 3.6789744791519737`*^9}, 
   3.6789956463957863`*^9, 3.679223472337393*^9, 3.6798240248882008`*^9, 
   3.679824130218361*^9}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGJBIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlT2p
4grvQ7WF647aM0CByJaTDyf7XbZX1tF6VDLpsn1RwyppS5n19vYT9hRrOD8m
2XyIqQ/g5sMAtdxPqvi3oEOx7BEX7Pf2PPvoqXjBntWFszp64gt7UwHfu9d2
XLRnj2YrfXHuqL3RKWP9dt9nJJsPAM5dwrs=
                "], {{0, 0}, {17, 1}}, {
                0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False, 
               FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["5", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "17", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGJBIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlT2p
4grvQ7WF647aM0CByJaTDyf7XbZX1tF6VDLpsn1RwyppS5n19vYT9hRrOD8m
2XyIqQ/g5sMAtdxPqvi3oEOx7BEX7Pf2PPvoqXjBntWFszp64gt7UwHfu9d2
XLRnj2YrfXHuqL3RKWP9dt9nJJsPAM5dwrs=
                "], {{0, 0}, {17, 1}}, {
                0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False, 
               FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["5", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "17", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.29411764705882354`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", "14", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "15"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "15", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["5", "28"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "2"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "8", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox[
                    SqrtBox[
                    FractionBox["\[Pi]", "2"]], "\[Chi]1"]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "5", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<5>, {17}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.678968137025979*^9, 3.6789702372341127`*^9, 3.678970589203196*^9, 
   3.678974326713447*^9, {3.678974468020219*^9, 3.6789744791519737`*^9}, 
   3.6789956463957863`*^9, 3.679223472337393*^9, 3.6798240248882008`*^9, 
   3.6798241302475233`*^9}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGJBIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlT2p
4tvmF73bn33JPmz5Vv9M3tX23P9UzfyYHtnv7DZw3bnlhf0N9+Xraqa9tT8Z
kfsv/ut7ks0nVZwBDB5AaQSglvnTj0R9eP7wgv011Vbr9zpn7MULg3kOr3tu
v6NiQv+q3Av2Nm52t7lX37NXN361rW/jG5LNBwBH/s1G
                "], {{0, 0}, {17,
                 1}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
               False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["5", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "17", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGJBIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlT2p
4tvmF73bn33JPmz5Vv9M3tX23P9UzfyYHtnv7DZw3bnlhf0N9+Xraqa9tT8Z
kfsv/ut7ks0nVZwBDB5AaQSglvnTj0R9eP7wgv011Vbr9zpn7MULg3kOr3tu
v6NiQv+q3Av2Nm52t7lX37NXN361rW/jG5LNBwBH/s1G
                "], {{0, 0}, {17,
                 1}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
               False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["5", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "17", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.29411764705882354`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", "10", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox[
                    SqrtBox[
                    FractionBox["\[Pi]", "2"]], "\[Chi]1"], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "14", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "75"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "15", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "14"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["2", "5"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "5", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["7", "5"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<5>, {17}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.678968137025979*^9, 3.6789702372341127`*^9, 3.678970589203196*^9, 
   3.678974326713447*^9, {3.678974468020219*^9, 3.6789744791519737`*^9}, 
   3.6789956463957863`*^9, 3.679223472337393*^9, 3.6798240248882008`*^9, 
   3.679824130274721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Null Space Fix", "Subsubsection",
 CellChangeTimes->{{3.6789743356405077`*^9, 3.678974338244499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffs", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Alpha]", "[", "ii", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "bc1Local", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc1LocalNew", " ", "=", " ", 
   RowBox[{"bc1Local", "*", "coeffs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc1LocalNew", ".", 
   RowBox[{"Transpose", "[", 
    RowBox[{"NullSpace", "[", "AxConventional", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc2LocalNew", " ", "=", " ", 
   RowBox[{"bc2Local", "*", "coeffs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bc2LocalNew", ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"NullSpace", "[", "AxConventional", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.678974351155839*^9, 3.67897438310415*^9}, {
  3.678974448870949*^9, 3.678974492484736*^9}, {3.678994377968158*^9, 
  3.678994379004056*^9}, {3.678994412438727*^9, 3.678994423700219*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[Alpha]", "[", "4", "]"}]}], "5"], "-", 
    FractionBox[
     RowBox[{"5", " ", 
      RowBox[{"\[Alpha]", "[", "15", "]"}]}], "28"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[Alpha]", "[", "4", "]"}]}], "15"], "-", 
    FractionBox[
     RowBox[{"\[Alpha]", "[", "14", "]"}], "15"]}], ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.678974359721829*^9, 3.678974383556583*^9}, {
   3.6789744493933*^9, 3.6789744929333553`*^9}, {3.678994366007431*^9, 
   3.678994379348772*^9}, 3.678994424290415*^9, {3.678995630151408*^9, 
   3.67899564925809*^9}, 3.679223473048256*^9, 3.679824025440794*^9, 
   3.6798241305320272`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[Alpha]", "[", "4", "]"}]}], "25"], "+", 
    FractionBox[
     RowBox[{"\[Alpha]", "[", "15", "]"}], "14"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"\[Alpha]", "[", "4", "]"}]}], "75"], "-", 
    FractionBox[
     RowBox[{"\[Alpha]", "[", "14", "]"}], "75"]}], ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.678974359721829*^9, 3.678974383556583*^9}, {
   3.6789744493933*^9, 3.6789744929333553`*^9}, {3.678994366007431*^9, 
   3.678994379348772*^9}, 3.678994424290415*^9, {3.678995630151408*^9, 
   3.67899564925809*^9}, 3.679223473048256*^9, 3.679824025440794*^9, 
   3.6798241305424833`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67899106522998*^9, 3.678991066820026*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Entropy Fix", "Subsubsection",
 CellChangeTimes->{{3.678970317734391*^9, 3.678970319271763*^9}, {
  3.679224143392902*^9, 3.679224145554833*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bc1LocalEntropy", " ", "=", " ", "bc1Local"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bc2LocalEntropy", " ", "=", " ", "bc2Local"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Boundary", " ", "Conditions", " ", "taken", " ", "from", " ", 
    RowBox[{"Anirudh", "'"}], "s", " ", "paper"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bc1LocalEntropy", "[", 
    RowBox[{"[", 
     RowBox[{"-", "4"}], "]"}], "]"}], "=", 
   RowBox[{"2", "*", 
    RowBox[{"bc1Local", "[", 
     RowBox[{"[", 
      RowBox[{"-", "4"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bc1LocalEntropy", "[", 
     RowBox[{"[", 
      RowBox[{"-", "3"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", "2"}], "/", "5"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bc2LocalEntropy", "[", 
    RowBox[{"[", 
     RowBox[{"-", "4"}], "]"}], "]"}], "=", 
   RowBox[{"2", "*", 
    RowBox[{"bc2Local", "[", 
     RowBox[{"[", 
      RowBox[{"-", "4"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bc2LocalEntropy", "[", 
    RowBox[{"[", 
     RowBox[{"-", "3"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], "/", "25"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678970323502389*^9, 3.678970373453808*^9}, {
   3.678970413387218*^9, 3.6789704484984913`*^9}, {3.6789705638441477`*^9, 
   3.678970575525234*^9}, {3.67897428702739*^9, 3.678974303306705*^9}, 
   3.678974346020979*^9, {3.678995725718225*^9, 3.678995793415434*^9}, 
   3.678995914947707*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bc1LocalEntropy", ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"NullSpace", "[", "AxConventional", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bc2LocalEntropy", ".", 
  RowBox[{"Transpose", "[", 
   RowBox[{"NullSpace", "[", "AxConventional", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.678970279064085*^9, 3.678970305771284*^9}, {
  3.678970461508453*^9, 3.678970467846624*^9}, {3.678995733787848*^9, 
  3.6789957347788677`*^9}, {3.67899577102017*^9, 3.678995772697425*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6789704708140917`*^9, {3.678970570081786*^9, 3.67897059980173*^9}, 
   3.678994442554757*^9, 3.678995800496181*^9, 3.6789959173207607`*^9, 
   3.6792234731456137`*^9, 3.67982402551495*^9, 3.67982413061569*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6789704708140917`*^9, {3.678970570081786*^9, 3.67897059980173*^9}, 
   3.678994442554757*^9, 3.678995800496181*^9, 3.6789959173207607`*^9, 
   3.6792234731456137`*^9, 3.67982402551495*^9, 3.679824130622884*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bc1Local", ".", "varLocal"}]], "Input",
 CellChangeTimes->{{3.678970504830028*^9, 3.6789705598904753`*^9}, {
  3.678970618661998*^9, 3.678970628117983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"5", " ", "Rnn"}], "28"]}], "-", 
  FractionBox["\[CapitalDelta]", "15"], "-", 
  RowBox[{"2", " ", "\[Theta]"}], "-", 
  FractionBox["\[Sigma]nn", "2"], "-", 
  FractionBox[
   RowBox[{
    SqrtBox[
     FractionBox["\[Pi]", "2"]], " ", "qn"}], "\[Chi]1"]}]], "Output",
 CellChangeTimes->{{3.6789705098466673`*^9, 3.678970515979312*^9}, {
   3.678970554487561*^9, 3.6789705601872883`*^9}, 3.678970628723352*^9, 
   3.679223473202138*^9, 3.6798240255718927`*^9, 3.67982413066593*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rough Wok", "Title",
 CellChangeTimes->{{3.678991074719153*^9, 3.678991082679616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "Ax", "]"}]], "Input",
 CellChangeTimes->{{3.679817427302238*^9, 3.679817438119019*^9}, {
  3.679818149257429*^9, 3.679818181047433*^9}}],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{{3.679817431182251*^9, 3.679817438466399*^9}, {
  3.679818154604698*^9, 3.679818181598118*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"B26Stable", ".", "var26"}], "+", "g26"}], ")"}], "*", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", 
       SqrtBox["5"], ",", 
       RowBox[{"2", 
        SqrtBox["3"]}], ",", 
       RowBox[{"2", 
        SqrtBox["3"]}], ",", 
       RowBox[{"4", 
        SqrtBox[
         FractionBox["7", "2"]]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"MappingToConventional", "[", "8", "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6798267701661453`*^9, 3.679826812985551*^9}, {
  3.679826846294725*^9, 3.679826891693562*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"vx"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "mxxy"}], "7"], "+", 
        FractionBox["qy", "5"], "+", "vy", "+", 
        RowBox[{
         SqrtBox[
          FractionBox["\[Pi]", "2"]], " ", "\[Sigma]xy"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           FractionBox["\[Pi]", "2"]]}], " ", "qx"}], "-", 
        FractionBox[
         RowBox[{"5", " ", "Rxx"}], "14"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[CapitalDelta]"}], "15"], "-", 
        RowBox[{"2", " ", "\[Theta]"}], "+", 
        RowBox[{"2", " ", "\[Theta]W"}], "-", 
        FractionBox["\[Sigma]xx", "2"]}]},
      {
       RowBox[{
        RowBox[{"mxxx", " ", 
         SqrtBox[
          FractionBox["\[Pi]", "2"]]}], "+", 
        FractionBox["Rxx", "7"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[CapitalDelta]"}], "75"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[Theta]"}], "5"], "+", 
        FractionBox[
         RowBox[{"2", " ", "\[Theta]W"}], "5"], "+", 
        FractionBox[
         RowBox[{"7", " ", "\[Sigma]xx"}], "5"]}]},
      {
       RowBox[{
        RowBox[{"mxyy", " ", 
         SqrtBox[
          FractionBox["\[Pi]", "2"]]}], "+", 
        FractionBox["Ryy", "7"], "+", 
        FractionBox["\[CapitalDelta]", "75"], "+", 
        FractionBox["\[Theta]", "5"], "-", 
        FractionBox["\[Theta]W", "5"], "-", 
        FractionBox["\[Sigma]xx", "5"], "+", "\[Sigma]yy"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"6", " ", "mxxy"}], "7"]}], "-", 
        FractionBox[
         RowBox[{"11", " ", "qy"}], "5"], "-", 
        RowBox[{
         SqrtBox[
          FractionBox["\[Pi]", "2"]], " ", "Rxy"}], "+", "vy"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.679826789323577*^9, 3.679826813262682*^9}, {
   3.67982684758565*^9, 3.679826858586075*^9}, 3.679826893165414*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6798270250458403`*^9, 3.6798270285502653`*^9}}]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{-28, Automatic}, {Automatic, 37}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 103, 1, 64, "Section"],
Cell[686, 25, 141, 3, 28, "Input"],
Cell[830, 30, 528, 12, 87, "Text"],
Cell[1361, 44, 28245, 726, 2589, "Input"],
Cell[29609, 772, 4572, 112, 303, "Input"],
Cell[34184, 886, 1495, 39, 114, "Input"],
Cell[CellGroupData[{
Cell[35704, 929, 566, 15, 46, "Input"],
Cell[36273, 946, 3930, 120, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40240, 1071, 648, 16, 28, "Input"],
Cell[40891, 1089, 1833, 55, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42761, 1149, 884, 19, 28, "Input"],
Cell[43648, 1170, 841, 17, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44526, 1192, 472, 13, 46, "Input"],
Cell[45001, 1207, 476, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45514, 1222, 1206, 29, 114, "Input"],
Cell[46723, 1253, 495, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47255, 1270, 1391, 34, 114, "Input"],
Cell[48649, 1306, 606, 14, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[49304, 1326, 40, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[49369, 1330, 104, 1, 44, "Subsection"],
Cell[49476, 1333, 31939, 784, 2690, "Input"],
Cell[CellGroupData[{
Cell[81440, 2121, 1984, 49, 131, "Input"],
Cell[CellGroupData[{
Cell[83449, 2174, 899, 15, 22, "Print"],
Cell[84351, 2191, 1423, 34, 38, "Print"],
Cell[85777, 2227, 782, 13, 21, "Print"],
Cell[86562, 2242, 784, 13, 21, "Print"],
Cell[87349, 2257, 782, 13, 21, "Print"],
Cell[88134, 2272, 826, 14, 21, "Print"]
}, Open  ]],
Cell[88975, 2289, 6359, 169, 694, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95371, 2463, 219, 3, 28, "Input"],
Cell[95593, 2468, 1660, 41, 63, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97302, 2515, 113, 1, 36, "Subsection"],
Cell[97418, 2518, 9869, 268, 730, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107324, 2791, 126, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[107475, 2796, 2071, 48, 131, "Input"],
Cell[109549, 2846, 189, 3, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109787, 2855, 109, 1, 36, "Subsection"],
Cell[109899, 2858, 9766, 260, 889, "Input"],
Cell[CellGroupData[{
Cell[119690, 3122, 1107, 27, 118, "Input"],
Cell[120800, 3151, 6338, 195, 438, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127175, 3351, 137, 2, 28, "Input"],
Cell[127315, 3355, 142, 2, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127518, 3364, 114, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[127657, 3369, 161, 2, 44, "Subsection"],
Cell[127821, 3373, 10722, 285, 854, "Input"],
Cell[138546, 3660, 17159, 418, 1211, "Input"],
Cell[155708, 4080, 220, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[155953, 4088, 628, 16, 35, "Input"],
Cell[156584, 4106, 21004, 631, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177625, 4742, 307, 5, 28, "Input"],
Cell[177935, 4749, 9217, 291, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[187201, 5046, 106, 1, 36, "Subsection"],
Cell[187310, 5049, 29964, 751, 2347, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[217311, 5805, 208, 3, 36, "Subsection"],
Cell[CellGroupData[{
Cell[217544, 5812, 3157, 84, 321, "Input"],
Cell[220704, 5898, 644, 17, 59, "Output"],
Cell[221351, 5917, 670, 18, 59, "Output"],
Cell[222024, 5937, 9990, 204, 64, "Output"],
Cell[232017, 6143, 9936, 202, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241990, 6350, 107, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[242122, 6355, 1083, 26, 114, "Input"],
Cell[243208, 6383, 793, 21, 48, "Output"],
Cell[244004, 6406, 767, 20, 48, "Output"]
}, Open  ]],
Cell[244786, 6429, 91, 1, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[244914, 6435, 151, 2, 29, "Subsubsection"],
Cell[245068, 6439, 1714, 50, 165, "Input"],
Cell[CellGroupData[{
Cell[246807, 6493, 516, 10, 46, "Input"],
Cell[247326, 6505, 337, 6, 28, "Output"],
Cell[247666, 6513, 338, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248041, 6524, 180, 3, 28, "Input"],
Cell[248224, 6529, 551, 14, 59, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248848, 6551, 92, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[248965, 6556, 175, 3, 28, "Input"],
Cell[249143, 6561, 143, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249323, 6568, 667, 21, 76, "Input"],
Cell[249993, 6591, 2534, 75, 180, "Output"]
}, Open  ]],
Cell[252542, 6669, 96, 1, 28, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
