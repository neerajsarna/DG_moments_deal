(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    247031,       6399]
NotebookOptionsPosition[    240057,       6172]
NotebookOutlinePosition[    240415,       6188]
CellTagsIndexPosition[    240372,       6185]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tensor Definitions", "Section",
 CellChangeTimes->{{3.569139429210832*^9, 3.569139448895958*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.679830152585128*^9}],

Cell["\<\
Mathematica build-in function like \[OpenCurlyQuote]Symmetrize[]\
\[CloseCurlyQuote] and \[OpenCurlyQuote]TensorContract[]\[CloseCurlyQuote] \
seem 
to work really slow or fail due to memory requirements on fully symmetric \
tensors 
with degree >10.
We define our own functions below based on a simply array data structure for \
fully symmetric tensors.\
\>", "Text",
 CellChangeTimes->{{3.5691393015045276`*^9, 3.5691394253246098`*^9}, {
  3.569230437595318*^9, 3.569230461117482*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "n", ",", "degree", ",", "idx", ",", "idx1", ",", "A", ",", "b", ",", "id3",
    ",", "IDX"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "TensorDegree", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Every", " ", "symmetric", " ", "tensor", " ", "can", " ", "be", " ", 
     "identified", " ", "with", " ", "the", " ", "help", " ", "of", " ", "a", 
     " ", "2", "D", " ", "array", " ", "say", " ", 
     RowBox[{
      RowBox[{"a", "[", "N", "]"}], "[", "3", "]"}], " ", "where", " ", "N", 
     " ", "is", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "indepedent", " ", "variables", " ", "it", " ", 
     RowBox[{"has", ".", " ", "So"}], " ", "every", " ", "row", " ", "ie", 
     " ", 
     RowBox[{"a", "[", "i", "]"}], " ", "store", " ", "the", " ", "number", 
     " ", "of", " ", "entries", " ", "for", " ", "x", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}]}], ",", 
    RowBox[{"for", " ", "y", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}], " ", "and", " ", "for", 
     " ", "z", " ", "in", " ", 
     RowBox[{
      RowBox[{"a", "[", "i", "]"}], "[", "3", "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", "ii"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "the", " ", "same", " ", "thing", " ", "as", " ", "IDXFull", 
    " ", "but", " ", "for", " ", "trace", " ", "free", " ", "tensors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDXtrfFull", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "-", "ii"}], ",", 
           RowBox[{"ii", "-", "jj"}], ",", "jj"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"ii", ",", "1"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"IDX", "[", "degree", "]"}], "=", 
      RowBox[{"IDXFull", "[", "degree", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDXtrf", "[", "degree", "]"}], "=", 
      RowBox[{"IDXtrfFull", "[", "degree", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"degree", ",", "0", ",", "40"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"given", " ", "an", " ", "array", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "counts", " ", "the", " ", 
     "number", " ", "of", " ", "1", "s"}], ",", " ", 
    RowBox[{"2", "s", " ", "and", " ", "3", "s"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX1", "[", "list_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Input", " ", "cartesean", " ", "indices"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "2", ",", "1", ",", "3"}], "}"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "Total", " ", "of", " ", "the", " ", "list", " ", "is", " ", 
     "the", " ", "tensorial", " ", "degree", " ", "we", " ", "are", " ", 
     "interested", " ", 
     RowBox[{"in", ".", " ", "So"}], " ", "list", " ", "should", " ", "be", 
     " ", "a", " ", "3", "X1", " ", "array", " ", "and", " ", "the", " ", 
     "following", " ", "function", " ", "will", " ", "give", " ", "us", " ", 
     "the", " ", "n", " ", "corresponding", " ", "to", " ", "which", " ", 
     RowBox[{"a", "[", "n", "]"}]}], " ", "=", " ", 
    RowBox[{"list", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX2", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDX", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", "trace", " ",
     "free", " ", "tensors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toIDX3", "[", "list_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"IDXtrfFull", "[", 
       RowBox[{"Total", "[", "list", "]"}], "]"}], ",", "list"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Input", " ", "triple", " ", "of", " ", "#", "indices", " ", "in", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "tensor", " ", "degree", " ", "of", " ", "a", 
    " ", "symmetric", " ", 
    RowBox[{"tensor", ".", "\[IndentingNewLine]", 
     RowBox[{"CAUTION", ":", " ", 
      RowBox[{
      "the", " ", "formulae", " ", "is", " ", "not", " ", "valid", " ", "for",
        " ", "trace", " ", "free", " ", 
       RowBox[{"tensors", "."}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorDegree", "[", "A_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"8", " ", 
         RowBox[{"Length", "[", "A", "]"}]}]}]]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"id3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaValues", "[", "list_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"b", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ",", 
        RowBox[{"c", "=", 
         RowBox[{
         "list", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OddQ", "[", "a", "]"}], "||", 
         RowBox[{"OddQ", "[", "b", "]"}], "||", 
         RowBox[{"OddQ", "[", "c", "]"}]}], ",", "0", ",", 
        FractionBox[
         RowBox[{"Multinomial", "[", 
          RowBox[{
           FractionBox["a", "2"], ",", 
           FractionBox["b", "2"], ",", 
           FractionBox["c", "2"]}], "]"}], 
         RowBox[{"Multinomial", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "applied", " ", "deltavalues", " ", "to", " ", "all", " ", "the", " ", 
    "components", " ", "of", " ", "an", " ", "even", " ", "degree", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeltaTensor2", "[", 
     RowBox[{"degree_", "?", "EvenQ"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"DeltaValues", ",", 
      RowBox[{"IDX", "[", "degree", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"What", " ", "does", " ", "this", " ", 
    RowBox[{"do", "?"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTrace2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX2", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IDX", "[", 
                   RowBox[{"degree", "-", "2"}], "]"}], 
                  "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTraces", "[", 
     RowBox[{"A_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", "=", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"SymTrace2", "[", "res", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Assumes", " ", "3", " ", 
     RowBox[{"dimensions", ".", " ", "And"}], " ", "so"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contraction", " ", "of", " ", "a", " ", "symmetric", " ", "tensor", " ", 
    "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymDot2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "-", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Lets", " ", "take", " ", "a", " ", "particular", " ", "term", " ",
             "say", " ", "Ai1i2"}], ".."}], 
          RowBox[{"xbx", ".", " ", "In"}], " ", "the", " ", "result", " ", 
          "only", " ", "those", " ", "components", " ", "will", " ", "appear",
           " ", "in", " ", "which", " ", "x", " ", "atleast", " ", "appears", 
          " ", "once", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "why", " ", "the", " ", "addition",
           " ", "of", " ", 
          RowBox[{"id3", "[", 
           RowBox[{"[", "iis", "]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"toIDX2", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IDX", "[", 
                    RowBox[{"degree", "-", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
                  "+", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], "]"}], 
                "\[RightDoubleBracket]"}], 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "format", " ", "of", " ", "the", " ", "input", " ",
      "is", " ", "IDX"}], ",", " ", 
    RowBox[{
    "then", " ", "the", " ", "output", " ", "is", " ", "also", " ", "in", " ",
      "IDX"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "full", " ", "contraction", " ", "of", " ", "two", " ", "symmetric", " ", 
     "tensors", " ", "A"}], ",", " ", 
    RowBox[{"B", " ", "with", " ", "same", " ", "degree"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymFullDot", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TensorDegree", "[", "B", "]"}], "\[NotEqual]", "degree"}], 
         ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"idx", "=", 
           RowBox[{
            RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", "jj",
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "+=", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
              "]"}], 
            RowBox[{
            "A", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
            RowBox[{
            "B", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["b", "i"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProduct2", "[", 
     RowBox[{"A_", ",", 
      RowBox[{"b_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"degree", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "b"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"degree", "+", "1"}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "1"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "b", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "symmetric", " ", "tensor", " ", "product", " ", "of", " ", "a", " ", 
    "symmetric", " ", "tensor", " ", "A", " ", "with", " ", 
    SubscriptBox["\[Delta]", "ij"]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymProductDelta2", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", 
          RowBox[{"degree", "+", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"degree", "+", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"degree", "+", "1"}], ")"}]}]], 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"idx", "=", 
                    RowBox[{
                    RowBox[{"IDX", "[", 
                    RowBox[{"degree", "+", "2"}], "]"}], 
                    "\[LeftDoubleBracket]", "jj", "\[RightDoubleBracket]"}]}],
                    ")"}], "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "\[GreaterEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}], 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"toIDX2", "[", 
                   RowBox[{"idx", "-", 
                    RowBox[{"2", 
                    RowBox[{
                    "id3", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], 
                  "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "converts", " ", "a", " ", "symmetric", " ", "tensor", " ", "into", " ", 
    "a", " ", "trace", " ", "free", " ", "tensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "returns", " ", "the", " ", "tracefree", " ", "part", " ", "of", " ", "a",
      " ", "symmetric", " ", "tensor"}], ",", " ", 
    RowBox[{"but", " ", "with", " ", "all", " ", "components"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymTracefree", "[", "A_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", "3"}], ",", "idx", ",", "idx1", ",", 
       RowBox[{"degree", "=", 
        RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length", ",", "res", 
       ",", "trace", ",", "res1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"trace", "=", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"res1", "=", 
          RowBox[{"trace", "=", 
           RowBox[{"SymTrace2", "[", "trace", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"res1", "=", 
            RowBox[{"SymProductDelta2", "[", "res1", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ll", ",", "1", ",", "kk"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "kk"], 
               RowBox[{"degree", "!"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"degree", "-", 
                  RowBox[{"2", "kk"}]}], ")"}], "!"}], 
               SuperscriptBox["2", "kk"], 
               RowBox[{"kk", "!"}]}]], 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"jj", "=", 
                RowBox[{"degree", "-", "kk"}]}], 
               RowBox[{"degree", "-", "1"}]], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", "jj"}], "+", "1"}]]}]}], ")"}], "res1"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"degree", "/", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5977647060562134`*^9, 3.5977647268750763`*^9}, {
   3.597764982828605*^9, 3.5977649884363317`*^9}, {3.676179501293851*^9, 
   3.6761796856337767`*^9}, {3.676179724780055*^9, 3.6761797401819553`*^9}, {
   3.6761800693011913`*^9, 3.67618009071702*^9}, {3.67618055987227*^9, 
   3.676180688136693*^9}, {3.676180727497422*^9, 3.676180773976479*^9}, {
   3.676181010436315*^9, 3.676181034457363*^9}, {3.676182895833144*^9, 
   3.676182910871441*^9}, {3.676183029280117*^9, 3.676183040299528*^9}, {
   3.676183109751354*^9, 3.676183133647092*^9}, {3.676184105172339*^9, 
   3.676184107563058*^9}, {3.676184447780569*^9, 3.676184559506366*^9}, 
   3.676184625341688*^9, {3.6761850010521708`*^9, 3.676185035780895*^9}, {
   3.6763163148181763`*^9, 3.676316347073567*^9}, {3.676316864163743*^9, 
   3.676316876694518*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trfEvaluate", "[", 
     RowBox[{"A_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "m", ",", 
        RowBox[{"dim", "=", "3"}], ",", 
        RowBox[{"degree", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", 
          "2"}]}], ",", "length", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "list"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Floor", "[", 
         RowBox[{"c", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"toIDX3", "[", "list", "]"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Binomial", "[", 
               RowBox[{"m", ",", "i"}], "]"}], 
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"toIDX3", "[", 
                RowBox[{"list", "+", 
                 RowBox[{"2", "i", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "i"}], ")"}], " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"2", "m", " ", 
                  RowBox[{
                  "id3", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "say", " ", "we", " ", "have", " ", "a", " ", "trace", " ", "free", " ", 
     "tensor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "whose", " ", "independent", " ", "components", " ", "are", " ", "given",
       " ", "then", " ", "the", " ", "following", " ", "function", " ", 
      "will", " ", "introduce", " ", "those", " ", "components", " ", "in", 
      " ", "the", " ", "list", " ", "which", " ", "have", " ", "been", " ", 
      "negelected", " ", "due", " ", "to", " ", "the", " ", "trace", " ", 
      "free", " ", "nature", " ", "of", " ", "the", " ", 
      RowBox[{"tensor", ".", " ", "For"}], " ", 
      RowBox[{"eg", ".", " ", "it"}], " ", "will", " ", "introduce"}], " ", 
     "-", "Rxx", "-", 
     RowBox[{
     "Ryy", " ", "for", " ", "a", " ", "second", " ", "order", " ", 
      "tensor"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trf2sym", "[", "A_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"trfEvaluate", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "&"}], ",", 
       "#"}], "]"}], "&"}], ",", 
    RowBox[{"IDX", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", "A", "]"}], "-", "1"}], ")"}], "/", "2"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.592214156581615*^9, 3.5922142269069633`*^9}, {
  3.592214273648*^9, 3.592214321643592*^9}, {3.592214562691799*^9, 
  3.5922146307578783`*^9}, {3.5922150087114487`*^9, 3.5922151927530117`*^9}, {
  3.592215226866392*^9, 3.592215227208199*^9}, {3.5922152622517147`*^9, 
  3.592215315308941*^9}, {3.592215349687686*^9, 3.592215358801886*^9}, {
  3.59221558179191*^9, 3.592215608488448*^9}, {3.592215669267857*^9, 
  3.592215699095985*^9}, {3.676315905534268*^9, 3.676315915972599*^9}, {
  3.6763161617740183`*^9, 3.676316190517806*^9}, {3.67631623272976*^9, 
  3.676316302687489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymTensorForm", "[", "A_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"degree", "=", 
         RowBox[{"TensorDegree", "[", "A", "]"}]}], ",", "length"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"IDX", "[", "degree", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", 
               RowBox[{
               "A", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}]}],
               "}"}], "&"}], ",", 
            RowBox[{
             RowBox[{"IDX", "[", "degree", "]"}], "\[LeftDoubleBracket]", 
             "ii", "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "length"}], "}"}]}], "]"}], "//", 
        "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.59211253078022*^9, 3.592112545437512*^9}, {
   3.5921125805422792`*^9, 3.5921127616337748`*^9}, {3.592112796427103*^9, 
   3.5921128146670732`*^9}, 3.597764731152925*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymProductDelta2", "[", 
  RowBox[{"SymProductDelta2", "[", 
   RowBox[{"SymProductDelta2", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
        "]"}], "&"}], ",", 
      RowBox[{"IDX", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516209179254*^9, 3.591516237845764*^9}, {
  3.591516279723213*^9, 3.591516319002157*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["3", "35"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "7"], " ", 
    RowBox[{"A", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675954441912649*^9, 3.676179291151037*^9, 
  3.6762888609657383`*^9, 3.6763161356528177`*^9, 3.6779058949079237`*^9, 
  3.678529868398068*^9, 3.679117967252459*^9, 3.679300777736515*^9, 
  3.679829690468359*^9, 3.679830155649837*^9, 3.679914562950115*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "2", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591517786313066*^9, 3.5915178359472446`*^9}, {
  3.591517885949567*^9, 3.591517930610208*^9}, {3.5977650183992825`*^9, 
  3.597765018845586*^9}, {3.676316092317675*^9, 3.6763161065616913`*^9}, {
  3.676316140175808*^9, 3.676316140772443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "3"]}], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}], ",", 
   RowBox[{"A", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954441957636*^9, 3.6761792911794147`*^9, 3.676288861012822*^9, {
   3.676316093569808*^9, 3.676316107287977*^9}, {3.676316137581958*^9, 
   3.6763161413544827`*^9}, 3.677905894933*^9, 3.678529868437419*^9, 
   3.679117967277781*^9, 3.679300777774482*^9, 3.679829690502551*^9, 
   3.679830155669004*^9, 3.679914562991309*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymTracefree", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "+", 
          RowBox[{"2.", "#2"}], "-", 
          RowBox[{"3", "#3"}]}], "&"}], ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"IDX", "[", "4", "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591516796847253*^9, 3.591516813094841*^9}, {
   3.5915174393368073`*^9, 3.5915174614075623`*^9}, {3.59151750012652*^9, 
   3.59151776014233*^9}, {3.591517814794807*^9, 3.5915178185262527`*^9}, {
   3.591517860691409*^9, 3.5915178802347727`*^9}, 3.591518123963479*^9, {
   3.5915182744621964`*^9, 3.591518302569395*^9}, {3.591526482595047*^9, 
   3.5915265043240232`*^9}, {3.591611217481101*^9, 3.591611231450076*^9}, {
   3.597765011088415*^9, 3.5977650116257725`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1428571428571423`"}], ",", "1.1428571428571432`", ",", 
   "2.571428571428571`", ",", "3.428571428571429`", ",", 
   "1.4285714285714286`", ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", "3.1428571428571432`", ",", 
   "2.857142857142857`", ",", 
   RowBox[{"-", "4.285714285714286`"}], ",", 
   RowBox[{"-", "5.428571428571429`"}], ",", 
   RowBox[{"-", "2.2857142857142847`"}], ",", "4.285714285714286`", ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "5.714285714285714`"}], ",", "3.428571428571427`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675954442007567*^9, 3.67617929122402*^9, 
  3.676288861058632*^9, 3.677905894982387*^9, 3.678529868487091*^9, 
  3.679117967319182*^9, 3.679300777807352*^9, 3.679829690534746*^9, 
  3.6798301556995277`*^9, 3.679914563030772*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"SymFullDot", "[", 
   RowBox[{
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], "}"}], 
      "]"}], "]"}], ",", 
    RowBox[{"SymTracefree", "[", 
     RowBox[{"trf2sym", "[", 
      RowBox[{"{", 
       RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], "}"}], 
      "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Rxx", " ", "Sxx"}], "+", 
  RowBox[{"Ryy", " ", "Sxx"}], "+", 
  RowBox[{"2", " ", "Rxy", " ", "Sxy"}], "+", 
  RowBox[{"Rxx", " ", "Syy"}], "+", 
  RowBox[{"2", " ", "Ryy", " ", "Syy"}]}]], "Output",
 CellChangeTimes->{3.675954442064178*^9, 3.676179291269311*^9, 
  3.676288861096998*^9, 3.6779058950315104`*^9, 3.6785298685371113`*^9, 
  3.679117967356577*^9, 3.67930077784163*^9, 3.679829690557966*^9, 
  3.679830155718549*^9, 3.679914563079667*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Rxx", ",", "Rxy", ",", "0", ",", "Ryy", ",", "0"}], 
               "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{"Sxx", ",", "Sxy", ",", "0", ",", "Syy", ",", "0"}], 
               "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Rxx", ",", "Rxy", ",", "Ryy"}], "}"}]}], "]"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Sxx", ",", "Sxy", ",", "Syy"}], "}"}]}], "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759544421144657`*^9, 3.676179291324445*^9, 
  3.676288861145307*^9, 3.6779058950810213`*^9, 3.678529868586431*^9, 
  3.679117967407839*^9, 3.679300777873829*^9, 3.6798296906019287`*^9, 
  3.679830155748868*^9, 3.6799145631130543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"SymFullDot", "[", 
           RowBox[{
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "mxxx", ",", "mxxy", ",", "0", ",", "mxyy", ",", "0", ",", 
                "myyy", ",", "0"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"SymTracefree", "[", 
             RowBox[{"trf2sym", "[", 
              RowBox[{"{", 
               RowBox[{
               "nxxx", ",", "nxxy", ",", "0", ",", "nxyy", ",", "0", ",", 
                "nyyy", ",", "0"}], "}"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"mxxx", ",", "mxxy", ",", "mxyy", ",", "myyy"}], "}"}]}], 
        "]"}], "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"nxxx", ",", "nxxy", ",", "nxyy", ",", "nyyy"}], "}"}]}], "]"}],
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.656604952688126*^9, 3.656605038854427*^9}, {
  3.656605091139191*^9, 3.6566052689034147`*^9}, {3.656607710425463*^9, 
  3.656607745128602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759544421633577`*^9, 3.676179291374331*^9, 
  3.6762888611958103`*^9, 3.6779058951312113`*^9, 3.6785298686374598`*^9, 
  3.679117967455283*^9, 3.679300777897785*^9, 3.679829690634919*^9, 
  3.679830155768948*^9, 3.679914563142716*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equations Definitions", "Section"],

Cell[CellGroupData[{

Cell["core routines", "Subsection",
 CellChangeTimes->{{3.6799177602505407`*^9, 3.679917768068754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ref", " ", "to", " ", "manuels", " ", "paper", " ", "on", " ", "fluxes", 
    " ", "for", " ", "large", " ", "moment", " ", "system", " ", "for", " ", 
    "a", " ", "detailed", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "tensorial", " ", "degree", " ", "including", " ", 
    "traces"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"iFullDegree", "[", "i_", "]"}], "=", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"4", "i"}], "-", "3"}]], "-", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"number", " ", "of", " ", "traces", " ", 
     RowBox[{"C", "^", "2"}], " ", "has", " ", "one", " ", "trace"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTraces", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"iFullDegree", "[", "i", "]"}]}]}], ")"}], "2"], "]"}], 
      "-", "i"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "tensorial", " ", "degree"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iTensorDegree", "[", "i_", "]"}], "=", 
     RowBox[{
      RowBox[{"iFullDegree", "[", "i", "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"iTraces", "[", "i", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ii", "[", 
      RowBox[{"s_", ",", "A_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"A", "+", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{"A", "+", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"s", "+", "1"}], ")"}]}], "-", 
         RowBox[{"Floor", "[", 
          FractionBox[
           RowBox[{"A", "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"s", "+", "1"}], ")"}]}]}], "2"], "]"}]}], ")"}]}], "-",
       "s"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "i", " ", "is", " ", "as", " ", "defined", " ", "in", " ", "the", " ", 
     "reference"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables2D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"iTensorDegree", "[", "i", "]"}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfVariables3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumberOfFullTensors3D", "[", "ntensors_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"iFullDegree", "[", "ntensors", "]"}]}], ",", "frac"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"m", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"m", "+", "3"}], ")"}]}], "6."], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", 
               RowBox[{"iTensorDegree", "[", "i", "]"}]}], "+", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ntensors"}], "}"}]}], "]"}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}], "2"], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varName", "[", 
     RowBox[{"s_", ",", "ix_", ",", "iy_", ",", "iz_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<\[Rho]\>\"", ",", 
      RowBox[{"ToString", "[", "s", "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<x\>\"", ",", "ix"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<y\>\"", ",", "iy"}], "]"}], ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\<z\>\"", ",", "iz"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "not", " ", "the", " ", "norm", " ", "of", " ", 
      "\[Psi]"}], ",", " ", 
     RowBox[{"rather", " ", 
      RowBox[{"it", "'"}], "s", " ", "the", " ", "norm", " ", "of", " ", 
      "the", " ", "laguerre", " ", "polynomials"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm\[Psi]", "[", 
      RowBox[{"a_", ",", "deg_"}], "]"}], "=", 
     FractionBox[
      RowBox[{
       RowBox[{"deg", "!"}], 
       RowBox[{"a", "!"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"deg", "+", "a", "+", 
         RowBox[{"3", "/", "2"}]}], "]"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"deg", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "given", " ", "a", " ", "tensor", " ", "W", " ", "extract", " ", "all", 
     " ", "the", " ", "independed", " ", "components", " ", "in", " ", "2", 
     "D", " ", "in", " ", "case", " ", "of", " ", "trace", " ", "free", " ", 
     "situation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfComponents2D", "[", "W_", "]"}], ":=", 
    RowBox[{"Extract", "[", 
     RowBox[{"W", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"IDX", "[", 
             RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", "#"}], 
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "&"}], ",", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"IDXtrf", "[", 
           RowBox[{"TensorDegree", "[", "W", "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"TensorDegree", "[", "W", "]"}]}], "}"}]}], "]"}]}], 
            "]"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trfVar2D", "[", 
     RowBox[{"deg_", ",", "name_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"name", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"deg", "+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"From2Dto3D", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "list", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "list", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Given", " ", "the", " ", "components", " ", "of", " ", "a", " ", 
        "tensor", " ", "represented", " ", "by", " ", "B"}], ",", " ", 
       RowBox[{
        RowBox[{
        "then", " ", "tmp", " ", "collects", " ", "the", " ", "terms", " ", 
         "corresponding", " ", 
         RowBox[{"to", " ", "\\", "partial_x"}], " ", 
         RowBox[{"in", " ", "\\", "partial_"}]}], "<", 
        RowBox[{"x_", 
         RowBox[{"{", "in", "}"}], " ", "w_", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i1", ".."}], "in"}], ">"}], "}"}], "\[IndentingNewLine]",
          "the", " ", "second", " ", "one", " ", "does", " ", "the", " ", 
         "same", " ", "job", " ", "but", " ", "for", " ", "a", " ", "tensor", 
         " ", 
         RowBox[{"product", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymDot2", "[", 
              RowBox[{
               RowBox[{"trf2sym", "[", 
                RowBox[{"From2Dto3D", "[", 
                 RowBox[{"trfVar2D", "[", 
                  RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficient", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R1", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "above", " ", "but", " ", "for", " ", 
         "tensor", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{
            RowBox[{"trfComponents2D", "[", 
             RowBox[{"SymTracefree", "[", 
              RowBox[{"SymProduct2", "[", 
               RowBox[{
                RowBox[{"trf2sym", "[", 
                 RowBox[{"From2Dto3D", "[", 
                  RowBox[{"trfVar2D", "[", 
                   RowBox[{"d", ",", "B"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"dx", ",", "dy", ",", "0"}], "}"}]}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "store", " ", "the", " ", "coefficients", " ", "infront", " ", "of", 
         " ", "the", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"d", ",", "i"}], "]"}], "=", 
          RowBox[{
           RowBox[{"CoefficientArrays", "[", 
            RowBox[{
             RowBox[{"tmp", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{"d", ",", "B"}], "]"}]}], "]"}], "\[LeftDoubleBracket]",
            "2", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "15"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"flag", " ", "is", " ", "the", " ", "dimension"}], ",", " ", 
     RowBox[{
     "this", " ", "is", " ", "the", " ", "main", " ", "moment", " ", 
      "equation", " ", "I", " ", 
      RowBox[{"think", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"recursion1", "[", 
     RowBox[{"a_", ",", "deg_", ",", "flag_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"R1", "[", 
        RowBox[{
         RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
       RowBox[{"trfVar2D", "[", 
        RowBox[{
         RowBox[{"deg", "+", "1"}], ",", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"#", ",", "a", ",", 
            RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}], "-", 
      RowBox[{"a", " ", 
       RowBox[{
        RowBox[{"R1", "[", 
         RowBox[{
          RowBox[{"deg", "+", "1"}], ",", "flag"}], "]"}], ".", 
        RowBox[{"trfVar2D", "[", 
         RowBox[{
          RowBox[{"deg", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"\[Psi]", "[", 
            RowBox[{"#", ",", 
             RowBox[{"a", "-", "1"}], ",", 
             RowBox[{"deg", "+", "1"}]}], "]"}], "&"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"deg", ">", "0"}], ",", 
        RowBox[{
         FractionBox[
          RowBox[{"2", "deg"}], 
          RowBox[{
           RowBox[{"2", "deg"}], "+", "1"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"deg", "+", "a", "+", 
              FractionBox["1", "2"]}], ")"}], 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
             RowBox[{"trfVar2D", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"#", ",", "a", ",", 
                  RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}], "-", 
           RowBox[{
            RowBox[{"R2", "[", 
             RowBox[{
              RowBox[{"deg", "-", "1"}], ",", "flag"}], "]"}], ".", 
            RowBox[{"trfVar2D", "[", 
             RowBox[{
              RowBox[{"deg", "-", "1"}], ",", 
              RowBox[{
               RowBox[{"\[Psi]", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"a", "+", "1"}], ",", 
                 RowBox[{"deg", "-", "1"}]}], "]"}], "&"}]}], "]"}]}]}], 
          ")"}]}], ",", "0"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mixed", "[", 
     RowBox[{"a_", ",", "n_", ",", "b_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Expand", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"n", "-", 
           FractionBox[
            RowBox[{"n", "+", "m"}], "2"], "+", "a", "-", "c1", "-", "1"}], 
          ",", 
          RowBox[{"a", "-", "c1"}]}], "]"}], 
        FractionBox[
         RowBox[{"a", "!"}], 
         RowBox[{"c1", "!"}]], 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"m", "-", 
           FractionBox[
            RowBox[{"n", "+", "m"}], "2"], "+", "b", "-", "c1", "-", "1"}], 
          ",", 
          RowBox[{"b", "-", "c1"}]}], "]"}], 
        FractionBox[
         RowBox[{"b", "!"}], 
         RowBox[{"c1", "!"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "!"}], 
          SqrtBox["2"], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"n", "+", "m"}], "2"], "+", "c1", "+", 
            RowBox[{"3", "/", "2"}]}], "]"}], 
          SuperscriptBox["2", 
           FractionBox[
            RowBox[{"n", "+", "m"}], "2"]]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "0", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "The", " ", "following", " ", "function", " ", "integrates", " ", 
        "expressions", " ", "of", " ", "the", " ", "kind", " ", 
        RowBox[{"\[Integral]", 
         RowBox[{
          SuperscriptBox["\[Nu]x", "m"], 
          SuperscriptBox["\[Nu]y", "p"], 
          SuperscriptBox["\[Nu]z", "n"], "d\[Nu]", " ", "but", " ", "the", 
          " ", "integration", " ", "is", " ", "such", " ", "that", " ", 
          "only", " ", "\[Nu]x"}]}]}], " ", ">", 
       RowBox[{
       "0.", " ", "Making", " ", "the", " ", "transformation", " ", "to", " ",
         "spherical", " ", "coordinates", " ", 
        RowBox[{"i", ".", "e", ".", " ", "\[Nu]x"}]}]}], " ", "=", " ", 
      RowBox[{"Sin", " ", "\[Nu]", " ", "Cos", " ", "\[Theta]"}]}], ",", " ", 
     
     RowBox[{"\[Nu]y", " ", "=", " ", 
      RowBox[{
       RowBox[{
       "Sin", " ", "\[Nu]", " ", "Sin", " ", "\[Theta]", " ", "and", " ", 
        "\[Nu]z"}], " ", "=", " ", 
       RowBox[{"Cos", " ", "\[Nu]", " ", "we", " ", "have", " ", 
        RowBox[{
         SubscriptBox[
          SuperscriptBox["\[Integral]", 
           RowBox[{
            RowBox[{"+", "\[Pi]"}], "/", "2"}]], 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "2"}]], 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Integral]", "0"], "\[Pi]"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Sin\[Nu]", 
              RowBox[{"mm", "+", "nn", "+", "1"}]], 
             SuperscriptBox["Cos\[Nu]", "pp"], 
             SuperscriptBox["Sin\[Theta]", "nn"], 
             SuperscriptBox["Cos\[Theta]", "mm"]}], ")"}], 
           "d\[Nu]d\[Theta]"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNz1", "[", "ex_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2", ",", "pos3", ",", 
        RowBox[{"mm", "=", "0"}], ",", 
        RowBox[{"nn", "=", "0"}], ",", 
        RowBox[{"pp", "=", "0"}], ",", "res", ",", 
        RowBox[{"res1", "=", 
         RowBox[{"\[Nu]x", " ", "\[Nu]y", " ", "\[Nu]z", " ", "ex"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos1", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]x", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos2", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]y", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos3", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"res1", ",", 
          SuperscriptBox["\[Nu]z", "_"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], ">", "0"}], ",", 
         RowBox[{"mm", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], ">", "0"}], ",", 
         RowBox[{"nn", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos2", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], ">", "0"}], ",", 
         RowBox[{"pp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Extract", "[", 
             RowBox[{"res1", ",", 
              RowBox[{
              "pos3", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
            "2", "\[RightDoubleBracket]"}], "-", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{"res1", ",", 
           RowBox[{"Join", "[", 
            RowBox[{"pos1", ",", "pos2", ",", "pos3"}], "]"}]}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OddQ", "[", "nn", "]"}], "||", 
            RowBox[{"OddQ", "[", "pp", "]"}]}], ",", "0", ",", 
           RowBox[{"2", "\[Pi]", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nn", "-", "1"}], ")"}], "!!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"mm", "-", "1"}], ")"}], "!!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pp", "-", "1"}], ")"}], "!!"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nn", "+", "mm", "+", "pp", "+", "1"}], ")"}], 
              "!!"}]]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos1", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]x"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos2", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]y"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos3", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"res", "=", 
          RowBox[{"res", "/", "\[Nu]z"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "applies", " ", "integrate", " ", "halfnxnynz1", " ", "to", " ", "a", " ",
      "long", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegrateHalfNxNyNz", "[", "ex_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "ex", "]"}], "===", " ", "Plus"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"IntegrateHalfNxNyNz1", "[", 
           RowBox[{
           "ex", "\[LeftDoubleBracket]", "ii", "\[RightDoubleBracket]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"IntegrateHalfNxNyNz1", "[", "ex", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "input", " ", "of", " ", "the", " ", "following", " ", 
      "function", " ", 
      RowBox[{"i", ".", "e"}], " ", "idx1", " ", "and", " ", "idx2", " ", 
      "are", " ", "arrays", " ", "such", " ", "that", " ", 
      RowBox[{"idx1", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}]}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#xcomponents", ",", "#ycomponents", ",", "#zcomponents"}], 
         "}"}], ".", " ", "The"}], " ", "following", " ", "function", " ", 
       "computes", " ", "the", " ", "half", " ", "integrals", " ", "of", " ", 
       "the", " ", "form", " ", 
       RowBox[{"\[Integral]", " ", 
        RowBox[{
        "\[Psi]", " ", "fdc", " ", "where", " ", "\[Psi]", " ", "is", " ", 
         "the", " ", "basis", " ", "function", " ", "and", " ", "the", " ", 
         "integral", " ", "is", " ", "only", " ", "over", " ", "the", " ", 
         "half", " ", 
         RowBox[{"space", ".", " ", "The"}], " ", "\[Psi]", " ", "is", " ", 
         "represented", " ", "by", " ", "one", " ", "of", " ", "the", " ", 
         "input", " ", "parameters", " ", "and", " ", "the", " ", "basis", 
         " ", "functions", " ", "in", " ", "f", " ", "are", " ", 
         "represented", " ", "by", " ", "one", " ", "of", " ", "the", " ", 
         "input", " ", 
         RowBox[{
         "parameters", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "idx1"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
       "index", " ", "for", " ", "the", " ", "testfunction", 
        "\[IndentingNewLine]", "\t   ", "ix2"}], " ", "=", " ", 
       RowBox[{
       "index", " ", "for", " ", "the", " ", "basis", " ", "of", " ", "the", 
        " ", "distribution", " ", "function"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfIntegrate", "[", 
     RowBox[{"idx1_", ",", "idx2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Int1", ",", 
        RowBox[{"deg1", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx1", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", 
        RowBox[{"deg2", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx2", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "following", " ", "term", " ", "develops", " ", "terms", 
        " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         SubscriptBox["\[Nu]", 
          RowBox[{"<", 
           RowBox[{
            SuperscriptBox["x", "m"], 
            SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "The"}], " ", 
        "algorithm", " ", "is", " ", "as", " ", "follows", 
        "\[IndentingNewLine]", "1.", " ", "Extract", " ", "the", " ", "total",
         " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in", 
        " ", "the", " ", "tensor", "\[IndentingNewLine]", "2.", " ", 
        "Develop", " ", "the", " ", "full", " ", "sym", " ", "trace", " ", 
        "free", " ", "tensor", " ", 
        RowBox[{"i", ".", "e"}], " ", "develop", " ", "all", " ", "the", " ", 
        "components", " ", "of", " ", 
        SubscriptBox["\[Nu]", 
         RowBox[{"<", 
          RowBox[{
           SubscriptBox["i", 
            RowBox[{"1", "..."}]], 
           SubscriptBox["i", "n"]}], ">"}]], "\[IndentingNewLine]", "3.", " ",
         "Extract", " ", "the", " ", "component", " ", "corresponding", " ", 
        "to", " ", "idx1"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Int1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"SymTracefree", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Nu]x", "#1"], 
                  SuperscriptBox["\[Nu]y", "#2"], 
                  SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
              "&"}], ",", 
             RowBox[{"IDX", "[", "deg1", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"toIDX2", "[", 
           RowBox[{"idx1", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
            "\[RightDoubleBracket]"}], "]"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"mixed", "[", 
           RowBox[{
            RowBox[{
            "idx1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", "deg1", ",", 
            RowBox[{
            "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", "deg2"}], "]"}], 
          RowBox[{
           RowBox[{"Norm\[Psi]", "[", 
            RowBox[{
             RowBox[{
             "idx1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "deg1"}], "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             SqrtBox[
              RowBox[{"2", "\[Pi]"}]], ")"}], "3"]}]], 
         RowBox[{"IntegrateHalfNxNyNz", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Int1", " ", 
            RowBox[{"SymFullDot", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Apply", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["\[Nu]x", "#1"], 
                    SuperscriptBox["\[Nu]y", "#2"], 
                    SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], 
                  "]"}], "&"}], ",", 
                RowBox[{"IDX", "[", "deg2", "]"}]}], "]"}], ",", 
              RowBox[{"trf2sym", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Apply", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "\[Equal]", 
                    RowBox[{"idx2", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], ",", "1", ",", "0"}], "]"}], 
                    "&"}], ",", "#"}], "]"}], "&"}], ",", 
                 RowBox[{"IDXtrf", "[", "deg2", "]"}]}], "]"}], "]"}]}], 
             "]"}]}], "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trialHalfIntegrate", "[", 
     RowBox[{"idx1_", ",", "idx2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Int1", ",", 
        RowBox[{"deg1", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx1", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", 
        RowBox[{"deg2", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"idx2", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
           "\[RightDoubleBracket]"}], "]"}]}], ",", "Int2", ",", "f0"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "following", " ", "term", " ", "develops", " ", "terms", 
        " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         SubscriptBox["\[Nu]", 
          RowBox[{"<", 
           RowBox[{
            SuperscriptBox["x", "m"], 
            SuperscriptBox["y", "n"]}], ">"}]], ".", " ", "The"}], " ", 
        "algorithm", " ", "is", " ", "as", " ", "follows", 
        "\[IndentingNewLine]", "1.", " ", "Extract", " ", "the", " ", "total",
         " ", "number", " ", "of", " ", "free", " ", "indices", " ", "in", 
        " ", "the", " ", "tensor", "\[IndentingNewLine]", "2.", " ", 
        "Develop", " ", "the", " ", "full", " ", "sym", " ", "trace", " ", 
        "free", " ", "tensor", " ", 
        RowBox[{"i", ".", "e"}], " ", "develop", " ", "all", " ", "the", " ", 
        "components", " ", "of", " ", 
        SubscriptBox["\[Nu]", 
         RowBox[{"<", 
          RowBox[{
           SubscriptBox["i", 
            RowBox[{"1", "..."}]], 
           SubscriptBox["i", "n"]}], ">"}]], "\[IndentingNewLine]", "3.", " ",
         "Extract", " ", "the", " ", "component", " ", "corresponding", " ", 
        "to", " ", "idx1"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Int1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"SymTracefree", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Nu]x", "#1"], 
                  SuperscriptBox["\[Nu]y", "#2"], 
                  SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
              "&"}], ",", 
             RowBox[{"IDX", "[", "deg1", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"toIDX2", "[", 
           RowBox[{"idx1", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
            "\[RightDoubleBracket]"}], "]"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Int2", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"SymTracefree", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Nu]x", "#1"], 
                  SuperscriptBox["\[Nu]y", "#2"], 
                  SuperscriptBox["\[Nu]z", "#3"]}], "&"}], ",", "#"}], "]"}], 
              "&"}], ",", 
             RowBox[{"IDX", "[", "deg2", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"toIDX2", "[", 
           RowBox[{"idx2", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4"}], "}"}], 
            "\[RightDoubleBracket]"}], "]"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f0", " ", "=", " ", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"mixed", "[", 
          RowBox[{
           RowBox[{
           "idx1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg1", ",", 
           RowBox[{
           "idx2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "deg2"}], "]"}], 
         RowBox[{"IntegrateHalfNxNyNz", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Int1", "*", "Int2"}], "]"}], "]"}], "*", "f0"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.679121885999333*^9, 
   3.679121891174914*^9}, {3.679122262361793*^9, 3.679122267112525*^9}, {
   3.679133059362032*^9, 3.679133059631439*^9}, {3.679133589038743*^9, 
   3.67913360936185*^9}, {3.679133640904398*^9, 3.6791336831388493`*^9}, {
   3.6791337141082077`*^9, 3.679133874437611*^9}, {3.679135482134459*^9, 
   3.679135484173957*^9}, {3.6792156676707373`*^9, 3.679215704456918*^9}, {
   3.6792240744446783`*^9, 3.67922407965063*^9}, {3.679224862877001*^9, 
   3.679224873400732*^9}, {3.679225442671756*^9, 3.679225466025872*^9}, {
   3.679226905039249*^9, 3.679226910362652*^9}, {3.679302746622109*^9, 
   3.6793027776615343`*^9}, {3.679302813181233*^9, 3.679302879795128*^9}, {
   3.67930294047698*^9, 3.6793029632269*^9}, 3.679917780582199*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix computations", "Subsection",
 CellChangeTimes->{{3.679917786433001*^9, 3.679917788836399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetMatrices1D", "[", "Ntensors_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "varIdx", ",", "varIdxComplete", ",", "theory", ",", "normMatrix", ",",
         "varNames", ",", "var", ",", "Ax", ",", "Ay", ",", 
        "\[IndentingNewLine]", "var1D", ",", "BCvar", ",", "varOdd", ",", 
        "varIdxCompleteEven", ",", "varEven", ",", "BCraw", ",", 
        RowBox[{"\[Rho]index", "=", "1"}], ",", 
        RowBox[{"vindex", "=", "2"}], ",", "\[Rho]Weqn", ",", "BCnum", ",", 
        "BCrhs", ",", "Praw", ",", "BCraw2"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "compute", " ", "the", " ", "tensor", " ", "degree", " ", "and", " ", 
         "the", " ", "number", " ", "of", " ", "traces", " ", "for", " ", 
         "every", " ", "tensor", " ", "in", " ", "the", " ", 
         RowBox[{"system", ".", "\[IndentingNewLine]", "In"}], " ", "all", 
         " ", "the", " ", "coming", " ", "computations"}], ",", " ", 
        RowBox[{
        "iTraces", " ", "will", " ", "be", " ", "represented", " ", "by", " ", 
         RowBox[{"a", ".", "sa"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"varIdx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"iTraces", "[", "i", "]"}], ",", 
            RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "IDXtrf", " ", "but", " ", "instead", " ", 
         "stores", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
         "number", " ", "of", " ", "traces", " ", "in", " ", "the", " ", 
         "first", " ", "argument", " ", "of", " ", "every", " ", "list"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varIdxComplete", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                 ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"IDXtrf", "[", 
                 RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                  RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
                ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "computes", " ", "the", " ", "number", " ", "of", " ", "traces", " ", 
         "for", " ", "a", " ", "given", " ", 
         RowBox[{"iTensorDegree", ".", " ", "The"}], " ", "final", " ", 
         "result", " ", "gives", " ", "us", " ", "the", " ", "tuple", " ", 
         "discussed", " ", "in", " ", "the", " ", "paper", " ", "on", " ", 
         "the", " ", "convergence", " ", "of", " ", "the", " ", "boundary", 
         " ", "value", " ", 
         RowBox[{"problem", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"theory", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"varIdx", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "k"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"iFullDegree", "[", "Ntensors", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<number of different tensor degrees: \>\"", ",", "theory"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<corresponding variables (traces,indices): \>\"", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "0", ",", 
                 RowBox[{
                  RowBox[{
                  "theory", "\[LeftDoubleBracket]", "n", 
                   "\[RightDoubleBracket]"}], "-", "1"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"Length", "[", "theory", "]"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Number of Variables 1D: \>\"", ",", "Ntensors"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Number of Variables 2D: \>\"", ",", 
         RowBox[{"NumberOfVariables2D", "[", "Ntensors", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Number of Variables 3D: \>\"", ",", 
         RowBox[{"NumberOfVariables3D", "[", "Ntensors", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Number of full Tensors 3D: \>\"", ",", 
         RowBox[{"NumberOfFullTensors3D", "[", "Ntensors", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"normMatrix", "=", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "deg"}], "}"}], ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{"Norm\[Psi]", "[", 
                    RowBox[{"a", ",", "deg"}], "]"}], ",", 
                   RowBox[{"deg", "+", "1"}]}], "]"}]}], "]"}], "@@", "#"}], 
              "&"}], ",", "varIdx"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "So", " ", "the", " ", "stress", " ", "tensor", " ", "will", " ", 
         "be", " ", "different", " ", "from", " ", "the", " ", "usual", " ", 
         "stress", " ", "tensor", " ", "defined", " ", 
         RowBox[{"normally", ".", "\[IndentingNewLine]", "All"}], " ", "the", 
         " ", "variable", " ", "names", " ", "are", " ", "for", " ", "the", 
         " ", "2", "D", " ", 
         RowBox[{"case", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varNames", "=", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"varName", "@@", "#"}], "&"}], ",", "varIdxComplete"}], 
            "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<\[Rho]0\>\"", "\[Rule]", "\"\<\[Rho]\>\""}], ",", 
             RowBox[{"\"\<\[Rho]0x\>\"", "\[Rule]", "\"\<vx\>\""}], ",", 
             RowBox[{"\"\<\[Rho]0y\>\"", "\[Rule]", "\"\<vy\>\""}], ",", 
             RowBox[{"\"\<\[Rho]1\>\"", "\[Rule]", "\"\<\[Theta]\>\""}], ",", 
             
             RowBox[{"\"\<\[Rho]0xx\>\"", "\[Rule]", "\"\<\[Sigma]xx\>\""}], 
             ",", 
             RowBox[{"\"\<\[Rho]0xy\>\"", "\[Rule]", "\"\<\[Sigma]xy\>\""}], 
             ",", 
             RowBox[{"\"\<\[Rho]0yy\>\"", "\[Rule]", "\"\<\[Sigma]yy\>\""}], 
             ",", 
             RowBox[{"\"\<\[Rho]1x\>\"", "\[Rule]", "\"\<qx\>\""}], ",", 
             RowBox[{"\"\<\[Rho]1y\>\"", "\[Rule]", "\"\<qy\>\""}]}], "}"}]}],
           "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], "/", "2"}], "\[Theta]"}]}], ",", 
           RowBox[{"qx", "\[Rule]", 
            RowBox[{"-", "qx"}]}], ",", 
           RowBox[{"qy", "\[Rule]", 
            RowBox[{"-", "qy"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "the", " ", "result", " ", "from", " ", "var", " ", "consists", " ", 
          "of", " ", "the", " ", "form", " ", 
          RowBox[{"\[Psi]", "[", 
           RowBox[{"n", ",", "a", ",", "deg"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"where", " ", "a"}], " ", "=", " ", "#traces"}], ",", " ", 
         RowBox[{"deg", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "#free", " ", "tensors", " ", "and", " ", "n", " ", "is", " ", 
            "the", " ", "name", " ", "for", " ", "eg", " ", "vx"}], " ", "=", 
           " ", 
           RowBox[{
            RowBox[{"1", " ", "and", " ", "vy"}], " ", "=", " ", 
            RowBox[{
            "2", " ", "or", " ", "\[Theta]", " ", "is", " ", "simply", " ", 
             "1"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"var", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "deg"}], "}"}], ",", 
              RowBox[{"trfVar2D", "[", 
               RowBox[{"deg", ",", 
                RowBox[{
                 RowBox[{"\[Psi]", "[", 
                  RowBox[{"#", ",", "a", ",", "deg"}], "]"}], "&"}]}], 
               "]"}]}], "]"}], ",", "item"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Ax", "=", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "deg"}], "}"}], ",", 
                  RowBox[{"recursion1", "[", 
                   RowBox[{"a", ",", "deg", ",", "1"}], "]"}]}], "]"}], ",", 
                "item"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ay", "=", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "deg"}], "}"}], ",", 
                  RowBox[{"recursion1", "[", 
                   RowBox[{"a", ",", "deg", ",", "2"}], "]"}]}], "]"}], ",", 
                "item"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"item", ",", "varIdx"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Flatten", "[", "var", "]"}]}], "]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"reduction", " ", "for", " ", "1", "d"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"var1D", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ")"}], "&&", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ")"}]}], 
                  ",", "1", ",", "0"}], "]"}], "&"}], ",", "varIdxComplete"}],
               "]"}], ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"varIdxComplete", "=", 
          RowBox[{
          "varIdxComplete", "\[LeftDoubleBracket]", "var1D", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"varNames", "=", 
          RowBox[{
          "varNames", "\[LeftDoubleBracket]", "var1D", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Ax", "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"Ax", "\[LeftDoubleBracket]", 
            RowBox[{"var1D", ",", "var1D"}], "\[RightDoubleBracket]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"normMatrix", "=", 
          RowBox[{"normMatrix", "\[LeftDoubleBracket]", 
           RowBox[{"var1D", ",", "var1D"}], "\[RightDoubleBracket]"}]}], 
         ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "As", " ", "the", " ", "literature", " ", "says", " ", "the", " ", 
         "boundary", " ", "conditions", " ", "will", " ", "only", " ", "be", 
         " ", "computed", " ", "with", " ", "basis", " ", "functions", " ", 
         "which", " ", "have", " ", "odd", " ", "powers", " ", "of", " ", 
         "Cx", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
           "considering", " ", "the", " ", "normal", " ", "to", " ", "point", 
            " ", "in", " ", "the", " ", "x", " ", "direction"}], ")"}], ".", 
          " ", "BCVar"}], " ", "is", " ", "a", " ", "mapping", " ", "which", 
         " ", "collects", " ", "odd", " ", "basis", " ", "functions"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BCvar", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OddQ", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}], ",", "1", ",", "0"}], "]"}], "&"}], ",", 
          "varIdxComplete"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"the", " ", "position", " ", "of", " ", "odd", " ", 
         RowBox[{"variables", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varOdd", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"BCvar", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Picks", " ", "out", " ", "the", " ", "even", " ", 
         RowBox[{"components", ".", " ", "The"}], " ", "fourth", " ", 
         "component", " ", "is", " ", "anyhow", " ", "always", " ", 
         RowBox[{"zero", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varIdxCompleteEven", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"varIdxComplete", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"EvenQ", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}], "&&", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              "\[Equal]", "0"}]}], ")"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Every", " ", "element", " ", "is", " ", "same", " ", "as", " ", 
          "that", " ", "to", " ", 
          RowBox[{"varIdxCompleteEven", ".", " ", "The"}], " ", "following", 
          " ", "manupilation", " ", "just", " ", "separates", " ", "out", " ",
           "the", " ", "elements", " ", "depending", " ", "upon", " ", "the", 
          " ", "number", " ", "of", " ", "y"}], "-", "indices"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"varEven", "[", 
           RowBox[{"jj", ",", "0"}], "]"}], "=", 
          RowBox[{"Select", "[", 
           RowBox[{"varIdxCompleteEven", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Equal]", "jj"}], ")"}], "&"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "0", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"varIdxCompleteEven", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "]"}]}], 
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "In", " ", "the", " ", "following", " ", "function", " ", "we", " ",
            "compute", " ", 
           RowBox[{"\[Integral]", " ", 
            RowBox[{"\[Psi]", " ", 
             SuperscriptBox["f", "even"], "dc", " ", "where", " ", "\[Psi]", 
             " ", "is", " ", "such", " ", "that", " ", "the", " ", "powers", 
             " ", "of", " ", "Cx", " ", "appearing", " ", "in", " ", "\[Psi]",
              " ", "are", " ", 
             RowBox[{"odd", ".", " ", "The"}], " ", "first", " ", "argument", 
             " ", "of", " ", "jj", " ", "has", " ", "been", " ", "optimised", 
             " ", "using", " ", "some", " ", "currently", " ", "unkown", " ", 
             
             RowBox[{"formula", ".", " ", "The"}], " ", "result", " ", "from",
              " ", "this", " ", "manipulation", " ", "remains", " ", "the", 
             " ", "same", " ", "even", " ", "if", " ", 
             RowBox[{"{", 
              RowBox[{"jj", ",", 
               RowBox[{"idx", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
               RowBox[{"-", "2"}]}], "}"}], " ", "is", " ", "substituted", 
             " ", "by", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"jj", ",", "0", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"varIdxCompleteEven", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], 
                 "]"}]}], "}"}], ".", "\[IndentingNewLine]", "Let"}], " ", 
             "the", " ", "basis", " ", "function", " ", "of", " ", "f", " ", 
             "be", " ", "\[Phi]", " ", "and", " ", "the", " ", "test", " ", 
             "function", " ", "be", " ", 
             RowBox[{"\[Psi]", ".", " ", "m"}]}]}]}], " ", "=", " ", 
          RowBox[{
           RowBox[{
           "powers", " ", "of", " ", "Cy", " ", "in", " ", "\[Psi]", " ", 
            "and", " ", "n"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"powers", " ", "of", " ", "Cy", " ", "in", " ", 
             RowBox[{"\[Phi]", ".", " ", "\[IndentingNewLine]", " ", "Then"}],
              " ", "the", " ", "following", " ", "unexplained", " ", 
             "observation", " ", "holds", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "1.", " ", 
             RowBox[{"\[Integral]", 
              RowBox[{"\[Psi]", " ", "f"}]}]}], " ", "=", " ", 
            RowBox[{
             RowBox[{"0", " ", "if", " ", "n"}], " ", ">", " ", 
             RowBox[{
              RowBox[{"m", " ", "or", " ", "n"}], "+", "m"}], " ", 
             "\[NotEqual]", " ", 
             RowBox[{
              RowBox[{"Even", ".", "\[IndentingNewLine]", "2."}], " ", "In", 
              " ", "the", " ", "equation", " ", "for", " ", 
              "\[Rho]W"}]}]}]}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "the", " ", "odd", " ", "part", " ", "of", " ", "f", " ", "only", 
           " ", "contributed", " ", "vx"}], " ", "=", " ", 
          RowBox[{
          "0", " ", "and", " ", "thus", " ", "has", " ", "been", " ", 
           RowBox[{
           "neglected", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            " ", "Based"}], " ", "on", " ", "this", " ", "observation"}]}], 
         ",", " ", 
         RowBox[{
         "the", " ", "following", " ", "routine", " ", "has", " ", "been", 
          " ", 
          RowBox[{"simplified", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BCraw", "=", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"OddQ", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Total", "[", 
                RowBox[{
                 SqrtBox[
                  RowBox[{"2", "\[Pi]"}]], 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"HalfIntegrate", "[", 
                    RowBox[{"idx", ",", "#"}], "]"}], 
                    RowBox[{"Apply", "[", 
                    RowBox[{"w", ",", "#"}], "]"}]}], "&"}], ",", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"varEven", "[", 
                    RowBox[{"jj", ",", 
                    RowBox[{
                    "idx", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", 
                    RowBox[{
                    "idx", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
                   "]"}]}], "]"}], "\[IndentingNewLine]", ",", "0"}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"w", ",", "#"}], "]"}], "&"}], ",", "varIdxComplete"}],
             "]"}]}], "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", 
         "2", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"BCraw2", " ", "=", " ", "BCraw"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"eliminate", " ", "\[Rho]W"}], ",", 
         RowBox[{
         "vindex", " ", "is", " ", "the", " ", "index", " ", "of", " ", 
          RowBox[{"vx", ".", "\[IndentingNewLine]", "The"}], " ", "part", " ",
           "after", " ", "this", " ", "has", " ", "to", " ", "be", " ", 
          "understood", " ", "with", " ", "Manuel"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Rho]Weqn", "=", 
        RowBox[{
        "BCraw", "\[LeftDoubleBracket]", "vindex", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OddQ", "[", 
               RowBox[{"varIdxComplete", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"EvenQ", "[", 
               RowBox[{"varIdxComplete", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"varIdxComplete", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}], 
               "\[Equal]", "0"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "BCraw", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               "-=", 
              RowBox[{
               FractionBox[
                RowBox[{"BCraw", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "\[Rho]index"}], "\[RightDoubleBracket]"}], 
                RowBox[{
                "\[Rho]Weqn", "\[LeftDoubleBracket]", "\[Rho]index", 
                 "\[RightDoubleBracket]"}]], "\[Rho]Weqn"}]}], ";"}]}], "]"}],
           ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "varIdxComplete", "]"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"relaxational", " ", "normal", " ", "velocity"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BCraw", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BCraw", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"BCnum", "=", 
        RowBox[{
         RowBox[{
         "normMatrix", "\[LeftDoubleBracket]", "varOdd", 
          "\[RightDoubleBracket]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DiagonalMatrix", "[", "BCvar", "]"}], "-", "BCraw"}], 
          ")"}], ".", 
         RowBox[{"Inverse", "[", "normMatrix", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BCrhs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"BCnum", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "/", "2"}], "TW"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"BCnum", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
          RowBox[{"(", 
           RowBox[{"pW", "-", "TW"}], ")"}]}]}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Ax", ",", "Ay", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"w", ",", "#"}], "]"}], "&"}], ",", "varIdxComplete"}], 
          "]"}], ",", "BCraw2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.67631470816096*^9, 3.67631473862078*^9}, {
   3.676317894422679*^9, 3.67631799965135*^9}, {3.676318188048513*^9, 
   3.6763181982500257`*^9}, {3.6763183953865232`*^9, 
   3.6763184178625727`*^9}, {3.676318568228354*^9, 3.67631858480794*^9}, {
   3.676318622205942*^9, 3.676318645921948*^9}, {3.676319214105597*^9, 
   3.676319234157358*^9}, {3.676319326239319*^9, 3.676319388343461*^9}, {
   3.676319761350873*^9, 3.676319803088903*^9}, {3.676319841379665*^9, 
   3.6763198673575573`*^9}, {3.676319958093553*^9, 3.676319971501892*^9}, {
   3.676350466462089*^9, 3.676350479134638*^9}, {3.676350995823554*^9, 
   3.676351030344117*^9}, {3.676351424695251*^9, 3.676351476528409*^9}, {
   3.6763515223163843`*^9, 3.676351539489685*^9}, {3.6763516802975492`*^9, 
   3.6763517593173532`*^9}, {3.676353161841096*^9, 3.6763531770489073`*^9}, {
   3.676353813021338*^9, 3.676353938574492*^9}, {3.676354165546465*^9, 
   3.676354191016698*^9}, {3.676354250843234*^9, 3.676354259123694*^9}, {
   3.6763543295360537`*^9, 3.676354395457556*^9}, {3.676354540414845*^9, 
   3.67635454168749*^9}, {3.67635459713883*^9, 3.6763546011450453`*^9}, {
   3.677908182475833*^9, 3.677908189521323*^9}, {3.677908243075292*^9, 
   3.677908517383662*^9}, {3.67790855597474*^9, 3.677908558256701*^9}, {
   3.6779091648701353`*^9, 3.677909175956766*^9}, {3.6779092206167173`*^9, 
   3.6779092677442703`*^9}, {3.677910129079022*^9, 3.677910254625524*^9}, {
   3.677910316939592*^9, 3.677910409950611*^9}, 3.6779203395219107`*^9, {
   3.677931966262611*^9, 3.677931987184534*^9}, {3.677932106227659*^9, 
   3.677932108152259*^9}, {3.678094286666443*^9, 3.678094288061706*^9}, {
   3.678529965150991*^9, 3.678530070926092*^9}, {3.678530336357444*^9, 
   3.678530369194284*^9}, {3.678530889386294*^9, 3.678530939577683*^9}, {
   3.6785328035496073`*^9, 3.6785328568562326`*^9}, {3.678532891869742*^9, 
   3.678532970857788*^9}, 3.6785330137269163`*^9, {3.678533982597075*^9, 
   3.678533986487608*^9}, {3.6785358698347807`*^9, 3.678535873043728*^9}, {
   3.678537566243249*^9, 3.6785375776539707`*^9}, {3.679121885999333*^9, 
   3.679121891174914*^9}, {3.679122262361793*^9, 3.679122267112525*^9}, {
   3.679133059362032*^9, 3.679133059631439*^9}, {3.679133589038743*^9, 
   3.67913360936185*^9}, {3.679133640904398*^9, 3.6791336831388493`*^9}, {
   3.6791337141082077`*^9, 3.679133874437611*^9}, {3.679135482134459*^9, 
   3.679135484173957*^9}, {3.6792156676707373`*^9, 3.679215704456918*^9}, {
   3.6792240744446783`*^9, 3.67922407965063*^9}, {3.679224862877001*^9, 
   3.679224873400732*^9}, {3.679225442671756*^9, 3.679225466025872*^9}, {
   3.679226905039249*^9, 3.679226910362652*^9}, {3.679302746622109*^9, 
   3.6793027776615343`*^9}, {3.679302813181233*^9, 3.679302879795128*^9}, {
   3.67930294047698*^9, 3.6793029632269*^9}, 3.679917780582199*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices to check Boundary stability", "Subsection",
 CellChangeTimes->{{3.679742700232418*^9, 3.679742705723098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoundaryMatrices", "[", 
   RowBox[{"Ax_", ",", "B_", ",", "nEqn_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "X", ",", "\[Lambda]Ax", ",", "Position\[Lambda]neg", ",", 
      "num\[Lambda]neg", ",", "Position\[Lambda]pos", ",", "num\[Lambda]pos", 
      ",", "Position\[Lambda]zero", ",", "num\[Lambda]zero", ",", "Xsorted", 
      ",", "Xplus", ",", "Xminus", ",", "Bminus", ",", "Bplus", ",", 
      "Bhatplus", ",", "Btemp", ",", "\[Lambda]plus", ",", "\[Lambda]minus"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "nomenclature", " ", "matches", " ", "\[IndentingNewLine]", 
      "with", " ", "the", " ", "DG", " ", 
      RowBox[{"paper", "."}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]Ax", ",", "X"}], "}"}], " ", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"Eigensystem", "[", "Ax", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", 
      RowBox[{"Transpose", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Position\[Lambda]neg", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"\[Lambda]Ax", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "<", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num\[Lambda]neg", " ", "=", " ", 
      RowBox[{"Length", "[", "Position\[Lambda]neg", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Position\[Lambda]pos", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"\[Lambda]Ax", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num\[Lambda]pos", " ", "=", " ", 
      RowBox[{"Length", "[", "Position\[Lambda]pos", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Position\[Lambda]zero", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"\[Lambda]Ax", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "==", "0"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num\[Lambda]zero", " ", "=", " ", 
      RowBox[{"Length", "[", "Position\[Lambda]zero", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"sorting", " ", "the", " ", "eigen", " ", "vectors"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Xsorted", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"nEqn", ",", "nEqn"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xsorted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", "num\[Lambda]neg"}]}], "]"}], "]"}], "=", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "Position\[Lambda]neg"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xsorted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "1"}], ";;", 
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero"}]}]}], "]"}], 
       "]"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"NullSpace", "[", "Ax", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xsorted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero", "+", "1"}], ";;",
           "nEqn"}]}], "]"}], "]"}], "=", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "Position\[Lambda]pos"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", "Xsorted"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]plus", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"\[Lambda]Ax", "[", 
        RowBox[{"[", "Position\[Lambda]pos", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]minus", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"\[Lambda]Ax", "[", 
        RowBox[{"[", "Position\[Lambda]neg", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Xplus", " ", "=", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"num\[Lambda]neg", "+", "num\[Lambda]zero", "+", "1"}], ";;",
           "nEqn"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Xminus", " ", "=", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", "num\[Lambda]neg"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Bminus", " ", "=", " ", 
      RowBox[{"B", ".", "Xminus"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bplus", " ", "=", " ", 
      RowBox[{"B", ".", "Xplus"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Bhatplus", "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Inverse", "[", "Bminus", "]"}], ".", "Bplus"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{
       RowBox[{"Bhatplus", ".", "\[Lambda]minus", ".", 
        RowBox[{"Transpose", "[", "Bhatplus", "]"}]}], "+", "\[Lambda]plus"}],
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.679742724254963*^9, 3.679742982479104*^9}, {
   3.679743034130999*^9, 3.679743038305441*^9}, {3.679746427634984*^9, 
   3.679746486133237*^9}, {3.679746717663476*^9, 3.679746791661701*^9}, {
   3.679746887851783*^9, 3.679746897906802*^9}, {3.679747079267716*^9, 
   3.679747081368713*^9}, {3.6797471180927067`*^9, 3.6797472939285183`*^9}, {
   3.679747395750904*^9, 3.6797474865110283`*^9}, {3.679747804259759*^9, 
   3.6797478196951323`*^9}, {3.679747959032469*^9, 3.6797480109595757`*^9}, {
   3.679748491903791*^9, 3.6797485329048758`*^9}, {3.679748586027457*^9, 
   3.679748600194077*^9}, {3.6797504373314543`*^9, 3.6797504517929287`*^9}, {
   3.679750486418377*^9, 3.679750487017827*^9}, {3.679750517587657*^9, 
   3.679750581949787*^9}, {3.67975063285717*^9, 3.679750637687499*^9}, 
   3.679751110863654*^9, {3.679751151465179*^9, 3.679751224449839*^9}, {
   3.679752325463382*^9, 3.679752383543941*^9}, {3.679752419545927*^9, 
   3.6797524211614428`*^9}, {3.679752758222352*^9, 3.6797527730125303`*^9}, {
   3.679752862672418*^9, 3.679752898594411*^9}, {3.679752981820176*^9, 
   3.6797530073981647`*^9}, {3.67975305432629*^9, 3.679753055239648*^9}, {
   3.679825084672862*^9, 3.679825085303248*^9}, {3.6798251202338667`*^9, 
   3.679825194076666*^9}, {3.679827238061002*^9, 3.6798272597719917`*^9}, {
   3.6799185163073997`*^9, 3.679918519119061*^9}, 3.6799188442463217`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example Matrices", "Subchapter"],

Cell[TextData[{
 "GetMatrices1D gives the variable names, transport matrix A, production \
matrix P, a list VarBC marking the boundary fluxes, \nboundary matrix BC and \
a boundary right-hand-side g (containing pW and TW) for a number of moments \
(canonical ordering \nby tracefree components).\n\nThe moment equations for a \
process between walls read  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", 
     FractionBox["dU", "dx"]}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "Kn"]}], "P", " ", "U"}]}], TraditionalForm]]],
 " with boundary \nconditions ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"BC", " ", "U"}], "=", " ", "g"}], TraditionalForm]]],
 " at the right wall. For the left wall the BC-matrix needs to be modified\n\
by BC.",
 "DiagonalMatrix[1-2BCvar].",
 "\n\nThe list VarNames gives a transformation from the moment vector U to \
commonly used variables, like\ntemperature.\n"
}], "Text",
 FontSize->16],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "VarNames", ",", "trialAx", ",", "trialAy", ",", "VarBC", ",", "BC", ",",
       "g"}], "}"}], "=", 
    RowBox[{"GetMatrices1D", "[", "9", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Variables:\>\"", ",", "Red"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"VarNames", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Eigenvalues:\>\"", ",", "Red"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"1.", "trialAx"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<Boundary Conditions:\>\"", ",", "Red"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC", ".", "VarNames"}], "-", "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BC", ".", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"1", "-", 
      RowBox[{"2", "VarBC"}]}], "]"}], ".", "VarNames"}], "-", "g"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"pW", "\[Rule]", "p0"}], ",", 
    RowBox[{"TW", "\[Rule]", "T1"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "[", "BC", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "[", "trialAx", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trialAy", ".", "VarNames"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.675954722596938*^9, 3.6759547250369987`*^9}, {
  3.675954780502644*^9, 3.67595478087674*^9}, {3.676289559215464*^9, 
  3.676289582560815*^9}, {3.676354646516018*^9, 3.67635468531096*^9}, {
  3.676355149009048*^9, 3.676355151418141*^9}, {3.6763553919683237`*^9, 
  3.676355394527697*^9}, {3.678169073021989*^9, 3.678169073347747*^9}, {
  3.6781695992148314`*^9, 3.678169627039831*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of different tensor degrees: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["number of different tensor degrees: ", {3, 2, 2, 1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627526454*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"corresponding variables (traces,indices): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}],
  SequenceForm[
  "corresponding variables (traces,indices): ", {{0, 0}, {1, 0}, {2, 0}, {0, 
   1}, {1, 1}, {0, 2}, {1, 2}, {0, 3}, {0, 4}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627535673*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 1D: \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Number of Variables 1D: ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.67816962754744*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 2D: \"\>", "\[InvisibleSpace]", "22"}],
  SequenceForm["Number of Variables 2D: ", 22],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627558613*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 3D: \"\>", "\[InvisibleSpace]", "35"}],
  SequenceForm["Number of Variables 3D: ", 35],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627569676*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of full Tensors 3D: \"\>", "\[InvisibleSpace]", 
   "4.000000000000001`"}],
  SequenceForm["Number of full Tensors 3D: ", 4.000000000000001],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627580533*^9}],

Cell[BoxData[
 StyleBox["\<\"Variables:\"\>",
  StripOnInput->False,
  LineColor->RGBColor[1, 0, 0],
  FrontFaceColor->RGBColor[1, 0, 0],
  BackFaceColor->RGBColor[1, 0, 0],
  GraphicsColor->RGBColor[1, 0, 0],
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.6781696276325808`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Rho]", ",", "vx", ",", "vy", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", "\[Theta]"}], "2"]}], ",", "\[Sigma]xx", ",", 
   "\[Sigma]xy", ",", "\[Sigma]yy", ",", 
   RowBox[{"-", "qx"}], ",", 
   RowBox[{"-", "qy"}], ",", "\[Rho]0xxx", ",", "\[Rho]0xxy", ",", 
   "\[Rho]0xyy", ",", "\[Rho]0yyy", ",", "\[Rho]2", ",", "\[Rho]1xx", ",", 
   "\[Rho]1xy", ",", "\[Rho]1yy", ",", "\[Rho]0xxxx", ",", "\[Rho]0xxxy", ",",
    "\[Rho]0xxyy", ",", "\[Rho]0xyyy", ",", "\[Rho]0yyyy"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.6781696276433477`*^9}],

Cell[BoxData[
 StyleBox["\<\"Eigenvalues:\"\>",
  StripOnInput->False,
  LineColor->RGBColor[1, 0, 0],
  FrontFaceColor->RGBColor[1, 0, 0],
  BackFaceColor->RGBColor[1, 0, 0],
  GraphicsColor->RGBColor[1, 0, 0],
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627652175*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.8569700138728105`", ",", 
   RowBox[{"-", "2.856970013872809`"}], ",", 
   RowBox[{"-", "2.33441421833898`"}], ",", "2.33441421833898`", ",", 
   RowBox[{"-", "1.7320508075688776`"}], ",", "1.7320508075688772`", ",", 
   RowBox[{"-", "1.732050807568877`"}], ",", "1.7320508075688754`", ",", 
   RowBox[{"-", "1.355626179974269`"}], ",", "1.3556261799742677`", ",", 
   "1.0000000000000009`", ",", 
   RowBox[{"-", "1.0000000000000004`"}], ",", "1.0000000000000002`", ",", 
   RowBox[{"-", "0.999999999999999`"}], ",", 
   RowBox[{"-", "0.7419637843027269`"}], ",", "0.741963784302726`", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.678169627660576*^9}],

Cell[BoxData[
 StyleBox["\<\"Boundary Conditions:\"\>",
  StripOnInput->False,
  LineColor->RGBColor[1, 0, 0],
  FrontFaceColor->RGBColor[1, 0, 0],
  BackFaceColor->RGBColor[1, 0, 0],
  GraphicsColor->RGBColor[1, 0, 0],
  FontColor->RGBColor[1, 0, 0]]], "Print",
 CellChangeTimes->{
  3.675954449721407*^9, 3.675954725411138*^9, 3.67595478156139*^9, {
   3.676289559722628*^9, 3.676289583010315*^9}, {3.676354659455727*^9, 
   3.6763546857433577`*^9}, 3.676355152176161*^9, 3.67635539493983*^9, 
   3.678169075491027*^9, 3.678169627671813*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pW", "+", 
    FractionBox["TW", "2"], "+", "vx", "+", "vy", "-", "\[Rho]"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["qy", "5"]}], "-", 
    FractionBox[
     RowBox[{"3", " ", "TW"}], "2"], "-", "vy", "-", 
    FractionBox["\[Rho]0xxy", "2"], "+", "\[Sigma]xy"}], ",", 
   RowBox[{
    RowBox[{"-", "qx"}], "+", 
    RowBox[{"2", " ", "\[Theta]"}], "-", 
    FractionBox["\[Rho]0xxxx", "12"], "-", 
    FractionBox[
     RowBox[{"5", " ", "\[Rho]1xx"}], "14"], "+", 
    FractionBox[
     RowBox[{"4", " ", "\[Rho]2"}], "15"], "+", 
    FractionBox["\[Sigma]xx", "2"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", "\[Theta]"}], "5"], "+", "\[Rho]0xxx", "-", 
    FractionBox[
     RowBox[{"13", " ", "\[Rho]0xxxx"}], "30"], "+", 
    FractionBox["\[Rho]1xx", "7"], "+", 
    FractionBox[
     RowBox[{"4", " ", "\[Rho]2"}], "75"], "-", 
    FractionBox[
     RowBox[{"7", " ", "\[Sigma]xx"}], "5"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[Theta]", "5"]}], "-", 
    FractionBox["\[Rho]0xxxx", "30"], "-", 
    FractionBox["\[Rho]0xxyy", "2"], "+", "\[Rho]0xyy", "+", 
    FractionBox["\[Rho]1yy", "7"], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[Rho]2"}], "75"], "+", 
    FractionBox["\[Sigma]xx", "5"], "-", "\[Sigma]yy"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"11", " ", "qy"}], "10"], "-", 
    FractionBox[
     RowBox[{"3", " ", "TW"}], "4"], "-", 
    FractionBox["vy", "2"], "+", 
    FractionBox["\[Rho]0xxy", "4"], "+", "\[Rho]1xy"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"12", " ", "qy"}], "35"], "+", 
    FractionBox[
     RowBox[{"6", " ", "TW"}], "7"], "+", 
    FractionBox[
     RowBox[{"4", " ", "vy"}], "7"], "+", "\[Rho]0xxxy", "-", 
    FractionBox[
     RowBox[{"9", " ", "\[Rho]0xxy"}], "7"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"9", " ", "qy"}], "35"]}], "-", 
    FractionBox[
     RowBox[{"9", " ", "TW"}], "14"], "-", 
    FractionBox[
     RowBox[{"3", " ", "vy"}], "7"], "+", 
    FractionBox[
     RowBox[{"3", " ", "\[Rho]0xxy"}], "14"], "+", "\[Rho]0xyyy", "-", 
    "\[Rho]0yyy"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.6781696276802588`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p0", "+", 
    FractionBox["T1", "2"], "-", "vx", "+", "vy", "-", "\[Rho]"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["qy", "5"]}], "-", 
    FractionBox[
     RowBox[{"3", " ", "T1"}], "2"], "-", "vy", "-", 
    FractionBox["\[Rho]0xxy", "2"], "-", "\[Sigma]xy"}], ",", 
   RowBox[{"qx", "+", 
    RowBox[{"2", " ", "\[Theta]"}], "-", 
    FractionBox["\[Rho]0xxxx", "12"], "-", 
    FractionBox[
     RowBox[{"5", " ", "\[Rho]1xx"}], "14"], "+", 
    FractionBox[
     RowBox[{"4", " ", "\[Rho]2"}], "15"], "+", 
    FractionBox["\[Sigma]xx", "2"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", "\[Theta]"}], "5"], "-", "\[Rho]0xxx", "-", 
    FractionBox[
     RowBox[{"13", " ", "\[Rho]0xxxx"}], "30"], "+", 
    FractionBox["\[Rho]1xx", "7"], "+", 
    FractionBox[
     RowBox[{"4", " ", "\[Rho]2"}], "75"], "-", 
    FractionBox[
     RowBox[{"7", " ", "\[Sigma]xx"}], "5"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[Theta]", "5"]}], "-", 
    FractionBox["\[Rho]0xxxx", "30"], "-", 
    FractionBox["\[Rho]0xxyy", "2"], "-", "\[Rho]0xyy", "+", 
    FractionBox["\[Rho]1yy", "7"], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[Rho]2"}], "75"], "+", 
    FractionBox["\[Sigma]xx", "5"], "-", "\[Sigma]yy"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"11", " ", "qy"}], "10"], "-", 
    FractionBox[
     RowBox[{"3", " ", "T1"}], "4"], "-", 
    FractionBox["vy", "2"], "+", 
    FractionBox["\[Rho]0xxy", "4"], "-", "\[Rho]1xy"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"12", " ", "qy"}], "35"], "+", 
    FractionBox[
     RowBox[{"6", " ", "T1"}], "7"], "+", 
    FractionBox[
     RowBox[{"4", " ", "vy"}], "7"], "-", "\[Rho]0xxxy", "-", 
    FractionBox[
     RowBox[{"9", " ", "\[Rho]0xxy"}], "7"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"9", " ", "qy"}], "35"]}], "-", 
    FractionBox[
     RowBox[{"9", " ", "T1"}], "14"], "-", 
    FractionBox[
     RowBox[{"3", " ", "vy"}], "7"], "+", 
    FractionBox[
     RowBox[{"3", " ", "\[Rho]0xxy"}], "14"], "-", "\[Rho]0xyyy", "-", 
    "\[Rho]0yyy"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.6781696276924257`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.`"}], "1.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "1.`", "0.`", "0.`", "0.2`", "0.`", 
      
      RowBox[{"-", "0.5`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"-", "1.3333333333333333`"}], "0.5`", "0.`", "0.`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.26666666666666666`", 
      RowBox[{"-", "0.35714285714285715`"}], "0.`", "0.`", 
      RowBox[{"-", "0.08333333333333333`"}], "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"-", "0.26666666666666666`"}], 
      RowBox[{"-", "1.4`"}], "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.`", "0.05333333333333334`", "0.14285714285714285`", "0.`", "0.`", 
      RowBox[{"-", "0.43333333333333335`"}], "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.13333333333333333`", "0.2`", "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", 
      RowBox[{"-", "0.02666666666666667`"}], "0.`", "0.`", 
      "0.14285714285714285`", 
      RowBox[{"-", "0.03333333333333333`"}], "0.`", 
      RowBox[{"-", "0.5`"}], "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "0.5`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.1`"}], "0.`", "0.25`", "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.5714285714285714`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      
      RowBox[{"-", "0.34285714285714286`"}], "0.`", 
      RowBox[{"-", "1.2857142857142858`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "0.42857142857142855`"}], "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.2571428571428571`", "0.`", "0.21428571428571427`", "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "1.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.6781696276997538`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"1.`", "0.`", "0.`", 
      RowBox[{"-", "0.6666666666666666`"}], "1.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`"},
     {"0.`", "1.3333333333333333`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.5333333333333333`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.4`"}], "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "0.6666666666666666`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.26666666666666666`", "0.`", "0.`", "0.`", "1.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.6666666666666667`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.6666666666666666`"}], "1.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "1.8`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.5142857142857142`"}], "0.`", "0.`", "1.`", "0.`", "0.`",
       "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1.6`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.45714285714285713`"}], "0.`", "0.`", "1.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.4`"}], "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.11428571428571428`", "0.`", 
      RowBox[{"-", "0.2857142857142857`"}], "0.`", "0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.2`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.34285714285714286`", "0.`", "0.`", "0.`", "0.`", "1.`",
       "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "1.8666666666666667`", 
      "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "1.4`", "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.9333333333333333`"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "2.2857142857142856`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "2.142857142857143`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.2857142857142857`"}], "0.`", "1.7142857142857142`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.8571428571428571`"}], "0.`", "1.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "1.7142857142857142`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {22, 22}, 0., {
     1, {{0, 1, 4, 5, 7, 10, 13, 16, 20, 22, 25, 28, 33, 36, 37, 39, 41, 43, 
       44, 45, 47, 49, 50}, {{2}, {5}, {1}, {4}, {6}, {2}, {8}, {10}, {2}, {
       8}, {11}, {3}, {9}, {2}, {8}, {12}, {5}, {15}, {4}, {14}, {6}, {16}, {
       18}, {5}, {15}, {19}, {6}, {16}, {20}, {15}, {5}, {7}, {17}, {6}, {
       16}, {21}, {8}, {10}, {8}, {11}, {9}, {8}, {12}, {10}, {11}, {10}, {
       12}, {11}, {13}, {12}}}, CompressedData["
1:eJxTTMoPSmVkYGAwYoCBD/bodCgYPN2PJo7Oh6r7ai8IBg8x5GfNBIGb+2Hm
QdRdRLcPrm/1KhD4hW4/hrlnz4DAH/sA9lIgerAf1b6f9rJXHIHoLlwcwt8L
dw9MfJKKJxBd2m8MBp/3i8V/FI3/eBXNfQwHYO64dxcE/sLdnQYG3+wh4m/h
7oWYy+TgCWYwOsDsub0tF4h+20Po13B3QMX3AwCiwYs5
      "]}]]]]], "Output",
 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.6781696277111063`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"vy"},
      {"\[Sigma]xy"},
      {
       RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]yy"}]},
      {
       RowBox[{
        RowBox[{"-", "qy"}], "-", "vy"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", "qy"}], "15"]}], "-", 
        FractionBox[
         RowBox[{"2", " ", "vy"}], "3"], "+", "\[Rho]0xxy"}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "qx"}], "5"], "+", "vx", "+", "\[Rho]0xyy"}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"8", " ", "qy"}], "15"], "+", 
        FractionBox[
         RowBox[{"4", " ", "vy"}], "3"], "+", "\[Rho]0yyy"}]},
      {
       RowBox[{"\[Rho]1xy", "-", "\[Sigma]xy"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"5", " ", "\[Theta]"}], "2"]}], "+", "\[Rho]1yy", "-", 
        FractionBox[
         RowBox[{"2", " ", "\[Rho]2"}], "3"], "-", "\[Sigma]yy"}]},
      {
       RowBox[{"\[Rho]0xxxy", "+", 
        FractionBox[
         RowBox[{"12", " ", "\[Rho]1xy"}], "35"], "-", 
        FractionBox[
         RowBox[{"6", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{"\[Rho]0xxyy", "-", 
        FractionBox[
         RowBox[{"2", " ", "\[Rho]1xx"}], "7"], "+", 
        FractionBox[
         RowBox[{"4", " ", "\[Rho]1yy"}], "35"], "+", "\[Sigma]xx", "-", 
        FractionBox[
         RowBox[{"2", " ", "\[Sigma]yy"}], "5"]}]},
      {
       RowBox[{"\[Rho]0xyyy", "-", 
        FractionBox[
         RowBox[{"16", " ", "\[Rho]1xy"}], "35"], "+", 
        FractionBox[
         RowBox[{"8", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{"\[Rho]0yyyy", "-", 
        FractionBox[
         RowBox[{"18", " ", "\[Rho]1yy"}], "35"], "+", 
        FractionBox[
         RowBox[{"9", " ", "\[Sigma]yy"}], "5"]}]},
      {
       RowBox[{"2", " ", "qy"}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"14", " ", "qy"}], "15"], "-", "\[Rho]0xxy"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"7", " ", "qx"}], "5"]}], "-", "\[Rho]0xyy"}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"28", " ", "qy"}], "15"]}], "-", "\[Rho]0yyy"}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"12", " ", "\[Rho]0xxy"}], "7"]}]},
      {
       RowBox[{"\[Rho]0xxx", "-", 
        FractionBox[
         RowBox[{"6", " ", "\[Rho]0xyy"}], "7"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"12", " ", "\[Rho]0xxy"}], "7"], "-", 
        FractionBox[
         RowBox[{"2", " ", "\[Rho]0yyy"}], "7"]}]},
      {
       FractionBox[
        RowBox[{"15", " ", "\[Rho]0xyy"}], "7"]},
      {
       FractionBox[
        RowBox[{"16", " ", "\[Rho]0yyy"}], "7"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.675954449791565*^9, 3.675954725480599*^9, 3.675954781625581*^9, {
   3.6762895598092937`*^9, 3.6762895830791817`*^9}, {3.676354659526585*^9, 
   3.6763546858130283`*^9}, 3.676355152247136*^9, 3.676355395009714*^9, 
   3.6781690756049013`*^9, 3.678169627722888*^9}]
}, Open  ]],

Cell[TextData[{
 "\nLet\[CloseCurlyQuote]s consider the extreme case ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Kn", "\[Rule]", "\[Infinity]"}], TraditionalForm]]],
 " which simplifies the equations ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", 
     FractionBox["dU", "dx"]}], "=", "0"}], TraditionalForm]]],
 ". \n\nFor certain 1D moment systems the transport matrix is regular and can \
be inverted, such that\nU = const is a solution. The constants then follow \
from the boundary conditions left and right.\n\nThis seems possible for all \
systems with an odd number of complete tensors\n(Ntensors = 6, 12, 20, 30, \
42, 56, ...)\n"
}], "Text",
 FontSize->16],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "VarNames", ",", "A", ",", "P", ",", "VarBC", ",", "BC", ",", "g"}], 
    "}"}], "=", 
   RowBox[{"GetMatrices1D", "[", "12", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"1.", "A"}], "]"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"BC", ",", 
     RowBox[{"BC", ".", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"1", "-", 
        RowBox[{"2", "VarBC"}]}], "]"}]}]}], "]"}], "]"}], ".", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"g", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pW", "\[Rule]", "p0"}], ",", 
       RowBox[{"TW", "\[Rule]", "T0"}]}], "}"}]}], ",", 
    RowBox[{"g", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pW", "\[Rule]", "p0"}], ",", 
       RowBox[{"TW", "\[Rule]", "T1"}]}], "}"}]}]}], "]"}]}]], "Input"],

Cell[TextData[{
 "\nSurprisingly, the result for lower moments does not change if the system \
is enlarged (with A invertible). Indeed, \nthe temperature is (T0+T1)/2 which \
is probably the exact result from the kinetic equation for Kn\[Rule]\
\[Infinity]. \n\nCHALLENGE: All the other moment systems using incomplete \
tensors should also give this result !!!!!\n\nHowever: If the transport \
matrix is not invertible there remains a nullspace, that is, we are \
\[OpenCurlyDoubleQuote]free\[CloseCurlyDoubleQuote] to choose a constant for \
\na certain combination of variables. The boundary conditions must be such \
that only the none-nullspace \ncomponents are specified. Then, the free \
choices must be such that the result is correct.... \n\nTo achieve this, it \
might be necessary to include production, i.e., to set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", "Kn"], "=", "\[Epsilon]"}], TraditionalForm]]],
 " and consider the value of the \nnullspace components for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "\[Rule]", "0"}], TraditionalForm]]],
 ".\n"
}], "Text",
 FontSize->16],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iTraces", "[", "5", "]"}]], "Input",
 CellChangeTimes->{{3.676314603882416*^9, 3.6763146395670643`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.676314606814904*^9, 3.676314640167033*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["G26 from git", "Section",
 CellChangeTimes->{{3.67421088236403*^9, 3.674210883228538*^9}, {
  3.6763557313950253`*^9, 3.6763557349777393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"neqn26", " ", "=", " ", "17"}], ";"}]], "Input",
 CellChangeTimes->{{3.676355751903214*^9, 3.676355756155223*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ax26", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"neqn26", ",", "neqn26"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Row26", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "0", ",", "3", ",", "1", ",", "4", ",", "1", ",", "5", ",", 
      "2", ",", "6", ",", "7", ",", "7", ",", "6", ",", "4", ",", "3", ",", 
      "8", ",", "5", ",", "9", ",", "4", ",", "10", ",", "5", ",", "11", ",", 
      "11", ",", "6", ",", "12", ",", "13", ",", "7", ",", "14", ",", "14", 
      ",", "11", ",", "9", ",", "7", ",", "15", ",", "15", ",", "12", ",", 
      "10", ",", "8", ",", "16", ",", "16", ",", "11"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Col26", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "1", ",", "1", ",", "3", ",", "1", ",", "4", ",", "2", ",", 
      "5", ",", "1", ",", "3", ",", "4", ",", "7", ",", "7", ",", "7", ",", 
      "5", ",", "8", ",", "4", ",", "9", ",", "5", ",", "10", ",", "6", ",", 
      "4", ",", "11", ",", "5", ",", "7", ",", "13", ",", "7", ",", "9", ",", 
      "14", ",", "14", ",", "14", ",", "8", ",", "10", ",", "15", ",", "15", 
      ",", "15", ",", "11", ",", "7", ",", "16"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Val26", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "0.6666666666666666"}], ",", "1.3333333333333333", ",", 
      "1", ",", "1", ",", "1", ",", 
      RowBox[{"-", "0.6666666666666666"}], ",", "1.6666666666666667", ",", 
      RowBox[{"-", "1"}], ",", "0.26666666666666666", ",", 
      RowBox[{"-", "0.5333333333333333"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "0.4"}], ",", "1.8", ",", "1", ",", "1.6", ",", "1", ",", 
      "1", ",", 
      RowBox[{"-", "0.4"}], ",", "1", ",", 
      RowBox[{"-", "1.2"}], ",", 
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "0.6666666666666666"}], ",", "1.8666666666666667", ",", 
      RowBox[{"-", "1"}], ",", "0.11428571428571428", ",", 
      RowBox[{"-", "0.5142857142857142"}], ",", "1", ",", "1.4", ",", 
      RowBox[{"-", "1"}], ",", "0.34285714285714286", ",", 
      RowBox[{"-", "0.45714285714285713"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "0.9333333333333333"}], ",", 
      RowBox[{"-", "0.2857142857142857"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ax26", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"Row26", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"Col26", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
     RowBox[{"Val26", "[", 
      RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", "1", ",", 
      RowBox[{"Length", "[", "Row26", "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.674210886092553*^9, 3.6742110060854197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"Eigenvalues", "[", "Ax26", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.676355764916046*^9, 3.676355785172254*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.756815472675976`", ",", 
   RowBox[{"-", "2.7568154726759757`"}], ",", "2.032464207655784`", ",", 
   RowBox[{"-", "2.032464207655782`"}], ",", "1.448616849805276`", ",", 
   RowBox[{"-", "1.4486168498052723`"}], ",", 
   RowBox[{"-", "1.1338934190276828`"}], ",", "1.1338934190276817`", ",", 
   "1.0078508750605453`", ",", 
   RowBox[{"-", "1.0078508750605428`"}], ",", 
   RowBox[{"-", "0.8521925262175223`"}], ",", "0.8521925262175222`", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.676355769357519*^9, 3.676355785509695*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rough Work", "Title",
 CellChangeTimes->{{3.677929248128832*^9, 3.677929250287393*^9}}],

Cell[CellGroupData[{

Cell["orthogonality of Laguerre polynomials", "Section",
 CellChangeTimes->{{3.677930668415245*^9, 3.6779306831611032`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "laguere", " ", "polynomials", " ", "used", " ", "in", " ", "boundary", 
    " ", "value", " ", "problem", " ", "paper"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"trialLaguere", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", 
           RowBox[{"3", "/", "2"}]}], "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", "s", "+", 
           RowBox[{"3", "/", "2"}]}], "]"}]}], 
        RowBox[{
         RowBox[{"n", "!"}], 
         RowBox[{"s", "!"}]}]]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          RowBox[{"Gamma", "[", 
           RowBox[{"n", "+", "p", "+", 
            RowBox[{"3", "/", "2"}]}], "]"}]], 
         RowBox[{"Binomial", "[", 
          RowBox[{"s", ",", "p"}], "]"}], 
         SuperscriptBox[
          RowBox[{"(", "x", ")"}], 
          RowBox[{"p", "+", 
           RowBox[{"n", "/", "2"}]}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"classical", " ", "laguerre", " ", "polynomials"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassicalLaguerre", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"n", "+", "s", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          RowBox[{"Gamma", "[", 
           RowBox[{"n", "+", "p", "+", 
            RowBox[{"3", "/", "2"}]}], "]"}]], 
         RowBox[{"Binomial", "[", 
          RowBox[{"s", ",", "p"}], "]"}], 
         SuperscriptBox[
          RowBox[{"(", "x", ")"}], "p"]}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "laguerre", " ", "polynomials", " ", "used", " ", "in", " ", "the", " ", 
     "computations", " ", 
     RowBox[{"above", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trialLaguere2", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"n", "!"}], 
         RowBox[{"s", "!"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", "s", "+", 
           RowBox[{"3", "/", "2"}]}], "]"}]}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"n", "+", 
          RowBox[{"3", "/", "2"}]}], "]"}]]], 
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", 
           RowBox[{"3", "/", "2"}]}], "]"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", "s", "+", 
           RowBox[{"3", "/", "2"}]}], "]"}]}], 
        RowBox[{
         RowBox[{"n", "!"}], 
         RowBox[{"s", "!"}]}]]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "p"], 
          RowBox[{"Gamma", "[", 
           RowBox[{"n", "+", "p", "+", 
            RowBox[{"3", "/", "2"}]}], "]"}]], 
         RowBox[{"Binomial", "[", 
          RowBox[{"s", ",", "p"}], "]"}], 
         SuperscriptBox[
          RowBox[{"(", "x", ")"}], 
          RowBox[{"p", "+", 
           RowBox[{"n", "/", "2"}]}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "s"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "weighted", " ", "norm", " ", "of", " ", "the", " ", "laguerre", " ", 
     "polynomials"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trialNormL", "[", 
     RowBox[{"n_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"radial", ",", "angular", ",", "result", ",", "Int1"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"radial", " ", "=", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"trialLaguere2", "[", 
             RowBox[{"n", ",", "s", ",", 
              FractionBox[
               SuperscriptBox["c", "2"], 
               RowBox[{"2", " ", "\[Theta]0"}]]}], "]"}], "2"], 
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{"-", 
              SuperscriptBox["c", "2"]}], 
             RowBox[{"2", "\[Theta]0"}]], "]"}], 
           SuperscriptBox["c", "2"]}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "0", ",", "Infinity"}], "}"}], ",", 
          RowBox[{"Assumptions", "\[Rule]", 
           RowBox[{"\[Theta]0", ">", "0"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "radial"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.677922744325004*^9, 3.6779229068867188`*^9}, 
   3.677922938954444*^9, {3.6779230552956343`*^9, 3.677923077166833*^9}, {
   3.677923130698187*^9, 3.6779232167655897`*^9}, {3.677923250727586*^9, 
   3.677923255951735*^9}, {3.6779235306781597`*^9, 3.677923557213912*^9}, {
   3.6779235961709127`*^9, 3.677923689501333*^9}, {3.677923773960453*^9, 
   3.6779237821616163`*^9}, {3.677923825836307*^9, 3.677923826372644*^9}, {
   3.677923858149123*^9, 3.677923886341552*^9}, {3.677923976353414*^9, 
   3.6779240368123627`*^9}, {3.677924080602618*^9, 3.6779240826646433`*^9}, {
   3.6779241300095263`*^9, 3.677924138290596*^9}, {3.677924168723885*^9, 
   3.677924169736343*^9}, {3.677924482050818*^9, 3.6779245074247828`*^9}, {
   3.677925663193678*^9, 3.677925687697406*^9}, {3.67792576267603*^9, 
   3.677925801222846*^9}, {3.677925851135507*^9, 3.677925878738638*^9}, {
   3.677926557616292*^9, 3.677926559699687*^9}, {3.6779266151904593`*^9, 
   3.677926619956213*^9}, {3.6779276967688913`*^9, 3.6779277284641123`*^9}, {
   3.677928743236581*^9, 3.67792874358574*^9}, {3.677928889008562*^9, 
   3.677928891744652*^9}, {3.677929023485203*^9, 3.677929058435594*^9}, {
   3.677930721386554*^9, 3.677930745122773*^9}, {3.677931368649564*^9, 
   3.677931427995603*^9}, 3.677931875644019*^9, 3.677931925182124*^9, {
   3.677936217194997*^9, 3.677936245730526*^9}, {3.677956754600809*^9, 
   3.677956798487685*^9}, {3.677956981587779*^9, 3.677956982443799*^9}, {
   3.677957092450882*^9, 3.677957146631549*^9}, {3.677957179483205*^9, 
   3.677957181818056*^9}, {3.677959991272732*^9, 3.677959993307498*^9}, 
   3.67796002437367*^9, 3.6779601012441196`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trialNormL", "[", 
  RowBox[{"6", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.677930735465139*^9, 3.677930751593479*^9}, {
  3.67793086869636*^9, 3.6779308753255568`*^9}, {3.6792343102076283`*^9, 
  3.679234310312194*^9}, {3.679234349542499*^9, 3.6792343509097643`*^9}}],

Cell[BoxData[
 RowBox[{"135135", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]], " ", 
  SuperscriptBox["\[Theta]0", 
   RowBox[{"3", "/", "2"}]]}]], "Output",
 CellChangeTimes->{
  3.677930760939258*^9, {3.677930871661922*^9, 3.677930876436582*^9}, 
   3.677936257010605*^9, 3.678095070558729*^9, 3.678181478132902*^9, 
   3.6791501791873426`*^9, 3.6792343112573347`*^9, 3.6792343513416567`*^9, 
   3.6793026522926064`*^9, 3.6793067303119087`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mixed", "[", 
  RowBox[{"0", ",", "6", ",", "0", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.677931326423917*^9, 3.677931337100183*^9}, {
  3.67793173280553*^9, 3.6779317360813503`*^9}, {3.677931843785674*^9, 
  3.677931855425519*^9}, {3.6779319400774603`*^9, 3.677931942360538*^9}}],

Cell[BoxData[
 RowBox[{"135135", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{
  3.6779313381768208`*^9, 3.677931737913775*^9, {3.67793184577349*^9, 
   3.677931856056744*^9}, 3.677931942732107*^9, 3.677936257090081*^9, 
   3.6780950705831633`*^9, 3.678181478154148*^9, 3.6791501799509287`*^9, 
   3.679302652326611*^9, 3.679306730362485*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"trialLaguere2", "[", 
       RowBox[{"6", ",", "0", ",", 
        FractionBox[
         SuperscriptBox["c", "2"], "2"]}], "]"}], "2"], 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{"-", 
        SuperscriptBox["c", "2"]}], 
       RowBox[{"2", " "}]], "]"}], 
     SuperscriptBox["c", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"\[Theta]0", ">", "0"}]}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["2", "6"], 
        RowBox[{"ClassicalLaguerre", "[", 
         RowBox[{"6", ",", "0", ",", 
          FractionBox[
           SuperscriptBox["c", "2"], 
           RowBox[{"2", "\[Theta]0"}]]}], "]"}]}], ")"}], "2"], 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{"-", 
        SuperscriptBox["c", "2"]}], 
       RowBox[{"2", " ", "\[Theta]0"}]], "]"}], 
     SuperscriptBox["c", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"\[Theta]0", ">", "0"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.677931432826089*^9, 3.677931520898539*^9}, {
   3.6779316736738243`*^9, 3.6779316882575397`*^9}, {3.6779317197574778`*^9, 
   3.677931743674066*^9}, {3.6779318068767567`*^9, 3.677931807771921*^9}, 
   3.677931911737762*^9, {3.677931946613516*^9, 3.6779319467374983`*^9}, {
   3.6779600309272823`*^9, 3.6779600922236967`*^9}, {3.678014473958618*^9, 
   3.678014501051607*^9}, {3.678014551132861*^9, 3.678014585069058*^9}}],

Cell[BoxData[
 RowBox[{"135135", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{{3.677931482792018*^9, 3.6779315215165377`*^9}, 
   3.677931689081286*^9, {3.677931724169491*^9, 3.677931744859219*^9}, 
   3.677931809354479*^9, {3.677931882421076*^9, 3.677931947197703*^9}, 
   3.677936257174305*^9, 3.677960092766087*^9, 3.678014502732633*^9, {
   3.678014560946068*^9, 3.678014585891631*^9}, 3.678095070689776*^9, 
   3.678181478251482*^9, 3.679150180041218*^9, 3.6793026524217463`*^9, 
   3.679306730448031*^9}],

Cell[BoxData[
 RowBox[{"2048", " ", 
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]], " ", 
  SuperscriptBox["\[Theta]0", 
   RowBox[{"3", "/", "2"}]]}]], "Output",
 CellChangeTimes->{{3.677931482792018*^9, 3.6779315215165377`*^9}, 
   3.677931689081286*^9, {3.677931724169491*^9, 3.677931744859219*^9}, 
   3.677931809354479*^9, {3.677931882421076*^9, 3.677931947197703*^9}, 
   3.677936257174305*^9, 3.677960092766087*^9, 3.678014502732633*^9, {
   3.678014560946068*^9, 3.678014585891631*^9}, 3.678095070689776*^9, 
   3.678181478251482*^9, 3.679150180041218*^9, 3.6793026524217463`*^9, 
   3.679306730534134*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trialNormL", "[", 
  RowBox[{"6", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.677960106109805*^9, 3.677960126215836*^9}}],

Cell[BoxData[
 RowBox[{"135135", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]], " ", 
  SuperscriptBox["\[Theta]0", 
   RowBox[{"3", "/", "2"}]]}]], "Output",
 CellChangeTimes->{{3.677960112177763*^9, 3.677960126660981*^9}, 
   3.678095070924388*^9, 3.678181478383115*^9, 3.679150180191266*^9, 
   3.679302652922176*^9, 3.679306730594648*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["integrals of laguerre polynomials", "Section",
 CellChangeTimes->{{3.677961163124371*^9, 3.677961169712151*^9}}],

Cell[TextData[{
 "In the following we compute integrals of the form \[Integral] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["L", "2"], 
    SuperscriptBox["\[Zeta]", "n"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[Zeta]", "2"]}], "/", "2"}]], 
    SuperscriptBox["\[Zeta]", "2"], "d\[Zeta]"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.677961176139804*^9, 3.6779612249479437`*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"integralsClassicalLaguerre", "[", 
     RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"n", "+", 
       RowBox[{"1", "/", "2"}]}]], 
     RowBox[{"s", "!"}], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"n", "+", "s", "+", 
       RowBox[{"3", "/", "2"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"integralsLaguerre", "[", 
     RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{
        RowBox[{"2", "n"}], "+", 
        RowBox[{"1", "/", "2"}]}]], 
      RowBox[{"Gamma", "[", 
       RowBox[{"n", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]}], 
     RowBox[{"n", "!"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"ClassicalLaguerre", "[", 
      RowBox[{"4", ",", "0", ",", "x"}], "]"}], "2"], 
    SuperscriptBox["x", "8"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["x", "2"]}], "/", "2"}]], 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Infinity]"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"integralsClassicalLaguerre", "[", 
  RowBox[{"4", ",", "0", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"integralsLaguerre", "[", 
  RowBox[{"4", ",", "0", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"trialLaguere", "[", 
      RowBox[{"4", ",", "0", ",", "x"}], "]"}], "2"], 
    SuperscriptBox["x", "4"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["x", "2"]}], "/", "2"}]], 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.677961237279333*^9, 3.6779615271517477`*^9}}],

Cell[BoxData[
 RowBox[{"945", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{{3.677961341450411*^9, 3.6779614051099873`*^9}, {
  3.67796148911736*^9, 3.6779615275672607`*^9}}],

Cell[BoxData[
 RowBox[{"945", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{{3.677961341450411*^9, 3.6779614051099873`*^9}, {
  3.67796148911736*^9, 3.677961527580708*^9}}],

Cell[BoxData[
 RowBox[{"315", " ", 
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{{3.677961341450411*^9, 3.6779614051099873`*^9}, {
  3.67796148911736*^9, 3.677961527590375*^9}}],

Cell[BoxData[
 RowBox[{"315", " ", 
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{{3.677961341450411*^9, 3.6779614051099873`*^9}, {
  3.67796148911736*^9, 3.677961527598507*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Recurrance relation", "Section",
 CellChangeTimes->{{3.677935721785096*^9, 3.677935724591771*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["L", "s"], "n"], "=", 
     RowBox[{
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["\[Omega]", "n"], ")"}], "s"], 
      SubscriptBox[
       RowBox[{"(", 
        SuperscriptBox["p", "n"], ")"}], "s"]}]}], ",", " ", 
    RowBox[{
    "so", " ", "\[Omega]", " ", "is", " ", "the", " ", "ratio", " ", 
     "between", " ", "the", " ", "classical", " ", "laguerre", " ", 
     "polynomials", " ", "and", " ", "the", " ", "laguerre", " ", 
     "polynomials", " ", "used", " ", "in", " ", "the", " ", "paper", " ", 
     "with", " ", 
     RowBox[{"BGK", ".", " ", "the"}], " ", "\[Omega]", " ", "below", " ", 
     "is", " ", "the", " ", "same", " ", "ratio", " ", "for", " ", "laguerre",
      " ", "polynomials", " ", "used", " ", "in", " ", "this", " ", 
     RowBox[{"file", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]], 
      SqrtBox[
       FractionBox[
        RowBox[{"Gamma", "[", 
         RowBox[{"n", "+", 
          RowBox[{"3", "/", "2"}]}], "]"}], 
        RowBox[{
         RowBox[{"n", "!"}], 
         RowBox[{"s", "!"}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"n", "+", "s", "+", 
           RowBox[{"3", "/", "2"}]}], "]"}]}]]], 
      SuperscriptBox["x", 
       RowBox[{"n", "/", "2"}]]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]2", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]], 
      SuperscriptBox["x", 
       RowBox[{"n", "/", "2"}]]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"recurranceClassical", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"ClassicalLaguerre", "[", 
        RowBox[{"n", ",", "s", ",", "x"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "s", "+", 
         FractionBox["1", "2"]}], ")"}], " ", 
       RowBox[{"ClassicalLaguerre", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", "s", ",", "x"}], "]"}]}], "+", 
      RowBox[{"ClassicalLaguerre", "[", 
       RowBox[{
        RowBox[{"n", "-", "1"}], ",", 
        RowBox[{"s", "+", "1"}], ",", "x"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"recurranceClassical2", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ClassicalLaguerre", "[", 
       RowBox[{"n", ",", "s", ",", "x"}], "]"}], "-", " ", 
      RowBox[{"ClassicalLaguerre", "[", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ",", "s", ",", "x"}], "]"}], "+", 
      RowBox[{"s", " ", 
       RowBox[{"ClassicalLaguerre", "[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", 
         RowBox[{"s", "-", "1"}], ",", "x"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"recurrancetrialLaguerre", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"trialLaguere", "[", 
        RowBox[{"n", ",", "s", ",", "x"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "s", "+", 
         FractionBox["1", "2"]}], ")"}], 
       FractionBox[
        RowBox[{"\[Omega]", "[", 
         RowBox[{"n", ",", "s", ",", "x"}], "]"}], 
        RowBox[{"\[Omega]", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "s", ",", "x"}], "]"}]], " ", 
       RowBox[{"trialLaguere", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", "s", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"trialLaguere", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", 
         RowBox[{"s", "+", "1"}], ",", "x"}], "]"}], 
       FractionBox[
        RowBox[{"\[Omega]", "[", 
         RowBox[{"n", ",", "s", ",", "x"}], "]"}], 
        RowBox[{"\[Omega]", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", 
          RowBox[{"s", "+", "1"}], ",", "x"}], "]"}]]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"recurrancetrialLaguerre2", "[", 
      RowBox[{"n_", ",", "s_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"trialLaguere2", "[", 
        RowBox[{"n", ",", "s", ",", "x"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "s", "+", 
         FractionBox["1", "2"]}], ")"}], 
       FractionBox[
        RowBox[{"\[Omega]2", "[", 
         RowBox[{"n", ",", "s", ",", "x"}], "]"}], 
        RowBox[{"\[Omega]2", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "s", ",", "x"}], "]"}]], " ", 
       RowBox[{"trialLaguere2", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", "s", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"trialLaguere2", "[", 
        RowBox[{
         RowBox[{"n", "-", "1"}], ",", 
         RowBox[{"s", "+", "1"}], ",", "x"}], "]"}], 
       FractionBox[
        RowBox[{"\[Omega]2", "[", 
         RowBox[{"n", ",", "s", ",", "x"}], "]"}], 
        RowBox[{"\[Omega]2", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", 
          RowBox[{"s", "+", "1"}], ",", "x"}], "]"}]]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trialn", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trials", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"recurrance", "[", 
     RowBox[{"trialn", ",", "trials", ",", "x"}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"recurrancetrialLaguerre", "[", 
     RowBox[{"trialn", ",", "trials", ",", "x"}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"recurrancetrialLaguerre2", "[", 
     RowBox[{"trialn", ",", "trials", ",", 
      SuperscriptBox["x", "2"]}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"recurranceClassical2", "[", 
     RowBox[{"trialn", ",", "trials", ",", "x"}], "]"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.677935727078639*^9, 3.67793582416717*^9}, {
  3.677936318668213*^9, 3.677936547541564*^9}, {3.6779365826079397`*^9, 
  3.677936601080853*^9}, {3.6779567381140823`*^9, 3.677956738748084*^9}, {
  3.677956817354672*^9, 3.6779568771742153`*^9}, {3.677956908277255*^9, 
  3.677956908590232*^9}, {3.677957262982696*^9, 3.677957263242805*^9}, {
  3.6779575241855917`*^9, 3.6779579585400667`*^9}, {3.678180873433462*^9, 
  3.678181000341867*^9}, {3.678181059250084*^9, 3.678181087354802*^9}, {
  3.678181535854209*^9, 3.678181656681711*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.677936547792054*^9, 3.677936601699017*^9}, 
   3.677956739858234*^9, {3.6779568795845413`*^9, 3.677956909498012*^9}, 
   3.677956995308535*^9, 3.677957263694942*^9, {3.6779576923086452`*^9, 
   3.677957711903245*^9}, 3.677957906625382*^9, {3.677957937226342*^9, 
   3.677957959113511*^9}, {3.6781809260295753`*^9, 3.6781810012230663`*^9}, {
   3.678181078178906*^9, 3.678181087777392*^9}, {3.678181598898324*^9, 
   3.678181656997594*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.677936547792054*^9, 3.677936601699017*^9}, 
   3.677956739858234*^9, {3.6779568795845413`*^9, 3.677956909498012*^9}, 
   3.677956995308535*^9, 3.677957263694942*^9, {3.6779576923086452`*^9, 
   3.677957711903245*^9}, 3.677957906625382*^9, {3.677957937226342*^9, 
   3.677957959113511*^9}, {3.6781809260295753`*^9, 3.6781810012230663`*^9}, {
   3.678181078178906*^9, 3.678181087777392*^9}, {3.678181598898324*^9, 
   3.678181657015081*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.677936547792054*^9, 3.677936601699017*^9}, 
   3.677956739858234*^9, {3.6779568795845413`*^9, 3.677956909498012*^9}, 
   3.677956995308535*^9, 3.677957263694942*^9, {3.6779576923086452`*^9, 
   3.677957711903245*^9}, 3.677957906625382*^9, {3.677957937226342*^9, 
   3.677957959113511*^9}, {3.6781809260295753`*^9, 3.6781810012230663`*^9}, {
   3.678181078178906*^9, 3.678181087777392*^9}, {3.678181598898324*^9, 
   3.678181657024735*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.677936547792054*^9, 3.677936601699017*^9}, 
   3.677956739858234*^9, {3.6779568795845413`*^9, 3.677956909498012*^9}, 
   3.677956995308535*^9, 3.677957263694942*^9, {3.6779576923086452`*^9, 
   3.677957711903245*^9}, 3.677957906625382*^9, {3.677957937226342*^9, 
   3.677957959113511*^9}, {3.6781809260295753`*^9, 3.6781810012230663`*^9}, {
   3.678181078178906*^9, 3.678181087777392*^9}, {3.678181598898324*^9, 
   3.678181657033394*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClassicalLaguerre", "[", 
  RowBox[{"n", ",", "s", ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Gamma", "[", 
    RowBox[{
     FractionBox["3", "2"], "+", "n", "+", "s"}], "]"}], " ", 
   RowBox[{"Hypergeometric1F1", "[", 
    RowBox[{
     RowBox[{"-", "s"}], ",", 
     RowBox[{
      FractionBox["3", "2"], "+", "n"}], ",", "x"}], "]"}]}], 
  RowBox[{"Gamma", "[", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"2", " ", "n"}]}], ")"}]}], "]"}]]], "Output",
 CellChangeTimes->{{3.677936547792054*^9, 3.677936601699017*^9}, 
   3.677956739858234*^9, {3.6779568795845413`*^9, 3.677956909498012*^9}, 
   3.677956995308535*^9, 3.677957263694942*^9, {3.6779576923086452`*^9, 
   3.677957711903245*^9}, 3.677957906625382*^9, {3.677957937226342*^9, 
   3.677957959113511*^9}, {3.6781809260295753`*^9, 3.6781810012230663`*^9}, {
   3.678181078178906*^9, 3.678181087812406*^9}, 3.6781814602851067`*^9, 
   3.678181500464698*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["orthogonality of basis functions", "Section",
 CellChangeTimes->{{3.677929258880911*^9, 3.677929263767886*^9}, {
  3.677930652654825*^9, 3.677930655869565*^9}}],

Cell["Only checked for n = 1", "Text",
 CellChangeTimes->{{3.6779298564789953`*^9, 3.677929865051168*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"trialNorm\[Psi]", "[", 
    RowBox[{"n_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"radial", ",", "angular", ",", "result", ",", "Int1"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"radial", " ", "=", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]", " ", "\[Theta]0"}], ")"}], 
          RowBox[{"3", "/", "2"}]]], " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"trialLaguere", "[", 
             RowBox[{"n", ",", "s", ",", 
              FractionBox[
               SuperscriptBox["c", "2"], 
               RowBox[{"2", " ", "\[Theta]0"}]]}], "]"}], "2"], 
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{"-", 
              SuperscriptBox["c", "2"]}], 
             RowBox[{"2", "\[Theta]0"}]], "]"}], 
           SuperscriptBox["c", "2"]}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "0", ",", "Infinity"}], "}"}], ",", 
          RowBox[{"Assumptions", "\[Rule]", 
           RowBox[{"\[Theta]0", ">", "0"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Int1", "=", 
       SuperscriptBox["\[Nu]x", "2"]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"angular", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Int1", "*", 
          RowBox[{"Sin", "[", "\[Nu]", "]"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Nu]x", "\[Rule]", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Nu]", "]"}], 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
          RowBox[{"\[Nu]y", "\[Rule]", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Nu]", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
          RowBox[{"\[Nu]z", "->", 
           RowBox[{"Cos", "[", "\[Nu]", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"angular", " ", "=", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{"angular", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{"radial", "*", "angular"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.677922744325004*^9, 3.6779229068867188`*^9}, 
   3.677922938954444*^9, {3.6779230552956343`*^9, 3.677923077166833*^9}, {
   3.677923130698187*^9, 3.6779232167655897`*^9}, {3.677923250727586*^9, 
   3.677923255951735*^9}, {3.6779235306781597`*^9, 3.677923557213912*^9}, {
   3.6779235961709127`*^9, 3.677923689501333*^9}, {3.677923773960453*^9, 
   3.6779237821616163`*^9}, {3.677923825836307*^9, 3.677923826372644*^9}, {
   3.677923858149123*^9, 3.677923886341552*^9}, {3.677923976353414*^9, 
   3.6779240368123627`*^9}, {3.677924080602618*^9, 3.6779240826646433`*^9}, {
   3.6779241300095263`*^9, 3.677924138290596*^9}, {3.677924168723885*^9, 
   3.677924169736343*^9}, {3.677924482050818*^9, 3.6779245074247828`*^9}, {
   3.677925663193678*^9, 3.677925687697406*^9}, {3.67792576267603*^9, 
   3.677925801222846*^9}, {3.677925851135507*^9, 3.677925878738638*^9}, {
   3.677926557616292*^9, 3.677926559699687*^9}, {3.6779266151904593`*^9, 
   3.677926619956213*^9}, {3.6779276967688913`*^9, 3.6779277284641123`*^9}, {
   3.677928743236581*^9, 3.67792874358574*^9}, {3.677928889008562*^9, 
   3.677928891744652*^9}, {3.677929023485203*^9, 3.677929058435594*^9}, {
   3.677931594297409*^9, 3.6779316090642643`*^9}, {3.6779316477379923`*^9, 
   3.6779316525521727`*^9}, {3.677936268151051*^9, 3.67793629407478*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trialNorm\[Psi]", "[", 
  RowBox[{"1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.677931633415978*^9, 3.677931640270035*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6779316408623543`*^9, 3.6779316553406754`*^9}, {
  3.677936279657268*^9, 3.6779362981620283`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"trialLaguere", "[", 
   RowBox[{"2", ",", "0", ",", "x"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"trialLaguere2", "[", 
   RowBox[{"0", ",", "1", ",", "x"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.678095072099494*^9, 3.678095076963572*^9}, {
  3.6780951308097563`*^9, 3.6780951311581297`*^9}, {3.678095301793152*^9, 
  3.678095318496006*^9}, {3.67809576610913*^9, 3.678095768116089*^9}, {
  3.6780958561222773`*^9, 3.678095857592392*^9}}],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", "x"}]], "Output",
 CellChangeTimes->{
  3.678095077152598*^9, 3.6780951320365877`*^9, {3.67809530430506*^9, 
   3.6780953187988663`*^9}, 3.678095768647707*^9, 3.678095858117304*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "2"], "-", "x"}]], "Output",
 CellChangeTimes->{
  3.678095077152598*^9, 3.6780951320365877`*^9, {3.67809530430506*^9, 
   3.6780953187988663`*^9}, 3.678095768647707*^9, 3.678095858123529*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Mapping to old system and conventional variables", "Section",
 CellChangeTimes->{{3.679135022893161*^9, 3.679135034708869*^9}, {
  3.679151073679915*^9, 3.679151079219372*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "transformation", " ", "from", " ", "current", " ", "moments", " ", "to", 
    " ", "old", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "convert", " ", "the", " ", "variables", " ", "to", " ", "the", 
    " ", "old", " ", "system", " ", "do", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"conversionMatrix", "[", "n", "]"}], "]"}], ".", "Ax", ".", 
     RowBox[{"conversionMatrix", "[", "n", "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"conversionMatrix", "[", "Ntensors_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "TransformMatrix", ",", "varIdx", ",", "varIdxComplete", ",", 
        "ToConventional", ",", "OldToConventional", ",", "OldVariables"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "compute", " ", "the", " ", "tensor", " ", "degree", " ", "and", " ", 
         "the", " ", "number", " ", "of", " ", "traces", " ", "for", " ", 
         "every", " ", "tensor", " ", "in", " ", "the", " ", 
         RowBox[{"system", ".", "\[IndentingNewLine]", "In"}], " ", "all", 
         " ", "the", " ", "coming", " ", "computations"}], ",", " ", 
        RowBox[{
        "iTraces", " ", "will", " ", "be", " ", "represented", " ", "by", " ", 
         RowBox[{"a", ".", "sa"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"varIdx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"iTraces", "[", "i", "]"}], ",", 
            RowBox[{"iTensorDegree", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ntensors"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "same", " ", "as", " ", "IDXtrf", " ", "but", " ", "instead", " ", 
         "stores", " ", "the", " ", "value", " ", "of", " ", "the", " ", 
         "number", " ", "of", " ", "traces", " ", "in", " ", "the", " ", 
         "first", " ", "argument", " ", "of", " ", "every", " ", "list"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"varIdxComplete", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                 ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"IDXtrf", "[", 
                 RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                  RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
                ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"varIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "varIdx", "]"}]}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Final", " ", "diagonal", " ", "matrix", " ", "for", " ", 
         "conversion"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"TransformMatrix", " ", "=", " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "!"}], 
                RowBox[{
                 RowBox[{"idx", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "!"}], 
                RowBox[{"Gamma", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "+", 
                  RowBox[{"idx", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  FractionBox["3", "2"]}], "]"}]}], ")"}], "/", 
              RowBox[{"Gamma", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"idx", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"idx", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "+", 
                  RowBox[{"idx", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "+", 
                RowBox[{"3", "/", "2"}]}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Same", " ", "as", " ", "above", " ", "but", " ", "element", " ", 
         "wise"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ToConventional", "  ", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"w", ",", "idx"}], "]"}], "->", 
           RowBox[{
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "!"}], 
                 RowBox[{
                  RowBox[{"idx", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "!"}], 
                 RowBox[{"Gamma", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    RowBox[{"idx", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "+", 
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   FractionBox["3", "2"]}], "]"}]}], ")"}], "/", 
               RowBox[{"Gamma", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                   RowBox[{"idx", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "+", 
                 RowBox[{"3", "/", "2"}]}], "]"}]}], ")"}]}], 
            RowBox[{"Apply", "[", 
             RowBox[{"\[Psi]", ",", "idx"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"OldVariables", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"\[Psi]", ",", "idx"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"idx", ",", "varIdxComplete"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"old", " ", "variables", " ", "to", " ", "conventional"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"OldToConventional", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"\[Rho]", ",", "vx", ",", "vy", ",", 
          RowBox[{
           RowBox[{"-", 
            SqrtBox[
             FractionBox["3", "2"]]}], " ", "\[Theta]"}], ",", 
          FractionBox["\[Sigma]xx", 
           SqrtBox["2"]], ",", 
          FractionBox["\[Sigma]xy", 
           SqrtBox["2"]], ",", 
          FractionBox["\[Sigma]yy", 
           SqrtBox["2"]], ",", 
          RowBox[{
           RowBox[{"-", 
            SqrtBox[
             FractionBox["2", "5"]]}], "qx"}], ",", 
          RowBox[{
           RowBox[{"-", 
            SqrtBox[
             FractionBox["2", "5"]]}], "qy"}], ",", 
          FractionBox["mxxx", 
           SqrtBox["6"]], ",", 
          FractionBox["mxxy", 
           SqrtBox["6"]], ",", 
          FractionBox["mxyy", 
           SqrtBox["6"]], ",", 
          FractionBox["myyy", 
           SqrtBox["6"]], ",", 
          FractionBox["\[CapitalDelta]", 
           RowBox[{"2", " ", 
            SqrtBox["30"]}]], ",", 
          FractionBox[
           RowBox[{"-", "Rxx"}], 
           RowBox[{"2", 
            SqrtBox["7"]}]], ",", 
          FractionBox[
           RowBox[{"-", "Rxy"}], 
           RowBox[{"2", 
            SqrtBox["7"]}]], ",", 
          FractionBox[
           RowBox[{"-", "Ryy"}], 
           RowBox[{"2", 
            SqrtBox["7"]}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"OldToConventional", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OldVariables", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", 
           RowBox[{"OldToConventional", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"Length", "[", "OldToConventional", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ToConventional", "=", 
        RowBox[{"ToConventional", "/.", "OldToConventional"}]}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "can", " ", "be", " ", "multiplied", " ", "from", " ", "the", " ", "left",
      " ", "and", " ", "the", " ", 
     RowBox[{"right", ".", "For"}], " ", "G26"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conversionMatrix2", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " "}], "2"]}], ",", "1", ",", "1", ",", "1", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox[
         RowBox[{"-", "1"}], "2"], ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}], ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQrdFzYWdK5mvHU5d7D4HoG5+OXgDRSTv3XgPRy9q/
vgTR5862fAXRr16d/w2i52zd8R9Er5igL54KpOO3tsmDaKlgQU8QzXjoqR+I
Fri7PQhEa709GQqiHYsulILoTckGZSD6EUNcJ4i+krMMTEtwG9unAWmzDQfd
QHRMZHkFiF7V9XwxiP7lwLMCRO+56b0VRP9xOLMLRCfd9jwHorkT5R+AaDa7
XDB95UTOcxC9Rv3mBxAt8zJfMB1Im7yuEALR/D2FZ3uA9A7raWD6QWXjCxAt
ZP8VTC869/QjiK7IYfsEok2l1mZMALlrNkMmiP6ou0d4R9Zrx2BlPWUQXXBO
1QBEH7mTAaYBhZS5Dw==
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["G26 system", "Section",
 CellChangeTimes->{{3.679224810533169*^9, 3.679224812049224*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"systemG26", " ", "=", " ", 
   RowBox[{"GetMatrices1D", "[", "8", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"variablesG26", " ", "=", " ", 
   RowBox[{"systemG26", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AxG26", " ", "=", " ", 
   RowBox[{"systemG26", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AyG26", " ", "=", " ", 
   RowBox[{"systemG26", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCraw2G26", " ", "=", " ", 
    RowBox[{"systemG26", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"conversionMatrix", "[", "8", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BCraw2G26", ".", "variablesG26"}], "/.", 
   RowBox[{"conversionMatrix", "[", "8", "]"}]}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.679224824226304*^9, 3.679224843111251*^9}, {
  3.679224881281598*^9, 3.679224970551422*^9}, {3.67922500958366*^9, 
  3.679225012620419*^9}, {3.6792254750794497`*^9, 3.679225505504656*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"number of different tensor degrees: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2", ",", "1", ",", "0"}], "}"}]}],
  SequenceForm["number of different tensor degrees: ", {3, 2, 2, 1, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.679224949716915*^9, 3.6792249709487667`*^9}, 
   3.679225012985792*^9, {3.679225486524817*^9, 3.679225505883621*^9}, {
   3.679829700910707*^9, 3.679829706524516*^9}, 3.6798303114091682`*^9, 
   3.679914543160144*^9, 3.679914573931723*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"corresponding variables (traces,indices): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}],
  SequenceForm[
  "corresponding variables (traces,indices): ", {{0, 0}, {1, 0}, {2, 0}, {0, 
   1}, {1, 1}, {0, 2}, {1, 2}, {0, 3}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.679224949716915*^9, 3.6792249709487667`*^9}, 
   3.679225012985792*^9, {3.679225486524817*^9, 3.679225505883621*^9}, {
   3.679829700910707*^9, 3.679829706524516*^9}, 3.6798303114091682`*^9, 
   3.679914543160144*^9, 3.679914573937942*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 1D: \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Number of Variables 1D: ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.679224949716915*^9, 3.6792249709487667`*^9}, 
   3.679225012985792*^9, {3.679225486524817*^9, 3.679225505883621*^9}, {
   3.679829700910707*^9, 3.679829706524516*^9}, 3.6798303114091682`*^9, 
   3.679914543160144*^9, 3.6799145739459763`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 2D: \"\>", "\[InvisibleSpace]", "17"}],
  SequenceForm["Number of Variables 2D: ", 17],
  Editable->False]], "Print",
 CellChangeTimes->{{3.679224949716915*^9, 3.6792249709487667`*^9}, 
   3.679225012985792*^9, {3.679225486524817*^9, 3.679225505883621*^9}, {
   3.679829700910707*^9, 3.679829706524516*^9}, 3.6798303114091682`*^9, 
   3.679914543160144*^9, 3.679914573954208*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of Variables 3D: \"\>", "\[InvisibleSpace]", "26"}],
  SequenceForm["Number of Variables 3D: ", 26],
  Editable->False]], "Print",
 CellChangeTimes->{{3.679224949716915*^9, 3.6792249709487667`*^9}, 
   3.679225012985792*^9, {3.679225486524817*^9, 3.679225505883621*^9}, {
   3.679829700910707*^9, 3.679829706524516*^9}, 3.6798303114091682`*^9, 
   3.679914543160144*^9, 3.679914573961945*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of full Tensors 3D: \"\>", "\[InvisibleSpace]", 
   "3.4000000000000004`"}],
  SequenceForm["Number of full Tensors 3D: ", 3.4000000000000004`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.679224949716915*^9, 3.6792249709487667`*^9}, 
   3.679225012985792*^9, {3.679225486524817*^9, 3.679225505883621*^9}, {
   3.679829700910707*^9, 3.679829706524516*^9}, 3.6798303114091682`*^9, 
   3.679914543160144*^9, 3.6799145739702663`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "\[Rho]"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "vx"}], 
   ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", "vy"}], 
   ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "\[Theta]"}], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "\[Sigma]xx"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "\[Sigma]xy"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "\[Sigma]yy"}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"-", "qx"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"-", "qy"}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "3", ",", "0", ",", "0"}], "]"}], "\[Rule]", "mxxx"}], 
   ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}], "\[Rule]", "mxxy"}], 
   ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "1", ",", "2", ",", "0"}], "]"}], "\[Rule]", "mxyy"}], 
   ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"0", ",", "0", ",", "3", ",", "0"}], "]"}], "\[Rule]", "myyy"}], 
   ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    FractionBox["\[CapitalDelta]", "4"]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox["Rxx", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox["Rxy", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox["Ryy", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6792249497810507`*^9, 3.679224971024879*^9}, 
   3.679225013043477*^9, {3.679225486587419*^9, 3.679225505937252*^9}, {
   3.679829700963839*^9, 3.679829706577612*^9}, 3.679830311462099*^9, 
   3.679914543206862*^9, 3.679914573979808*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["Rxx", "4"]}], "-", 
        FractionBox["\[CapitalDelta]", "16"], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[Theta]"}], "4"], "+", "\[Rho]", "+", 
        "\[Sigma]xx"}]},
      {"0"},
      {"0"},
      {"0"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"3", " ", "mxxy"}], "2"], "+", 
        FractionBox["qy", "4"], "+", 
        FractionBox["vy", "2"]}]},
      {"0"},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"11", " ", "Rxx"}], "20"]}], "-", 
        FractionBox[
         RowBox[{"17", " ", "\[CapitalDelta]"}], "80"], "-", 
        FractionBox[
         RowBox[{"21", " ", "\[Theta]"}], "20"], "+", 
        FractionBox["\[Rho]", "5"], "-", 
        FractionBox["\[Sigma]xx", "5"]}]},
      {"0"},
      {
       RowBox[{
        FractionBox["Rxx", "10"], "-", 
        FractionBox["\[CapitalDelta]", "80"], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[Theta]"}], "20"], "-", 
        FractionBox["\[Rho]", "15"], "+", 
        FractionBox[
         RowBox[{"2", " ", "\[Sigma]xx"}], "5"]}]},
      {"0"},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox["Rxx", "120"]}], "+", 
        FractionBox["Ryy", "12"], "+", 
        FractionBox["\[CapitalDelta]", "160"], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[Theta]"}], "40"], "+", 
        FractionBox["\[Rho]", "30"], "-", 
        FractionBox["\[Sigma]xx", "30"], "+", 
        FractionBox["\[Sigma]yy", "3"]}]},
      {"0"},
      {"0"},
      {"0"},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "mxxy"}], "14"]}], "-", 
        FractionBox[
         RowBox[{"11", " ", "qy"}], "28"], "+", 
        FractionBox["vy", "14"]}]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6792249497810507`*^9, 3.679224971024879*^9}, 
   3.679225013043477*^9, {3.679225486587419*^9, 3.679225505937252*^9}, {
   3.679829700963839*^9, 3.679829706577612*^9}, 3.679830311462099*^9, 
   3.679914543206862*^9, 3.679914573988371*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["G26 explicit boundary computation", "Section",
 CellChangeTimes->{{3.679150110009618*^9, 3.6791501321664762`*^9}}],

Cell["\<\
In the following section, we will first compute the boundary conditions \
corresponding to the first test function. \
\>", "Text",
 CellChangeTimes->{{3.679150246986535*^9, 3.679150271947714*^9}, {
  3.679213131630886*^9, 3.679213134973316*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Radialf", " ", "=", " ", 
     RowBox[{"trialLaguere", "[", 
      RowBox[{"1", ",", "1", ",", 
       FractionBox[
        SuperscriptBox["x", "2"], "2"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angularf", " ", "=", " ", "\[Nu]y"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RadialW", " ", "=", " ", 
     RowBox[{"trialLaguere", "[", 
      RowBox[{"1", ",", "1", ",", 
       FractionBox[
        SuperscriptBox["x", "2"], "2"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angularW", " ", "=", " ", "\[Nu]y"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"resultRadial", " ", "=", " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Radialf", " ", "RadialW", " ", 
       SuperscriptBox["x", "2"], 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"-", 
          SuperscriptBox["x", "2"]}], "2"], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resultangular", " ", "=", " ", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Nu]", "]"}], "*", "angularf", "*", 
          "angularW"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Nu]x", "\[Rule]", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Nu]", "]"}], 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ",", 
          RowBox[{"\[Nu]y", "\[Rule]", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Nu]", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f0", " ", "=", " ", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], 
       RowBox[{"3", "/", "2"}]]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"result", " ", "=", " ", 
    RowBox[{
    "resultRadial", " ", "*", " ", "resultangular", "*", 
     "f0"}]}]}]}]], "Input",
 CellChangeTimes->{{3.679150465200976*^9, 3.679150712547818*^9}, {
   3.679150762272265*^9, 3.679150765198217*^9}, {3.679150908627254*^9, 
   3.6791510222267647`*^9}, {3.679151746499914*^9, 3.679151791878701*^9}, {
   3.6792128200520277`*^9, 3.679213084138877*^9}, {3.6792269578307447`*^9, 
   3.679226959684731*^9}, {3.6792269913568487`*^9, 3.679226993727417*^9}, {
   3.67922707318719*^9, 3.679227303009136*^9}, {3.679227338531363*^9, 
   3.679227415612391*^9}, {3.67922745287667*^9, 3.6792274533358297`*^9}, {
   3.679227531837618*^9, 3.679227557463482*^9}, {3.679229894996654*^9, 
   3.67922990648947*^9}, {3.679235603159886*^9, 3.679235631897873*^9}, {
   3.6792356833543177`*^9, 3.679235768837617*^9}, {3.67929989227048*^9, 
   3.679299908419085*^9}, {3.679300011496203*^9, 3.679300017016287*^9}, 
   3.6793001132477627`*^9, {3.6793005784261*^9, 3.6793005865297003`*^9}, {
   3.679300663681304*^9, 3.679300754052993*^9}, {3.679300798941526*^9, 
   3.6793009128297462`*^9}, {3.679301486206134*^9, 3.6793015055680733`*^9}, {
   3.679302636290399*^9, 3.679302685860671*^9}, {3.679303597323085*^9, 
   3.6793036154032793`*^9}, 3.679304340244988*^9, {3.679306691036634*^9, 
   3.6793067465326757`*^9}}],

Cell[BoxData[
 RowBox[{"3", " ", 
  SqrtBox[
   FractionBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{{3.679151765601149*^9, 3.6791517925487537`*^9}, {
   3.6792130584564037`*^9, 3.679213084855389*^9}, 3.6792269634574833`*^9, 
   3.6792271071101933`*^9, 3.679227417987919*^9, 3.679227456097104*^9, {
   3.6792275426119213`*^9, 3.6792275580333242`*^9}, {3.6792298976759663`*^9, 
   3.679229906834653*^9}, 3.6792356326327953`*^9, 3.6793006245262003`*^9, {
   3.6793026452563143`*^9, 3.6793026863560047`*^9}, 3.67930362120081*^9, 
   3.679304340733025*^9, {3.6793067249200497`*^9, 3.6793067473528843`*^9}}],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.679151765601149*^9, 3.6791517925487537`*^9}, {
   3.6792130584564037`*^9, 3.679213084855389*^9}, 3.6792269634574833`*^9, 
   3.6792271071101933`*^9, 3.679227417987919*^9, 3.679227456097104*^9, {
   3.6792275426119213`*^9, 3.6792275580333242`*^9}, {3.6792298976759663`*^9, 
   3.679229906834653*^9}, 3.6792356326327953`*^9, 3.6793006245262003`*^9, {
   3.6793026452563143`*^9, 3.6793026863560047`*^9}, 3.67930362120081*^9, 
   3.679304340733025*^9, {3.6793067249200497`*^9, 3.679306747442412*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Numerator", "[", "result", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.679306816034766*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"bc", "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "2", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.67930680455105*^9, 3.679306822688222*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "420"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"147", " ", 
     SqrtBox["10"], " ", "\[Theta]W"}], "-", 
    RowBox[{"42", " ", 
     SqrtBox["10"], " ", "\[Rho]W"}], "+", 
    RowBox[{"42", " ", 
     SqrtBox["10"], " ", 
     RowBox[{"w", "[", 
      RowBox[{"0", ",", "0"}], "]"}]}], "-", 
    RowBox[{"42", " ", 
     SqrtBox["5"], " ", 
     RowBox[{"w", "[", 
      RowBox[{"0", ",", "2"}], "]"}]}], "+", 
    RowBox[{"98", " ", 
     SqrtBox["15"], " ", 
     RowBox[{"w", "[", 
      RowBox[{"1", ",", "0"}], "]"}]}], "+", 
    FractionBox[
     RowBox[{"210", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", 
      RowBox[{"w", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], "\[Chi]1"], "+", 
    RowBox[{"33", " ", 
     SqrtBox["70"], " ", 
     RowBox[{"w", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "-", 
    RowBox[{"119", " ", 
     SqrtBox["3"], " ", 
     RowBox[{"w", "[", 
      RowBox[{"2", ",", "0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.679306812930957*^9, 3.679306823151713*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["R13 system(From Git)", "Section",
 CellChangeTimes->{{3.67991362796502*^9, 3.679913634111332*^9}, {
  3.679913679872384*^9, 3.679913680460202*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"neqnR13", " ", "=", " ", "17"}], ";"}]], "Input",
 CellChangeTimes->{{3.679913709144618*^9, 3.67991371452239*^9}, {
  3.679913758166546*^9, 3.6799137582583933`*^9}}],

Cell[CellGroupData[{

Cell["Ax and Production", "Subsection",
 CellChangeTimes->{{3.6799136886007357`*^9, 3.679913690442787*^9}, {
  3.6799138016686497`*^9, 3.679913803703191*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Axr13", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"neqnR13", ",", "neqnR13"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxRow13", " ", "=", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "0", ",", "3", ",", "1", ",", "4", ",", "1", ",", "5", ",", 
      "2", ",", "6", ",", "7", ",", "7", ",", "6", ",", "4", ",", "3", ",", 
      "8", ",", "5", ",", "9", ",", "4", ",", "10", ",", "5", ",", "11", ",", 
      "11", ",", "6", ",", "12", ",", "13", ",", "7", ",", "14", ",", "7", 
      ",", "15", ",", "8", ",", "16"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxCol13", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "1", ",", "1", ",", "3", ",", "1", ",", "4", ",", "2", ",", 
      "5", ",", "1", ",", "3", ",", "4", ",", "7", ",", "7", ",", "7", ",", 
      "5", ",", "8", ",", "4", ",", "9", ",", "5", ",", "10", ",", "6", ",", 
      "4", ",", "11", ",", "5", ",", "7", ",", "13", ",", "7", ",", "14", ",",
       "8", ",", "15", ",", "7"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxVal13", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "0.6666666666666666"}], ",", "1.3333333333333333", ",", 
      "1", ",", "1", ",", "1", ",", 
      RowBox[{"-", "0.6666666666666666"}], ",", "1.6666666666666667", ",", 
      RowBox[{"-", "1"}], ",", "0.26666666666666666", ",", 
      RowBox[{"-", "0.5333333333333333"}], ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "0.4"}], ",", "1.8", ",", "1", ",", "1.6", ",", "1", ",", 
      "1", ",", 
      RowBox[{"-", "0.4"}], ",", "1", ",", 
      RowBox[{"-", "1.2"}], ",", 
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "0.6666666666666666"}], ",", "1.8666666666666667", ",", 
      "1", ",", "1.4", ",", "1", ",", 
      RowBox[{"-", "0.9333333333333333"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Production", " ", "term"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PR13", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"neqnR13", ",", "neqnR13"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diagonalPR13", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", 
      "0.6666666666666666", ",", "0.6666666666666666", ",", "1.5", ",", "1.5",
       ",", "1.5", ",", "1.5", ",", "0.6666666666666666", ",", 
      "1.1666666666666667", ",", "1.1666666666666667", ",", 
      "1.1666666666666667"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PR13", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", "diagonalPR13", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Axr13", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"AxRow13", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"AxCol13", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
      RowBox[{"AxVal13", "[", 
       RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", 
       RowBox[{"Length", "[", "AxRow13", "]"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "making", " ", "the", " ", "production", " ", "term", " ", "invertible"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempPR13", " ", "=", " ", "PR13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tempPR13", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "ii"}], "]"}], "]"}], "=", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "1", ",", "4"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Axr13", " ", "=", " ", 
   RowBox[{"Rationalize", "[", "Axr13", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679913745820375*^9, 3.679913747240993*^9}, {
  3.67991379200252*^9, 3.67991382113494*^9}, {3.6799138720974083`*^9, 
  3.679914080929975*^9}, {3.679914217688883*^9, 3.679914251715291*^9}, {
  3.679915561610223*^9, 3.679915561706937*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "conversionMatrix2", "]"}], ".", "Axr13", ".", 
   "conversionMatrix2", ".", "varConventional"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.679913834816463*^9, 3.6799138627778*^9}, {
   3.679914147117592*^9, 3.679914177568577*^9}, {3.679914258200849*^9, 
   3.6799142583864202`*^9}, 3.6799143541390743`*^9, 3.679914772333531*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"vx"},
      {
       RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]xx"}]},
      {"\[Sigma]xy"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "qx"}], "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "vx"}], "3"]}]},
      {
       RowBox[{"mxxx", "+", 
        FractionBox[
         RowBox[{"8", " ", "qx"}], "15"], "+", 
        FractionBox[
         RowBox[{"4", " ", "vx"}], "3"]}]},
      {
       RowBox[{"mxxy", "+", 
        FractionBox[
         RowBox[{"2", " ", "qy"}], "5"], "+", "vy"}]},
      {
       RowBox[{"mxyy", "-", 
        FractionBox[
         RowBox[{"4", " ", "qx"}], "15"], "-", 
        FractionBox[
         RowBox[{"2", " ", "vx"}], "3"]}]},
      {
       RowBox[{
        FractionBox["Rxx", "2"], "+", 
        FractionBox["\[CapitalDelta]", "6"], "+", 
        FractionBox[
         RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]xx"}]},
      {
       RowBox[{
        FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}]},
      {
       FractionBox[
        RowBox[{"9", " ", "\[Sigma]xx"}], "5"]},
      {
       FractionBox[
        RowBox[{"8", " ", "\[Sigma]xy"}], "5"]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[Sigma]xx"}], "5"]}], "+", "\[Sigma]yy"}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{"8", " ", "qx"}]},
      {
       FractionBox[
        RowBox[{"56", " ", "qx"}], "15"]},
      {
       FractionBox[
        RowBox[{"14", " ", "qy"}], "5"]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"28", " ", "qx"}], "15"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6799138407218847`*^9, 3.679913863278517*^9}, {
   3.6799141697833977`*^9, 3.67991417786406*^9}, 3.679914258829096*^9, 
   3.679914772694655*^9, 3.679915566926649*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AxR13", ".", "varConventional"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.67991502954185*^9, 3.679915036239175*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"vx"},
      {
       RowBox[{"\[Theta]", "+", "\[Rho]", "+", "\[Sigma]xx"}]},
      {"\[Sigma]xy"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "qx"}], "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "vx"}], "3"]}]},
      {
       RowBox[{"mxxx", "+", 
        FractionBox[
         RowBox[{"8", " ", "qx"}], "15"], "+", 
        FractionBox[
         RowBox[{"4", " ", "vx"}], "3"]}]},
      {
       RowBox[{"mxxy", "+", 
        FractionBox[
         RowBox[{"2", " ", "qy"}], "5"], "+", "vy"}]},
      {
       RowBox[{"mxyy", "-", 
        FractionBox[
         RowBox[{"4", " ", "qx"}], "15"], "-", 
        FractionBox[
         RowBox[{"2", " ", "vx"}], "3"]}]},
      {
       RowBox[{
        FractionBox["Rxx", "2"], "+", 
        FractionBox["\[CapitalDelta]", "6"], "+", 
        FractionBox[
         RowBox[{"5", " ", "\[Theta]"}], "2"], "+", "\[Sigma]xx"}]},
      {
       RowBox[{
        FractionBox["Rxy", "2"], "+", "\[Sigma]xy"}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"9", " ", "\[Sigma]xx"}], "5"]}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"8", " ", "\[Sigma]xy"}], "5"]}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[Sigma]xx"}], "5"], "-", "\[Sigma]yy"}]},
      {
       FractionBox[
        RowBox[{"6", " ", "\[Sigma]xy"}], "5"]},
      {
       RowBox[{
        RowBox[{"-", "8"}], " ", "qx"}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"56", " ", "qx"}], "15"]}]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"14", " ", "qy"}], "5"]}]},
      {
       FractionBox[
        RowBox[{"28", " ", "qx"}], "15"]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.67991503664369*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[", 
  RowBox[{"Eigenvalues", "[", "AxR13", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{
    RowBox[{"Inverse", "[", "conversionMatrix2", "]"}], ".", "Axr13", ".", 
    "conversionMatrix2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.679914283073759*^9, 3.67991429081703*^9}, {
  3.679914814536569*^9, 3.679914845587384*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.638216656968964`"}], ",", "2.638216656968964`", ",", 
   RowBox[{"-", "1.8153360887203043`"}], ",", "1.8153360887203043`", ",", 
   RowBox[{"-", "1.5880854721062905`"}], ",", "1.5880854721062905`", ",", 
   RowBox[{"-", "1.0509780611362294`"}], ",", "1.0509780611362294`", ",", 
   RowBox[{"-", "1.`"}], ",", "1.`", ",", 
   RowBox[{"-", "0.847229251251657`"}], ",", "0.847229251251657`", ",", "0.`",
    ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.679914287690852*^9, 3.6799142911350613`*^9}, {
   3.6799148179699793`*^9, 3.679914846452776*^9}, 3.679915580794606*^9, 
   3.6799157099366903`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.638216656968964`"}], ",", "2.638216656968964`", ",", 
   RowBox[{"-", "1.8153360887203043`"}], ",", "1.8153360887203043`", ",", 
   RowBox[{"-", "1.5880854721062905`"}], ",", "1.5880854721062905`", ",", 
   RowBox[{"-", "1.0509780611362294`"}], ",", "1.0509780611362294`", ",", 
   RowBox[{"-", "1.`"}], ",", "1.`", ",", 
   RowBox[{"-", "0.847229251251657`"}], ",", "0.847229251251657`", ",", "0.`",
    ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.679914287690852*^9, 3.6799142911350613`*^9}, {
   3.6799148179699793`*^9, 3.679914846452776*^9}, 3.679915580794606*^9, 
   3.679915709948048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "13"}], "}"}]}], "}"}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.679921712484644*^9, 3.6799217299632196`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.082762530298218`", ",", "0.9172374697017807`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.679921730231583*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{783, 618},
WindowMargins->{{Automatic, 75}, {Automatic, 44}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 103, 1, 64, "Section"],
Cell[686, 25, 141, 3, 28, "Input"],
Cell[830, 30, 528, 12, 87, "Text"],
Cell[1361, 44, 28245, 726, 2538, "Input"],
Cell[29609, 772, 4572, 112, 303, "Input"],
Cell[34184, 886, 1495, 39, 114, "Input"],
Cell[CellGroupData[{
Cell[35704, 929, 566, 15, 28, "Input"],
Cell[36273, 946, 3948, 120, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40258, 1071, 648, 16, 28, "Input"],
Cell[40909, 1089, 1856, 55, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42802, 1149, 884, 19, 28, "Input"],
Cell[43689, 1170, 863, 17, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44589, 1192, 472, 13, 46, "Input"],
Cell[45064, 1207, 497, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45598, 1222, 1206, 29, 114, "Input"],
Cell[46807, 1253, 517, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47361, 1270, 1391, 34, 114, "Input"],
Cell[48755, 1306, 626, 14, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[49430, 1326, 40, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[49495, 1330, 103, 1, 44, "Subsection"],
Cell[49601, 1333, 39891, 1004, 3155, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[89529, 2342, 107, 1, 36, "Subsection"],
Cell[89639, 2345, 31355, 682, 2498, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121031, 3032, 124, 1, 44, "Subsection"],
Cell[121158, 3035, 7402, 166, 692, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128609, 3207, 38, 0, 62, "Subchapter"],
Cell[128650, 3209, 961, 25, 307, "Text"],
Cell[CellGroupData[{
Cell[129636, 3238, 2092, 56, 250, "Input"],
Cell[CellGroupData[{
Cell[131753, 3298, 582, 11, 22, "Print"],
Cell[132338, 3311, 1179, 32, 38, "Print"],
Cell[133520, 3345, 464, 9, 21, "Print"],
Cell[133987, 3356, 467, 9, 21, "Print"],
Cell[134457, 3367, 467, 9, 21, "Print"],
Cell[134927, 3378, 508, 10, 21, "Print"],
Cell[135438, 3390, 535, 12, 21, "Print"]
}, Open  ]],
Cell[135988, 3405, 847, 17, 75, "Output"],
Cell[136838, 3424, 535, 12, 22, "Print"],
Cell[137376, 3438, 1001, 17, 46, "Output"],
Cell[138380, 3457, 543, 12, 22, "Print"],
Cell[138926, 3471, 2487, 70, 162, "Output"],
Cell[141416, 3543, 2467, 69, 162, "Output"],
Cell[143886, 3614, 2944, 59, 149, "Output"],
Cell[146833, 3675, 6131, 111, 387, "Output"],
Cell[152967, 3788, 3693, 117, 576, "Output"]
}, Open  ]],
Cell[156675, 3908, 674, 17, 216, "Text"],
Cell[157352, 3927, 332, 10, 63, "Input"],
Cell[157687, 3939, 626, 20, 46, "Input"],
Cell[158316, 3961, 1123, 22, 371, "Text"],
Cell[CellGroupData[{
Cell[159464, 3987, 128, 2, 28, "Input"],
Cell[159595, 3991, 94, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159726, 3997, 149, 2, 64, "Section"],
Cell[159878, 4001, 149, 3, 28, "Input"],
Cell[160030, 4006, 3306, 78, 267, "Input"],
Cell[CellGroupData[{
Cell[163361, 4088, 164, 3, 28, "Input"],
Cell[163528, 4093, 623, 11, 46, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[164212, 4111, 93, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[164330, 4116, 124, 1, 64, "Section"],
Cell[164457, 4119, 7242, 185, 618, "Input"],
Cell[CellGroupData[{
Cell[171724, 4308, 301, 5, 28, "Input"],
Cell[172028, 4315, 448, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172513, 4330, 314, 5, 28, "Input"],
Cell[172830, 4337, 377, 8, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173244, 4350, 1847, 48, 127, "Input"],
Cell[175094, 4400, 545, 10, 70, "Output"],
Cell[175642, 4412, 611, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176290, 4429, 152, 3, 28, "Input"],
Cell[176445, 4434, 343, 8, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[176837, 4448, 118, 1, 50, "Section"],
Cell[176958, 4451, 536, 15, 55, "Text"],
Cell[CellGroupData[{
Cell[177519, 4470, 2107, 64, 208, "Input"],
Cell[179629, 4536, 208, 5, 56, "Output"],
Cell[179840, 4543, 206, 5, 56, "Output"],
Cell[180049, 4550, 208, 5, 33, "Output"],
Cell[180260, 4557, 208, 5, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[180517, 4568, 104, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[180646, 4573, 7215, 187, 779, "Input"],
Cell[187864, 4762, 490, 7, 28, "Output"],
Cell[188357, 4771, 490, 7, 28, "Output"],
Cell[188850, 4780, 490, 7, 28, "Output"],
Cell[189343, 4789, 490, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189870, 4801, 103, 2, 28, "Input"],
Cell[189976, 4805, 934, 23, 64, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[190959, 4834, 166, 2, 50, "Section"],
Cell[191128, 4838, 144, 2, 46, "Text"],
Cell[191275, 4842, 4053, 88, 314, "Input"],
Cell[CellGroupData[{
Cell[195353, 4934, 157, 3, 28, "Input"],
Cell[195513, 4939, 149, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195699, 4946, 536, 10, 46, "Input"],
Cell[196238, 4958, 226, 5, 33, "Output"],
Cell[196467, 4965, 235, 5, 47, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[196751, 4976, 182, 2, 50, "Section"],
Cell[196936, 4980, 12559, 306, 1247, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[209532, 5291, 95, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[209652, 5296, 1212, 30, 148, "Input"],
Cell[CellGroupData[{
Cell[210889, 5330, 563, 10, 22, "Print"],
Cell[211455, 5342, 1089, 29, 38, "Print"],
Cell[212547, 5373, 448, 8, 21, "Print"],
Cell[212998, 5383, 448, 8, 21, "Print"],
Cell[213449, 5393, 448, 8, 21, "Print"],
Cell[213900, 5403, 494, 9, 21, "Print"]
}, Open  ]],
Cell[214409, 5415, 2670, 79, 153, "Output"],
Cell[217082, 5496, 2715, 85, 353, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219846, 5587, 120, 1, 64, "Section"],
Cell[219969, 5590, 293, 6, 46, "Text"],
Cell[CellGroupData[{
Cell[220287, 5600, 3674, 88, 362, "Input"],
Cell[223964, 5690, 609, 10, 56, "Output"],
Cell[224576, 5702, 567, 8, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225180, 5715, 88, 2, 28, "Input"],
Cell[225271, 5719, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225378, 5725, 263, 7, 28, "Input"],
Cell[225644, 5734, 1089, 35, 101, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[226782, 5775, 153, 2, 50, "Section"],
Cell[226938, 5779, 200, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[227163, 5787, 158, 2, 44, "Subsection"],
Cell[227324, 5791, 4785, 122, 539, "Input"],
Cell[CellGroupData[{
Cell[232134, 5917, 406, 8, 46, "Input"],
Cell[232543, 5927, 2470, 82, 413, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235050, 6014, 165, 3, 28, "Input"],
Cell[235218, 6019, 2370, 82, 413, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237625, 6106, 416, 9, 46, "Input"],
Cell[238044, 6117, 701, 12, 46, "Output"],
Cell[238748, 6131, 699, 12, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239484, 6148, 364, 12, 28, "Input"],
Cell[239851, 6162, 154, 4, 62, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
