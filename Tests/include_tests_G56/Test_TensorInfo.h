namespace Test_TensorInfo
{
	using namespace dealii;

//	#include "develop_Aminus.h"

	Full_matrix Projector_manuel(const double nx,const double ny,
								   const unsigned int nEqn)
	{
		Full_matrix global_Projector;
		global_Projector.resize(nEqn,nEqn);

		global_Projector << 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.*nx,1.*ny,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1.*ny,1.*nx,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.7886751345948129*pow(nx,2) - 0.21132486540518713*pow(ny,2),
   1.4142135623730951*nx*ny,-0.21132486540518713*pow(nx,2) + 
    0.7886751345948129*pow(ny,2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,-1.*nx*ny,0.7071067811865476*pow(nx,2) - 0.7071067811865476*pow(ny,2),
   1.*nx*ny,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.21132486540518713*pow(nx,2) + 0.7886751345948129*pow(ny,2),
   -1.4142135623730951*nx*ny,0.7886751345948129*pow(nx,2) - 
    0.21132486540518713*pow(ny,2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,1.*nx,1.*ny,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,-1.*ny,1.*nx,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0.6051359354609693*pow(nx,3) - 0.5516289482287868*nx*pow(ny,2),
   1.4476551742303836*ny*pow(nx,2) - 0.18387631607626226*pow(ny,3),
   -0.18387631607626226*pow(nx,3) + 1.4476551742303836*nx*pow(ny,2),
   -0.5516289482287868*ny*pow(nx,2) + 0.6051359354609693*pow(ny,3),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.9728885676134938*ny*pow(nx,2) + 0.18387631607626226*pow(ny,3),
   0.4825517247434612*pow(nx,3) - 1.1489797655631846*nx*pow(ny,2),
   1.1489797655631846*ny*pow(nx,2) - 0.4825517247434612*pow(ny,3),
   -0.18387631607626226*pow(nx,3) + 0.9728885676134938*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.18387631607626226*pow(nx,3) + 0.9728885676134938*nx*pow(ny,2),
   -1.1489797655631846*ny*pow(nx,2) + 0.4825517247434612*pow(ny,3),
   0.4825517247434612*pow(nx,3) - 1.1489797655631846*nx*pow(ny,2),
   0.9728885676134938*ny*pow(nx,2) - 0.18387631607626226*pow(ny,3),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.5516289482287868*ny*pow(nx,2) - 0.6051359354609693*pow(ny,3),
   -0.18387631607626226*pow(nx,3) + 1.4476551742303836*nx*pow(ny,2),
   -1.4476551742303836*ny*pow(nx,2) + 0.18387631607626226*pow(ny,3),
   0.6051359354609693*pow(nx,3) - 0.5516289482287868*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.7886751345948129*pow(nx,2) - 
    0.21132486540518713*pow(ny,2),1.4142135623730951*nx*ny,
   -0.21132486540518713*pow(nx,2) + 0.7886751345948129*pow(ny,2),0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1.*nx*ny,
   0.7071067811865476*pow(nx,2) - 0.7071067811865476*pow(ny,2),1.*nx*ny,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.21132486540518713*pow(nx,2) + 0.7886751345948129*pow(ny,2),
   -1.4142135623730951*nx*ny,0.7886751345948129*pow(nx,2) - 
    0.21132486540518713*pow(ny,2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0.451650062404136*pow(nx,4) - 0.8303896737210595*pow(nx,2)*pow(ny,2) + 
    0.07368558939490877*pow(ny,4),1.3779644730092273*ny*pow(nx,3) - 
    0.6220355269907727*nx*pow(ny,3),
   -0.13839827895350992*pow(nx,4) + 1.8026306909975467*pow(nx,2)*pow(ny,2) - 
    0.13839827895350992*pow(ny,4),-0.6220355269907727*ny*pow(nx,3) + 
    1.3779644730092273*nx*pow(ny,3),
   0.07368558939490877*pow(nx,4) - 0.8303896737210595*pow(nx,2)*pow(ny,2) + 
    0.451650062404136*pow(ny,4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,-0.8668448992646658*ny*pow(nx,3) + 0.48888042625543854*nx*pow(ny,3),
   0.3444911182523068*pow(nx,4) - 1.5*pow(nx,2)*pow(ny,2) + 
    0.15550888174769317*pow(ny,4),1.0397136244522833*ny*pow(nx,3) - 
    1.0397136244522833*nx*pow(ny,3),
   -0.15550888174769317*pow(nx,4) + 1.5*pow(nx,2)*pow(ny,2) - 
    0.3444911182523068*pow(ny,4),-0.48888042625543854*ny*pow(nx,3) + 
    0.8668448992646658*nx*pow(ny,3),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,-0.13839827895350992*pow(nx,4) + 1.0789287676130845*pow(nx,2)*pow(ny,2) - 
    0.13839827895350992*pow(ny,4),-1.*ny*pow(nx,3) + 1.*nx*pow(ny,3),
   0.3004384484995911*pow(nx,4) - 1.4785503519053842*pow(nx,2)*pow(ny,2) + 
    0.3004384484995911*pow(ny,4),1.*ny*pow(nx,3) - 1.*nx*pow(ny,3),
   -0.13839827895350992*pow(nx,4) + 1.0789287676130845*pow(nx,2)*pow(ny,2) - 
    0.13839827895350992*pow(ny,4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0.48888042625543854*ny*pow(nx,3) - 0.8668448992646658*nx*pow(ny,3),
   -0.15550888174769317*pow(nx,4) + 1.5*pow(nx,2)*pow(ny,2) - 
    0.3444911182523068*pow(ny,4),-1.0397136244522833*ny*pow(nx,3) + 
    1.0397136244522833*nx*pow(ny,3),
   0.3444911182523068*pow(nx,4) - 1.5*pow(nx,2)*pow(ny,2) + 
    0.15550888174769317*pow(ny,4),0.8668448992646658*ny*pow(nx,3) - 
    0.48888042625543854*nx*pow(ny,3),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0.07368558939490877*pow(nx,4) - 0.8303896737210595*pow(nx,2)*pow(ny,2) + 
    0.451650062404136*pow(ny,4),0.6220355269907727*ny*pow(nx,3) - 
    1.3779644730092273*nx*pow(ny,3),
   -0.13839827895350992*pow(nx,4) + 1.8026306909975467*pow(nx,2)*pow(ny,2) - 
    0.13839827895350992*pow(ny,4),-1.3779644730092273*ny*pow(nx,3) + 
    0.6220355269907727*nx*pow(ny,3),
   0.451650062404136*pow(nx,4) - 0.8303896737210595*pow(nx,2)*pow(ny,2) + 
    0.07368558939490877*pow(ny,4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,1.*nx,1.*ny,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,-1.*ny,1.*nx,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0.6051359354609693*pow(nx,3) - 0.5516289482287868*nx*pow(ny,2),
   1.4476551742303836*ny*pow(nx,2) - 0.18387631607626226*pow(ny,3),
   -0.18387631607626226*pow(nx,3) + 1.4476551742303836*nx*pow(ny,2),
   -0.5516289482287868*ny*pow(nx,2) + 0.6051359354609693*pow(ny,3),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.9728885676134938*ny*pow(nx,2) + 0.18387631607626226*pow(ny,3),
   0.4825517247434612*pow(nx,3) - 1.1489797655631846*nx*pow(ny,2),
   1.1489797655631846*ny*pow(nx,2) - 0.4825517247434612*pow(ny,3),
   -0.18387631607626226*pow(nx,3) + 0.9728885676134938*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.18387631607626226*pow(nx,3) + 0.9728885676134938*nx*pow(ny,2),
   -1.1489797655631846*ny*pow(nx,2) + 0.4825517247434612*pow(ny,3),
   0.4825517247434612*pow(nx,3) - 1.1489797655631846*nx*pow(ny,2),
   0.9728885676134938*ny*pow(nx,2) - 0.18387631607626226*pow(ny,3),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.5516289482287868*ny*pow(nx,2) - 0.6051359354609693*pow(ny,3),
   -0.18387631607626226*pow(nx,3) + 1.4476551742303836*nx*pow(ny,2),
   -1.4476551742303836*ny*pow(nx,2) + 0.18387631607626226*pow(ny,3),
   0.6051359354609693*pow(nx,3) - 0.5516289482287868*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.3348780105982805*pow(nx,5) - 1.050471690880714*pow(nx,3)*pow(ny,2) + 
    0.3084613941989789*nx*pow(ny,4),
   1.2200151806866013*ny*pow(nx,4) - 1.1334485995314771*pow(nx,2)*pow(ny,3) + 
    0.06169227883979578*pow(ny,5),-0.1050471690880714*pow(nx,5) + 
    2.0297142672836626*pow(nx,3)*pow(ny,2) - 0.5667242997657387*nx*pow(ny,4),
   -0.5667242997657387*ny*pow(nx,4) + 2.0297142672836626*pow(nx,2)*pow(ny,3) - 
    0.10504716908807137*pow(ny,5),0.061692278839795806*pow(nx,5) - 
    1.1334485995314774*pow(nx,3)*pow(ny,2) + 1.220015180686601*nx*pow(ny,4),
   0.30846139419897917*ny*pow(nx,4) - 1.0504716908807137*pow(nx,2)*pow(ny,3) + 
    0.33487801059828043*pow(ny,5),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,-0.755066686950566*ny*pow(nx,4) + 0.8770521298876115*pow(nx,2)*pow(ny,3) - 
    0.06169227883979578*pow(ny,5),0.24400303613732024*pow(nx,5) - 
    1.6560813042681675*pow(nx,3)*pow(ny,2) + 0.5150717186523867*nx*pow(ny,4),
   0.9169328760015365*ny*pow(nx,4) - 1.6712080001827887*pow(nx,2)*pow(ny,3) + 
    0.11334485995314775*pow(ny,5),-0.11334485995314773*pow(nx,5) + 
    1.6712080001827887*pow(nx,3)*pow(ny,2) - 0.9169328760015364*nx*pow(ny,4),
   -0.5150717186523868*ny*pow(nx,4) + 1.6560813042681675*pow(nx,2)*pow(ny,3) - 
    0.24400303613732022*pow(ny,5),0.06169227883979583*pow(nx,5) - 
    0.8770521298876115*pow(nx,3)*pow(ny,2) + 0.7550666869505659*nx*pow(ny,4),0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.1050471690880714*pow(nx,5) + 1.1502378616460962*pow(nx,3)*pow(ny,2) - 
    0.43852606494380575*nx*pow(ny,4),
   -0.8280406521340837*ny*pow(nx,4) + 1.4737705469706428*pow(nx,2)*pow(ny,3) - 
    0.11334485995314772*pow(ny,5),0.20297142672836627*pow(nx,5) - 
    1.6629103093177124*pow(nx,3)*pow(ny,2) + 0.8356040000913943*nx*pow(ny,4),
   0.8356040000913943*ny*pow(nx,4) - 1.6629103093177124*pow(nx,2)*pow(ny,3) + 
    0.20297142672836627*pow(ny,5),-0.11334485995314775*pow(nx,5) + 
    1.4737705469706428*pow(nx,3)*pow(ny,2) - 0.8280406521340837*nx*pow(ny,4),
   -0.43852606494380575*ny*pow(nx,4) + 1.1502378616460962*pow(nx,2)*pow(ny,3) - 
    0.10504716908807137*pow(ny,5),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0.43852606494380575*ny*pow(nx,4) - 1.1502378616460962*pow(nx,2)*pow(ny,3) + 
    0.1050471690880714*pow(ny,5),-0.11334485995314772*pow(nx,5) + 
    1.4737705469706428*pow(nx,3)*pow(ny,2) - 0.8280406521340837*nx*pow(ny,4),
   -0.8356040000913943*ny*pow(nx,4) + 1.6629103093177124*pow(nx,2)*pow(ny,3) - 
    0.20297142672836627*pow(ny,5),0.20297142672836627*pow(nx,5) - 
    1.6629103093177124*pow(nx,3)*pow(ny,2) + 0.8356040000913943*nx*pow(ny,4),
   0.8280406521340837*ny*pow(nx,4) - 1.4737705469706428*pow(nx,2)*pow(ny,3) + 
    0.11334485995314775*pow(ny,5),-0.10504716908807137*pow(nx,5) + 
    1.1502378616460962*pow(nx,3)*pow(ny,2) - 0.43852606494380575*nx*pow(ny,4),0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.06169227883979578*pow(nx,5) - 0.8770521298876115*pow(nx,3)*pow(ny,2) + 
    0.755066686950566*nx*pow(ny,4),0.5150717186523867*ny*pow(nx,4) - 
    1.6560813042681675*pow(nx,2)*pow(ny,3) + 0.24400303613732024*pow(ny,5),
   -0.11334485995314775*pow(nx,5) + 1.6712080001827887*pow(nx,3)*pow(ny,2) - 
    0.9169328760015365*nx*pow(ny,4),
   -0.9169328760015364*ny*pow(nx,4) + 1.6712080001827887*pow(nx,2)*pow(ny,3) - 
    0.11334485995314773*pow(ny,5),0.24400303613732022*pow(nx,5) - 
    1.6560813042681675*pow(nx,3)*pow(ny,2) + 0.5150717186523868*nx*pow(ny,4),
   0.7550666869505659*ny*pow(nx,4) - 0.8770521298876115*pow(nx,2)*pow(ny,3) + 
    0.06169227883979583*pow(ny,5),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,-0.3084613941989789*ny*pow(nx,4) + 1.050471690880714*pow(nx,2)*pow(ny,3) - 
    0.3348780105982805*pow(ny,5),0.06169227883979578*pow(nx,5) - 
    1.1334485995314771*pow(nx,3)*pow(ny,2) + 1.2200151806866013*nx*pow(ny,4),
   0.5667242997657387*ny*pow(nx,4) - 2.0297142672836626*pow(nx,2)*pow(ny,3) + 
    0.1050471690880714*pow(ny,5),-0.10504716908807137*pow(nx,5) + 
    2.0297142672836626*pow(nx,3)*pow(ny,2) - 0.5667242997657387*nx*pow(ny,4),
   -1.220015180686601*ny*pow(nx,4) + 1.1334485995314774*pow(nx,2)*pow(ny,3) - 
    0.061692278839795806*pow(ny,5),0.33487801059828043*pow(nx,5) - 
    1.0504716908807137*pow(nx,3)*pow(ny,2) + 0.30846139419897917*nx*pow(ny,4);

		return(global_Projector);
	}

	Full_matrix InvProjector_manuel(const double nx,const double ny,
									  const unsigned int nEqn)
	{
		Full_matrix Inv_global_Projector;
		Inv_global_Projector.resize(nEqn,nEqn);

		Inv_global_Projector <<1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.*nx,-1.*ny,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.*ny,1.*nx,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   1.3660254037844386*pow(nx,2) + 0.3660254037844386*pow(ny,2),-2.*nx*ny,
   0.3660254037844386*pow(nx,2) + 1.3660254037844386*pow(ny,2),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.4142135623730951*nx*ny,
   1.4142135623730951*pow(nx,2) - 1.4142135623730951*pow(ny,2),
   -1.4142135623730951*nx*ny,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0.3660254037844386*pow(nx,2) + 1.3660254037844386*pow(ny,2),2.*nx*ny,
   1.3660254037844386*pow(nx,2) + 0.3660254037844386*pow(ny,2),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.*nx,-1.*ny,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.*ny,1.*nx,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   1.8689147936150907*pow(nx,3) + 0.712149909925335*nx*pow(ny,2),
   -4.182444560994602*pow(nx,2)*ny - 0.712149909925335*pow(ny,3),
   0.712149909925335*pow(nx,3) + 4.182444560994602*nx*pow(ny,2),
   -0.712149909925335*pow(nx,2)*ny - 1.8689147936150907*pow(ny,3),0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   2.3436814002319806*pow(nx,2)*ny + 0.7121499099253348*pow(ny,3),
   2.3436814002319806*pow(nx,3) - 2.550913070687957*nx*pow(ny,2),
   -2.550913070687957*pow(nx,2)*ny + 2.3436814002319806*pow(ny,3),
   0.7121499099253348*pow(nx,3) + 2.3436814002319806*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.7121499099253349*pow(nx,3) + 2.3436814002319806*nx*pow(ny,2),
   2.5509130706879564*pow(nx,2)*ny - 2.3436814002319806*pow(ny,3),
   2.3436814002319806*pow(nx,3) - 2.5509130706879564*nx*pow(ny,2),
   -2.3436814002319806*pow(nx,2)*ny - 0.7121499099253349*pow(ny,3),0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.7121499099253349*pow(nx,2)*ny + 1.8689147936150907*pow(ny,3),
   0.7121499099253349*pow(nx,3) + 4.182444560994603*nx*pow(ny,2),
   4.182444560994603*pow(nx,2)*ny + 0.7121499099253349*pow(ny,3),
   1.8689147936150907*pow(nx,3) + 0.7121499099253349*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   1.3660254037844386*pow(nx,2) + 0.3660254037844386*pow(ny,2),-2.*nx*ny,
   0.3660254037844386*pow(nx,2) + 1.3660254037844386*pow(ny,2),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.4142135623730951*nx*ny,
   1.4142135623730951*pow(nx,2) - 1.4142135623730951*pow(ny,2),
   -1.4142135623730951*nx*ny,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0.3660254037844386*pow(nx,2) + 1.3660254037844386*pow(ny,2),2.*nx*ny,
   1.3660254037844386*pow(nx,2) + 0.3660254037844386*pow(ny,2),0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   2.579699856999917*pow(nx,4) + 1.15792307741514*pow(nx,2)*pow(ny,2) - 
    0.06605145406467361*pow(ny,4),
   -8.002953273169389*pow(nx,3)*ny - 2.580051971088974*nx*pow(ny,3),
   1.15792307741514*pow(nx,4) + 10.4501981079509*pow(nx,2)*pow(ny,2) + 
    1.15792307741514*pow(ny,4),-2.580051971088974*pow(nx,3)*ny - 
    8.002953273169389*nx*pow(ny,3),
   -0.06605145406467361*pow(nx,4) + 1.15792307741514*pow(nx,2)*pow(ny,2) + 
    2.579699856999917*pow(ny,4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,3.6457513110645907*pow(nx,3)*ny + 1.6457513110645907*nx*pow(ny,3),
   3.6457513110645907*pow(nx,4) - 6.000000000000001*pow(nx,2)*pow(ny,2) - 
    1.6457513110645907*pow(ny,4),-6.000000000000001*pow(nx,3)*ny + 
    6.000000000000001*nx*pow(ny,3),
   1.6457513110645907*pow(nx,4) + 6.000000000000001*pow(nx,2)*pow(ny,2) - 
    3.6457513110645907*pow(ny,4),-1.6457513110645907*pow(nx,3)*ny - 
    3.6457513110645907*nx*pow(ny,3),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,1.1579230774151392*pow(nx,4) + 4.395273403734846*pow(nx,2)*pow(ny,2) + 
    1.1579230774151392*pow(ny,4),4.158854497809135*pow(nx,3)*ny - 
    4.158854497809135*nx*pow(ny,3),
   4.395273403734846*pow(nx,4) - 3.686016685957714*pow(nx,2)*pow(ny,2) + 
    4.395273403734846*pow(ny,4),-4.158854497809135*pow(nx,3)*ny + 
    4.158854497809135*nx*pow(ny,3),
   1.1579230774151392*pow(nx,4) + 4.395273403734846*pow(nx,2)*pow(ny,2) + 
    1.1579230774151392*pow(ny,4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,1.6457513110645907*pow(nx,3)*ny + 3.6457513110645907*nx*pow(ny,3),
   1.6457513110645907*pow(nx,4) + 6.000000000000001*pow(nx,2)*pow(ny,2) - 
    3.6457513110645907*pow(ny,4),6.000000000000001*pow(nx,3)*ny - 
    6.000000000000001*nx*pow(ny,3),
   3.6457513110645907*pow(nx,4) - 6.000000000000001*pow(nx,2)*pow(ny,2) - 
    1.6457513110645907*pow(ny,4),-3.6457513110645907*pow(nx,3)*ny - 
    1.6457513110645907*nx*pow(ny,3),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,-0.06605145406467361*pow(nx,4) + 
    1.15792307741514*pow(nx,2)*pow(ny,2) + 2.579699856999917*pow(ny,4),
   2.580051971088974*pow(nx,3)*ny + 8.002953273169389*nx*pow(ny,3),
   1.15792307741514*pow(nx,4) + 10.4501981079509*pow(nx,2)*pow(ny,2) + 
    1.15792307741514*pow(ny,4),8.002953273169389*pow(nx,3)*ny + 
    2.580051971088974*nx*pow(ny,3),
   2.579699856999917*pow(nx,4) + 1.15792307741514*pow(nx,2)*pow(ny,2) - 
    0.06605145406467361*pow(ny,4),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,1.*nx,-1.*ny,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,0,0,1.*ny,1.*nx,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,1.8689147936150907*pow(nx,3) + 0.712149909925335*nx*pow(ny,2),
   -4.182444560994602*pow(nx,2)*ny - 0.712149909925335*pow(ny,3),
   0.712149909925335*pow(nx,3) + 4.182444560994602*nx*pow(ny,2),
   -0.712149909925335*pow(nx,2)*ny - 1.8689147936150907*pow(ny,3),0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   2.3436814002319806*pow(nx,2)*ny + 0.7121499099253348*pow(ny,3),
   2.3436814002319806*pow(nx,3) - 2.550913070687957*nx*pow(ny,2),
   -2.550913070687957*pow(nx,2)*ny + 2.3436814002319806*pow(ny,3),
   0.7121499099253348*pow(nx,3) + 2.3436814002319806*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.7121499099253349*pow(nx,3) + 2.3436814002319806*nx*pow(ny,2),
   2.5509130706879564*pow(nx,2)*ny - 2.3436814002319806*pow(ny,3),
   2.3436814002319806*pow(nx,3) - 2.5509130706879564*nx*pow(ny,2),
   -2.3436814002319806*pow(nx,2)*ny - 0.7121499099253349*pow(ny,3),0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0.7121499099253349*pow(nx,2)*ny + 1.8689147936150907*pow(ny,3),
   0.7121499099253349*pow(nx,3) + 4.182444560994603*nx*pow(ny,2),
   4.182444560994603*pow(nx,2)*ny + 0.7121499099253349*pow(ny,3),
   1.8689147936150907*pow(nx,3) + 0.7121499099253349*nx*pow(ny,2),0,0,0,0,0,0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   3.565566182010038*pow(nx,5) + 1.8119495293924441*pow(nx,3)*pow(ny,2) - 
    0.05980555693962053*nx*pow(ny,4),
   -14.203931851265304*pow(nx,4)*ny - 5.675070815935815*pow(nx,2)*pow(ny,3) + 
    0.05980555693962053*pow(ny,5),
   1.8119495293924441*pow(nx,5) + 24.425131302107996*pow(nx,3)*pow(ny,2) + 
    5.675070815935815*nx*pow(ny,4),
   -5.675070815935815*pow(nx,4)*ny - 24.425131302107996*pow(nx,2)*pow(ny,3) - 
    1.8119495293924441*pow(ny,5),-0.05980555693962053*pow(nx,5) + 
    5.675070815935815*pow(nx,3)*pow(ny,2) + 14.203931851265304*nx*pow(ny,4),
   0.05980555693962053*pow(nx,4)*ny - 1.8119495293924441*pow(nx,2)*pow(ny,3) - 
    3.565566182010038*pow(ny,5),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,5.53478844156588*pow(nx,4)*ny + 3.059826825568384*pow(nx,2)*pow(ny,3) - 
    0.059805556939620974*pow(ny,5),
   5.53478844156588*pow(nx,5) - 12.959673289558367*pow(nx,3)*pow(ny,2) - 
    6.418681435834873*nx*pow(ny,4),
   -12.959673289558367*pow(nx,4)*ny + 14.251714126588766*pow(nx,2)*pow(ny,3) + 
    3.059826825568384*pow(ny,5),3.059826825568384*pow(nx,5) + 
    14.251714126588766*pow(nx,3)*pow(ny,2) - 12.959673289558367*nx*pow(ny,4),
   -6.418681435834873*pow(nx,4)*ny - 12.959673289558367*pow(nx,2)*pow(ny,3) + 
    5.53478844156588*pow(ny,5),-0.059805556939620974*pow(nx,5) + 
    3.059826825568384*pow(nx,3)*pow(ny,2) + 5.53478844156588*nx*pow(ny,4),0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   1.8119495293924444*pow(nx,5) + 7.5732620910983*pow(nx,3)*pow(ny,2) + 
    3.059826825568384*nx*pow(ny,4),
   6.086776535234378*pow(nx,4)*ny - 10.480478971021364*pow(nx,2)*pow(ny,3) - 
    3.059826825568384*pow(ny,5),7.5732620910983*pow(nx,5) - 
    8.961116299255053*pow(nx,3)*pow(ny,2) + 10.480478971021364*nx*pow(ny,4),
   -10.480478971021364*pow(nx,4)*ny + 8.961116299255053*pow(nx,2)*pow(ny,3) - 
    7.5732620910983*pow(ny,5),3.059826825568384*pow(nx,5) + 
    10.480478971021364*pow(nx,3)*pow(ny,2) - 6.086776535234378*nx*pow(ny,4),
   -3.059826825568384*pow(nx,4)*ny - 7.5732620910983*pow(nx,2)*pow(ny,3) - 
    1.8119495293924444*pow(ny,5),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,3.059826825568384*pow(nx,4)*ny + 7.5732620910983*pow(nx,2)*pow(ny,3) + 
    1.8119495293924448*pow(ny,5),3.059826825568384*pow(nx,5) + 
    10.480478971021364*pow(nx,3)*pow(ny,2) - 6.086776535234376*nx*pow(ny,4),
   10.480478971021364*pow(nx,4)*ny - 8.96111629925505*pow(nx,2)*pow(ny,3) + 
    7.5732620910983*pow(ny,5),7.5732620910983*pow(nx,5) - 
    8.96111629925505*pow(nx,3)*pow(ny,2) + 10.480478971021364*nx*pow(ny,4),
   -6.086776535234376*pow(nx,4)*ny + 10.480478971021364*pow(nx,2)*pow(ny,3) + 
    3.059826825568384*pow(ny,5),1.8119495293924448*pow(nx,5) + 
    7.5732620910983*pow(nx,3)*pow(ny,2) + 3.059826825568384*nx*pow(ny,4),0,0,0,0,
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   -0.05980555693962086*pow(nx,5) + 3.059826825568384*pow(nx,3)*pow(ny,2) + 
    5.53478844156588*nx*pow(ny,4),
   6.4186814358348725*pow(nx,4)*ny + 12.959673289558367*pow(nx,2)*pow(ny,3) - 
    5.53478844156588*pow(ny,5),3.059826825568384*pow(nx,5) + 
    14.251714126588766*pow(nx,3)*pow(ny,2) - 12.959673289558367*nx*pow(ny,4),
   12.959673289558367*pow(nx,4)*ny - 14.251714126588766*pow(nx,2)*pow(ny,3) - 
    3.059826825568384*pow(ny,5),5.53478844156588*pow(nx,5) - 
    12.959673289558367*pow(nx,3)*pow(ny,2) - 6.4186814358348725*nx*pow(ny,4),
   -5.53478844156588*pow(nx,4)*ny - 3.059826825568384*pow(nx,2)*pow(ny,3) + 
    0.05980555693962086*pow(ny,5),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
   0,0,-0.05980555693962086*pow(nx,4)*ny + 
    1.8119495293924448*pow(nx,2)*pow(ny,3) + 3.565566182010038*pow(ny,5),
   -0.05980555693962086*pow(nx,5) + 5.675070815935818*pow(nx,3)*pow(ny,2) + 
    14.203931851265303*nx*pow(ny,4),
   5.675070815935818*pow(nx,4)*ny + 24.425131302107992*pow(nx,2)*pow(ny,3) + 
    1.8119495293924448*pow(ny,5),1.8119495293924448*pow(nx,5) + 
    24.425131302107992*pow(nx,3)*pow(ny,2) + 5.675070815935818*nx*pow(ny,4),
   14.203931851265303*pow(nx,4)*ny + 5.675070815935818*pow(nx,2)*pow(ny,3) - 
    0.05980555693962086*pow(ny,5),
   3.565566182010038*pow(nx,5) + 1.8119495293924448*pow(nx,3)*pow(ny,2) - 
    0.05980555693962086*nx*pow(ny,4);

		return(Inv_global_Projector);
	}

	// TEST(iFullDegree,HandlesiFullDegree)
	// {
	// 	const unsigned int dim = 2;
	// 	const unsigned int tensors = 20;
	// 	VectorXd ntensors(tensors) ;
		 

	// 	for (unsigned int i = 0 ; i < tensors ; i ++)
	// 		ntensors(i) = i + 1;

	// 	TensorInfo::Base_TensorInfo<dim> base_tensorinfo;
	// 	base_tensorinfo.reinit(3);

	// 	VectorXd result(tensors);
	// 	VectorXd result_manuel(ntensors);


	// 	result_manuel<< 0, 1, 2, 2, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7;

	// 	for (unsigned int i = 0 ; i < ntensors.size() ; i ++)
	// 	{
	// 		result(i) = base_tensorinfo.iFullDegree(ntensors(i));
	// 		EXPECT_EQ(result(i),result_manuel(i));
	// 	}

	// }

	// TEST(iTraces,HandlesiTraces)
	// {
	// 	const unsigned int dim = 2;
	// 	const unsigned int tensors = 20;
	// 	VectorXd ntensors(tensors) ;
		 

	// 	for (unsigned int i = 0 ; i < tensors ; i ++)
	// 		ntensors(i) = i + 1;

	// 	TensorInfo::Base_TensorInfo<dim> base_tensorinfo;
	// 	base_tensorinfo.reinit(3);

	// 	VectorXd result(tensors);
	// 	VectorXd result_manuel(ntensors);


	// 	result_manuel<< 0, 0, 1, 0, 1, 0, 2, 1, 0, 2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0;

	// 	for (unsigned int i = 0 ; i < ntensors.size() ; i ++)
	// 	{
	// 		result(i) = base_tensorinfo.iTraces(ntensors(i));
	// 		EXPECT_EQ(result(i),result_manuel(i));
	// 	}		
	// }

	// TEST(iTensorDegree,HandlesiTensorDegree)
	// {
	// 	const unsigned int dim = 2;
	// 	const unsigned int tensors = 20;
	// 	VectorXd ntensors(tensors) ;


	// 	for (unsigned int i = 0 ; i < tensors ; i ++)
	// 		ntensors(i) = i + 1;

	// 	TensorInfo::Base_TensorInfo<dim> base_tensorinfo;
	// 	base_tensorinfo.reinit(3);

	// 	VectorXd result(tensors);
	// 	VectorXd result_manuel(ntensors);


	// 	result_manuel<< 0, 1, 0, 2, 1, 3, 0, 2, 4, 1, 3, 5, 0, 2, 4, 6, 1, 3, 5, 7;

	// 	for (unsigned int i = 0 ; i < ntensors.size() ; i ++)
	// 	{
	// 		result(i) = base_tensorinfo.iTensorDegree(ntensors(i));
	// 		EXPECT_EQ(result(i),result_manuel(i));
	// 	}		
	// }

	// TEST(varIdx,HandlesvarIdx)
	// {
	// 	const unsigned int dim = 2;
	// 	const unsigned int tensors = 4;
	// 	TensorInfo::Base_TensorInfo<dim> base_tensorinfo;
	// 	base_tensorinfo.reinit(tensors);

	// 	MatrixUI varIdx_result(20,2);

	// 	varIdx_result << 0, 0, 0, 1, 1, 0, 0, 2, 1, 1, 0, 3, 2, 0, 1, 2, 0, 4, 2, 1, 1, 3, 0, 
	// 						5, 3, 0, 2, 2, 1, 4, 0, 6, 3, 1, 2, 3, 1, 5, 0, 7;

	// 	for (unsigned int i = 0 ; i < varIdx_result.rows(); i ++)
	// 	{
	// 		EXPECT_EQ(base_tensorinfo.varIdx(i,0),varIdx_result(i,0)) << "Traces do not match";
	// 		EXPECT_EQ(base_tensorinfo.varIdx(i,1),varIdx_result(i,1)) << "Free indices do not match"; 
	// 	}
	// }

	// TEST(FreeIndices,HandlesFreeIndices)
	// {
	// 	const unsigned int dim = 2;
	// 	const unsigned int tensors = 20;
	// 	TensorInfo::Base_TensorInfo<dim> base_tensorinfo;
	// 	base_tensorinfo.reinit(tensors);

	// 	MatrixUI free_indices(tensors,1);

	// 	free_indices << 1, 2, 1, 3, 2, 4, 1, 3, 5, 2, 4, 6, 1, 3, 5, 7, 2, 4, 6, 8;

	// 	for (unsigned int i = 0 ; i < free_indices.size() ; i++)
	// 		EXPECT_EQ(base_tensorinfo.free_indices(i),free_indices(i))<<"free indices do not match";
	// }

	// TEST(FreeIndicesCumilative,HandlesFreeIndicesCumilative)
	// {
	// 	const unsigned int dim = 2;
	// 	const unsigned int tensors = 20;
	// 	TensorInfo::Base_TensorInfo<dim> base_tensorinfo;
	// 	base_tensorinfo.reinit(tensors);

	// 	MatrixUI free_indices_cumilative(tensors,1);		
	// 	free_indices_cumilative << 0, 1, 3, 4, 7, 9, 13, 14, 17, 22, 24, 28, 34, 35, 38, 43, 50, 52, 56,62;

	// 	for (unsigned int i = 0 ; i < free_indices_cumilative.size(); i ++)
	// 		EXPECT_EQ(base_tensorinfo.free_indices_cumilative(i),free_indices_cumilative(i))<< "Cumilative free indices do not match";
	// }

	TEST(Projector, HandlesG56Projector)
	{
		const unsigned int dim = 2;
		ASSERT_EQ(dim,2) << "3D not implemented" << std::endl;

		std::string folder_name = "../system_matrices/";
		Constants::Base_Constants constants(input_file);
		G56::G56<dim> G56(constants.constants,folder_name);

		std::vector<Tensor<1,dim>> normal_vectors(5);

		for (unsigned int i = 0 ; i < 5 ; i ++)
		{
			normal_vectors[i][0] = i * 0.1 + pow(i,2);
			normal_vectors[i][1] = i * 0.5 + pow(i,3);

			Sparse_matrix Projector = G56.build_Projector(normal_vectors[i]);
			Full_matrix result = Projector_manuel(normal_vectors[i][0],normal_vectors[i][1],G56.constants.nEqn);
			
			Compare_Float_Mat(Projector,result);
		}
	}

	TEST(InvProjector,HandlesG56InvProjector)
	{
		const unsigned int dim = 2;
		ASSERT_EQ(dim,2) << "3D not implemented" << std::endl;

		std::string folder_name = "../system_matrices/";
		Constants::Base_Constants constants(input_file);
		G56::G56<dim> G56(constants.constants,folder_name);

		std::vector<Tensor<1,dim>> normal_vectors(5);

		for (unsigned int i = 0 ; i < 5 ; i ++)
		{
			normal_vectors[i][0] = i * 0.1 + pow(i,2);
			normal_vectors[i][1] = i * 0.5 + pow(i,3);

			Sparse_matrix Inv_Projector = G56.build_InvProjector(normal_vectors[i]);
			Full_matrix result = InvProjector_manuel(normal_vectors[i][0],normal_vectors[i][1],G56.constants.nEqn);
			
			Compare_Float_Mat(Inv_Projector,result);
		}

	}

	// TEST(AminusAnG56,HandlesAminusAnG56)
	// {
	// 	const unsigned int dim = 2;
	// 	ASSERT_EQ(dim,2) << "3D not implemented" << std::endl;

	// 	std::string folder_name = "../system_matrices/";
	// 	Constants::Base_Constants constants(input_file);
	// 	G56::G56<dim> G56(constants.constants,folder_name);

	// 	std::vector<Tensor<1,dim>> normal_vectors(5);

	// 	for (unsigned int i = 0 ; i < 5 ; i ++)
	// 	{
	// 		normal_vectors[i][0] = i * 0.1 + pow(i,2) +1 ;
	// 		normal_vectors[i][1] = i * 0.5 + pow(i,3) + 1;

	// 		normal_vectors[i] = normal_vectors[i]/normal_vectors[i].norm();

	// 		Full_matrix Aminus = G56.build_Aminus(normal_vectors[i]);
	// 		Full_matrix result = Aminus_manuel(normal_vectors[i][0],normal_vectors[i][1],G56.constants.nEqn);
			
	// 		Compare_Float_Mat(Aminus,result);
	// 	}	
	// }

	}